var HandleUI=function(){this.additionalParams={};this.additionalParams.code="";this.bkgId=this.additionalParams.coins=0;this.additionalParams.wallet=0;this.promoAppllied=function(a){0==$("#applyPromo").prop("checked")&&this.checkPromo();$(".applremove").removeClass("hide");$(".applydremove").addClass("hide");var c=a.data.promo.id;$(".appl_"+c).addClass("hide");$(".promo_app"+c).removeClass("hide");$(".promoRemoveDiv").removeClass("hide");$(".card-body").removeClass("active");$(".promocard"+c).addClass("active");
$("#"+c).addClass("hide");$(".BookingInvoice_bkg_promo1_code").val(a.data.promo.code);$(".txtpromo").text(a.data.promo.code);$(".applydiscount").removeClass("hide");$(".applydiscount").text("Applied promo code: "+a.data.promo.code);$(".coupondiscount").text("Promo/Gozo coins applied");this.prevParams=JSON.parse($(".clsAdditionalParams").val());this.additionalParams.coins=this.prevParams.coins;this.additionalParams.code=a.data.promo.code;this.additionalParams.wallet=this.prevParams.wallet;this.updateAdditionalParams()};
this.promoRemoved=function(a){$(".applremove").removeClass("hide");$(".applydremove").addClass("hide");$(".promoRemoveDiv,.promoAppliedDiv,.sel_promo_app,.applydiscount").addClass("hide");$(".coupondiscount").text("Promo/Gozo coins");$(".card-body").removeClass("active");$(".sel_promo").removeClass("hide");$(".jkl").css({backgroundColor:" #fff",color:"#636363","border-color":"#ddd"});$(".spanPromoCreditSucc").html("");$(".jkl").addClass("lowerslab").removeClass("upperslab");$(".showPromoDescApplied").html(a.message);
this.prevParams=JSON.parse($(".clsAdditionalParams").val());this.additionalParams.coins=this.prevParams.coins;this.additionalParams.code="";this.additionalParams.wallet=this.prevParams.wallet;this.updateAdditionalParams()};this.setErrors=function(a){toastr.error("<div class='errorSummary'><ul><li>"+a.errors[0]+"</li></ul></div>","Failed to process!",{closeButton:!0,tapToDismiss:!1,timeout:5E5})};this.creditApplied=function(a){0==$("#applyGozocoins").prop("checked")&&this.checkGozocoins();$(".creditRemoveDiv").removeClass("hide");
$(".applydiscount").text("Gozocoins \u20b9"+a.data.fare.gozoCoins+" applied");this.prevParams=JSON.parse($(".clsAdditionalParams").val());this.additionalParams.code=this.prevParams.code;this.additionalParams.coins=a.data.fare.gozoCoins;this.additionalParams.wallet=this.prevParams.wallet;this.updateAdditionalParams()};this.creditRemoved=function(a){$(".creditRemoveDiv").addClass("hide");this.prevParams=JSON.parse($(".clsAdditionalParams").val());this.additionalParams.code=this.prevParams.code;this.additionalParams.coins=
0;this.additionalParams.wallet=this.prevParams.wallet;this.updateAdditionalParams()};this.walletApplied=function(a){$(".walletbox").addClass("hide");$(".walletRemoveDiv").removeClass("hide");$(".confirmbooking").removeClass("hide");$("#remainingWallet").text($("#walletbalance").val()-a.data.wallet)};this.walletRemoved=function(a){$(".walletbox").removeClass("hide");$(".walletRemoveDiv").addClass("hide");$(".confirmbooking").addClass("hide");$(".textproceed").removeClass("hide");$(".paymentoption").removeClass("hide");
$("#remainingWallet").text($("#walletbalance").val())};this.checkGozocoins=function(){$(".promoApplyDiv").hide();$(".autoPromoApplyDiv").hide();$(".creditApplyDiv").removeClass("hide");$(".creditApplyDiv").show();$(".creditApplyDiv").css("display","block");$("#applyGozocoins").prop("checked",!0);$("#applyPromo").prop("checked",!1)};this.checkPromo=function(){$(".promoApplyDiv").show();$(".autoPromoApplyDiv").show();$(".creditApplyDiv").hide();$(".creditApplyDiv").css("display","none");$("#applyGozocoins").prop("checked",
!1);$("#applyPromo").prop("checked",!0)};this.updateInvoice=function(a){this.updateBillingInvoice(a.data.fare,a.data.promo,a.data.wallet);this.updatePayBox(a.data.fare)};this.updateBillingInvoice=function(a,c,b){$(".clsBilling").addClass("hide");$(".txtBaseFare").text(this.moneyFormatter(a.baseFare));$(".txtPromoCode").html("");$(".distxtwallet").removeClass("color-highlight bolder");$(".distxtpromo").removeClass("color-highlight bolder");$(".distxtgozo").removeClass("color-highlight bolder");null!=
c?($(".txtPromoCode").html(c.code),$(".txtPromoId").val(c.id)):this.promoRemoved(a);$(".txtDiscountAmount").text(this.moneyFormatter(a.discount));$(".txtDiscountedBaseAmount").text(this.moneyFormatter(a.netBaseFare));$(".txtDriverAllowance").text(this.moneyFormatter(a.driverAllowance));$(".txtTollTax").text(this.moneyFormatter(a.tollTax));$(".txtStateTax").text(this.moneyFormatter(a.stateTax));$(".txtAirportFee").text(this.moneyFormatter(a.airportFee));$(".txtGstAmount").text(this.moneyFormatter(a.gst));
$(".txtEstimatedAmount").text(this.moneyFormatter(a.totalAmount));$(".txtAdvancePaid").text(this.moneyFormatter(a.customerPaid));$(".txtGozoCoinsUsed").text(a.gozoCoins);$(".hiddenGozoCoinsUsed").text(a.gozoCoins);$(".txtDueAmount").text(this.moneyFormatter(a.dueAmount));0!=a.addOnCharge&&($(".txtAddOnCharge").html(a.addOnCharge),$(".vwAddOnCharge").removeClass("hide"));0<a.baseFare&&($(".vwBaseFare").removeClass("hide"),$(".clsprmapplyaa").addClass("hide"));0<a.discount&&($(".vwDiscount").removeClass("hide"),
$(".distxtpromo").addClass("color-highlight bolder"));0<a.driverAllowance&&$(".vwDriverAllowance").removeClass("hide");1==a.tollIncluded&&0<a.tollTax&&$(".vwTollTax").removeClass("hide");1==a.stateTaxIncluded&&0<a.stateTax&&$(".vwStateTax").removeClass("hide");1==a.airportChargeIncluded&&0<a.airportFee&&$(".vwAirportCharge").removeClass("hide");0<a.customerPaid&&$(".vwAdvancePaid").removeClass("hide");0<a.gozoCoins?($(".vwGozoCoinsUsed").removeClass("hide"),$(".vwDueAmount").removeClass("hide"),$(".distxtgozo").addClass("color-highlight bolder"),
$(".clsprmapplyaa").removeClass("hide")):($(".vwGozoCoinsUsed").addClass("hide"),this.creditRemoved(a));b=parseInt(b);0<b&&($(".vwWalletUsed").removeClass("hide"),$(".walletUsed").text(b),$(".vwDueAmount").removeClass("hide"),$(".distxtwallet").addClass("color-highlight bolder"));0<b&&0==a.minPay&&($(".textproceed").addClass("hide"),$(".paymentoption").addClass("hide"))};this.updatePayBox=function(a){let c=a.minPay,b=a.dueAmount,d=0<a.customerPaid?b:a.totalAmount;$(".payChk:checked").val();$("#minamount").val(c);
$("#dueamount").val(b);$("#discountamount").val(a.discount);$(".payBoxBtnAmount").text(this.moneyFormatter(c));$(".payBoxMinAmount").text(this.moneyFormatter(c));$(".payBoxMinAmount").val(c);$(".minDueAmount").text(this.moneyFormatter(c));$(".payBoxDueAmount").text(this.moneyFormatter(b));$(".payBoxTotalAmount").html("<b>"+this.moneyFormatter(d)+"</b>");$(".clsMinPay").text(this.moneyFormatter(b));$(".maxAmount").val(b);$(".minipay").val(c);$(".clsPartialPayment").attr("min",c);$(".clsPartialPayment").attr("max",
b)};this.updateAdditionalParams=function(){$(".clsAdditionalParams").val(JSON.stringify(this.additionalParams))};this.getToken=function(){return $("input[name='YII_CSRF_TOKEN']").val()};this.moneyFormatter=function(a,c=0){a=a.toString();var b=a.substring(a.length-3);a=a.substring(0,a.length-3);""!=a&&(b=","+b);b=a.replace(/\B(?=(\d{2})+(?!\d))/g,",")+b;return 1==c?b:"\u20b9"+b};this.removeCommas=function(a){a=a.replaceAll(",","");return a=parseInt(a)}};