class Promotion{constructor(a){this.coins=0;this.code="";this.wallet=this.eventType=0;this.bkgId=a.bkgId;this.token=a.getToken();this.huiObj=a}getParams(){return this.data={content:{bookingId:this.bkgId,promo:{code:this.code},gozoCoins:this.coins,wallet:this.wallet,eventType:this.eventType},YII_CSRF_TOKEN:this.token}}process(){$.ajax({type:"POST",url:$baseUrl+"/booking/applypromo",data:this.getParams(),dataType:"json",success:function(a){a.success?(huiObj.bkgId=a.data.bookingId,prmObj=new Promotion(huiObj),
prmObj.processData(a)):huiObj.setErrors(a)},error:function(a){alert(a)}})}applyParams(a,b){prmObj=this;prmObj.eventType=a;prmObj.code=huiObj.additionalParams.code;prmObj.coins=huiObj.additionalParams.coins;prmObj.wallet=huiObj.additionalParams.wallet;switch(a){case 1:prmObj.code=b;break;case 2:prmObj.code="";break;case 3:prmObj.coins=b;break;case 4:prmObj.coins=0;break;case 5:prmObj.wallet=b;break;case 6:prmObj.wallet=0}return this.getParams()}applyPromo(a,b){this.applyParams(a,b);prmObj.process(this)}processData(a){if(a.success){prmObj.eventType=
a.data.eventType;switch(a.data.eventType){case "1":huiObj.promoAppllied(a);prmObj.code=huiObj.additionalParams.code;break;case "2":huiObj.promoRemoved(a);prmObj.code="";break;case "3":huiObj.creditApplied(a);prmObj.coins=huiObj.additionalParams.coins;break;case "4":huiObj.creditRemoved(a);prmObj.coins=0;break;case "5":huiObj.walletApplied(a);prmObj.wallet=huiObj.additionalParams.wallet;break;case "6":huiObj.walletRemoved(a),prmObj.wallet=0}huiObj.updateInvoice(a)}else huiObj.setErrors(a)}processWallet(){this.data=
{content:{bookingId:this.bkgId,wallet:this.wallet,eventType:this.eventType},YII_CSRF_TOKEN:this.token};$.ajax({type:"POST",url:$baseUrl+"/booking/applyWallet",data:this.data,dataType:"json",success:function(a){a.success?a.hasOwnProperty("url")?location.href=a.url:(huiObj.bkgId=a.data.bookingId,prmObj=new Promotion(huiObj),prmObj.processData(a)):huiObj.setErrors(a)},error:function(a){alert(a)}})}applyWallet(a,b){prmObj=this;prmObj.eventType=a;prmObj.wallet=huiObj.additionalParams.wallet;switch(a){case 5:prmObj.wallet=
b;break;case 6:prmObj.wallet=0}prmObj.processWallet(this)}};