

CREATE TABLE `vendor_transactions` (
  `ven_trans_id` int(11) NOT NULL,
  `ven_ptp_id` tinyint(3) UNSIGNED DEFAULT NULL,
  `trans_ven_id` int(11) DEFAULT NULL,
  `ven_trans_code` varchar(50) DEFAULT NULL,
  `ven_trans_mode` tinyint(3) UNSIGNED DEFAULT NULL,
  `ven_trans_remarks` varchar(200) DEFAULT NULL,
  `ven_trans_amount` float(16,2) NOT NULL,
  `ven_trans_active` tinyint(3) UNSIGNED NOT NULL DEFAULT '1',
  `ven_trans_status` tinyint(3) UNSIGNED NOT NULL DEFAULT '0',
  `ven_trans_start_datetime` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `ven_trans_response_details` varchar(1000) DEFAULT NULL,
  `ven_trans_complete_datetime` datetime DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

--
-- Indexes for dumped tables
--

--
-- Indexes for table `vendor_transactions`
--
ALTER TABLE `vendor_transactions`
  ADD PRIMARY KEY (`ven_trans_id`);

--
-- AUTO_INCREMENT for dumped tables
--

--
-- AUTO_INCREMENT for table `vendor_transactions`
--
ALTER TABLE `vendor_transactions`
  MODIFY `ven_trans_id` int(11) NOT NULL AUTO_INCREMENT;


ALTER TABLE `vendor_transactions` ADD INDEX(`trans_ven_id`);


ALTER TABLE `vendor_transactions` ADD FOREIGN KEY (`trans_ven_id`) REFERENCES `agents`(`agt_id`) ON DELETE NO ACTION ON UPDATE NO ACTION;



ALTER TABLE `vendor_transactions` CHANGE `ven_trans_start_datetime` `ven_trans_created` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, CHANGE `ven_trans_complete_datetime` `ven_trans_date` DATETIME NULL DEFAULT NULL;



ALTER TABLE `vendor_transactions` DROP `ven_trans_status`;

ALTER TABLE `vendor_transactions` ADD `ven_booking_id` INT(11) NULL DEFAULT NULL AFTER `trans_ven_id`;

ALTER TABLE `vendor_transactions` ADD INDEX(`ven_booking_id`);

ALTER TABLE `vendor_transactions` ADD FOREIGN KEY (`ven_booking_id`) REFERENCES `booking`(`bkg_id`) ON DELETE RESTRICT ON UPDATE RESTRICT;

ALTER TABLE `vendor_transactions` DROP FOREIGN KEY `vendor_transactions_ibfk_2`; ALTER TABLE `vendor_transactions` ADD CONSTRAINT `vendor_transactions_ibfk_2` FOREIGN KEY (`ven_booking_id`) REFERENCES `booking`(`bkg_id`) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE `vendor_transactions` CHANGE `trans_ven_id` `trans_vendor_id` INT(11) NULL DEFAULT NULL;

ALTER TABLE `vendor_transactions` ADD `ven_trans_type` TINYINT UNSIGNED NULL DEFAULT NULL AFTER `ven_trans_code`;


ALTER TABLE `vendor_transactions` ADD `ven_admin_id` INT(11) NULL DEFAULT NULL AFTER `ven_trans_created`;