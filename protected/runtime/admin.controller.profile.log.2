2024/10/17 13:54:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 102.926] [M: 10054.59] 
------------------------------------------------------module.admin.controller.booking.getamountbyvehicle ACTION START------------------------------------------------------
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"3","tripDistance":"664","tripDuration":"690","multiCityData":"[{\"pickup_city\":\"30804\",\"drop_city\":\"30711\",\"pickup_address\":\"\",\"drop_address\":null,\"date\":\"2024-10-31 18:00:00\",\"distance\":\"664\",\"duration\":\"680\"}]","bookingType":"1","pickupAddress":"","dropupAddress":"","routeDataArr":[{"locLatVal":"","locLonVal":"","brtLocationVal":""},{"locLatVal":"","locLonVal":"","brtLocationVal":""}],"pickupDate":"31\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","sccId":"1","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=3&tripDistance=664&tripDuration=690&multiCityData=%5B%7B%22pickup_city%22%3A%2230804%22%2C%22drop_city%22%3A%2230711%22%2C%22pickup_address%22%3A%22%22%2C%22drop_address%22%3Anull%2C%22date%22%3A%222024-10-31+18%3A00%3A00%22%2C%22distance%22%3A%22664%22%2C%22duration%22%3A%22680%22%7D%5D&bookingType=1&pickupAddress=&dropupAddress=&routeDataArr%5B0%5D%5BlocLatVal%5D=&routeDataArr%5B0%5D%5BlocLonVal%5D=&routeDataArr%5B0%5D%5BbrtLocationVal%5D=&routeDataArr%5B1%5D%5BlocLatVal%5D=&routeDataArr%5B1%5D%5BlocLonVal%5D=&routeDataArr%5B1%5D%5BbrtLocationVal%5D=&pickupDate=31%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&sccId=1&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 13:54:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 159.803] [M: 11290.8] setLocationRequest start
2024/10/17 13:54:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 241.263] [M: 11291.3] setLocationRequest ends
2024/10/17 13:54:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 319.431] [M: 18116.69] [ET: 0.326/289.628] [MU: 0.83/18116.5] 
	SQL: SELECT COUNT(1) as cnt FROM cities WHERE cty_active=1 AND cty_service_active=1 AND cty_id=30804 
	 [params: []]
2024/10/17 13:54:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 319.769] [M: 18117.98] [ET: 0.263/289.966] [MU: 0.84/18117.8] 
	SQL: SELECT COUNT(1) as cnt FROM cities WHERE cty_active=1 AND cty_service_active=1 AND cty_id=30711 
	 [params: []]
2024/10/17 13:54:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 337.454] [M: 18604.87] [ET: 17.579/307.6] [MU: 486.78/18604.76] 
	BookingRoute::calculateDistance
2024/10/17 13:54:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 338.218] [M: 18602.28] [ET: 0.386/308.398] [MU: 5.11/18602.17] 
	BookingRoute::calculateDistance
2024/10/17 13:54:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 338.32] [M: 18598.33] [ET: 52.551/308.506] [MU: 5974.34/18598.23] 
	validateRoutes
2024/10/17 13:54:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 342.064] [M: 18831.45] [ET: 0.866/312.24] [MU: 27.08/18831.23] 
	SQL: SELECT scv_id FROM svc_class_vhc_cat WHERE scv_active = 1 AND scv_scc_id IN (1,2,4,6) ORDER BY scv_vct_id ASC,scv_scc_id ASC 
	 [params: []]
2024/10/17 13:54:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 343.935] [M: 18819.77] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.Quote.getQuote START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"3","tripDistance":"664","tripDuration":"690","multiCityData":"[{\"pickup_city\":\"30804\",\"drop_city\":\"30711\",\"pickup_address\":\"\",\"drop_address\":null,\"date\":\"2024-10-31 18:00:00\",\"distance\":\"664\",\"duration\":\"680\"}]","bookingType":"1","pickupAddress":"","dropupAddress":"","routeDataArr":[{"locLatVal":"","locLonVal":"","brtLocationVal":""},{"locLatVal":"","locLonVal":"","brtLocationVal":""}],"pickupDate":"31\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","sccId":"1","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=3&tripDistance=664&tripDuration=690&multiCityData=%5B%7B%22pickup_city%22%3A%2230804%22%2C%22drop_city%22%3A%2230711%22%2C%22pickup_address%22%3A%22%22%2C%22drop_address%22%3Anull%2C%22date%22%3A%222024-10-31+18%3A00%3A00%22%2C%22distance%22%3A%22664%22%2C%22duration%22%3A%22680%22%7D%5D&bookingType=1&pickupAddress=&dropupAddress=&routeDataArr%5B0%5D%5BlocLatVal%5D=&routeDataArr%5B0%5D%5BlocLonVal%5D=&routeDataArr%5B0%5D%5BbrtLocationVal%5D=&routeDataArr%5B1%5D%5BlocLatVal%5D=&routeDataArr%5B1%5D%5BlocLonVal%5D=&routeDataArr%5B1%5D%5BbrtLocationVal%5D=&pickupDate=31%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&sccId=1&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 13:54:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 346.758] [M: 18938.88] [ET: 0.474/316.958] [MU: 8.84/18938.45] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:54:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 347.213] [M: 18943.83] [ET: 0.388/317.416] [MU: 3.33/18943.39] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30711"}]
2024/10/17 13:54:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 347.743] [M: 18945.87] [ET: 0.465/317.944] [MU: 0.9/18945.65] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:54:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 348.76] [M: 18997.03] [ET: 0.91/318.955] [MU: 43.61/18995.53] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (100) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30711) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp0)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp3,:gp4)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp1,:gp2)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp5,:gp6))
			OR (scr_area_type = 5 AND scr_area_id IN (3699))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (3)
		ORDER BY rank DESC
		 
	 [params: {":gp0":"31",":gp1":"30804",":gp2":"30711",":gp3":"105",":gp4":"100",":gp5":"1",":gp6":"1","tripType":"1"}]
2024/10/17 13:54:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 349.73] [M: 18988.15] [ET: 0.375/319.932] [MU: 3.33/18987.71] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:54:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 350.12] [M: 18993.09] [ET: 0.327/320.324] [MU: 3.34/18992.66] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30711"}]
2024/10/17 13:54:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 350.681] [M: 18995.13] [ET: 0.497/320.88] [MU: 0.9/18994.91] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:54:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 351.234] [M: 19026.91] [ET: 0.445/321.429] [MU: 24.22/19025.41] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (100) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30711) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp7)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp10,:gp11)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp8,:gp9)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp12,:gp13))
			OR (scr_area_type = 5 AND scr_area_id IN (3699))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (3)
		ORDER BY rank DESC
		 
	 [params: {":gp7":"31",":gp8":"30804",":gp9":"30711",":gp10":"105",":gp11":"100",":gp12":"1",":gp13":"1","tripType":"1"}]
2024/10/17 13:54:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 366.682] [M: 19077.27] [ET: 0.407/336.88] [MU: 0.84/19077.08] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 13:54:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 367.127] [M: 19079.55] [ET: 0.365/337.328] [MU: 0.96/19079.24] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"1"}]
2024/10/17 13:54:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 386.659] [M: 19530.03] [ET: 0.876/356.831] [MU: 3.78/19529.16] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:54:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 388.453] [M: 19543.39] [ET: 2.974/358.646] [MU: 21.6/19543.27] 
	Quote::calculateOneWay  for CAB 3 Date: 2024-10-31 18:00:00
2024/10/17 13:54:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 391.418] [M: 19708.58] [ET: 0.514/361.615] [MU: 0.9/19708.36] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:54:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 394.791] [M: 19836.17] [ET: 0.697/364.962] [MU: 3.34/19835.73] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:54:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 395.527] [M: 19868.03] [ET: 0.576/365.725] [MU: 25.34/19867.28] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp16)) OR (apr_area_type = 5 AND apr_area_id IN (:gp14)) OR (apr_area_type = 2 AND apr_area_id IN (:gp17)) OR (apr_area_type = 4 AND apr_area_id IN (:gp18)) OR (apr_area_type = 1 AND apr_area_id IN (:gp15))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp14":"3699",":gp15":"31",":gp16":"30804",":gp17":"105",":gp18":"1","cab":"3"}]
2024/10/17 13:54:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 409.336] [M: 19870.87] [ET: 0.43/379.47] [MU: 7.11/19870.77] 
	BookingRoute::calculateDistance
2024/10/17 13:54:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 428.38] [M: 19933.65] [ET: 1.126/398.578] [MU: 7.88/19933.54] 
	BookingRoute::calculateDistance
2024/10/17 13:54:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 429.469] [M: 19939.13] [ET: 0.983/399.665] [MU: 8.27/19939.02] 
	BookingRoute::calculateDistance
2024/10/17 13:54:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 432.745] [M: 19948.02] [ET: 2.719/402.826] [MU: 2.36/19947.65] 
	SQL: SELECT cts_airport_pickup_entry_fee
               FROM   cities
               INNER JOIN cities_stats
               ON cities.cty_id = cities_stats.cts_cty_id
               WHERE  cty_id = :cityId
               AND cty_is_airport = 1 AND cty_active = 1 
	 [params: {"cityId":"30804"}]
2024/10/17 13:54:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 435.378] [M: 19961.98] [ET: 1.596/405.555] [MU: 8.14/19961.88] 
	BookingRoute::calculateDistance
2024/10/17 13:54:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 436.796] [M: 19969.73] [ET: 1.246/406.994] [MU: 8.08/19969.62] 
	BookingRoute::calculateDistance
2024/10/17 13:54:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 437.419] [M: 19969.03] [ET: 0.517/407.614] [MU: 0.9/19968.81] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:54:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 439.077] [M: 19981.41] [ET: 0.794/409.273] [MU: 2.97/19980.97] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:54:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 440.453] [M: 20013.19] [ET: 1.074/410.642] [MU: 25.27/20012.44] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp21)) OR (apr_area_type = 5 AND apr_area_id IN (:gp19)) OR (apr_area_type = 2 AND apr_area_id IN (:gp22)) OR (apr_area_type = 4 AND apr_area_id IN (:gp23)) OR (apr_area_type = 1 AND apr_area_id IN (:gp20))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp19":"3699",":gp20":"31",":gp21":"30804",":gp22":"105",":gp23":"1","cab":"3"}]
2024/10/17 13:54:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 441.997] [M: 20005.08] [ET: 0.368/412.194] [MU: 2.98/20004.97] 
	BookingRoute::calculateDistance
2024/10/17 13:54:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 443.66] [M: 20022.23] [ET: 0.283/413.863] [MU: 7.11/20022.12] 
	BookingRoute::calculateDistance
2024/10/17 13:54:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 444.017] [M: 20022.55] [ET: 0.273/414.209] [MU: 2.98/20022.45] 
	BookingRoute::calculateDistance
2024/10/17 13:54:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 448.036] [M: 20058.49] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"3","tripDistance":"664","tripDuration":"690","multiCityData":"[{\"pickup_city\":\"30804\",\"drop_city\":\"30711\",\"pickup_address\":\"\",\"drop_address\":null,\"date\":\"2024-10-31 18:00:00\",\"distance\":\"664\",\"duration\":\"680\"}]","bookingType":"1","pickupAddress":"","dropupAddress":"","routeDataArr":[{"locLatVal":"","locLonVal":"","brtLocationVal":""},{"locLatVal":"","locLonVal":"","brtLocationVal":""}],"pickupDate":"31\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","sccId":"1","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=3&tripDistance=664&tripDuration=690&multiCityData=%5B%7B%22pickup_city%22%3A%2230804%22%2C%22drop_city%22%3A%2230711%22%2C%22pickup_address%22%3A%22%22%2C%22drop_address%22%3Anull%2C%22date%22%3A%222024-10-31+18%3A00%3A00%22%2C%22distance%22%3A%22664%22%2C%22duration%22%3A%22680%22%7D%5D&bookingType=1&pickupAddress=&dropupAddress=&routeDataArr%5B0%5D%5BlocLatVal%5D=&routeDataArr%5B0%5D%5BlocLonVal%5D=&routeDataArr%5B0%5D%5BbrtLocationVal%5D=&routeDataArr%5B1%5D%5BlocLatVal%5D=&routeDataArr%5B1%5D%5BlocLonVal%5D=&routeDataArr%5B1%5D%5BbrtLocationVal%5D=&pickupDate=31%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&sccId=1&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 13:54:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 448.452] [M: 20077.59] [ET: 0.825/418.661] [MU: 21.05/20077.48] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 13:54:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 448.486] [M: 20079.27] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 13:54:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 450.838] [M: 20162.54] [ET: 0.942/421.023] [MU: 3.19/20160.04] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+10013),(IF((cpm_value_type=2),(10013+(10013*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30937 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30937) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-31 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=3 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 13:54:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 486.751] [M: 21518.64] [ET: 39.16/456.927] [MU: 1462.57/21518.48] 
	RouteRates::calculate for CAB 3 2024-10-31 18:00:00 - Trip Type: 1 771364282
2024/10/17 13:54:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 486.98] [M: 21496.31] [ET: 98.44/457.186] [MU: 1951.45/21496.16] 
	Quote::calculateRules for CAB 3, From City Id: 30804, To city Id: 30711
2024/10/17 13:54:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 487.421] [M: 21468.93] [ET: 0.352/457.621] [MU: 0.9/21468.68] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"3"}]
2024/10/17 13:54:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 487.503] [M: 21470.21] [ET: 138.662/457.711] [MU: 2500.2/21470.12] 
	Quote For CabType: 3
2024/10/17 13:54:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 489.512] [M: 21513.02] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.QuotesDataCreated.setData START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"3","tripDistance":"664","tripDuration":"690","multiCityData":"[{\"pickup_city\":\"30804\",\"drop_city\":\"30711\",\"pickup_address\":\"\",\"drop_address\":null,\"date\":\"2024-10-31 18:00:00\",\"distance\":\"664\",\"duration\":\"680\"}]","bookingType":"1","pickupAddress":"","dropupAddress":"","routeDataArr":[{"locLatVal":"","locLonVal":"","brtLocationVal":""},{"locLatVal":"","locLonVal":"","brtLocationVal":""}],"pickupDate":"31\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","sccId":"1","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=3&tripDistance=664&tripDuration=690&multiCityData=%5B%7B%22pickup_city%22%3A%2230804%22%2C%22drop_city%22%3A%2230711%22%2C%22pickup_address%22%3A%22%22%2C%22drop_address%22%3Anull%2C%22date%22%3A%222024-10-31+18%3A00%3A00%22%2C%22distance%22%3A%22664%22%2C%22duration%22%3A%22680%22%7D%5D&bookingType=1&pickupAddress=&dropupAddress=&routeDataArr%5B0%5D%5BlocLatVal%5D=&routeDataArr%5B0%5D%5BlocLonVal%5D=&routeDataArr%5B0%5D%5BbrtLocationVal%5D=&routeDataArr%5B1%5D%5BlocLatVal%5D=&routeDataArr%5B1%5D%5BlocLonVal%5D=&routeDataArr%5B1%5D%5BbrtLocationVal%5D=&pickupDate=31%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&sccId=1&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 13:54:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 580.221] [M: 21597.23] [ET: 74.477/550.406] [MU: 16.66/21597.12] 
	QuotesDataPickup::setData for CAB 3
2024/10/17 13:54:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 580.335] [M: 21593.25] [ET: 91.568/550.532] [MU: 82.18/21593.14] 
	models.QuotesDataCreated.setData
2024/10/17 13:54:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 580.38] [M: 21594.8] 
============================================================Profile models.QuotesDataCreated.setData DONE==================================================
2024/10/17 13:54:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 580.526] [M: 21591.65] [ET: 237.005/550.71] [MU: 2771.85/21591.55] 
	models.Quote.getQuote
2024/10/17 13:54:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 580.674] [M: 21595.14] 
============================================================Profile models.Quote.getQuote DONE==================================================
2024/10/17 13:54:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 610.174] [M: 22056.51] [ET: 0.708/580.352] [MU: 1.15/22056.07] 
	SQL: SELECT zones.zon_id
                    FROM cities c1
                    INNER JOIN zone_cities ON zone_cities.zct_cty_id = c1.cty_id AND zct_active=1
                    INNER JOIN zones ON zone_cities.zct_zon_id = zones.zon_id AND zon_active=1
                    WHERE c1.cty_id = 30804 ORDER BY zones.zon_id DESC LIMIT 0,1 
	 [params: []]
2024/10/17 13:54:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 610.837] [M: 22059.14] [ET: 0.565/581.02] [MU: 1.15/22058.7] 
	SQL: SELECT zones.zon_id
                    FROM cities c1
                    INNER JOIN zone_cities ON zone_cities.zct_cty_id = c1.cty_id AND zct_active=1
                    INNER JOIN zones ON zone_cities.zct_zon_id = zones.zon_id AND zon_active=1
                    WHERE c1.cty_id = 30711 ORDER BY zones.zon_id DESC LIMIT 0,1 
	 [params: []]
2024/10/17 13:54:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 613.253] [M: 22148.82] [ET: 0.621/583.451] [MU: 1.3/22148.6] 
	SQL: SELECT stt.stt_zone FROM cities cty INNER JOIN states stt ON stt.stt_id = cty.cty_state_id WHERE cty.cty_id = 30804 
	 [params: []]
2024/10/17 13:54:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 613.58] [M: 22150.99] [ET: 0.245/583.783] [MU: 0.98/22150.62] 
	SQL: SELECT CONCAT('7','',LPAD(:regionId,2,'0'),'',LPAD(:fromZone,5,'0'),'',LPAD(:toZone,5,'0'),'',LPAD(:scv_id,3,'0'),'',LPAD(:tripType,2,'0')) AS rowIdentifier FROM DUAL 
	 [params: {"regionId":"1","fromZone":"31","toZone":"238","scv_id":"3","tripType":"1"}]
2024/10/17 13:54:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 677.661] [M: 22210.42] [ET: 0.634/647.845] [MU: 1.15/22209.98] 
	SQL: SELECT zones.zon_id
                    FROM cities c1
                    INNER JOIN zone_cities ON zone_cities.zct_cty_id = c1.cty_id AND zct_active=1
                    INNER JOIN zones ON zone_cities.zct_zon_id = zones.zon_id AND zon_active=1
                    WHERE c1.cty_id = 30804 ORDER BY zones.zon_id DESC LIMIT 0,1 
	 [params: []]
2024/10/17 13:54:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 678.158] [M: 22212.59] [ET: 0.383/648.341] [MU: 1.3/22212.37] 
	SQL: SELECT stt.stt_zone FROM cities cty INNER JOIN states stt ON stt.stt_id = cty.cty_state_id WHERE cty.cty_id = 30804 
	 [params: []]
2024/10/17 13:54:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 678.571] [M: 22214.47] [ET: 0.308/648.76] [MU: 0.9/22214.22] 
	SQL: SELECT CONCAT('7','',LPAD(:regionId,2,'0'),'',LPAD(:fromZone,5,'0'),LPAD(:tripType,2,'0')) AS demandIdentifier FROM DUAL 
	 [params: {"regionId":"1","fromZone":"31","tripType":2}]
2024/10/17 13:54:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 722.053] [M: 22511.09] [ET: 2.735/692.227] [MU: 1.97/22510.71] 
	SQL: SELECT dzs_zone_type FROM dynamic_zone_surge WHERE dzs_fromzoneid IN (:gp24) AND dzs_tozoneid IN (:gp25,:gp26) AND dzs_scv_id=:cab AND dzs_booking_type=:tripType  ORDER BY  dzs_zone_type ASC 
	 [params: {":gp25":"238",":gp26":"79",":gp24":"31","cab":"3","tripType":"1"}]
2024/10/17 13:54:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 723.501] [M: 22513.99] [ET: 0.669/693.674] [MU: 1.24/22513.37] 
	SQL: SELECT prc_cancel_rule_id FROM `partner_cancel_rule` 
			WHERE (prc_zone_category = :zoneType OR prc_zone_category IS NULL)
		AND (prc_scc_id = :sccId OR prc_scc_id IS NULL)
		AND (prc_partner_id = :partnerId OR prc_partner_id IS NULL) 
		AND (prc_bkg_type = :tripType OR prc_bkg_type IS NULL) 
		 AND (prc_is_gozonow IS NULL) 
		AND prc_active=1  
		ORDER BY prc_partner_id DESC, prc_bkg_type DESC  
	 [params: {"zoneType":1,"sccId":"1","partnerId":null,"tripType":"1"}]
2024/10/17 13:54:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 726.719] [M: 22590.38] [ET: 0.386/696.916] [MU: 1.42/22590.2] 
	SQL: SELECT acp_cr_to,acp_margin_data FROM `addon_cancellation_policy` WHERE `acp_id` = :id 
	 [params: {"id":"8"}]
2024/10/17 13:54:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 741.158] [M: 22630.32] [ET: 0.25/711.357] [MU: 1.43/22630.13] 
	SQL: SELECT acp_cr_to,acp_margin_data FROM `addon_cancellation_policy` WHERE `acp_id` = :id 
	 [params: {"id":"9"}]
2024/10/17 13:54:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 744.441] [M: 22708.96] [ET: 0.367/714.622] [MU: 1.35/22708.77] 
	SQL: SELECT acm_svc_id_to,acm_margin_data FROM `addon_cab_models` WHERE `acm_id` = :id 
	 [params: {"id":"1"}]
2024/10/17 13:54:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 745.664] [M: 22712.77] [ET: 0.426/715.845] [MU: 1.35/22712.59] 
	SQL: SELECT acm_svc_id_to,acm_margin_data FROM `addon_cab_models` WHERE `acm_id` = :id 
	 [params: {"id":"2"}]
2024/10/17 13:54:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 746.414] [M: 22716.21] [ET: 0.207/716.618] [MU: 1.35/22716.02] 
	SQL: SELECT acm_svc_id_to,acm_margin_data FROM `addon_cab_models` WHERE `acm_id` = :id 
	 [params: {"id":"3"}]
2024/10/17 13:54:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 746.976] [M: 22719.65] [ET: 0.176/717.181] [MU: 1.34/22719.46] 
	SQL: SELECT acm_svc_id_to,acm_margin_data FROM `addon_cab_models` WHERE `acm_id` = :id 
	 [params: {"id":"4"}]
2024/10/17 13:54:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 752] [M: 23118.94] [ET: 0.776/722.197] [MU: 48.58/23117.69] 
	SQL:  SELECT scv_id,scc_id, vct_id, scc_cancel_rule, scc_label,scc_rank, scv_label, scv_code, scc_model_year, 
								CONCAT(vct_label, ' (', scc_label , ')') label,
									vct_label,vct_rank, vct_desc, CONCAT(vct_label, ' ', vct_desc) vhcName, 
									vct_capacity, IF(vct_image IS NULL, 'images/cabs/no-image.png', vct_image) as vct_image, vct_big_bag_capacity, vct_small_bag_capacity, vcsc_small_bag, FLOOR(vcsc_small_bag/2) AS big_bag,
									scc_is_cng, scc_is_petrol_diesel, scc_id, scc_desc, IF( vct_id IN(5, 6), '1', '0' ) AS is_assured, scv_vct_id,scv_parent_id,scv_vct_id,scv_model,scv_scc_id
						FROM svc_class_vhc_cat
						INNER JOIN service_class ON scc_id = scv_scc_id
						INNER JOIN vehicle_category ON vct_id = scv_vct_id
						INNER JOIN vehicle_cat_svc_class on vcsc_ssc_id = scv_scc_id AND vcsc_vct_id = scv_vct_id
						WHERE scv_active = 1 
							AND scc_active = 1 
						AND vct_active = 1
		 AND scv_vct_id = 3 
	 [params: []]
2024/10/17 13:54:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 759.089] [M: 23062.14] [ET: 656.099/729.29] [MU: 13004.32/23062.02] 
	module.admin.controller.booking.getamountbyvehicle
2024/10/17 13:54:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 759.123] [M: 23062.79] 
*******************************************************module.admin.controller.booking.getamountbyvehicle ACTION DONE****************************************************************
2024/10/17 13:54:24 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 98.149] [M: 10054.59] 
------------------------------------------------------module.admin.controller.booking.getamountbyvehicle ACTION START------------------------------------------------------
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"3","tripDistance":"664","tripDuration":"690","multiCityData":"[{\"pickup_city\":\"30804\",\"drop_city\":\"30711\",\"pickup_address\":\"\",\"drop_address\":null,\"date\":\"2024-10-31 18:00:00\",\"distance\":\"664\",\"duration\":\"680\"}]","bookingType":"1","pickupAddress":"","dropupAddress":"","routeDataArr":[{"locLatVal":"","locLonVal":"","brtLocationVal":""},{"locLatVal":"","locLonVal":"","brtLocationVal":""}],"pickupDate":"31\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","sccId":"1","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=3&tripDistance=664&tripDuration=690&multiCityData=%5B%7B%22pickup_city%22%3A%2230804%22%2C%22drop_city%22%3A%2230711%22%2C%22pickup_address%22%3A%22%22%2C%22drop_address%22%3Anull%2C%22date%22%3A%222024-10-31+18%3A00%3A00%22%2C%22distance%22%3A%22664%22%2C%22duration%22%3A%22680%22%7D%5D&bookingType=1&pickupAddress=&dropupAddress=&routeDataArr%5B0%5D%5BlocLatVal%5D=&routeDataArr%5B0%5D%5BlocLonVal%5D=&routeDataArr%5B0%5D%5BbrtLocationVal%5D=&routeDataArr%5B1%5D%5BlocLatVal%5D=&routeDataArr%5B1%5D%5BlocLonVal%5D=&routeDataArr%5B1%5D%5BbrtLocationVal%5D=&pickupDate=31%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&sccId=1&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 13:54:24 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 134.56] [M: 11290.8] setLocationRequest start
2024/10/17 13:54:24 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 221.339] [M: 11291.3] setLocationRequest ends
2024/10/17 13:54:24 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 338.735] [M: 18116.69] [ET: 0.411/311.141] [MU: 0.83/18116.5] 
	SQL: SELECT COUNT(1) as cnt FROM cities WHERE cty_active=1 AND cty_service_active=1 AND cty_id=30804 
	 [params: []]
2024/10/17 13:54:24 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 339.079] [M: 18117.98] [ET: 0.261/311.476] [MU: 0.84/18117.8] 
	SQL: SELECT COUNT(1) as cnt FROM cities WHERE cty_active=1 AND cty_service_active=1 AND cty_id=30711 
	 [params: []]
2024/10/17 13:54:24 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 357.952] [M: 18604.87] [ET: 18.785/330.342] [MU: 486.78/18604.76] 
	BookingRoute::calculateDistance
2024/10/17 13:54:24 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 358.832] [M: 18602.28] [ET: 0.468/331.221] [MU: 5.11/18602.17] 
	BookingRoute::calculateDistance
2024/10/17 13:54:24 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 358.932] [M: 18598.33] [ET: 72.647/331.328] [MU: 5974.34/18598.23] 
	validateRoutes
2024/10/17 13:54:24 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 363.062] [M: 18831.45] [ET: 0.875/335.463] [MU: 27.08/18831.23] 
	SQL: SELECT scv_id FROM svc_class_vhc_cat WHERE scv_active = 1 AND scv_scc_id IN (1,2,4,6) ORDER BY scv_vct_id ASC,scv_scc_id ASC 
	 [params: []]
2024/10/17 13:54:24 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 364.893] [M: 18819.77] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.Quote.getQuote START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"3","tripDistance":"664","tripDuration":"690","multiCityData":"[{\"pickup_city\":\"30804\",\"drop_city\":\"30711\",\"pickup_address\":\"\",\"drop_address\":null,\"date\":\"2024-10-31 18:00:00\",\"distance\":\"664\",\"duration\":\"680\"}]","bookingType":"1","pickupAddress":"","dropupAddress":"","routeDataArr":[{"locLatVal":"","locLonVal":"","brtLocationVal":""},{"locLatVal":"","locLonVal":"","brtLocationVal":""}],"pickupDate":"31\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","sccId":"1","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=3&tripDistance=664&tripDuration=690&multiCityData=%5B%7B%22pickup_city%22%3A%2230804%22%2C%22drop_city%22%3A%2230711%22%2C%22pickup_address%22%3A%22%22%2C%22drop_address%22%3Anull%2C%22date%22%3A%222024-10-31+18%3A00%3A00%22%2C%22distance%22%3A%22664%22%2C%22duration%22%3A%22680%22%7D%5D&bookingType=1&pickupAddress=&dropupAddress=&routeDataArr%5B0%5D%5BlocLatVal%5D=&routeDataArr%5B0%5D%5BlocLonVal%5D=&routeDataArr%5B0%5D%5BbrtLocationVal%5D=&routeDataArr%5B1%5D%5BlocLatVal%5D=&routeDataArr%5B1%5D%5BlocLonVal%5D=&routeDataArr%5B1%5D%5BbrtLocationVal%5D=&pickupDate=31%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&sccId=1&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 13:54:24 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 368.211] [M: 18938.88] [ET: 0.611/340.598] [MU: 8.84/18938.45] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:54:24 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 368.806] [M: 18943.83] [ET: 0.494/341.198] [MU: 3.33/18943.39] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30711"}]
2024/10/17 13:54:24 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 369.414] [M: 18945.87] [ET: 0.525/341.824] [MU: 0.9/18945.65] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:54:24 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 370.601] [M: 18997.03] [ET: 1.061/342.981] [MU: 43.61/18995.53] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (100) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30711) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp0)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp3,:gp4)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp1,:gp2)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp5,:gp6))
			OR (scr_area_type = 5 AND scr_area_id IN (3699))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (3)
		ORDER BY rank DESC
		 
	 [params: {":gp0":"31",":gp1":"30804",":gp2":"30711",":gp3":"105",":gp4":"100",":gp5":"1",":gp6":"1","tripType":"1"}]
2024/10/17 13:54:24 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 371.997] [M: 18988.15] [ET: 0.51/344.386] [MU: 3.33/18987.71] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:54:24 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 372.798] [M: 18993.09] [ET: 0.658/345.173] [MU: 3.34/18992.66] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30711"}]
2024/10/17 13:54:24 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 374.013] [M: 18995.13] [ET: 1.08/346.383] [MU: 0.9/18994.91] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:54:24 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 375.27] [M: 19026.91] [ET: 1.045/347.666] [MU: 24.22/19025.41] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (100) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30711) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp7)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp10,:gp11)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp8,:gp9)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp12,:gp13))
			OR (scr_area_type = 5 AND scr_area_id IN (3699))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (3)
		ORDER BY rank DESC
		 
	 [params: {":gp7":"31",":gp8":"30804",":gp9":"30711",":gp10":"105",":gp11":"100",":gp12":"1",":gp13":"1","tripType":"1"}]
2024/10/17 13:54:24 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 390.145] [M: 19077.27] [ET: 0.539/362.489] [MU: 0.84/19077.08] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 13:54:24 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 391.463] [M: 19079.55] [ET: 1.178/363.824] [MU: 0.96/19079.24] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"1"}]
2024/10/17 13:54:24 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 411.119] [M: 19530.03] [ET: 0.806/383.504] [MU: 3.78/19529.16] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:54:24 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 412.854] [M: 19543.39] [ET: 2.795/385.248] [MU: 21.6/19543.27] 
	Quote::calculateOneWay  for CAB 3 Date: 2024-10-31 18:00:00
2024/10/17 13:54:24 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 415.785] [M: 19708.58] [ET: 0.518/388.191] [MU: 0.9/19708.36] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:54:24 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 418.49] [M: 19836.17] [ET: 0.52/390.899] [MU: 3.34/19835.73] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:54:24 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 419.267] [M: 19868.03] [ET: 0.667/391.671] [MU: 25.34/19867.28] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp16)) OR (apr_area_type = 5 AND apr_area_id IN (:gp14)) OR (apr_area_type = 2 AND apr_area_id IN (:gp17)) OR (apr_area_type = 4 AND apr_area_id IN (:gp18)) OR (apr_area_type = 1 AND apr_area_id IN (:gp15))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp14":"3699",":gp15":"31",":gp16":"30804",":gp17":"105",":gp18":"1","cab":"3"}]
2024/10/17 13:54:24 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 432.424] [M: 19870.88] [ET: 0.225/404.838] [MU: 7.11/19870.77] 
	BookingRoute::calculateDistance
2024/10/17 13:54:24 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 451.005] [M: 19933.65] [ET: 1.318/423.411] [MU: 7.88/19933.54] 
	BookingRoute::calculateDistance
2024/10/17 13:54:24 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 452.019] [M: 19939.13] [ET: 0.919/424.427] [MU: 8.27/19939.02] 
	BookingRoute::calculateDistance
2024/10/17 13:54:24 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 455.483] [M: 19948.02] [ET: 2.919/427.847] [MU: 2.36/19947.65] 
	SQL: SELECT cts_airport_pickup_entry_fee
               FROM   cities
               INNER JOIN cities_stats
               ON cities.cty_id = cities_stats.cts_cty_id
               WHERE  cty_id = :cityId
               AND cty_is_airport = 1 AND cty_active = 1 
	 [params: {"cityId":"30804"}]
2024/10/17 13:54:24 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 457.726] [M: 19961.98] [ET: 1.045/430.127] [MU: 8.14/19961.88] 
	BookingRoute::calculateDistance
2024/10/17 13:54:24 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 458.668] [M: 19969.73] [ET: 0.837/431.077] [MU: 8.08/19969.62] 
	BookingRoute::calculateDistance
2024/10/17 13:54:24 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 459.161] [M: 19969.03] [ET: 0.406/431.571] [MU: 0.9/19968.81] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:54:24 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 460.352] [M: 19981.41] [ET: 0.615/432.76] [MU: 2.97/19980.97] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:54:24 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 461.022] [M: 20013.19] [ET: 0.562/433.429] [MU: 25.27/20012.44] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp21)) OR (apr_area_type = 5 AND apr_area_id IN (:gp19)) OR (apr_area_type = 2 AND apr_area_id IN (:gp22)) OR (apr_area_type = 4 AND apr_area_id IN (:gp23)) OR (apr_area_type = 1 AND apr_area_id IN (:gp20))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp19":"3699",":gp20":"31",":gp21":"30804",":gp22":"105",":gp23":"1","cab":"3"}]
2024/10/17 13:54:24 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 461.982] [M: 20005.08] [ET: 0.22/434.397] [MU: 2.98/20004.97] 
	BookingRoute::calculateDistance
2024/10/17 13:54:24 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 463.49] [M: 20022.23] [ET: 0.261/435.905] [MU: 7.11/20022.12] 
	BookingRoute::calculateDistance
2024/10/17 13:54:24 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 463.76] [M: 20022.55] [ET: 0.196/436.177] [MU: 2.98/20022.45] 
	BookingRoute::calculateDistance
2024/10/17 13:54:24 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 467.166] [M: 20058.49] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"3","tripDistance":"664","tripDuration":"690","multiCityData":"[{\"pickup_city\":\"30804\",\"drop_city\":\"30711\",\"pickup_address\":\"\",\"drop_address\":null,\"date\":\"2024-10-31 18:00:00\",\"distance\":\"664\",\"duration\":\"680\"}]","bookingType":"1","pickupAddress":"","dropupAddress":"","routeDataArr":[{"locLatVal":"","locLonVal":"","brtLocationVal":""},{"locLatVal":"","locLonVal":"","brtLocationVal":""}],"pickupDate":"31\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","sccId":"1","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=3&tripDistance=664&tripDuration=690&multiCityData=%5B%7B%22pickup_city%22%3A%2230804%22%2C%22drop_city%22%3A%2230711%22%2C%22pickup_address%22%3A%22%22%2C%22drop_address%22%3Anull%2C%22date%22%3A%222024-10-31+18%3A00%3A00%22%2C%22distance%22%3A%22664%22%2C%22duration%22%3A%22680%22%7D%5D&bookingType=1&pickupAddress=&dropupAddress=&routeDataArr%5B0%5D%5BlocLatVal%5D=&routeDataArr%5B0%5D%5BlocLonVal%5D=&routeDataArr%5B0%5D%5BbrtLocationVal%5D=&routeDataArr%5B1%5D%5BlocLatVal%5D=&routeDataArr%5B1%5D%5BlocLonVal%5D=&routeDataArr%5B1%5D%5BbrtLocationVal%5D=&pickupDate=31%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&sccId=1&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 13:54:24 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 467.593] [M: 20077.59] [ET: 0.832/440.009] [MU: 21.05/20077.48] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 13:54:24 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 467.624] [M: 20079.27] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 13:54:24 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 469.788] [M: 20162.54] [ET: 0.865/442.185] [MU: 3.19/20160.04] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+10013),(IF((cpm_value_type=2),(10013+(10013*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30937 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30937) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-31 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=3 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 13:54:24 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 502.198] [M: 21518.64] [ET: 35.469/474.581] [MU: 1462.57/21518.48] 
	RouteRates::calculate for CAB 3 2024-10-31 18:00:00 - Trip Type: 1 760811540
2024/10/17 13:54:24 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 502.548] [M: 21496.31] [ET: 89.549/474.91] [MU: 1951.45/21496.16] 
	Quote::calculateRules for CAB 3, From City Id: 30804, To city Id: 30711
2024/10/17 13:54:24 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 503.012] [M: 21468.93] [ET: 0.366/475.422] [MU: 0.9/21468.68] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"3"}]
2024/10/17 13:54:24 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 503.092] [M: 21470.21] [ET: 132.357/475.508] [MU: 2500.2/21470.12] 
	Quote For CabType: 3
2024/10/17 13:54:24 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 504.685] [M: 21513.02] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.QuotesDataCreated.setData START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"3","tripDistance":"664","tripDuration":"690","multiCityData":"[{\"pickup_city\":\"30804\",\"drop_city\":\"30711\",\"pickup_address\":\"\",\"drop_address\":null,\"date\":\"2024-10-31 18:00:00\",\"distance\":\"664\",\"duration\":\"680\"}]","bookingType":"1","pickupAddress":"","dropupAddress":"","routeDataArr":[{"locLatVal":"","locLonVal":"","brtLocationVal":""},{"locLatVal":"","locLonVal":"","brtLocationVal":""}],"pickupDate":"31\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","sccId":"1","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=3&tripDistance=664&tripDuration=690&multiCityData=%5B%7B%22pickup_city%22%3A%2230804%22%2C%22drop_city%22%3A%2230711%22%2C%22pickup_address%22%3A%22%22%2C%22drop_address%22%3Anull%2C%22date%22%3A%222024-10-31+18%3A00%3A00%22%2C%22distance%22%3A%22664%22%2C%22duration%22%3A%22680%22%7D%5D&bookingType=1&pickupAddress=&dropupAddress=&routeDataArr%5B0%5D%5BlocLatVal%5D=&routeDataArr%5B0%5D%5BlocLonVal%5D=&routeDataArr%5B0%5D%5BbrtLocationVal%5D=&routeDataArr%5B1%5D%5BlocLatVal%5D=&routeDataArr%5B1%5D%5BlocLonVal%5D=&routeDataArr%5B1%5D%5BbrtLocationVal%5D=&pickupDate=31%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&sccId=1&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 13:54:24 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 537.619] [M: 21602.09] [ET: 15.983/510.001] [MU: 18.83/21601.98] 
	QuotesDataPickup::setData for CAB 3
2024/10/17 13:54:24 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 537.75] [M: 21597.98] [ET: 33.48/510.149] [MU: 86.92/21597.88] 
	models.QuotesDataCreated.setData
2024/10/17 13:54:24 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 537.801] [M: 21599.54] 
============================================================Profile models.QuotesDataCreated.setData DONE==================================================
2024/10/17 13:54:24 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 537.947] [M: 21595.97] [ET: 173.479/510.342] [MU: 2776.17/21595.88] 
	models.Quote.getQuote
2024/10/17 13:54:24 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 538.119] [M: 21599.46] 
============================================================Profile models.Quote.getQuote DONE==================================================
2024/10/17 13:54:24 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 547.588] [M: 22060.77] [ET: 0.606/519.994] [MU: 1.1/22060.34] 
	SQL: SELECT zones.zon_id
                    FROM cities c1
                    INNER JOIN zone_cities ON zone_cities.zct_cty_id = c1.cty_id AND zct_active=1
                    INNER JOIN zones ON zone_cities.zct_zon_id = zones.zon_id AND zon_active=1
                    WHERE c1.cty_id = 30804 ORDER BY zones.zon_id DESC LIMIT 0,1 
	 [params: []]
2024/10/17 13:54:24 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 548.052] [M: 22063.41] [ET: 0.385/520.446] [MU: 1.15/22062.97] 
	SQL: SELECT zones.zon_id
                    FROM cities c1
                    INNER JOIN zone_cities ON zone_cities.zct_cty_id = c1.cty_id AND zct_active=1
                    INNER JOIN zones ON zone_cities.zct_zon_id = zones.zon_id AND zon_active=1
                    WHERE c1.cty_id = 30711 ORDER BY zones.zon_id DESC LIMIT 0,1 
	 [params: []]
2024/10/17 13:54:24 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 550.213] [M: 22153.09] [ET: 0.542/522.606] [MU: 1.3/22152.87] 
	SQL: SELECT stt.stt_zone FROM cities cty INNER JOIN states stt ON stt.stt_id = cty.cty_state_id WHERE cty.cty_id = 30804 
	 [params: []]
2024/10/17 13:54:24 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 550.639] [M: 22155.26] [ET: 0.298/523.029] [MU: 0.98/22154.88] 
	SQL: SELECT CONCAT('7','',LPAD(:regionId,2,'0'),'',LPAD(:fromZone,5,'0'),'',LPAD(:toZone,5,'0'),'',LPAD(:scv_id,3,'0'),'',LPAD(:tripType,2,'0')) AS rowIdentifier FROM DUAL 
	 [params: {"regionId":"1","fromZone":"31","toZone":"238","scv_id":"3","tripType":"1"}]
2024/10/17 13:54:24 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 568.25] [M: 22216.11] [ET: 0.782/540.637] [MU: 1.09/22215.67] 
	SQL: SELECT zones.zon_id
                    FROM cities c1
                    INNER JOIN zone_cities ON zone_cities.zct_cty_id = c1.cty_id AND zct_active=1
                    INNER JOIN zones ON zone_cities.zct_zon_id = zones.zon_id AND zon_active=1
                    WHERE c1.cty_id = 30804 ORDER BY zones.zon_id DESC LIMIT 0,1 
	 [params: []]
2024/10/17 13:54:24 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 568.85] [M: 22218.27] [ET: 0.472/541.234] [MU: 1.31/22218.05] 
	SQL: SELECT stt.stt_zone FROM cities cty INNER JOIN states stt ON stt.stt_id = cty.cty_state_id WHERE cty.cty_id = 30804 
	 [params: []]
2024/10/17 13:54:24 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 569.226] [M: 22220.16] [ET: 0.253/541.614] [MU: 0.91/22219.91] 
	SQL: SELECT CONCAT('7','',LPAD(:regionId,2,'0'),'',LPAD(:fromZone,5,'0'),LPAD(:tripType,2,'0')) AS demandIdentifier FROM DUAL 
	 [params: {"regionId":"1","fromZone":"31","tripType":2}]
2024/10/17 13:54:24 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 590.451] [M: 22518.56] [ET: 0.951/562.837] [MU: 2.23/22518.19] 
	SQL: SELECT dzs_zone_type FROM dynamic_zone_surge WHERE dzs_fromzoneid IN (:gp24) AND dzs_tozoneid IN (:gp25,:gp26) AND dzs_scv_id=:cab AND dzs_booking_type=:tripType  ORDER BY  dzs_zone_type ASC 
	 [params: {":gp25":"238",":gp26":"79",":gp24":"31","cab":"3","tripType":"1"}]
2024/10/17 13:54:24 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 591.486] [M: 22521.47] [ET: 0.455/563.87] [MU: 1.25/22520.84] 
	SQL: SELECT prc_cancel_rule_id FROM `partner_cancel_rule` 
			WHERE (prc_zone_category = :zoneType OR prc_zone_category IS NULL)
		AND (prc_scc_id = :sccId OR prc_scc_id IS NULL)
		AND (prc_partner_id = :partnerId OR prc_partner_id IS NULL) 
		AND (prc_bkg_type = :tripType OR prc_bkg_type IS NULL) 
		 AND (prc_is_gozonow IS NULL) 
		AND prc_active=1  
		ORDER BY prc_partner_id DESC, prc_bkg_type DESC  
	 [params: {"zoneType":1,"sccId":"1","partnerId":null,"tripType":"1"}]
2024/10/17 13:54:24 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 595.339] [M: 22597.8] [ET: 0.416/567.746] [MU: 1.42/22597.62] 
	SQL: SELECT acp_cr_to,acp_margin_data FROM `addon_cancellation_policy` WHERE `acp_id` = :id 
	 [params: {"id":"8"}]
2024/10/17 13:54:24 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 610.019] [M: 22637.74] [ET: 0.363/582.404] [MU: 1.42/22637.55] 
	SQL: SELECT acp_cr_to,acp_margin_data FROM `addon_cancellation_policy` WHERE `acp_id` = :id 
	 [params: {"id":"9"}]
2024/10/17 13:54:24 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 614.064] [M: 22716.38] [ET: 0.504/586.446] [MU: 1.35/22716.2] 
	SQL: SELECT acm_svc_id_to,acm_margin_data FROM `addon_cab_models` WHERE `acm_id` = :id 
	 [params: {"id":"1"}]
2024/10/17 13:54:24 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 615.282] [M: 22720.2] [ET: 0.332/587.67] [MU: 1.34/22720.01] 
	SQL: SELECT acm_svc_id_to,acm_margin_data FROM `addon_cab_models` WHERE `acm_id` = :id 
	 [params: {"id":"2"}]
2024/10/17 13:54:24 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 616.143] [M: 22723.63] [ET: 0.235/588.533] [MU: 1.35/22723.45] 
	SQL: SELECT acm_svc_id_to,acm_margin_data FROM `addon_cab_models` WHERE `acm_id` = :id 
	 [params: {"id":"3"}]
2024/10/17 13:54:24 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 616.919] [M: 22727.07] [ET: 0.267/589.309] [MU: 1.35/22726.88] 
	SQL: SELECT acm_svc_id_to,acm_margin_data FROM `addon_cab_models` WHERE `acm_id` = :id 
	 [params: {"id":"4"}]
2024/10/17 13:54:24 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 623.552] [M: 23126.73] [ET: 1.418/595.949] [MU: 48.95/23125.48] 
	SQL:  SELECT scv_id,scc_id, vct_id, scc_cancel_rule, scc_label,scc_rank, scv_label, scv_code, scc_model_year, 
								CONCAT(vct_label, ' (', scc_label , ')') label,
									vct_label,vct_rank, vct_desc, CONCAT(vct_label, ' ', vct_desc) vhcName, 
									vct_capacity, IF(vct_image IS NULL, 'images/cabs/no-image.png', vct_image) as vct_image, vct_big_bag_capacity, vct_small_bag_capacity, vcsc_small_bag, FLOOR(vcsc_small_bag/2) AS big_bag,
									scc_is_cng, scc_is_petrol_diesel, scc_id, scc_desc, IF( vct_id IN(5, 6), '1', '0' ) AS is_assured, scv_vct_id,scv_parent_id,scv_vct_id,scv_model,scv_scc_id
						FROM svc_class_vhc_cat
						INNER JOIN service_class ON scc_id = scv_scc_id
						INNER JOIN vehicle_category ON vct_id = scv_vct_id
						INNER JOIN vehicle_cat_svc_class on vcsc_ssc_id = scv_scc_id AND vcsc_vct_id = scv_vct_id
						WHERE scv_active = 1 
							AND scc_active = 1 
						AND vct_active = 1
		 AND scv_vct_id = 3 
	 [params: []]
2024/10/17 13:54:24 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 630.139] [M: 23069.93] [ET: 531.895/602.526] [MU: 13012.11/23069.8] 
	module.admin.controller.booking.getamountbyvehicle
2024/10/17 13:54:24 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 630.179] [M: 23086.58] 
*******************************************************module.admin.controller.booking.getamountbyvehicle ACTION DONE****************************************************************
2024/10/17 14:01:41 [profile] [profile.module.admin.controller.booking.create] [T: 147.783] [M: 10083.73] 
------------------------------------------------------module.admin.controller.booking.create ACTION START------------------------------------------------------
	URL: [POST]/aaohome/booking/create
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","jsonData_vendorIns":"{\"trip_user\":\"1\",\"username\":\"9874585888\",\"bkg_contact_id\":\"\",\"bkg_user_id\":\"\",\"bkg_contact_no\":\"9874585888\",\"bkg_country_code\":\"91\",\"bkg_user_email\":\"puja.developer@gmail.com\",\"bkg_user_fname\":\"dsad\",\"bkg_user_lname\":\"sadsa\",\"bkg_booking_type\":\"1\",\"multicityAutoComTot\":\"\",\"multicityAutoComData\":\"\",\"bkg_from_city_id\":\"30804\",\"bkg_to_city_id\":\"30711\",\"routeProcessed\":\"Agra - Amritsar - Dalhousie  (One Way)\",\"baseamount\":\"10062\",\"isGozonow\":0,\"bkg_from_city_id1\":\"30804\",\"bkg_to_city_id1\":\"30711\",\"bkg_pickup_date_date\":\"31\\\/10\\\/2024\",\"bkg_pickup_date_time\":\"06:00 PM\",\"bkg_return_date_date\":\"\",\"bkg_return_date_time\":\"\",\"bkg_pickup_address\":\"\",\"bkg_drop_address\":\"\",\"tot_est_dist\":\"664\",\"tot_est_dur\":\"690\",\"bkg_vehicle_type_id\":\"3\",\"modelId\":\"\",\"bkg_service_class\":\"1\",\"bkg_addon_details\":\"\",\"cabNotSupported\":1,\"paymentChangesData\":\"\",\"bkg_surge_differentiate_amount\":\"0\",\"bkgPricefactor\":{\"surgeFactorUsed\":0,\"regularBaseAmount\":9021,\"additional_param\":\"{\\\"defMarkupCab\\\":10013,\\\"partnerMinimumBasePrice\\\":9496}\",\"partner_soldout\":0},\"agtBkgCategory\":null,\"bkg_vht_id\":\"\",\"bkg_trip_distance\":\"664\",\"bkg_trip_duration\":\"690\",\"bkg_addon_ids\":\"\",\"bkg_addon_cab\":\"\",\"bkg_chargeable_distance\":\"0\",\"bkg_gozo_base_amount\":\"10062\",\"bkg_rate_per_km_extra\":\"12.25\",\"bkg_rate_per_km\":\"10.55\",\"bkg_base_amount\":\"10062\",\"bkg_addon_charges\":\"0\",\"bkg_additional_charge_remark\":\"\",\"bkg_additional_charge\":\"0\",\"bkg_promo1_code\":\"\",\"bkg_discount_amount\":\"0\",\"bkg_quoted_vendor_amount\":\"8787\",\"bkg_vendor_amount\":\"8787\",\"bkg_night_pickup_included\":\"0\",\"bkg_night_drop_included\":\"1\",\"bkg_driver_allowance_amount\":\"250\",\"bkg_parking_charge\":\"0\",\"bkg_toll_tax\":\"0\",\"bkg_state_tax\":\"0\",\"bkg_airport_entry_fee\":\"0\",\"bkg_convenience_charge\":\"0\",\"bkg_service_tax_rate\":\"5\",\"bkg_service_tax\":\"516\",\"bkg_total_amount\":\"10828\",\"bkg_is_warned\":\"\",\"scvId\":\"3\",\"BookingRoute\":[{\"brt_from_latitude\":\"\",\"brt_from_longitude\":\"\",\"brt_from_place_id\":\"\",\"brt_from_formatted_address\":\"\",\"brt_from_city_is_airport\":\"0\",\"brt_from_city_is_poi\":\"0\",\"brt_from_location\":\"\"},{\"brt_to_latitude\":\"\",\"brt_to_longitude\":\"\",\"brt_to_place_id\":\"\",\"brt_to_formatted_address\":\"\",\"brt_to_city_is_airport\":\"0\",\"brt_to_city_is_poi\":\"0\",\"brt_to_location\":\"\"}],\"multicityjsondata\":[{\"pickup_city\":\"30804\",\"drop_city\":\"30711\",\"pickup_address\":\"\",\"drop_address\":\"\",\"date\":\"2024-10-31 18:00:00\",\"distance\":\"664\",\"duration\":\"680\"}],\"bkg_chk_others\":\"0\",\"bkg_add_my_trip\":\"0\",\"fileImage\":\"\",\"bkg_invoice\":\"0\",\"bkg_trip_otp_required\":\"1\",\"bkg_driver_app_required\":\"1\",\"bkg_duty_slip_required\":\"0\",\"bkg_water_bottles_required\":\"0\",\"bkg_is_cash_required\":\"0\",\"bkg_pref_req_other\":\"\",\"bkg_tentative_booking\":\"0\",\"bkg_send_email\":\"1\",\"bkg_send_sms\":\"1\",\"bkg_spl_req_senior_citizen_trvl\":\"0\",\"bkg_spl_req_kids_trvl\":\"0\",\"bkg_spl_req_woman_trvl\":\"0\",\"bkg_spl_req_carrier\":\"0\",\"bkg_spl_req_driver_hindi_speaking\":\"0\",\"bkg_spl_req_driver_english_speaking\":\"0\",\"bkg_spl_req_other\":\"\",\"bkg_spl_req_lunch_break_time\":\"0\",\"bkg_info_source\":\"\",\"bkg_flight_no\":\"\",\"bkg_info_source_desc\":\"\",\"bkg_user_trip_type\":\"1\",\"bkg_no_person\":\"2\",\"bkg_num_large_bag\":\"0\",\"bkg_num_small_bag\":\"1\",\"locale_followup_date\":\"17\\\/10\\\/2024\",\"locale_followup_time\":\"03:59 PM\",\"bkg_quote_expire_date\":\"19\\\/10\\\/2024\",\"bkg_quote_expire_time_1\":\"05:59 AM\"}","Booking":{"bkg_instruction_to_driver_vendor":""},"BookingPref":{"bkg_pref_req_other":""}}
	RawBody: YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&jsonData_vendorIns=%7B%22trip_user%22%3A%221%22%2C%22username%22%3A%229874585888%22%2C%22bkg_contact_id%22%3A%22%22%2C%22bkg_user_id%22%3A%22%22%2C%22bkg_contact_no%22%3A%229874585888%22%2C%22bkg_country_code%22%3A%2291%22%2C%22bkg_user_email%22%3A%22puja.developer%40gmail.com%22%2C%22bkg_user_fname%22%3A%22dsad%22%2C%22bkg_user_lname%22%3A%22sadsa%22%2C%22bkg_booking_type%22%3A%221%22%2C%22multicityAutoComTot%22%3A%22%22%2C%22multicityAutoComData%22%3A%22%22%2C%22bkg_from_city_id%22%3A%2230804%22%2C%22bkg_to_city_id%22%3A%2230711%22%2C%22routeProcessed%22%3A%22Agra+-+Amritsar+-+Dalhousie++(One+Way)%22%2C%22baseamount%22%3A%2210062%22%2C%22isGozonow%22%3A0%2C%22bkg_from_city_id1%22%3A%2230804%22%2C%22bkg_to_city_id1%22%3A%2230711%22%2C%22bkg_pickup_date_date%22%3A%2231%5C%2F10%5C%2F2024%22%2C%22bkg_pickup_date_time%22%3A%2206%3A00+PM%22%2C%22bkg_return_date_date%22%3A%22%22%2C%22bkg_return_date_time%22%3A%22%22%2C%22bkg_pickup_address%22%3A%22%22%2C%22bkg_drop_address%22%3A%22%22%2C%22tot_est_dist%22%3A%22664%22%2C%22tot_est_dur%22%3A%22690%22%2C%22bkg_vehicle_type_id%22%3A%223%22%2C%22modelId%22%3A%22%22%2C%22bkg_service_class%22%3A%221%22%2C%22bkg_addon_details%22%3A%22%22%2C%22cabNotSupported%22%3A1%2C%22paymentChangesData%22%3A%22%22%2C%22bkg_surge_differentiate_amount%22%3A%220%22%2C%22bkgPricefactor%22%3A%7B%22surgeFactorUsed%22%3A0%2C%22regularBaseAmount%22%3A9021%2C%22additional_param%22%3A%22%7B%5C%22defMarkupCab%5C%22%3A10013%2C%5C%22partnerMinimumBasePrice%5C%22%3A9496%7D%22%2C%22partner_soldout%22%3A0%7D%2C%22agtBkgCategory%22%3Anull%2C%22bkg_vht_id%22%3A%22%22%2C%22bkg_trip_distance%22%3A%22664%22%2C%22bkg_trip_duration%22%3A%22690%22%2C%22bkg_addon_ids%22%3A%22%22%2C%22bkg_addon_cab%22%3A%22%22%2C%22bkg_chargeable_distance%22%3A%220%22%2C%22bkg_gozo_base_amount%22%3A%2210062%22%2C%22bkg_rate_per_km_extra%22%3A%2212.25%22%2C%22bkg_rate_per_km%22%3A%2210.55%22%2C%22bkg_base_amount%22%3A%2210062%22%2C%22bkg_addon_charges%22%3A%220%22%2C%22bkg_additional_charge_remark%22%3A%22%22%2C%22bkg_additional_charge%22%3A%220%22%2C%22bkg_promo1_code%22%3A%22%22%2C%22bkg_discount_amount%22%3A%220%22%2C%22bkg_quoted_vendor_amount%22%3A%228787%22%2C%22bkg_vendor_amount%22%3A%228787%22%2C%22bkg_night_pickup_included%22%3A%220%22%2C%22bkg_night_drop_included%22%3A%221%22%2C%22bkg_driver_allowance_amount%22%3A%22250%22%2C%22bkg_parking_charge%22%3A%220%22%2C%22bkg_toll_tax%22%3A%220%22%2C%22bkg_state_tax%22%3A%220%22%2C%22bkg_airport_entry_fee%22%3A%220%22%2C%22bkg_convenience_charge%22%3A%220%22%2C%22bkg_service_tax_rate%22%3A%225%22%2C%22bkg_service_tax%22%3A%22516%22%2C%22bkg_total_amount%22%3A%2210828%22%2C%22bkg_is_warned%22%3A%22%22%2C%22scvId%22%3A%223%22%2C%22BookingRoute%22%3A%5B%7B%22brt_from_latitude%22%3A%22%22%2C%22brt_from_longitude%22%3A%22%22%2C%22brt_from_place_id%22%3A%22%22%2C%22brt_from_formatted_address%22%3A%22%22%2C%22brt_from_city_is_airport%22%3A%220%22%2C%22brt_from_city_is_poi%22%3A%220%22%2C%22brt_from_location%22%3A%22%22%7D%2C%7B%22brt_to_latitude%22%3A%22%22%2C%22brt_to_longitude%22%3A%22%22%2C%22brt_to_place_id%22%3A%22%22%2C%22brt_to_formatted_address%22%3A%22%22%2C%22brt_to_city_is_airport%22%3A%220%22%2C%22brt_to_city_is_poi%22%3A%220%22%2C%22brt_to_location%22%3A%22%22%7D%5D%2C%22multicityjsondata%22%3A%5B%7B%22pickup_city%22%3A%2230804%22%2C%22drop_city%22%3A%2230711%22%2C%22pickup_address%22%3A%22%22%2C%22drop_address%22%3A%22%22%2C%22date%22%3A%222024-10-31+18%3A00%3A00%22%2C%22distance%22%3A%22664%22%2C%22duration%22%3A%22680%22%7D%5D%2C%22bkg_chk_others%22%3A%220%22%2C%22bkg_add_my_trip%22%3A%220%22%2C%22fileImage%22%3A%22%22%2C%22bkg_invoice%22%3A%220%22%2C%22bkg_trip_otp_required%22%3A%221%22%2C%22bkg_driver_app_required%22%3A%221%22%2C%22bkg_duty_slip_required%22%3A%220%22%2C%22bkg_water_bottles_required%22%3A%220%22%2C%22bkg_is_cash_required%22%3A%220%22%2C%22bkg_pref_req_other%22%3A%22%22%2C%22bkg_tentative_booking%22%3A%220%22%2C%22bkg_send_email%22%3A%221%22%2C%22bkg_send_sms%22%3A%221%22%2C%22bkg_spl_req_senior_citizen_trvl%22%3A%220%22%2C%22bkg_spl_req_kids_trvl%22%3A%220%22%2C%22bkg_spl_req_woman_trvl%22%3A%220%22%2C%22bkg_spl_req_carrier%22%3A%220%22%2C%22bkg_spl_req_driver_hindi_speaking%22%3A%220%22%2C%22bkg_spl_req_driver_english_speaking%22%3A%220%22%2C%22bkg_spl_req_other%22%3A%22%22%2C%22bkg_spl_req_lunch_break_time%22%3A%220%22%2C%22bkg_info_source%22%3A%22%22%2C%22bkg_flight_no%22%3A%22%22%2C%22bkg_info_source_desc%22%3A%22%22%2C%22bkg_user_trip_type%22%3A%221%22%2C%22bkg_no_person%22%3A%222%22%2C%22bkg_num_large_bag%22%3A%220%22%2C%22bkg_num_small_bag%22%3A%221%22%2C%22locale_followup_date%22%3A%2217%5C%2F10%5C%2F2024%22%2C%22locale_followup_time%22%3A%2203%3A59+PM%22%2C%22bkg_quote_expire_date%22%3A%2219%5C%2F10%5C%2F2024%22%2C%22bkg_quote_expire_time_1%22%3A%2205%3A59+AM%22%7D&Booking%5Bbkg_instruction_to_driver_vendor%5D=&BookingPref%5Bbkg_pref_req_other%5D=
	[UserID: 30] [UserType: 4]
2024/10/17 14:01:41 [profile] [profile.module.admin.controller.booking.create] [T: 186.923] [M: 11319.93] setLocationRequest start
2024/10/17 14:01:41 [profile] [profile.module.admin.controller.booking.create] [T: 282.586] [M: 11320.44] setLocationRequest ends
2024/10/17 14:01:42 [profile] [profile.module.admin.controller.booking.create] [T: 787.656] [M: 26276.77] [ET: 0.55/717.78] [MU: 2.65/26276.46] 
	SQL: SELECT GROUP_CONCAT(zct_zon_id) as zones FROM zone_cities 
						INNER JOIN zones ON zon_id=zct_zon_id AND zon_active=1
						WHERE zct_cty_id=:city AND zct_active=1 
	 [params: {":city":"30804"}]
2024/10/17 14:01:42 [profile] [profile.module.admin.controller.booking.create] [T: 846.663] [M: 27612.42] Upload Attachment
2024/10/17 14:01:42 [profile] [profile.module.admin.controller.booking.create] [T: 860.749] [M: 27617.01] Booking Model Saved
2024/10/17 14:01:42 [profile] [profile.module.admin.controller.booking.create] [T: 996.281] [M: 29064.51] Additional Data Saved
2024/10/17 14:01:42 [profile] [profile.module.admin.controller.booking.create] [T: 1007.521] [M: 29605.99] [ET: 0.308/937.638] [MU: 0.93/29605.8] 
	SQL: SELECT CalcWorkingMinutes('2024-10-17 14:01:42', '2024-10-31 18:00:00') FROM dual 
	 [params: []]
2024/10/17 14:01:42 [profile] [profile.module.admin.controller.booking.create] [T: 1025.79] [M: 29667.84] Create traveller contact
2024/10/17 14:01:42 [profile] [profile.module.admin.controller.booking.create] [T: 1050.507] [M: 30730.45] [ET: 1.792/980.627] [MU: 2.49/30728.7] 
	SQL: SELECT ctt1.ctt_id, IF(SOUNDEX(ctt.ctt_first_name)=SOUNDEX(:firstName),1,0) as firstNameScore, IF(SOUNDEX(ctt.ctt_last_name)=SOUNDEX(:lastName),1,0) as lastNameScore, 
							IF(cp.phn_is_primary=1, 1, 0) as phonePrimaryScore, IF(ce.eml_is_primary=1, 1,0) as emailPrimaryScore,
							IF(cp.phn_is_verified>0, 2,0) as phoneVerifyScore, IF(ce.eml_is_verified>0, 2,0) as emailVerifyScore,
							cp.phn_is_verified, ce.eml_is_verified
							FROM contact ctt
							INNER JOIN contact ctt1 ON ctt.ctt_ref_code=ctt1.ctt_id AND ctt1.ctt_active=1
							LEFT JOIN contact_phone cp ON cp.phn_contact_id=ctt.ctt_id AND cp.phn_active=1 AND cp.phn_phone_no IS NOT NULL AND cp.phn_phone_no<>'' AND cp.phn_full_number=:phone
							LEFT JOIN contact_email ce ON ce.eml_contact_id=ctt.ctt_id AND ce.eml_active=1 AND ce.eml_email_address IS NOT NULL AND ce.eml_email_address<>'' AND ce.eml_email_address=:email
							WHERE ctt.ctt_id IN (:gp0)  AND ctt.ctt_active=1 AND (cp.phn_id IS NOT NULL OR ce.eml_id IS NOT NULL)
							HAVING ((lastNameScore>0 AND firstNameScore>0) OR phoneVerifyScore>0 OR emailVerifyScore>0 OR phonePrimaryScore >0 OR emailPrimaryScore>0)
							ORDER BY (lastNameScore + firstNameScore + phonePrimaryScore + phoneVerifyScore + emailPrimaryScore + emailVerifyScore) DESC, firstNameScore DESC, lastNameScore DESC, phoneVerifyScore DESC, emailVerifyScore DESC 
	 [params: {"firstName":"dsad","lastName":"sadsa","phone":"+919874585888","email":"puja.developer@gmail.com",":gp0":"1687739"}]
2024/10/17 14:01:42 [profile] [profile.module.admin.controller.booking.create] [T: 1057.013] [M: 30747.7] [ET: 0.498/987.14] [MU: 1.16/30747.27] 
	SQL: SELECT   if(phn_full_number <> '', phn_full_number, CONCAT(usr_country_code, usr_mobile)) contactNumber
					FROM `contact_phone` 
					LEFT JOIN users ON usr_contact_id = phn_contact_id
					WHERE  phn_contact_id=:contact  AND phn_active=1
					ORDER BY  phn_active DESC, (phn_is_primary + phn_is_verified + phn_active) DESC
			 
	 [params: {"contact":"1687739"}]
2024/10/17 14:01:42 [profile] [profile.module.admin.controller.booking.create] [T: 1073.184] [M: 30791.43] [ET: 0.445/1003.272] [MU: 1.73/30791.12] 
	SQL: 
				SELECT eml_id, eml_contact_id
				FROM `contact_email`
				WHERE eml_email_address = :email
					AND eml_active = 1
			 AND eml_type = 1 
	 [params: {"email":"puja.developer@gmail.com"}]
2024/10/17 14:01:42 [profile] [profile.module.admin.controller.booking.create] [T: 1073.72] [M: 30793.84] [ET: 0.35/1003.83] [MU: 1.73/30793.53] 
	SQL: 
				SELECT eml_id, eml_contact_id
				FROM `contact_email`
				WHERE eml_email_address = :email
					AND eml_active = 1
			 AND eml_type = 1 
	 [params: {"email":"puja.developer@gmail.com"}]
2024/10/17 14:01:42 [profile] [profile.module.admin.controller.booking.create] [T: 1075.672] [M: 30794.63] [ET: 0.541/1005.785] [MU: 1.79/30794.32] 
	SQL: SELECT phn_id, phn_contact_id
                              FROM contact_phone
                              WHERE phn_phone_no = :phnNumber AND phn_active = 1 AND phn_phone_country_code = 91 
	 [params: {"phnNumber":"9874394779"}]
2024/10/17 14:01:42 [profile] [profile.module.admin.controller.booking.create] [T: 1076.872] [M: 30797.27] [ET: 0.454/1006.999] [MU: 1.79/30796.89] 
	SQL: SELECT phn_id, phn_contact_id
                              FROM contact_phone
                              WHERE phn_phone_no = :phnNumber AND phn_active = 1 AND phn_phone_country_code = 91 AND phn_contact_id = 1687739 
	 [params: {"phnNumber":"9874394779"}]
2024/10/17 14:01:43 [profile] [profile.module.admin.controller.booking.create] [T: 2173.411] [M: 30855.34] Contact::createbyBookingUser DONE
2024/10/17 14:01:43 [profile] [profile.module.admin.controller.booking.create] [T: 2192.698] [M: 32024.18] [ET: 0.699/2122.783] [MU: 1.52/32023.87] 
	SQL: SELECT cr_contact_id, cr_is_vendor, cr_is_driver, cr_is_consumer, cr_is_partner
					FROM contact_profile WHERE cr_contact_id = :contactId AND cr_status = 1 
	 [params: {"contactId":"1687739"}]
2024/10/17 14:01:43 [profile] [profile.module.admin.controller.booking.create] [T: 2211.578] [M: 32060.91] User Created and Linked
2024/10/17 14:01:43 [profile] [profile.module.admin.controller.booking.create] [T: 2217.39] [M: 32063.76] User Info Saved
2024/10/17 14:01:43 [profile] [profile.module.admin.controller.booking.create] [T: 2217.446] [M: 32064.2] BKG User Info Saved
2024/10/17 14:01:43 [profile] [profile.module.admin.controller.booking.create] [T: 2224.214] [M: 32857.15] Lead Converted to Booking
2024/10/17 14:01:43 [profile] [profile.module.admin.controller.booking.create] [T: 2226.394] [M: 32861.91] setBookingRouteInfo Saved
2024/10/17 14:01:43 [profile] [profile.module.admin.controller.booking.create] [T: 2260.899] [M: 36809.35] [ET: 0.403/2191.028] [MU: 1.53/36808.98] 
	SQL: SELECT
					MAX(date_add(brt_pickup_datetime,INTERVAL brt_trip_duration MINUTE)) drop_time,
					MIN(brt_pickup_datetime) pickup_time
					FROM booking_route
					WHERE brt_bkg_id IN(5) AND brt_active=1
					ORDER BY brt_pickup_datetime desc 
	 [params: []]
2024/10/17 14:01:43 [profile] [profile.module.admin.controller.booking.create] [T: 2356.142] [M: 36851.14] [ET: 0.617/2286.231] [MU: 6.16/36849.14] 
	SQL: SELECT bkg_regular_base_amount AS regular, 
				bkg_manual_base_amount AS manual,bkg_manual_surge_factor,
				bkg_ddbp_base_amount AS ddbp,
				bkg_dtbp_base_amount AS dtbp,bkg_dtbp_factor,								
                bkg_ddbp_surge_factor,
				bkg_profitability_base_amount  AS pb,
				bkg_profitability_surge_factor,
				bkg_dzpp_surge_factor,
				bkg_dzpp_base_amount,
				bkg_debp_surge_factor,
				bkg_debp_base_amount,
				bkg_durp_surge_factor,
				bkg_durp_base_amount,
				bkg_ddbpv2_base_amount,
				bkg_ddbpv2_surge_factor,
				bkg_ddsbp_base_amount,
				bkg_ddsbp_surge_factor,
				bkg_additional_param AS additionalParam,
				JSON_VALUE(booking_price_factor.bkg_additional_param,'$.srgManual.factor') AS srgManualFactor,
				JSON_VALUE(booking_price_factor.bkg_additional_param,'$.srgDZPP.factor') AS srgDZPPFactor,
				JSON_VALUE(booking_price_factor.bkg_additional_param,'$.srgDDBP.factor') AS srgDDBPFactor,
				JSON_VALUE(booking_price_factor.bkg_additional_param,'$.srgDEBP.factor') AS srgDEBPFactor,
				JSON_VALUE(booking_price_factor.bkg_additional_param,'$.srgDURP.factor') AS srgDURPFactor,
				JSON_VALUE(booking_price_factor.bkg_additional_param,'$.srgDDBPV2.factor') AS srgDDBPV2Factor,
				JSON_VALUE(booking_price_factor.bkg_additional_param,'$.srgDTBP.factor') AS srgDTBPFactor,
				JSON_VALUE(booking_price_factor.bkg_additional_param,'$.srgDTBP.surgeAmount') AS dtbpSurgeAmount,
				JSON_VALUE(booking_price_factor.bkg_additional_param,'$.srgDDSBP.factor') AS srgDDSBPFactor,
				(CASE bkg_surge_applied  WHEN 0 THEN 'R'  WHEN 1 THEN 'M'  WHEN 2 THEN 'DD'  WHEN 4 THEN 'DT'  WHEN 7 THEN 'DZ'  WHEN 8 THEN 'DUR'  WHEN 9 THEN 'DE'  WHEN 10 THEN 'DD(V2)'  WHEN 11 THEN 'DE+DD(V2)'  WHEN 12 THEN 'DDSBP'  ELSE '' END) AS QuoteFactor 
				FROM booking_price_factor WHERE  bpf_bkg_id =:bkgId 
	 [params: {"bkgId":"5"}]
2024/10/17 14:01:43 [profile] [profile.module.admin.controller.booking.create] [T: 2357.71] [M: 36844.99] BookingPriceFactor::getQuotedFactor
2024/10/17 14:01:43 [profile] [profile.module.admin.controller.booking.create] [T: 2357.77] [M: 36845.45] Promo Part Done
2024/10/17 14:01:43 [profile] [profile.module.admin.controller.booking.create] [T: 2359.332] [M: 36851.05] [ET: 0.524/2289.465] [MU: 2.5/36850.74] 
	SQL: SELECT GROUP_CONCAT(zct_zon_id) as zones FROM zone_cities 
						INNER JOIN zones ON zon_id=zct_zon_id AND zon_active=1
						WHERE zct_cty_id=:city AND zct_active=1 
	 [params: {":city":"30804"}]
2024/10/17 14:01:43 [profile] [profile.module.admin.controller.booking.create] [T: 2360.568] [M: 36896.87] [ET: 1.107/2290.691] [MU: 43/36895.62] 
	SQL:  SELECT scv_id,scc_id, vct_id, scc_cancel_rule, scc_label,scc_rank, scv_label, scv_code, scc_model_year, 
								CONCAT(vct_label, ' (', scc_label , ')') label,
									vct_label,vct_rank, vct_desc, CONCAT(vct_label, ' ', vct_desc) vhcName, 
									vct_capacity, IF(vct_image IS NULL, 'images/cabs/no-image.png', vct_image) as vct_image, vct_big_bag_capacity, vct_small_bag_capacity, vcsc_small_bag, FLOOR(vcsc_small_bag/2) AS big_bag,
									scc_is_cng, scc_is_petrol_diesel, scc_id, scc_desc, IF( vct_id IN(5, 6), '1', '0' ) AS is_assured, scv_vct_id,scv_parent_id,scv_vct_id,scv_model,scv_scc_id
						FROM svc_class_vhc_cat
						INNER JOIN service_class ON scc_id = scv_scc_id
						INNER JOIN vehicle_category ON vct_id = scv_vct_id
						INNER JOIN vehicle_cat_svc_class on vcsc_ssc_id = scv_scc_id AND vcsc_vct_id = scv_vct_id
						WHERE scv_active = 1 
							AND scc_active = 1 
						AND vct_active = 1
		 AND scv_id = 3 
	 [params: []]
2024/10/17 14:01:43 [profile] [profile.module.admin.controller.booking.create] [T: 2370.886] [M: 37489.16] [ET: 2.224/2300.989] [MU: 2.34/37488.78] 
	SQL: SELECT dzs_zone_type FROM dynamic_zone_surge WHERE dzs_fromzoneid IN (:gp1) AND dzs_tozoneid IN (:gp2,:gp3) AND dzs_scv_id=:cab AND dzs_booking_type=:tripType  ORDER BY  dzs_zone_type ASC 
	 [params: {":gp2":"238",":gp3":"79",":gp1":"31","cab":"3","tripType":"1"}]
2024/10/17 14:01:43 [profile] [profile.module.admin.controller.booking.create] [T: 2371.897] [M: 37491.32] [ET: 0.417/2302.026] [MU: 1.24/37490.7] 
	SQL: SELECT prc_cancel_rule_id FROM `partner_cancel_rule` 
			WHERE (prc_zone_category = :zoneType OR prc_zone_category IS NULL)
		AND (prc_scc_id = :sccId OR prc_scc_id IS NULL)
		AND (prc_partner_id = :partnerId OR prc_partner_id IS NULL) 
		AND (prc_bkg_type = :tripType OR prc_bkg_type IS NULL) 
		 AND (prc_is_gozonow IS NULL) 
		AND prc_active=1  
		ORDER BY prc_partner_id DESC, prc_bkg_type DESC  
	 [params: {"zoneType":1,"sccId":"1","partnerId":null,"tripType":"1"}]
2024/10/17 14:01:43 [profile] [profile.module.admin.controller.booking.create] [T: 2384.861] [M: 37506.57] Cancellation Policy
2024/10/17 14:01:43 [profile] [profile.module.admin.controller.booking.create] [T: 2391.748] [M: 37509.68] Booking Saved
2024/10/17 14:01:43 [profile] [profile.module.admin.controller.booking.create] [T: 2405.566] [M: 37552.99] Booking Other Models Saved
2024/10/17 14:01:44 [profile] [profile.module.admin.controller.booking.create] [T: 2511.653] [M: 37666.23] Agent booking assignment test 1:	
2024/10/17 14:01:44 [profile] [profile.module.admin.controller.booking.create] [T: 2525.976] [M: 38206.63] [ET: 1679.957/2456.106] [MU: 10619.93/38206.53] 
	DBUtil::Transaction
2024/10/17 14:01:44 [profile] [profile.module.admin.controller.booking.create] [T: 2527.745] [M: 38281.6] [ET: 0.447/2457.875] [MU: 0.93/38281.29] 
	SQL: select bkg_id FROM booking bkg INNER JOIN booking_trail bkgTrail ON bkgTrail.btr_bkg_id = bkg.bkg_id WHERE 1
 			    AND bkgTrail.bkg_tags IS NOT NULL AND CONCAT(',', bkg_tags , ',') REGEXP ',(3),'  AND bkg.bkg_id = 5 
	 [params: []]
2024/10/17 14:01:44 [profile] [profile.module.admin.controller.booking.create] [T: 2528.468] [M: 38283.15] [ET: 0.651/2458.588] [MU: 0.93/38282.84] 
	SQL: select bkg_id FROM booking bkg INNER JOIN booking_trail bkgTrail ON bkgTrail.btr_bkg_id = bkg.bkg_id WHERE 1
 			    AND bkgTrail.bkg_tags IS NOT NULL AND CONCAT(',', bkg_tags , ',') REGEXP ',(2),'  AND bkg.bkg_id = 5 
	 [params: []]
2024/10/17 14:01:44 [profile] [profile.module.admin.controller.booking.create] [T: 2572.398] [M: 38407.98] [ET: 19.927/2502.519] [MU: 1.24/38407.35] 
	SQL: SELECT ucm_id,ucm_label,ucm_cash_trip_types,ucm_rel_manager,ucm_gozocoin_percent,ucm_coins 
					FROM contact_profile cp 
				INNER JOIN contact ON ctt_id = cp.cr_contact_id AND ctt_active = 1
				INNER JOIN contact_pref cpr ON cp.cr_contact_id = cpr.cpr_ctt_id 
				INNER JOIN user_category_master ucm ON ucm.ucm_id = cpr.cpr_category 
				WHERE cp.cr_status = 1 AND cp.cr_is_consumer = :user AND ucm_active = 1 
	 [params: {"user":"1"}]
2024/10/17 14:01:44 [profile] [profile.module.admin.controller.booking.create] [T: 2573.028] [M: 37814.94] [ET: 0.318/2503.163] [MU: 0.91/37814.78] 
	SQL: SELECT CalcWorkingMinutes(NOW(), '2024-10-31 18:00:00') FROM dual 
	 [params: []]
2024/10/17 14:01:44 [profile] [profile.module.admin.controller.booking.create] [T: 2573.766] [M: 37817.19] [ET: 0.18/2503.902] [MU: 0.93/37817] 
	SQL: SELECT CalcWorkingMinutes('2024-10-17 17:01:44', '2024-10-31 18:00:00') FROM dual 
	 [params: []]
2024/10/17 14:01:44 [profile] [profile.module.admin.controller.booking.create] [T: 2598.657] [M: 39127.58] [ET: 0.54/2528.746] [MU: 0.83/39127.39] 
	SQL: SELECT bkg_id FROM booking WHERE bkg_booking_id =:bkgId OR bkg_id=:bkgId  
	 [params: {"bkgId":"5"}]
2024/10/17 14:01:44 [profile] [profile.module.admin.controller.booking.create] [T: 2607.088] [M: 39144.58] [ET: 7.03/2537.193] [MU: 1.01/39144.27] 
	SQL: SELECT count(distinct scq_id)
					FROM service_call_queue
					WHERE scq_follow_up_queue_type = :refType 
					AND scq_follow_up_date_time<=NOW() AND scq_status IN (1,3) 
	 [params: {"refType":7}]
2024/10/17 14:01:44 [profile] [profile.module.admin.controller.booking.create] [T: 2667.456] [M: 39261.41] [ET: 25.5/2597.565] [MU: 0.87/39261.16] 
	SQL: SELECT tqm_tea_id FROM `team_queue_mapping` WHERE `tqm_active` = 1 AND tqm_queue_id=:refTypeId ORDER BY `tqm_priority` ASC LIMIT 0,1  
	 [params: {"refTypeId":7}]
2024/10/17 14:01:44 [profile] [profile.module.admin.controller.booking.create] [T: 2699.864] [M: 39268.61] [ET: 25.498/2629.968] [MU: 2.27/39266.86] 
	SQL: SELECT
					COUNT(DISTINCT  adm_id) as cnt
					FROM admins adm
					JOIN `admin_profiles` adp ON adp.adp_adm_id = adm.adm_id AND  adm.adm_active=1
					JOIN
					(
						SELECT  ado_admin_id, ado_status, ado_time
						FROM `admin_onoff`
						WHERE 1 AND ado_status = 1 AND
						ado_time > DATE_SUB(NOW(),INTERVAL :duration HOUR)
						GROUP BY ado_admin_id
						ORDER BY ado_time desc
					) aadmin_onoff on aadmin_onoff.ado_admin_id = adm.adm_id
					 JOIN
					(
						SELECT
						admin_profiles.adp_adm_id,
						JSON_UNQUOTE(JSON_EXTRACT(admin_profiles.adp_cdt_id, CONCAT("$[", pseudo_rows.row, "].cdtWeight"))) AS cdtWeight,
						JSON_UNQUOTE(JSON_EXTRACT(admin_profiles.adp_cdt_id, CONCAT("$[", pseudo_rows.row, "].cdtId"))) AS cdtId
						FROM admin_profiles
						JOIN pseudo_rows
						WHERE 1
						HAVING cdtId IS NOT NULL
					) temp ON temp.adp_adm_id=adp.adp_adm_id
					JOIN `cat_depart_team_map` cdt  ON temp.cdtId=cdt.cdt_id
					JOIN teams ON cdt.cdt_tea_id = teams.tea_id
					WHERE  teams.tea_id =:teamid
					AND
					(
						(tea_start_time IS NULL AND tea_stop_time IS NULL)
							OR
						(tea_start_time < tea_stop_time AND CURRENT_TIME() BETWEEN tea_start_time AND tea_stop_time)
							OR
						(tea_stop_time < tea_start_time AND CURRENT_TIME() < tea_start_time AND CURRENT_TIME() < tea_stop_time)
							OR
						(tea_stop_time < tea_start_time AND CURRENT_TIME() > tea_start_time)
					)
					ORDER BY temp.cdtWeight ASC LIMIT 0,1 
	 [params: {"teamid":false,"duration":4}]
2024/10/17 14:01:44 [profile] [profile.module.admin.controller.booking.create] [T: 2700.425] [M: 39268.88] [ET: 0.45/2630.542] [MU: 1.08/39268.5] 
	SQL: SELECT
					COUNT(DISTINCT scq_assigned_uid)
					FROM  service_call_queue
					WHERE  scq_follow_up_queue_type = :refType AND scq_active=1  AND scq_status IN (1,3) AND scq_follow_up_date_time > DATE_SUB(NOW(),INTERVAL :duration HOUR) 
	 [params: {"refType":7,"duration":4}]
2024/10/17 14:01:44 [profile] [profile.module.admin.controller.booking.create] [T: 2700.905] [M: 39270.22] [ET: 0.35/2631.037] [MU: 0.93/39269.91] 
	SQL: select bkg_id FROM booking bkg INNER JOIN booking_trail bkgTrail ON bkgTrail.btr_bkg_id = bkg.bkg_id WHERE 1
 			    AND bkgTrail.bkg_tags IS NOT NULL AND CONCAT(',', bkg_tags , ',') REGEXP ',(3),'  AND bkg.bkg_id = 5 
	 [params: []]
2024/10/17 14:01:44 [profile] [profile.module.admin.controller.booking.create] [T: 2701.213] [M: 39271.77] [ET: 0.247/2631.349] [MU: 0.93/39271.45] 
	SQL: select bkg_id FROM booking bkg INNER JOIN booking_trail bkgTrail ON bkgTrail.btr_bkg_id = bkg.bkg_id WHERE 1
 			    AND bkgTrail.bkg_tags IS NOT NULL AND CONCAT(',', bkg_tags , ',') REGEXP ',(2),'  AND bkg.bkg_id = 5 
	 [params: []]
2024/10/17 14:01:44 [profile] [profile.module.admin.controller.booking.create] [T: 2708.489] [M: 39300.67] [ET: 0.359/2638.62] [MU: 0.99/39300.36] 
	SQL: SELECT GROUP_CONCAT(tqm.tqm_tea_id) teamIds FROM `service_call_queue` scq
			INNER JOIN team_queue_mapping tqm ON
			tqm.tqm_queue_id=scq.scq_follow_up_queue_type
			AND tqm.tqm_active = 1
			WHERE `scq_id` = :scqId 
	 [params: {"scqId":"3"}]
2024/10/17 14:01:44 [profile] [profile.module.admin.controller.booking.create] [T: 2708.831] [M: 39302.28] [ET: 0.267/2638.967] [MU: 0.99/39301.97] 
	SQL: SELECT GROUP_CONCAT(tqm.tqm_tea_id) teamIds FROM `service_call_queue` scq
			INNER JOIN team_queue_mapping tqm ON
			tqm.tqm_queue_id=scq.scq_follow_up_queue_type
			AND tqm.tqm_active = 1
			WHERE `scq_id` = :scqId 
	 [params: {"scqId":"3"}]
2024/10/17 14:01:44 [profile] [profile.module.admin.controller.booking.create] [T: 2709.164] [M: 39304.78] [ET: 0.267/2639.3] [MU: 1.64/39304.34] 
	SQL: SELECT COUNT(DISTINCT scq_assigned_uid) countCSR, COUNT(DISTINCT scq_id) countClosedCalls
				FROM  service_call_queue
				WHERE  scq_to_be_followed_up_by_id = :teamId 
					AND	scq_to_be_followed_up_by_type=1 
					AND scq_active=1 AND scq_status IN (2) 
					AND scq_follow_up_date_time > DATE_SUB(NOW(),INTERVAL :duration HOUR) 
	 [params: {"teamId":null,"duration":1}]
2024/10/17 14:03:36 [profile] [profile.module.admin.controller.booking.create] [T: 115.445] [M: 9522.56] 
------------------------------------------------------module.admin.controller.booking.create ACTION START------------------------------------------------------
	URL: [GET]/aaohome/booking/create
	User IP: 192.168.1.240
	[UserID: 30] [UserType: 4]
2024/10/17 14:03:36 [profile] [profile.module.admin.controller.booking.create] [T: 169.403] [M: 10758.83] setLocationRequest start
2024/10/17 14:03:36 [profile] [profile.module.admin.controller.booking.create] [T: 259.617] [M: 10759.34] setLocationRequest ends
2024/10/17 14:03:36 [profile] [profile.module.admin.controller.booking.create] [T: 370.631] [M: 20742.64] [ET: 0.772/333.748] [MU: 1.99/20741.14] 
	SQL: SELECT  teams.tea_id 
					FROM   admins adm
					LEFT JOIN `admin_profiles` adp ON adp.adp_adm_id = adm.adm_id
					LEFT JOIN
					(
						SELECT 
						admin_profiles.adp_adm_id,
						JSON_UNQUOTE(JSON_EXTRACT(admin_profiles.adp_cdt_id, CONCAT('$[', pseudo_rows.row, '].cdtWeight'))) AS cdtWeight,
						JSON_UNQUOTE(JSON_EXTRACT(admin_profiles.adp_cdt_id, CONCAT('$[', pseudo_rows.row, '].cdtId'))) AS cdtId
						FROM admin_profiles
						JOIN pseudo_rows
						WHERE 1 AND  adp_adm_id = :admId
						HAVING cdtId IS NOT NULL
					) temp ON temp.adp_adm_id=adp.adp_adm_id
					LEFT JOIN `cat_depart_team_map` cdt  ON temp.cdtId=cdt.cdt_id
					LEFT JOIN teams ON cdt.cdt_tea_id = teams.tea_id								   
					WHERE  adm_id = :admId
					AND
					( 
						(tea_start_time IS NULL AND tea_stop_time IS NULL)
							OR           
						(tea_start_time < tea_stop_time AND CURRENT_TIME() BETWEEN tea_start_time AND tea_stop_time)
							OR
						(tea_stop_time < tea_start_time AND CURRENT_TIME() < tea_start_time AND CURRENT_TIME() < tea_stop_time)
							OR
						(tea_stop_time < tea_start_time AND CURRENT_TIME() > tea_start_time)
					)
					ORDER BY temp.cdtWeight  ASC LIMIT 0,1 
	 [params: {"admId":"30"}]
2024/10/17 14:03:36 [profile] [profile.module.admin.controller.booking.create] [T: 374.441] [M: 20743.71] [ET: 3.737/337.583] [MU: 1.2/20743.27] 
	SQL: SELECT  COUNT(*) as active_cbr_count_byId FROM `service_call_queue`
					WHERE 1 AND scq_status IN (1,3) AND scq_follow_up_queue_type=9
					AND scq_create_date >='2021-01-01 00:00:00'
					AND scq_active=1
				    AND scq_follow_up_date_time  < DATE_ADD(NOW(),INTERVAL 24 HOUR) AND scq_to_be_followed_up_by_id = :team_id 
	 [params: {"team_id":null}]
2024/10/17 14:03:36 [profile] [profile.module.admin.controller.booking.create] [T: 374.899] [M: 20745.73] [ET: 0.364/338.047] [MU: 1.15/20745.23] 
	SQL: SELECT  COUNT(*) as active_cbr_count_byId FROM `service_call_queue`
					WHERE 1 AND scq_status IN (1,3)  AND scq_follow_up_queue_type=9
					 AND scq_create_date >='2021-01-01 00:00:00'
					 AND scq_active=1
				   AND scq_follow_up_date_time  < DATE_ADD(NOW(),INTERVAL 24 HOUR) AND scq_to_be_followed_up_by_id = :adm_id AND scq_to_be_followed_up_by_type=2 
	 [params: {"adm_id":"30"}]
2024/10/17 14:03:36 [profile] [profile.module.admin.controller.booking.create] [T: 404.004] [M: 21085.73] [ET: 6.391/367.115] [MU: 1.99/21084.48] 
	SQL: SELECT cdt.cdt_id
			FROM admins adm
			LEFT JOIN `admin_profiles` adp ON adp.adp_adm_id = adm.adm_id
			LEFT JOIN
			(
				SELECT 
				admin_profiles.adp_adm_id,
				JSON_UNQUOTE(JSON_EXTRACT(admin_profiles.adp_cdt_id, CONCAT('$[', pseudo_rows.row, '].cdtWeight'))) AS cdtWeight,
				JSON_UNQUOTE(JSON_EXTRACT(admin_profiles.adp_cdt_id, CONCAT('$[', pseudo_rows.row, '].cdtId'))) AS cdtId
				FROM admin_profiles
				JOIN pseudo_rows
				WHERE 1
				HAVING cdtId IS NOT NULL
			) temp ON temp.adp_adm_id=adp.adp_adm_id
			LEFT JOIN `cat_depart_team_map` cdt  ON temp.cdtId=cdt.cdt_id
			LEFT JOIN teams ON cdt.cdt_tea_id = teams.tea_id
			WHERE cdt.cdt_id IN (:gp0)
			AND
			(
				(tea_start_time IS NULL AND tea_stop_time IS NULL)
				OR
				(tea_start_time < tea_stop_time AND CURRENT_TIME() BETWEEN tea_start_time AND tea_stop_time)
				OR
				(tea_stop_time < tea_start_time AND CURRENT_TIME() < tea_start_time AND CURRENT_TIME() < tea_stop_time)
				OR
				(tea_stop_time < tea_start_time AND CURRENT_TIME() > tea_start_time)
			)
			ORDER BY temp.cdtWeight ASC LIMIT 0,1 
	 [params: {":gp0":"1"}]
2024/10/17 14:03:36 [profile] [profile.module.admin.controller.booking.create] [T: 549.231] [M: 21384.41] [ET: 433.699/512.348] [MU: 11860.32/21384.3] 
	module.admin.controller.booking.create
2024/10/17 14:03:36 [profile] [profile.module.admin.controller.booking.create] [T: 549.283] [M: 21384.55] 
*******************************************************module.admin.controller.booking.create ACTION DONE****************************************************************
2024/10/17 14:04:26 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 89.108] [M: 10045.42] 
------------------------------------------------------module.admin.controller.booking.getamountbyvehicle ACTION START------------------------------------------------------
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30726","cabType":"3","tripDistance":"","tripDuration":"","multiCityData":"","bookingType":"1","pickupAddress":"","pickupDate":"24\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","sccId":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30726&cabType=3&tripDistance=&tripDuration=&multiCityData=&bookingType=1&pickupAddress=&pickupDate=24%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&sccId=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 14:04:26 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 123.241] [M: 11281.63] setLocationRequest start
2024/10/17 14:04:26 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 208.287] [M: 11282.13] setLocationRequest ends
2024/10/17 14:04:27 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 303.981] [M: 18107.56] [ET: 0.31/280.942] [MU: 0.84/18107.38] 
	SQL: SELECT COUNT(1) as cnt FROM cities WHERE cty_active=1 AND cty_service_active=1 AND cty_id=30804 
	 [params: []]
2024/10/17 14:04:27 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 304.249] [M: 18108.86] [ET: 0.199/281.215] [MU: 0.83/18108.67] 
	SQL: SELECT COUNT(1) as cnt FROM cities WHERE cty_active=1 AND cty_service_active=1 AND cty_id=30726 
	 [params: []]
2024/10/17 14:04:27 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 321.504] [M: 18592.12] [ET: 17.177/298.44] [MU: 483.16/18592.01] 
	BookingRoute::calculateDistance
2024/10/17 14:04:27 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 322.262] [M: 18589.41] [ET: 0.371/299.208] [MU: 1.24/18589.3] 
	BookingRoute::calculateDistance
2024/10/17 14:04:27 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 322.358] [M: 18589.2] [ET: 56.941/299.308] [MU: 5974.33/18589.11] 
	validateRoutes
2024/10/17 14:04:27 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 325.717] [M: 18822.32] [ET: 0.895/302.65] [MU: 27.07/18822.1] 
	SQL: SELECT scv_id FROM svc_class_vhc_cat WHERE scv_active = 1 AND scv_scc_id IN (1,2,4,6) ORDER BY scv_vct_id ASC,scv_scc_id ASC 
	 [params: []]
2024/10/17 14:04:27 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 330.785] [M: 18809.96] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.Quote.getQuote START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30726","cabType":"3","tripDistance":"","tripDuration":"","multiCityData":"","bookingType":"1","pickupAddress":"","pickupDate":"24\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","sccId":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30726&cabType=3&tripDistance=&tripDuration=&multiCityData=&bookingType=1&pickupAddress=&pickupDate=24%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&sccId=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 14:04:27 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 363.504] [M: 19262.34] [ET: 0.749/340.444] [MU: 2.5/19262.03] 
	SQL: SELECT GROUP_CONCAT(zct_zon_id) as zones FROM zone_cities 
						INNER JOIN zones ON zon_id=zct_zon_id AND zon_active=1
						WHERE zct_cty_id=:city AND zct_active=1 
	 [params: {":city":"30804"}]
2024/10/17 14:04:27 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 383.031] [M: 19675.74] [ET: 0.785/359.972] [MU: 3.34/19675.3] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:27 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 386.294] [M: 19680.57] [ET: 3.141/363.226] [MU: 3.22/19680.13] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30726"}]
2024/10/17 14:04:27 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 387.186] [M: 19682.61] [ET: 0.751/364.116] [MU: 0.9/19682.39] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:27 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 401.233] [M: 19733.77] [ET: 13.859/378.162] [MU: 43.61/19732.27] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (101) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30726) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp0)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp3,:gp4)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp1,:gp2)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp5,:gp6))
			OR (scr_area_type = 5 AND scr_area_id IN (908))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (3)
		ORDER BY rank DESC
		 
	 [params: {":gp0":"31",":gp1":"30804",":gp2":"30726",":gp3":"105",":gp4":"101",":gp5":"1",":gp6":"1","tripType":"1"}]
2024/10/17 14:04:27 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 427.142] [M: 19784.31] [ET: 11.276/404.068] [MU: 0.84/19784.13] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 14:04:27 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 434.826] [M: 19786.6] [ET: 7.472/411.78] [MU: 0.96/19786.29] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"1"}]
2024/10/17 14:04:27 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 454.524] [M: 19930.42] [ET: 3.495/431.471] [MU: 6.66/19929.55] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:27 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 457.088] [M: 20097.34] [ET: 0.562/434.044] [MU: 0.9/20097.13] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:27 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 460.02] [M: 20228.41] [ET: 0.633/436.977] [MU: 2.97/20227.97] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:27 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 461.12] [M: 20260.27] [ET: 0.946/438.049] [MU: 25.35/20259.52] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp9)) OR (apr_area_type = 5 AND apr_area_id IN (:gp7)) OR (apr_area_type = 2 AND apr_area_id IN (:gp10)) OR (apr_area_type = 4 AND apr_area_id IN (:gp11)) OR (apr_area_type = 1 AND apr_area_id IN (:gp8))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp7":"908",":gp8":"31",":gp9":"30804",":gp10":"105",":gp11":"1","cab":"3"}]
2024/10/17 14:04:28 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1447.72] [M: 21868.79] [ET: 963.007/1424.672] [MU: 4.1/21867.91] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30804"}]
2024/10/17 14:04:29 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 2346.171] [M: 21889.65] [ET: 897.055/2323.102] [MU: 3.74/21888.77] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30726"}]
2024/10/17 14:04:29 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 2348.295] [M: 21906.95] [ET: 0.391/2325.244] [MU: 3/21906.85] 
	BookingRoute::calculateDistance
2024/10/17 14:04:29 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 2476.181] [M: 21947.52] [ET: 99.152/2453.108] [MU: 2.04/21947.14] 
	SQL: SELECT *
				FROM   partner_rate prt 
				JOIN route rut ON prt.prt_route_id = rut.rut_id AND rut.rut_active = 1
				AND  rut.rut_from_city_id  = 30804 
				AND  rut.rut_to_city_id  = 30726 
				 WHERE prt_vehicletype_id = 3
				AND prt_partner_id = 1249
				AND prt_status = 1
				 
	 [params: []]
2024/10/17 14:04:29 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 2477.345] [M: 21952.74] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30726","cabType":"3","tripDistance":"","tripDuration":"","multiCityData":"","bookingType":"1","pickupAddress":"","pickupDate":"24\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","sccId":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30726&cabType=3&tripDistance=&tripDuration=&multiCityData=&bookingType=1&pickupAddress=&pickupDate=24%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&sccId=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 14:04:29 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 2478.075] [M: 21969.59] [ET: 1.401/2455.028] [MU: 18.05/21969.48] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 14:04:29 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 2478.129] [M: 21971.27] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 14:04:29 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 2511.205] [M: 22054.23] [ET: 31.13/2488.131] [MU: 3.2/22051.73] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+5845),(IF((cpm_value_type=2),(5845+(5845*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30726 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30726) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-24 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=3 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 14:04:29 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 2549.005] [M: 23407.64] [ET: 72.462/2525.963] [MU: 1456.57/23407.48] 
	RouteRates::calculate for CAB 3 2024-10-24 18:00:00 - Trip Type: 1 912268839
2024/10/17 14:04:29 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 2549.231] [M: 23386.58] [ET: 2098.472/2526.201] [MU: 3467.25/23386.42] 
	Quote::calculateOneWay  for CAB 3 Date: 2024-10-24 18:00:00
2024/10/17 14:04:29 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 2549.59] [M: 23380.91] [ET: 0.274/2526.536] [MU: 0.9/23380.66] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"3"}]
2024/10/17 14:04:29 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 2549.701] [M: 23381.52] [ET: 2218.815/2526.655] [MU: 4569.06/23381.42] 
	Quote For CabType: 3
2024/10/17 14:04:29 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 2551.162] [M: 23394.91] [ET: 0.475/2528.109] [MU: 2.97/23394.48] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:29 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 2551.699] [M: 23399.87] [ET: 0.439/2528.649] [MU: 3.34/23399.43] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30726"}]
2024/10/17 14:04:29 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 2552.301] [M: 23401.94] [ET: 0.518/2529.265] [MU: 0.9/23401.69] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:29 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 2563.377] [M: 23441.67] [ET: 10.964/2540.328] [MU: 32.21/23440.17] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (101) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30726) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp12)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp15,:gp16)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp13,:gp14)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp17,:gp18))
			OR (scr_area_type = 5 AND scr_area_id IN (908))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (16)
		ORDER BY rank DESC
		 
	 [params: {":gp12":"31",":gp13":"30804",":gp14":"30726",":gp15":"105",":gp16":"101",":gp17":"1",":gp18":"1","tripType":"1"}]
2024/10/17 14:04:29 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 2567.706] [M: 23419.98] [ET: 3.753/2544.662] [MU: 0.83/23419.79] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 14:04:29 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 2576.769] [M: 23422.27] [ET: 8.976/2553.725] [MU: 0.97/23421.95] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"2"}]
2024/10/17 14:04:29 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 2579.998] [M: 23439.13] [ET: 2.204/2556.95] [MU: 3.53/23438.26] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"16","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:29 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 2586.019] [M: 23442.38] [ET: 5.774/2562.958] [MU: 0.87/23442.16] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":0}]
2024/10/17 14:04:29 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 2586.783] [M: 23449.66] [ET: 0.568/2563.747] [MU: 2.97/23449.23] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:29 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 2587.606] [M: 23477.84] [ET: 0.685/2564.559] [MU: 22.04/23477.21] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp20)) OR (apr_area_type = 2 AND apr_area_id IN (:gp21)) OR (apr_area_type = 4 AND apr_area_id IN (:gp22)) OR (apr_area_type = 1 AND apr_area_id IN (:gp19))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp19":"31",":gp20":"30804",":gp21":"105",":gp22":"1","cab":"16"}]
2024/10/17 14:04:29 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 2588.774] [M: 23463.81] [ET: 0.504/2565.738] [MU: 3.34/23463.38] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:29 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 2589.422] [M: 23494.84] [ET: 0.532/2566.368] [MU: 24.9/23494.22] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp24)) OR (apr_area_type = 2 AND apr_area_id IN (:gp25)) OR (apr_area_type = 4 AND apr_area_id IN (:gp26)) OR (apr_area_type = 1 AND apr_area_id IN (:gp23))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp23":"31",":gp24":"30804",":gp25":"105",":gp26":"1","cab":"3"}]
2024/10/17 14:04:29 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 2590.856] [M: 23480.79] [ET: 0.577/2567.796] [MU: 3.33/23480.35] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:29 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 2593.596] [M: 23491.11] [ET: 2.554/2570.522] [MU: 3.57/23490.23] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp28)) OR (scr_area_type = 2 AND scr_area_id IN (:gp29)) OR (scr_area_type = 4 AND scr_area_id IN (:gp30)) OR (scr_area_type = 1 AND scr_area_id IN (:gp27)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp27":"31",":gp28":"30804",":gp29":"105",":gp30":"1","scv_id":"16"}]
2024/10/17 14:04:32 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 5611.406] [M: 23567.4] [ET: 3016.428/5588.29] [MU: 0.74/23559.4] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"nearest_route_30804_30726","sql":"(INDEX indx_nearest_rt_rutid (rut_id)) \r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, routeFrom.rut_name as fromAlias, \r\n\t\t\t\tNULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, \r\n\t\t\t\t0 as rank, routeFrom.rut_estm_time as startTime, 0 as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\tAND route.rut_to_city_id=30726 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 \r\n\t\t\t\tAND routeFrom.rut_from_city_id<>routeFrom.rut_to_city_id AND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\t\tAND (routeAlias.rut_to_city_id=route.rut_to_city_id) AND routeAlias.rut_active = 1 \r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, NULL, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) \r\n\t\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\t0 AS extraStartDistance, 0, 0 as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND route.rut_from_city_id = 30804 AND route.rut_to_city_id=30726 \r\n\t\t\t\tAND routeTo.rut_from_city_id=30726\r\n\t\t\t\tAND route.rut_active = 1 AND routeTo.rut_active = 1 AND routeTo.rut_estm_distance < 50 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = route.rut_from_city_id) \r\n\t\t\t   AND (routeAlias.rut_to_city_id = routeTo.rut_to_city_id) AND routeAlias.rut_active = 1 \r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, \r\n\t\t\t\trouteFrom.rut_name, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t+ IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) \r\n\t\t\t\tAS extraDistance, IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, 0, \r\n\t\t\t\trouteFrom.rut_estm_time as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\t\tAND route.rut_to_city_id=30726 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 AND routeFrom.rut_from_city_id <> routeFrom.rut_to_city_id\r\n\t\t\t\t\tAND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND routeTo.rut_estm_distance < 50 \r\n\t\t\t\t\tAND routeTo.rut_from_city_id=30726 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\tAND (routeAlias.rut_to_city_id=routeTo.rut_to_city_id) AND routeAlias.rut_active = 1 AND routeAlias.rut_from_city_id=30804 "}]
2024/10/17 14:04:32 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 5611.948] [M: 23577.25] [ET: 0.416/5588.858] [MU: 0.87/23577.09] 
	SQL: SELECT GROUP_CONCAT(rut_id) as rutIds FROM nearest_route_30804_30726 
	 [params: []]
2024/10/17 14:04:32 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 5616.999] [M: 23575.29] [ET: 3.362/5593.905] [MU: 2.77/23574.85] 
	SQL: SELECT *, (rte_vendor_amount + extraDistance * 10.55) as totalCost FROM (SELECT * FROM nearest_route_30804_30726) a
					INNER JOIN rate ON a.rut_id = rate.rte_route_id AND rte_status=1 AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <>0
					WHERE 1 ORDER BY rank DESC, totalCost ASC LIMIT 0,1 
	 [params: {"cabType":"16"}]
2024/10/17 14:04:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 13266.293] [M: 23583.31] [ET: 7649.07/13243.212] [MU: 0.75/23581.31] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"getNearestRoute_30804_30726_70","sql":"(INDEX getNearestRoute_30804_30726_70_index_rut_id (rut_id))\r\n\t\t\t\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id AS start, routeAlias.rut_to_city_id AS end,\r\n\t\t\t\t\t\t\t\trouteFrom.rut_name AS fromAlias, NULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance AS quotedDistance,\r\n\t\t\t\t\t\t\t\trouteAlias.rut_estm_distance AS rateDistance, \r\n\t\t\t\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance)\r\n\t\t\t\t\t\t\t\t\t - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance,\r\n\t\t\t\t\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance,\r\n\t\t\t\t\t\t\t\t0 AS rank, routeFrom.rut_estm_time AS startTime, 0 AS endTime, route.rut_estm_time, \r\n\t\t\t\t\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraTravelDistance\r\n\t\t\t\t\t\tFROM   route\r\n\t\t\t\t\t\tINNER JOIN route routeTo ON routeTo.rut_to_city_id=route.rut_from_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_from_city_id=30804 AND routeTo.rut_active=1\r\n\t\t\t\t\t\t\t\tAND routeTo.rut_estm_distance<70 AND route.rut_active=1\r\n\t\t\t\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_from_city_id=route.rut_to_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_to_city_id=30726 AND routeFrom.rut_active = 1\r\n\t\t\t\t\t\t\t\tAND routeFrom.rut_estm_distance<70 AND route.rut_active = 1\r\n\t\t\t\t\t\tINNER JOIN route routeAlias ON routeAlias.rut_to_city_id=routeFrom.rut_to_city_id\r\n\t\t\t\t\t\t\tAND routeAlias.rut_from_city_id=routeTo.rut_from_city_id AND routeAlias.rut_active = 1"}]
2024/10/17 14:04:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 13274.894] [M: 23588.63] [ET: 8.42/13251.787] [MU: 2.46/23588] 
	SQL: SELECT *, (rte_vendor_amount + extradistance * 10.55 ) AS totalCost, 
						ABS(quotedDistance-rateDistance) AS extraChargeableDistance
					FROM getNearestRoute_30804_30726_70 a
					INNER JOIN rate ON a.rut_id=rate.rte_route_id AND rte_status=1 
						AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <> 0
					WHERE  1
					ORDER  BY rank DESC, extraStartDistance, extraChargeableDistance ASC, totalcost ASC
					LIMIT  0, 1 
	 [params: {"cabType":"16"}]
2024/10/17 14:04:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 13283.995] [M: 23605.48] [ET: 0.741/13260.925] [MU: 5.19/23604.61] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 13347.548] [M: 23612.75] [ET: 63.312/13324.499] [MU: 0.9/23612.5] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 13351.093] [M: 23631.34] [ET: 0.57/13328.049] [MU: 3.34/23630.91] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 13360.871] [M: 23641.89] [ET: 9.631/13337.799] [MU: 3.53/23641.02] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp33)) OR (scr_area_type = 5 AND scr_area_id IN (:gp31)) OR (scr_area_type = 2 AND scr_area_id IN (:gp34)) OR (scr_area_type = 4 AND scr_area_id IN (:gp35)) OR (scr_area_type = 1 AND scr_area_id IN (:gp32)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp31":"908",":gp32":"31",":gp33":"908",":gp34":"105",":gp35":"1","scv_id":"16"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 13361.94] [M: 23640.49] [ET: 0.638/13338.899] [MU: 0.89/23640.24] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 13363.109] [M: 23652.84] [ET: 0.507/13340.056] [MU: 2.97/23652.4] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 13364.065] [M: 23681.76] [ET: 0.815/13340.999] [MU: 22.41/23681.01] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp38)) OR (apr_area_type = 5 AND apr_area_id IN (:gp36)) OR (apr_area_type = 2 AND apr_area_id IN (:gp39)) OR (apr_area_type = 4 AND apr_area_id IN (:gp40)) OR (apr_area_type = 1 AND apr_area_id IN (:gp37))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp36":"908",":gp37":"31",":gp38":"30804",":gp39":"105",":gp40":"1","cab":"16"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 13366.666] [M: 23669.02] [ET: 0.727/13343.582] [MU: 3.34/23668.58] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 13369.933] [M: 23679.56] [ET: 3.072/13346.866] [MU: 3.53/23678.69] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp43)) OR (scr_area_type = 5 AND scr_area_id IN (:gp41)) OR (scr_area_type = 2 AND scr_area_id IN (:gp44)) OR (scr_area_type = 4 AND scr_area_id IN (:gp45)) OR (scr_area_type = 1 AND scr_area_id IN (:gp42)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp41":"908",":gp42":"31",":gp43":"908",":gp44":"105",":gp45":"1","scv_id":"16"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 13371.253] [M: 23684.32] [ET: 0.851/13348.182] [MU: 3.85/23683.45] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30804"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 13372.174] [M: 23692.13] [ET: 0.777/13349.116] [MU: 4.21/23691.26] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30726"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 13372.728] [M: 23696.27] [ET: 0.427/13349.661] [MU: 2.98/23696.16] 
	BookingRoute::calculateDistance
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 13379.766] [M: 23702.65] [ET: 6.702/13356.699] [MU: 2.41/23702.27] 
	SQL: SELECT *
				FROM   partner_rate prt 
				JOIN route rut ON prt.prt_route_id = rut.rut_id AND rut.rut_active = 1
				AND  rut.rut_from_city_id  = 30804 
				AND  rut.rut_to_city_id  = 30726 
				 WHERE prt_vehicletype_id = 16
				AND prt_partner_id = 1249
				AND prt_status = 1
				 
	 [params: []]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 13380.83] [M: 23707.88] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30726","cabType":"3","tripDistance":"","tripDuration":"","multiCityData":"","bookingType":"1","pickupAddress":"","pickupDate":"24\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","sccId":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30726&cabType=3&tripDistance=&tripDuration=&multiCityData=&bookingType=1&pickupAddress=&pickupDate=24%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&sccId=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 13381.7] [M: 23724.72] [ET: 1.514/13358.64] [MU: 18.04/23724.61] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 13381.943] [M: 23726.4] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 13407.417] [M: 23739.86] [ET: 25.244/13384.318] [MU: 2.99/23737.36] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+5845),(IF((cpm_value_type=2),(5845+(5845*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30726 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30726) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-24 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=16 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 13418.358] [M: 23798.09] [ET: 38.283/13395.32] [MU: 91.87/23797.93] 
	RouteRates::calculate for CAB 16 2024-10-24 18:00:00 - Trip Type: 1 598994876
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 13418.579] [M: 23777.7] [ET: 10840.933/13395.549] [MU: 346.53/23777.55] 
	Quote::calculateOneWay  for CAB 16 Date: 2024-10-24 18:00:00
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 13418.875] [M: 23774.4] [ET: 0.224/13395.837] [MU: 0.9/23774.15] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"16"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 13418.956] [M: 23775.65] [ET: 10869.193/13395.925] [MU: 393.32/23775.55] 
	Quote For CabType: 16
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 13420.045] [M: 23785.63] [ET: 0.365/13397.009] [MU: 2.97/23785.19] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 13420.456] [M: 23791.45] [ET: 0.342/13397.421] [MU: 3.34/23791.01] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30726"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 13420.978] [M: 23794.38] [ET: 0.442/13397.928] [MU: 0.9/23794.13] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 13428.681] [M: 23826.73] [ET: 7.552/13405.615] [MU: 24.22/23825.23] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (101) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30726) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp46)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp49,:gp50)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp47,:gp48)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp51,:gp52))
			OR (scr_area_type = 5 AND scr_area_id IN (908))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (45)
		ORDER BY rank DESC
		 
	 [params: {":gp46":"31",":gp47":"30804",":gp48":"30726",":gp49":"105",":gp50":"101",":gp51":"1",":gp52":"1","tripType":"1"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 13441.005] [M: 23806.91] [ET: 11.639/13417.961] [MU: 0.83/23806.72] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 13450.682] [M: 23809.78] [ET: 9.575/13427.63] [MU: 0.96/23809.47] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"4"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 13454.914] [M: 23827.61] [ET: 2.961/13431.824] [MU: 3.53/23826.73] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"45","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 13464.885] [M: 23830.86] [ET: 9.544/13441.819] [MU: 0.86/23830.64] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":0}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 13466.08] [M: 23838.14] [ET: 0.768/13443.025] [MU: 2.97/23837.7] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 13466.893] [M: 23866.31] [ET: 0.628/13443.846] [MU: 22.05/23865.69] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp54)) OR (apr_area_type = 2 AND apr_area_id IN (:gp55)) OR (apr_area_type = 4 AND apr_area_id IN (:gp56)) OR (apr_area_type = 1 AND apr_area_id IN (:gp53))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp53":"31",":gp54":"30804",":gp55":"105",":gp56":"1","cab":"45"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 13468.036] [M: 23853.02] [ET: 0.492/13444.999] [MU: 3.34/23852.59] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 13470.342] [M: 23863.18] [ET: 2.167/13447.275] [MU: 3.41/23862.3] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp58)) OR (scr_area_type = 2 AND scr_area_id IN (:gp59)) OR (scr_area_type = 4 AND scr_area_id IN (:gp60)) OR (scr_area_type = 1 AND scr_area_id IN (:gp57)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp57":"31",":gp58":"30804",":gp59":"105",":gp60":"1","scv_id":"45"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 13965.478] [M: 23891.02] [ET: 494.137/13942.393] [MU: 0.74/23883.02] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"nearest_route_30804_30726","sql":"(INDEX indx_nearest_rt_rutid (rut_id)) \r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, routeFrom.rut_name as fromAlias, \r\n\t\t\t\tNULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, \r\n\t\t\t\t0 as rank, routeFrom.rut_estm_time as startTime, 0 as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\tAND route.rut_to_city_id=30726 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 \r\n\t\t\t\tAND routeFrom.rut_from_city_id<>routeFrom.rut_to_city_id AND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\t\tAND (routeAlias.rut_to_city_id=route.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (1967,16216,47825,322451,3087761,3190710)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, NULL, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) \r\n\t\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\t0 AS extraStartDistance, 0, 0 as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND route.rut_from_city_id = 30804 AND route.rut_to_city_id=30726 \r\n\t\t\t\tAND routeTo.rut_from_city_id=30726\r\n\t\t\t\tAND route.rut_active = 1 AND routeTo.rut_active = 1 AND routeTo.rut_estm_distance < 50 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = route.rut_from_city_id) \r\n\t\t\t   AND (routeAlias.rut_to_city_id = routeTo.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (1967,16216,47825,322451,3087761,3190710)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, \r\n\t\t\t\trouteFrom.rut_name, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t+ IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) \r\n\t\t\t\tAS extraDistance, IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, 0, \r\n\t\t\t\trouteFrom.rut_estm_time as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\t\tAND route.rut_to_city_id=30726 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 AND routeFrom.rut_from_city_id <> routeFrom.rut_to_city_id\r\n\t\t\t\t\tAND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND routeTo.rut_estm_distance < 50 \r\n\t\t\t\t\tAND routeTo.rut_from_city_id=30726 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\tAND (routeAlias.rut_to_city_id=routeTo.rut_to_city_id) AND routeAlias.rut_active = 1 AND routeAlias.rut_from_city_id=30804  AND routeAlias.rut_id IN (1967,16216,47825,322451,3087761,3190710)"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 13968.641] [M: 23895.13] [ET: 3.044/13945.569] [MU: 2.16/23894.69] 
	SQL: SELECT *, (rte_vendor_amount + extraDistance * 10.55) as totalCost FROM (SELECT * FROM nearest_route_30804_30726) a
					INNER JOIN rate ON a.rut_id = rate.rte_route_id AND rte_status=1 AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <>0
					WHERE 1 ORDER BY rank DESC, totalCost ASC LIMIT 0,1 
	 [params: {"cabType":"45"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 13969.551] [M: 23903.15] [ET: 0.73/13946.473] [MU: 0.74/23901.15] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"getNearestRoute_30804_30726_70","sql":"(INDEX getNearestRoute_30804_30726_70_index_rut_id (rut_id))\r\n\t\t\t\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id AS start, routeAlias.rut_to_city_id AS end,\r\n\t\t\t\t\t\t\t\trouteFrom.rut_name AS fromAlias, NULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance AS quotedDistance,\r\n\t\t\t\t\t\t\t\trouteAlias.rut_estm_distance AS rateDistance, \r\n\t\t\t\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance)\r\n\t\t\t\t\t\t\t\t\t - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance,\r\n\t\t\t\t\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance,\r\n\t\t\t\t\t\t\t\t0 AS rank, routeFrom.rut_estm_time AS startTime, 0 AS endTime, route.rut_estm_time, \r\n\t\t\t\t\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraTravelDistance\r\n\t\t\t\t\t\tFROM   route\r\n\t\t\t\t\t\tINNER JOIN route routeTo ON routeTo.rut_to_city_id=route.rut_from_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_from_city_id=30804 AND routeTo.rut_active=1\r\n\t\t\t\t\t\t\t\tAND routeTo.rut_estm_distance<70 AND route.rut_active=1\r\n\t\t\t\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_from_city_id=route.rut_to_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_to_city_id=30726 AND routeFrom.rut_active = 1\r\n\t\t\t\t\t\t\t\tAND routeFrom.rut_estm_distance<70 AND route.rut_active = 1\r\n\t\t\t\t\t\tINNER JOIN route routeAlias ON routeAlias.rut_to_city_id=routeFrom.rut_to_city_id\r\n\t\t\t\t\t\t\tAND routeAlias.rut_from_city_id=routeTo.rut_from_city_id AND routeAlias.rut_active = 1"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 13972.311] [M: 23908.41] [ET: 2.595/13949.208] [MU: 2.41/23907.79] 
	SQL: SELECT *, (rte_vendor_amount + extradistance * 10.55 ) AS totalCost, 
						ABS(quotedDistance-rateDistance) AS extraChargeableDistance
					FROM getNearestRoute_30804_30726_70 a
					INNER JOIN rate ON a.rut_id=rate.rte_route_id AND rte_status=1 
						AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <> 0
					WHERE  1
					ORDER  BY rank DESC, extraStartDistance, extraChargeableDistance ASC, totalcost ASC
					LIMIT  0, 1 
	 [params: {"cabType":"45"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 13979.852] [M: 23923.49] [ET: 0.595/13956.786] [MU: 3.41/23922.62] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"16","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 13982.285] [M: 23941.89] [ET: 0.797/13959.228] [MU: 5.56/23941.02] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 13983.273] [M: 23949.16] [ET: 0.589/13960.22] [MU: 0.9/23948.91] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 13984.313] [M: 23959.75] [ET: 0.499/13961.268] [MU: 3.34/23959.31] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 13995.718] [M: 23970.3] [ET: 11.281/13972.652] [MU: 3.53/23969.42] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp63)) OR (scr_area_type = 5 AND scr_area_id IN (:gp61)) OR (scr_area_type = 2 AND scr_area_id IN (:gp64)) OR (scr_area_type = 4 AND scr_area_id IN (:gp65)) OR (scr_area_type = 1 AND scr_area_id IN (:gp62)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp61":"908",":gp62":"31",":gp63":"908",":gp64":"105",":gp65":"1","scv_id":"16"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 13996.789] [M: 23970.88] [ET: 0.656/13973.734] [MU: 0.9/23970.63] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 13998.332] [M: 23981.1] [ET: 0.965/13975.266] [MU: 2.97/23980.66] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14001.627] [M: 23991.65] [ET: 3.094/13978.558] [MU: 3.54/23990.77] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp68)) OR (scr_area_type = 5 AND scr_area_id IN (:gp66)) OR (scr_area_type = 2 AND scr_area_id IN (:gp69)) OR (scr_area_type = 4 AND scr_area_id IN (:gp70)) OR (scr_area_type = 1 AND scr_area_id IN (:gp67)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp66":"908",":gp67":"31",":gp68":"908",":gp69":"105",":gp70":"1","scv_id":"45"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14002.61] [M: 23990.22] [ET: 0.568/13979.56] [MU: 0.9/23990] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14003.882] [M: 24002.59] [ET: 0.556/13980.83] [MU: 2.97/24002.16] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14004.774] [M: 24031.52] [ET: 0.728/13981.681] [MU: 22.41/24030.77] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp73)) OR (apr_area_type = 5 AND apr_area_id IN (:gp71)) OR (apr_area_type = 2 AND apr_area_id IN (:gp74)) OR (apr_area_type = 4 AND apr_area_id IN (:gp75)) OR (apr_area_type = 1 AND apr_area_id IN (:gp72))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp71":"908",":gp72":"31",":gp73":"30804",":gp74":"105",":gp75":"1","cab":"45"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14006.362] [M: 24018.77] [ET: 0.488/13983.312] [MU: 3.34/24018.34] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14008.643] [M: 24029.32] [ET: 2.155/13985.577] [MU: 3.53/24028.45] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp78)) OR (scr_area_type = 5 AND scr_area_id IN (:gp76)) OR (scr_area_type = 2 AND scr_area_id IN (:gp79)) OR (scr_area_type = 4 AND scr_area_id IN (:gp80)) OR (scr_area_type = 1 AND scr_area_id IN (:gp77)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp76":"908",":gp77":"31",":gp78":"908",":gp79":"105",":gp80":"1","scv_id":"45"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14009.548] [M: 24034.08] [ET: 0.559/13986.492] [MU: 3.85/24033.2] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30804"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14010.085] [M: 24041.89] [ET: 0.427/13987.049] [MU: 4.21/24041.02] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30726"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14010.372] [M: 24046.03] [ET: 0.223/13987.342] [MU: 2.97/24045.92] 
	BookingRoute::calculateDistance
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14015.823] [M: 24052.41] [ET: 5.284/13992.768] [MU: 2.4/24052.03] 
	SQL: SELECT *
				FROM   partner_rate prt 
				JOIN route rut ON prt.prt_route_id = rut.rut_id AND rut.rut_active = 1
				AND  rut.rut_from_city_id  = 30804 
				AND  rut.rut_to_city_id  = 30726 
				 WHERE prt_vehicletype_id = 45
				AND prt_partner_id = 1249
				AND prt_status = 1
				 
	 [params: []]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14016.832] [M: 24057.63] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30726","cabType":"3","tripDistance":"","tripDuration":"","multiCityData":"","bookingType":"1","pickupAddress":"","pickupDate":"24\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","sccId":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30726&cabType=3&tripDistance=&tripDuration=&multiCityData=&bookingType=1&pickupAddress=&pickupDate=24%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&sccId=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14017.468] [M: 24074.48] [ET: 1.298/13994.407] [MU: 18.05/24074.37] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14017.511] [M: 24076.16] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14035.141] [M: 24089.62] [ET: 17.477/14012.069] [MU: 2.99/24087.12] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+5845),(IF((cpm_value_type=2),(5845+(5845*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30726 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30726) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-24 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=45 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14043.648] [M: 24131.84] [ET: 27.59/14020.611] [MU: 75.87/24131.69] 
	RouteRates::calculate for CAB 45 2024-10-24 18:00:00 - Trip Type: 1 452499400
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14043.862] [M: 24111.46] [ET: 592.126/14020.832] [MU: 291.82/24111.3] 
	Quote::calculateOneWay  for CAB 45 Date: 2024-10-24 18:00:00
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14044.129] [M: 24107.94] [ET: 0.199/14021.097] [MU: 0.9/24107.69] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"45"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14044.2] [M: 24109.19] [ET: 625.193/14021.171] [MU: 332.24/24109.09] 
	Quote For CabType: 45
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14045.357] [M: 24119.16] [ET: 0.371/14022.316] [MU: 2.97/24118.73] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14045.759] [M: 24124.98] [ET: 0.334/14022.723] [MU: 3.34/24124.55] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30726"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14046.343] [M: 24127.92] [ET: 0.495/14023.28] [MU: 0.89/24127.67] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14054.51] [M: 24160.27] [ET: 8.009/14031.459] [MU: 24.22/24158.77] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (101) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30726) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp81)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp84,:gp85)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp82,:gp83)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp86,:gp87))
			OR (scr_area_type = 5 AND scr_area_id IN (908))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (54)
		ORDER BY rank DESC
		 
	 [params: {":gp81":"31",":gp82":"30804",":gp83":"30726",":gp84":"105",":gp85":"101",":gp86":"1",":gp87":"1","tripType":"1"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14066.639] [M: 24140.46] [ET: 11.524/14043.56] [MU: 0.84/24140.27] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14074.103] [M: 24143.34] [ET: 7.292/14051.021] [MU: 0.96/24143.02] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"4"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14083.645] [M: 24156.3] [ET: 7.944/14060.597] [MU: 2.05/24155.8] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"54"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14086.799] [M: 24165.69] [ET: 2.888/14063.732] [MU: 3.54/24164.81] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"54","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14087.619] [M: 24168.94] [ET: 0.515/14064.571] [MU: 0.87/24168.72] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":0}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14088.3] [M: 24176.22] [ET: 0.485/14065.263] [MU: 2.96/24175.78] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14089.156] [M: 24204.39] [ET: 0.72/14066.119] [MU: 22.05/24203.77] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp89)) OR (apr_area_type = 2 AND apr_area_id IN (:gp90)) OR (apr_area_type = 4 AND apr_area_id IN (:gp91)) OR (apr_area_type = 1 AND apr_area_id IN (:gp88))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp88":"31",":gp89":"30804",":gp90":"105",":gp91":"1","cab":"54"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14090.774] [M: 24191.12] [ET: 0.845/14067.7] [MU: 3.33/24190.68] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14093.123] [M: 24201.27] [ET: 2.158/14070.06] [MU: 3.41/24200.4] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp93)) OR (scr_area_type = 2 AND scr_area_id IN (:gp94)) OR (scr_area_type = 4 AND scr_area_id IN (:gp95)) OR (scr_area_type = 1 AND scr_area_id IN (:gp92)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp92":"31",":gp93":"30804",":gp94":"105",":gp95":"1","scv_id":"54"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14102.788] [M: 24229.09] [ET: 8.756/14079.719] [MU: 0.75/24221.09] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"nearest_route_30804_30726","sql":"(INDEX indx_nearest_rt_rutid (rut_id)) \r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, routeFrom.rut_name as fromAlias, \r\n\t\t\t\tNULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, \r\n\t\t\t\t0 as rank, routeFrom.rut_estm_time as startTime, 0 as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\tAND route.rut_to_city_id=30726 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 \r\n\t\t\t\tAND routeFrom.rut_from_city_id<>routeFrom.rut_to_city_id AND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\t\tAND (routeAlias.rut_to_city_id=route.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (1967,16216,47825,322451,3087761,3190710)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, NULL, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) \r\n\t\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\t0 AS extraStartDistance, 0, 0 as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND route.rut_from_city_id = 30804 AND route.rut_to_city_id=30726 \r\n\t\t\t\tAND routeTo.rut_from_city_id=30726\r\n\t\t\t\tAND route.rut_active = 1 AND routeTo.rut_active = 1 AND routeTo.rut_estm_distance < 50 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = route.rut_from_city_id) \r\n\t\t\t   AND (routeAlias.rut_to_city_id = routeTo.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (1967,16216,47825,322451,3087761,3190710)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, \r\n\t\t\t\trouteFrom.rut_name, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t+ IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) \r\n\t\t\t\tAS extraDistance, IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, 0, \r\n\t\t\t\trouteFrom.rut_estm_time as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\t\tAND route.rut_to_city_id=30726 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 AND routeFrom.rut_from_city_id <> routeFrom.rut_to_city_id\r\n\t\t\t\t\tAND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND routeTo.rut_estm_distance < 50 \r\n\t\t\t\t\tAND routeTo.rut_from_city_id=30726 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\tAND (routeAlias.rut_to_city_id=routeTo.rut_to_city_id) AND routeAlias.rut_active = 1 AND routeAlias.rut_from_city_id=30804  AND routeAlias.rut_id IN (1967,16216,47825,322451,3087761,3190710)"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14105.415] [M: 24233.2] [ET: 2.532/14082.366] [MU: 2.17/24232.77] 
	SQL: SELECT *, (rte_vendor_amount + extraDistance * 10.55) as totalCost FROM (SELECT * FROM nearest_route_30804_30726) a
					INNER JOIN rate ON a.rut_id = rate.rte_route_id AND rte_status=1 AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <>0
					WHERE 1 ORDER BY rank DESC, totalCost ASC LIMIT 0,1 
	 [params: {"cabType":"54"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14106.288] [M: 24241.23] [ET: 0.708/14083.197] [MU: 0.74/24239.23] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"getNearestRoute_30804_30726_70","sql":"(INDEX getNearestRoute_30804_30726_70_index_rut_id (rut_id))\r\n\t\t\t\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id AS start, routeAlias.rut_to_city_id AS end,\r\n\t\t\t\t\t\t\t\trouteFrom.rut_name AS fromAlias, NULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance AS quotedDistance,\r\n\t\t\t\t\t\t\t\trouteAlias.rut_estm_distance AS rateDistance, \r\n\t\t\t\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance)\r\n\t\t\t\t\t\t\t\t\t - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance,\r\n\t\t\t\t\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance,\r\n\t\t\t\t\t\t\t\t0 AS rank, routeFrom.rut_estm_time AS startTime, 0 AS endTime, route.rut_estm_time, \r\n\t\t\t\t\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraTravelDistance\r\n\t\t\t\t\t\tFROM   route\r\n\t\t\t\t\t\tINNER JOIN route routeTo ON routeTo.rut_to_city_id=route.rut_from_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_from_city_id=30804 AND routeTo.rut_active=1\r\n\t\t\t\t\t\t\t\tAND routeTo.rut_estm_distance<70 AND route.rut_active=1\r\n\t\t\t\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_from_city_id=route.rut_to_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_to_city_id=30726 AND routeFrom.rut_active = 1\r\n\t\t\t\t\t\t\t\tAND routeFrom.rut_estm_distance<70 AND route.rut_active = 1\r\n\t\t\t\t\t\tINNER JOIN route routeAlias ON routeAlias.rut_to_city_id=routeFrom.rut_to_city_id\r\n\t\t\t\t\t\t\tAND routeAlias.rut_from_city_id=routeTo.rut_from_city_id AND routeAlias.rut_active = 1"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14109.005] [M: 24246.49] [ET: 2.581/14085.942] [MU: 2.41/24245.87] 
	SQL: SELECT *, (rte_vendor_amount + extradistance * 10.55 ) AS totalCost, 
						ABS(quotedDistance-rateDistance) AS extraChargeableDistance
					FROM getNearestRoute_30804_30726_70 a
					INNER JOIN rate ON a.rut_id=rate.rte_route_id AND rte_status=1 
						AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <> 0
					WHERE  1
					ORDER  BY rank DESC, extraStartDistance, extraChargeableDistance ASC, totalcost ASC
					LIMIT  0, 1 
	 [params: {"cabType":"54"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14112.239] [M: 24261.59] [ET: 0.533/14089.182] [MU: 3.41/24260.71] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"45","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14114.003] [M: 24278.2] [ET: 0.557/14090.95] [MU: 3.78/24277.33] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"16","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14116.219] [M: 24296.6] [ET: 0.616/14093.162] [MU: 5.56/24295.73] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14117.027] [M: 24335.87] [ET: 0.462/14093.974] [MU: 0.9/24335.62] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14118.297] [M: 24346.46] [ET: 0.588/14095.245] [MU: 3.34/24346.02] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14120.839] [M: 24357.01] [ET: 2.336/14097.766] [MU: 3.54/24356.13] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp98)) OR (scr_area_type = 5 AND scr_area_id IN (:gp96)) OR (scr_area_type = 2 AND scr_area_id IN (:gp99)) OR (scr_area_type = 4 AND scr_area_id IN (:gp100)) OR (scr_area_type = 1 AND scr_area_id IN (:gp97)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp96":"908",":gp97":"31",":gp98":"908",":gp99":"105",":gp100":"1","scv_id":"16"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14121.885] [M: 24357.59] [ET: 0.512/14098.845] [MU: 0.9/24357.34] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14122.91] [M: 24367.81] [ET: 0.501/14099.873] [MU: 2.97/24367.38] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14125.129] [M: 24378.36] [ET: 2.101/14102.082] [MU: 3.53/24377.48] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp103)) OR (scr_area_type = 5 AND scr_area_id IN (:gp101)) OR (scr_area_type = 2 AND scr_area_id IN (:gp104)) OR (scr_area_type = 4 AND scr_area_id IN (:gp105)) OR (scr_area_type = 1 AND scr_area_id IN (:gp102)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp101":"908",":gp102":"31",":gp103":"908",":gp104":"105",":gp105":"1","scv_id":"45"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14126.159] [M: 24378.91] [ET: 0.58/14103.08] [MU: 0.9/24378.69] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14127.349] [M: 24389.16] [ET: 0.493/14104.311] [MU: 2.97/24388.73] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14129.95] [M: 24399.71] [ET: 2.475/14106.885] [MU: 3.53/24398.84] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp108)) OR (scr_area_type = 5 AND scr_area_id IN (:gp106)) OR (scr_area_type = 2 AND scr_area_id IN (:gp109)) OR (scr_area_type = 4 AND scr_area_id IN (:gp110)) OR (scr_area_type = 1 AND scr_area_id IN (:gp107)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp106":"908",":gp107":"31",":gp108":"908",":gp109":"105",":gp110":"1","scv_id":"54"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14130.889] [M: 24398.3] [ET: 0.523/14107.836] [MU: 0.9/24398.05] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14132.538] [M: 24410.64] [ET: 0.505/14109.502] [MU: 2.97/24410.2] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14133.222] [M: 24439.81] [ET: 0.58/14110.187] [MU: 22.54/24439.06] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp113)) OR (apr_area_type = 5 AND apr_area_id IN (:gp111)) OR (apr_area_type = 2 AND apr_area_id IN (:gp114)) OR (apr_area_type = 4 AND apr_area_id IN (:gp115)) OR (apr_area_type = 1 AND apr_area_id IN (:gp112))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp111":"908",":gp112":"31",":gp113":"30804",":gp114":"105",":gp115":"1","cab":"54"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14134.591] [M: 24426.84] [ET: 0.452/14111.556] [MU: 3.33/24426.4] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14136.963] [M: 24437.38] [ET: 2.253/14113.901] [MU: 3.53/24436.51] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp118)) OR (scr_area_type = 5 AND scr_area_id IN (:gp116)) OR (scr_area_type = 2 AND scr_area_id IN (:gp119)) OR (scr_area_type = 4 AND scr_area_id IN (:gp120)) OR (scr_area_type = 1 AND scr_area_id IN (:gp117)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp116":"908",":gp117":"31",":gp118":"908",":gp119":"105",":gp120":"1","scv_id":"54"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14137.953] [M: 24442.13] [ET: 0.59/14114.915] [MU: 3.84/24441.25] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30804"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14138.416] [M: 24449.94] [ET: 0.374/14115.379] [MU: 4.22/24449.06] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30726"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14138.706] [M: 24454.08] [ET: 0.226/14115.676] [MU: 2.98/24453.97] 
	BookingRoute::calculateDistance
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14141.223] [M: 24460.45] [ET: 2.344/14118.162] [MU: 2.41/24460.08] 
	SQL: SELECT *
				FROM   partner_rate prt 
				JOIN route rut ON prt.prt_route_id = rut.rut_id AND rut.rut_active = 1
				AND  rut.rut_from_city_id  = 30804 
				AND  rut.rut_to_city_id  = 30726 
				 WHERE prt_vehicletype_id = 54
				AND prt_partner_id = 1249
				AND prt_status = 1
				 
	 [params: []]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14141.955] [M: 24465.68] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30726","cabType":"3","tripDistance":"","tripDuration":"","multiCityData":"","bookingType":"1","pickupAddress":"","pickupDate":"24\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","sccId":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30726&cabType=3&tripDistance=&tripDuration=&multiCityData=&bookingType=1&pickupAddress=&pickupDate=24%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&sccId=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14142.524] [M: 24482.52] [ET: 1.009/14119.473] [MU: 18.05/24482.41] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14142.587] [M: 24484.2] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14144.001] [M: 24497.66] [ET: 1.2/14120.918] [MU: 3/24495.16] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+5845),(IF((cpm_value_type=2),(5845+(5845*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30726 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30726) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-24 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=54 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14145.862] [M: 24539.89] [ET: 4.411/14122.823] [MU: 75.88/24539.73] 
	RouteRates::calculate for CAB 54 2024-10-24 18:00:00 - Trip Type: 1 370747785
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14146.092] [M: 24519.51] [ET: 62.364/14123.061] [MU: 361.78/24519.35] 
	Quote::calculateOneWay  for CAB 54 Date: 2024-10-24 18:00:00
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14146.373] [M: 24515.1] [ET: 0.199/14123.322] [MU: 0.89/24514.85] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"54"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14146.482] [M: 24516.35] [ET: 102.219/14123.436] [MU: 405.86/24516.26] 
	Quote For CabType: 54
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14148.073] [M: 24526.33] [ET: 0.696/14125.014] [MU: 2.97/24525.89] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14148.707] [M: 24532.15] [ET: 0.534/14125.662] [MU: 3.34/24531.71] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30726"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14149.256] [M: 24535.05] [ET: 0.463/14126.2] [MU: 0.9/24534.84] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14149.888] [M: 24567.44] [ET: 0.485/14126.849] [MU: 24.22/24565.94] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (101) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30726) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp121)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp124,:gp125)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp122,:gp123)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp126,:gp127))
			OR (scr_area_type = 5 AND scr_area_id IN (908))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (55)
		ORDER BY rank DESC
		 
	 [params: {":gp121":"31",":gp122":"30804",":gp123":"30726",":gp124":"105",":gp125":"101",":gp126":"1",":gp127":"1","tripType":"1"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14150.644] [M: 24547.62] [ET: 0.22/14127.588] [MU: 0.83/24547.43] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14151.031] [M: 24550.49] [ET: 0.286/14127.991] [MU: 0.96/24550.18] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"4"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14152.219] [M: 24563.46] [ET: 0.367/14129.166] [MU: 2.04/24562.96] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"55"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14154.838] [M: 24572.84] [ET: 2.334/14131.788] [MU: 3.53/24571.97] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"55","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14155.599] [M: 24576.09] [ET: 0.524/14132.549] [MU: 0.87/24575.88] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":0}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14156.314] [M: 24583.38] [ET: 0.519/14133.278] [MU: 2.97/24582.94] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14157.022] [M: 24611.55] [ET: 0.571/14133.981] [MU: 22.04/24610.92] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp129)) OR (apr_area_type = 2 AND apr_area_id IN (:gp130)) OR (apr_area_type = 4 AND apr_area_id IN (:gp131)) OR (apr_area_type = 1 AND apr_area_id IN (:gp128))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp128":"31",":gp129":"30804",":gp130":"105",":gp131":"1","cab":"55"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14157.985] [M: 24598.27] [ET: 0.419/14134.95] [MU: 3.34/24597.83] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14160.11] [M: 24608.55] [ET: 2.018/14137.055] [MU: 3.4/24607.67] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp133)) OR (scr_area_type = 2 AND scr_area_id IN (:gp134)) OR (scr_area_type = 4 AND scr_area_id IN (:gp135)) OR (scr_area_type = 1 AND scr_area_id IN (:gp132)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp132":"31",":gp133":"30804",":gp134":"105",":gp135":"1","scv_id":"55"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14162.764] [M: 24636.25] [ET: 1.788/14139.695] [MU: 0.74/24628.25] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"nearest_route_30804_30726","sql":"(INDEX indx_nearest_rt_rutid (rut_id)) \r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, routeFrom.rut_name as fromAlias, \r\n\t\t\t\tNULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, \r\n\t\t\t\t0 as rank, routeFrom.rut_estm_time as startTime, 0 as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\tAND route.rut_to_city_id=30726 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 \r\n\t\t\t\tAND routeFrom.rut_from_city_id<>routeFrom.rut_to_city_id AND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\t\tAND (routeAlias.rut_to_city_id=route.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (1967,16216,47825,322451,3087761,3190710)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, NULL, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) \r\n\t\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\t0 AS extraStartDistance, 0, 0 as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND route.rut_from_city_id = 30804 AND route.rut_to_city_id=30726 \r\n\t\t\t\tAND routeTo.rut_from_city_id=30726\r\n\t\t\t\tAND route.rut_active = 1 AND routeTo.rut_active = 1 AND routeTo.rut_estm_distance < 50 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = route.rut_from_city_id) \r\n\t\t\t   AND (routeAlias.rut_to_city_id = routeTo.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (1967,16216,47825,322451,3087761,3190710)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, \r\n\t\t\t\trouteFrom.rut_name, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t+ IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) \r\n\t\t\t\tAS extraDistance, IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, 0, \r\n\t\t\t\trouteFrom.rut_estm_time as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\t\tAND route.rut_to_city_id=30726 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 AND routeFrom.rut_from_city_id <> routeFrom.rut_to_city_id\r\n\t\t\t\t\tAND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND routeTo.rut_estm_distance < 50 \r\n\t\t\t\t\tAND routeTo.rut_from_city_id=30726 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\tAND (routeAlias.rut_to_city_id=routeTo.rut_to_city_id) AND routeAlias.rut_active = 1 AND routeAlias.rut_from_city_id=30804  AND routeAlias.rut_id IN (1967,16216,47825,322451,3087761,3190710)"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14165.502] [M: 24640.36] [ET: 2.645/14142.453] [MU: 2.16/24639.92] 
	SQL: SELECT *, (rte_vendor_amount + extraDistance * 10.55) as totalCost FROM (SELECT * FROM nearest_route_30804_30726) a
					INNER JOIN rate ON a.rut_id = rate.rte_route_id AND rte_status=1 AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <>0
					WHERE 1 ORDER BY rank DESC, totalCost ASC LIMIT 0,1 
	 [params: {"cabType":"55"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14166.336] [M: 24648.38] [ET: 0.707/14143.278] [MU: 0.75/24646.38] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"getNearestRoute_30804_30726_70","sql":"(INDEX getNearestRoute_30804_30726_70_index_rut_id (rut_id))\r\n\t\t\t\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id AS start, routeAlias.rut_to_city_id AS end,\r\n\t\t\t\t\t\t\t\trouteFrom.rut_name AS fromAlias, NULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance AS quotedDistance,\r\n\t\t\t\t\t\t\t\trouteAlias.rut_estm_distance AS rateDistance, \r\n\t\t\t\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance)\r\n\t\t\t\t\t\t\t\t\t - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance,\r\n\t\t\t\t\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance,\r\n\t\t\t\t\t\t\t\t0 AS rank, routeFrom.rut_estm_time AS startTime, 0 AS endTime, route.rut_estm_time, \r\n\t\t\t\t\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraTravelDistance\r\n\t\t\t\t\t\tFROM   route\r\n\t\t\t\t\t\tINNER JOIN route routeTo ON routeTo.rut_to_city_id=route.rut_from_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_from_city_id=30804 AND routeTo.rut_active=1\r\n\t\t\t\t\t\t\t\tAND routeTo.rut_estm_distance<70 AND route.rut_active=1\r\n\t\t\t\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_from_city_id=route.rut_to_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_to_city_id=30726 AND routeFrom.rut_active = 1\r\n\t\t\t\t\t\t\t\tAND routeFrom.rut_estm_distance<70 AND route.rut_active = 1\r\n\t\t\t\t\t\tINNER JOIN route routeAlias ON routeAlias.rut_to_city_id=routeFrom.rut_to_city_id\r\n\t\t\t\t\t\t\tAND routeAlias.rut_from_city_id=routeTo.rut_from_city_id AND routeAlias.rut_active = 1"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14168.732] [M: 24653.65] [ET: 2.282/14145.652] [MU: 2.42/24653.02] 
	SQL: SELECT *, (rte_vendor_amount + extradistance * 10.55 ) AS totalCost, 
						ABS(quotedDistance-rateDistance) AS extraChargeableDistance
					FROM getNearestRoute_30804_30726_70 a
					INNER JOIN rate ON a.rut_id=rate.rte_route_id AND rte_status=1 
						AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <> 0
					WHERE  1
					ORDER  BY rank DESC, extraStartDistance, extraChargeableDistance ASC, totalcost ASC
					LIMIT  0, 1 
	 [params: {"cabType":"55"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14171.875] [M: 24668.73] [ET: 0.511/14148.818] [MU: 3.41/24667.86] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"45","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14173.398] [M: 24685.35] [ET: 0.422/14150.356] [MU: 3.78/24684.48] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"16","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14175.096] [M: 24703.75] [ET: 0.653/14152.057] [MU: 5.56/24702.88] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14175.875] [M: 24711.02] [ET: 0.547/14152.841] [MU: 0.9/24710.77] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14176.857] [M: 24721.61] [ET: 0.467/14153.82] [MU: 3.33/24721.17] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14179.193] [M: 24732.16] [ET: 2.179/14156.121] [MU: 3.53/24731.28] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp138)) OR (scr_area_type = 5 AND scr_area_id IN (:gp136)) OR (scr_area_type = 2 AND scr_area_id IN (:gp139)) OR (scr_area_type = 4 AND scr_area_id IN (:gp140)) OR (scr_area_type = 1 AND scr_area_id IN (:gp137)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp136":"908",":gp137":"31",":gp138":"908",":gp139":"105",":gp140":"1","scv_id":"16"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14180.249] [M: 24732.7] [ET: 0.52/14157.19] [MU: 0.9/24732.48] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14181.657] [M: 24742.96] [ET: 0.777/14158.618] [MU: 2.97/24742.52] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14184.085] [M: 24753.51] [ET: 2.288/14161.014] [MU: 3.54/24752.63] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp143)) OR (scr_area_type = 5 AND scr_area_id IN (:gp141)) OR (scr_area_type = 2 AND scr_area_id IN (:gp144)) OR (scr_area_type = 4 AND scr_area_id IN (:gp145)) OR (scr_area_type = 1 AND scr_area_id IN (:gp142)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp141":"908",":gp142":"31",":gp143":"908",":gp144":"105",":gp145":"1","scv_id":"45"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14185.179] [M: 24754.09] [ET: 0.578/14162.141] [MU: 0.9/24753.84] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14186.166] [M: 24764.31] [ET: 0.468/14163.13] [MU: 2.97/24763.88] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14188.532] [M: 24774.86] [ET: 2.239/14165.462] [MU: 3.53/24773.98] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp148)) OR (scr_area_type = 5 AND scr_area_id IN (:gp146)) OR (scr_area_type = 2 AND scr_area_id IN (:gp149)) OR (scr_area_type = 4 AND scr_area_id IN (:gp150)) OR (scr_area_type = 1 AND scr_area_id IN (:gp147)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp146":"908",":gp147":"31",":gp148":"908",":gp149":"105",":gp150":"1","scv_id":"55"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14189.352] [M: 24773.42] [ET: 0.49/14166.294] [MU: 0.9/24773.2] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14190.577] [M: 24785.8] [ET: 0.476/14167.54] [MU: 2.97/24785.36] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14191.175] [M: 24814.97] [ET: 0.479/14168.12] [MU: 22.53/24814.22] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp153)) OR (apr_area_type = 5 AND apr_area_id IN (:gp151)) OR (apr_area_type = 2 AND apr_area_id IN (:gp154)) OR (apr_area_type = 4 AND apr_area_id IN (:gp155)) OR (apr_area_type = 1 AND apr_area_id IN (:gp152))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp151":"908",":gp152":"31",":gp153":"30804",":gp154":"105",":gp155":"1","cab":"55"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14192.681] [M: 24801.98] [ET: 0.453/14169.645] [MU: 3.34/24801.55] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14194.671] [M: 24812.53] [ET: 1.875/14171.62] [MU: 3.53/24811.66] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp158)) OR (scr_area_type = 5 AND scr_area_id IN (:gp156)) OR (scr_area_type = 2 AND scr_area_id IN (:gp159)) OR (scr_area_type = 4 AND scr_area_id IN (:gp160)) OR (scr_area_type = 1 AND scr_area_id IN (:gp157)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp156":"908",":gp157":"31",":gp158":"908",":gp159":"105",":gp160":"1","scv_id":"55"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14195.574] [M: 24817.28] [ET: 0.611/14172.52] [MU: 3.84/24816.41] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30804"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14196.101] [M: 24825.09] [ET: 0.425/14173.046] [MU: 4.21/24824.22] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30726"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14196.398] [M: 24829.23] [ET: 0.228/14173.368] [MU: 2.98/24829.13] 
	BookingRoute::calculateDistance
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14199.05] [M: 24835.61] [ET: 2.489/14176.002] [MU: 2.41/24835.23] 
	SQL: SELECT *
				FROM   partner_rate prt 
				JOIN route rut ON prt.prt_route_id = rut.rut_id AND rut.rut_active = 1
				AND  rut.rut_from_city_id  = 30804 
				AND  rut.rut_to_city_id  = 30726 
				 WHERE prt_vehicletype_id = 55
				AND prt_partner_id = 1249
				AND prt_status = 1
				 
	 [params: []]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14199.893] [M: 24840.84] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30726","cabType":"3","tripDistance":"","tripDuration":"","multiCityData":"","bookingType":"1","pickupAddress":"","pickupDate":"24\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","sccId":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30726&cabType=3&tripDistance=&tripDuration=&multiCityData=&bookingType=1&pickupAddress=&pickupDate=24%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&sccId=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14200.339] [M: 24857.68] [ET: 0.986/14177.308] [MU: 18.04/24857.57] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14200.382] [M: 24859.36] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14201.527] [M: 24872.82] [ET: 1.01/14178.466] [MU: 2.99/24870.32] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+5845),(IF((cpm_value_type=2),(5845+(5845*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30726 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30726) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-24 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=55 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14202.947] [M: 24915.05] [ET: 3.66/14179.891] [MU: 75.87/24914.89] 
	RouteRates::calculate for CAB 55 2024-10-24 18:00:00 - Trip Type: 1 681801622
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14203.294] [M: 24894.66] [ET: 50.978/14180.247] [MU: 329.78/24894.51] 
	Quote::calculateOneWay  for CAB 55 Date: 2024-10-24 18:00:00
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14203.602] [M: 24890.27] [ET: 0.215/14180.569] [MU: 0.9/24890.02] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"55"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14203.673] [M: 24891.52] [ET: 57.125/14180.644] [MU: 373.85/24891.42] 
	Quote For CabType: 55
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14204.769] [M: 24901.49] [ET: 0.39/14181.732] [MU: 2.97/24901.05] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14205.174] [M: 24907.31] [ET: 0.336/14182.14] [MU: 3.35/24906.88] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30726"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14205.705] [M: 24910.22] [ET: 0.446/14182.647] [MU: 0.9/24910] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14206.322] [M: 24942.6] [ET: 0.476/14183.281] [MU: 24.21/24941.1] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (101) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30726) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp161)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp164,:gp165)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp162,:gp163)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp166,:gp167))
			OR (scr_area_type = 5 AND scr_area_id IN (908))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (57)
		ORDER BY rank DESC
		 
	 [params: {":gp161":"31",":gp162":"30804",":gp163":"30726",":gp164":"105",":gp165":"101",":gp166":"1",":gp167":"1","tripType":"1"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14206.952] [M: 24922.78] [ET: 0.194/14183.919] [MU: 0.84/24922.59] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14207.295] [M: 24925.66] [ET: 0.26/14184.245] [MU: 0.96/24925.34] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"4"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14208.665] [M: 24938.63] [ET: 0.321/14185.627] [MU: 2.05/24938.13] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"57"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14211.297] [M: 24948.01] [ET: 2.418/14188.247] [MU: 3.54/24947.13] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"57","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14212.226] [M: 24951.26] [ET: 0.616/14189.16] [MU: 0.87/24951.04] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":0}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14212.976] [M: 24958.54] [ET: 0.51/14189.942] [MU: 2.96/24958.1] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14213.598] [M: 24986.71] [ET: 0.486/14190.562] [MU: 22.05/24986.09] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp169)) OR (apr_area_type = 2 AND apr_area_id IN (:gp170)) OR (apr_area_type = 4 AND apr_area_id IN (:gp171)) OR (apr_area_type = 1 AND apr_area_id IN (:gp168))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp168":"31",":gp169":"30804",":gp170":"105",":gp171":"1","cab":"57"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14215.045] [M: 24973.43] [ET: 0.695/14192.002] [MU: 3.33/24972.99] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14215.628] [M: 24983.96] [ET: 0.475/14192.591] [MU: 3.66/24983.09] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp173)) OR (scr_area_type = 2 AND scr_area_id IN (:gp174)) OR (scr_area_type = 4 AND scr_area_id IN (:gp175)) OR (scr_area_type = 1 AND scr_area_id IN (:gp172)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp172":"31",":gp173":"30804",":gp174":"105",":gp175":"1","scv_id":"57"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14217.963] [M: 25011.66] [ET: 1.814/14194.902] [MU: 0.75/25003.66] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"nearest_route_30804_30726","sql":"(INDEX indx_nearest_rt_rutid (rut_id)) \r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, routeFrom.rut_name as fromAlias, \r\n\t\t\t\tNULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, \r\n\t\t\t\t0 as rank, routeFrom.rut_estm_time as startTime, 0 as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\tAND route.rut_to_city_id=30726 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 \r\n\t\t\t\tAND routeFrom.rut_from_city_id<>routeFrom.rut_to_city_id AND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\t\tAND (routeAlias.rut_to_city_id=route.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (1967,16216,47825,322451,3087761,3190710)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, NULL, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) \r\n\t\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\t0 AS extraStartDistance, 0, 0 as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND route.rut_from_city_id = 30804 AND route.rut_to_city_id=30726 \r\n\t\t\t\tAND routeTo.rut_from_city_id=30726\r\n\t\t\t\tAND route.rut_active = 1 AND routeTo.rut_active = 1 AND routeTo.rut_estm_distance < 50 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = route.rut_from_city_id) \r\n\t\t\t   AND (routeAlias.rut_to_city_id = routeTo.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (1967,16216,47825,322451,3087761,3190710)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, \r\n\t\t\t\trouteFrom.rut_name, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t+ IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) \r\n\t\t\t\tAS extraDistance, IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, 0, \r\n\t\t\t\trouteFrom.rut_estm_time as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\t\tAND route.rut_to_city_id=30726 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 AND routeFrom.rut_from_city_id <> routeFrom.rut_to_city_id\r\n\t\t\t\t\tAND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND routeTo.rut_estm_distance < 50 \r\n\t\t\t\t\tAND routeTo.rut_from_city_id=30726 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\tAND (routeAlias.rut_to_city_id=routeTo.rut_to_city_id) AND routeAlias.rut_active = 1 AND routeAlias.rut_from_city_id=30804  AND routeAlias.rut_id IN (1967,16216,47825,322451,3087761,3190710)"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14220.454] [M: 25015.77] [ET: 2.382/14197.382] [MU: 2.17/25015.34] 
	SQL: SELECT *, (rte_vendor_amount + extraDistance * 10.55) as totalCost FROM (SELECT * FROM nearest_route_30804_30726) a
					INNER JOIN rate ON a.rut_id = rate.rte_route_id AND rte_status=1 AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <>0
					WHERE 1 ORDER BY rank DESC, totalCost ASC LIMIT 0,1 
	 [params: {"cabType":"57"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14221.357] [M: 25023.8] [ET: 0.73/14198.276] [MU: 0.74/25021.8] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"getNearestRoute_30804_30726_70","sql":"(INDEX getNearestRoute_30804_30726_70_index_rut_id (rut_id))\r\n\t\t\t\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id AS start, routeAlias.rut_to_city_id AS end,\r\n\t\t\t\t\t\t\t\trouteFrom.rut_name AS fromAlias, NULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance AS quotedDistance,\r\n\t\t\t\t\t\t\t\trouteAlias.rut_estm_distance AS rateDistance, \r\n\t\t\t\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance)\r\n\t\t\t\t\t\t\t\t\t - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance,\r\n\t\t\t\t\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance,\r\n\t\t\t\t\t\t\t\t0 AS rank, routeFrom.rut_estm_time AS startTime, 0 AS endTime, route.rut_estm_time, \r\n\t\t\t\t\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraTravelDistance\r\n\t\t\t\t\t\tFROM   route\r\n\t\t\t\t\t\tINNER JOIN route routeTo ON routeTo.rut_to_city_id=route.rut_from_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_from_city_id=30804 AND routeTo.rut_active=1\r\n\t\t\t\t\t\t\t\tAND routeTo.rut_estm_distance<70 AND route.rut_active=1\r\n\t\t\t\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_from_city_id=route.rut_to_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_to_city_id=30726 AND routeFrom.rut_active = 1\r\n\t\t\t\t\t\t\t\tAND routeFrom.rut_estm_distance<70 AND route.rut_active = 1\r\n\t\t\t\t\t\tINNER JOIN route routeAlias ON routeAlias.rut_to_city_id=routeFrom.rut_to_city_id\r\n\t\t\t\t\t\t\tAND routeAlias.rut_from_city_id=routeTo.rut_from_city_id AND routeAlias.rut_active = 1"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14223.57] [M: 25029.06] [ET: 2.093/14200.509] [MU: 2.41/25028.44] 
	SQL: SELECT *, (rte_vendor_amount + extradistance * 10.55 ) AS totalCost, 
						ABS(quotedDistance-rateDistance) AS extraChargeableDistance
					FROM getNearestRoute_30804_30726_70 a
					INNER JOIN rate ON a.rut_id=rate.rte_route_id AND rte_status=1 
						AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <> 0
					WHERE  1
					ORDER  BY rank DESC, extraStartDistance, extraChargeableDistance ASC, totalcost ASC
					LIMIT  0, 1 
	 [params: {"cabType":"57"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14226.473] [M: 25044.52] [ET: 0.484/14203.42] [MU: 3.78/25043.64] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"45","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14227.943] [M: 25061.13] [ET: 0.432/14204.907] [MU: 3.78/25060.26] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"16","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14229.65] [M: 25079.53] [ET: 0.606/14206.611] [MU: 5.56/25078.66] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14230.392] [M: 25086.8] [ET: 0.483/14207.332] [MU: 0.9/25086.55] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14232.199] [M: 25097.39] [ET: 0.694/14209.144] [MU: 3.34/25096.95] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14234.396] [M: 25107.94] [ET: 2.002/14211.333] [MU: 3.54/25107.06] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp178)) OR (scr_area_type = 5 AND scr_area_id IN (:gp176)) OR (scr_area_type = 2 AND scr_area_id IN (:gp179)) OR (scr_area_type = 4 AND scr_area_id IN (:gp180)) OR (scr_area_type = 1 AND scr_area_id IN (:gp177)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp176":"908",":gp177":"31",":gp178":"908",":gp179":"105",":gp180":"1","scv_id":"16"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14235.484] [M: 25108.52] [ET: 0.543/14212.44] [MU: 0.9/25108.27] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14236.681] [M: 25118.74] [ET: 0.598/14213.628] [MU: 2.97/25118.3] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14239.217] [M: 25129.29] [ET: 2.368/14216.156] [MU: 3.53/25128.41] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp183)) OR (scr_area_type = 5 AND scr_area_id IN (:gp181)) OR (scr_area_type = 2 AND scr_area_id IN (:gp184)) OR (scr_area_type = 4 AND scr_area_id IN (:gp185)) OR (scr_area_type = 1 AND scr_area_id IN (:gp182)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp181":"908",":gp182":"31",":gp183":"908",":gp184":"105",":gp185":"1","scv_id":"45"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14240.288] [M: 25129.87] [ET: 0.574/14217.252] [MU: 0.9/25129.62] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14241.49] [M: 25140.09] [ET: 0.611/14218.436] [MU: 2.97/25139.66] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14243.896] [M: 25150.64] [ET: 2.219/14220.835] [MU: 3.53/25149.77] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp188)) OR (scr_area_type = 5 AND scr_area_id IN (:gp186)) OR (scr_area_type = 2 AND scr_area_id IN (:gp189)) OR (scr_area_type = 4 AND scr_area_id IN (:gp190)) OR (scr_area_type = 1 AND scr_area_id IN (:gp187)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp186":"908",":gp187":"31",":gp188":"908",":gp189":"105",":gp190":"1","scv_id":"57"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14244.916] [M: 25149.23] [ET: 0.615/14221.859] [MU: 0.9/25148.98] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14246.242] [M: 25161.58] [ET: 0.592/14223.189] [MU: 2.97/25161.14] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14246.887] [M: 25190.75] [ET: 0.499/14223.848] [MU: 22.53/25190] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp193)) OR (apr_area_type = 5 AND apr_area_id IN (:gp191)) OR (apr_area_type = 2 AND apr_area_id IN (:gp194)) OR (apr_area_type = 4 AND apr_area_id IN (:gp195)) OR (apr_area_type = 1 AND apr_area_id IN (:gp192))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp191":"908",":gp192":"31",":gp193":"30804",":gp194":"105",":gp195":"1","cab":"57"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14248.959] [M: 25177.77] [ET: 0.632/14225.904] [MU: 3.34/25177.33] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14251.293] [M: 25188.31] [ET: 2.162/14228.218] [MU: 3.53/25187.44] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp198)) OR (scr_area_type = 5 AND scr_area_id IN (:gp196)) OR (scr_area_type = 2 AND scr_area_id IN (:gp199)) OR (scr_area_type = 4 AND scr_area_id IN (:gp200)) OR (scr_area_type = 1 AND scr_area_id IN (:gp197)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp196":"908",":gp197":"31",":gp198":"908",":gp199":"105",":gp200":"1","scv_id":"57"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14252.331] [M: 25193.06] [ET: 0.623/14229.275] [MU: 3.84/25192.19] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30804"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14252.92] [M: 25200.88] [ET: 0.465/14229.867] [MU: 4.21/25200] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30726"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14253.374] [M: 25205.02] [ET: 0.352/14230.322] [MU: 2.98/25204.91] 
	BookingRoute::calculateDistance
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14255.783] [M: 25211.39] [ET: 2.169/14232.713] [MU: 2.41/25211.02] 
	SQL: SELECT *
				FROM   partner_rate prt 
				JOIN route rut ON prt.prt_route_id = rut.rut_id AND rut.rut_active = 1
				AND  rut.rut_from_city_id  = 30804 
				AND  rut.rut_to_city_id  = 30726 
				 WHERE prt_vehicletype_id = 57
				AND prt_partner_id = 1249
				AND prt_status = 1
				 
	 [params: []]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14256.758] [M: 25216.62] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30726","cabType":"3","tripDistance":"","tripDuration":"","multiCityData":"","bookingType":"1","pickupAddress":"","pickupDate":"24\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","sccId":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30726&cabType=3&tripDistance=&tripDuration=&multiCityData=&bookingType=1&pickupAddress=&pickupDate=24%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&sccId=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14257.434] [M: 25233.46] [ET: 1.259/14234.382] [MU: 18.04/25233.35] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14257.497] [M: 25235.14] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14258.571] [M: 25248.6] [ET: 0.89/14235.505] [MU: 2.99/25246.1] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+5845),(IF((cpm_value_type=2),(5845+(5845*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30726 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30726) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-24 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=57 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14260.311] [M: 25290.83] [ET: 4.243/14237.274] [MU: 75.87/25290.67] 
	RouteRates::calculate for CAB 57 2024-10-24 18:00:00 - Trip Type: 1 366002349
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14260.526] [M: 25270.45] [ET: 51.79/14237.492] [MU: 330.4/25270.29] 
	Quote::calculateOneWay  for CAB 57 Date: 2024-10-24 18:00:00
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14260.779] [M: 25265.95] [ET: 0.185/14237.746] [MU: 0.9/25265.7] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"57"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14260.855] [M: 25272.7] [ET: 57.134/14237.826] [MU: 379.88/25272.61] 
	Quote For CabType: 57
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14261.983] [M: 25282.68] [ET: 0.381/14238.946] [MU: 2.96/25282.24] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14262.401] [M: 25288.5] [ET: 0.348/14239.367] [MU: 3.35/25288.06] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30726"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14262.969] [M: 25291.44] [ET: 0.486/14239.915] [MU: 0.9/25291.19] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14263.78] [M: 25323.79] [ET: 0.656/14240.732] [MU: 24.22/25322.29] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (101) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30726) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp201)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp204,:gp205)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp202,:gp203)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp206,:gp207))
			OR (scr_area_type = 5 AND scr_area_id IN (908))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (69)
		ORDER BY rank DESC
		 
	 [params: {":gp201":"31",":gp202":"30804",":gp203":"30726",":gp204":"105",":gp205":"101",":gp206":"1",":gp207":"1","tripType":"1"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14265.196] [M: 25303.97] [ET: 0.437/14242.137] [MU: 0.83/25303.78] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14265.818] [M: 25306.84] [ET: 0.496/14242.763] [MU: 0.96/25306.53] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"4"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14267.631] [M: 25319.81] [ET: 0.549/14244.589] [MU: 2.05/25319.31] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"69"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14270.512] [M: 25329.2] [ET: 2.643/14247.445] [MU: 3.53/25328.32] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"69","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14271.547] [M: 25332.45] [ET: 0.577/14248.48] [MU: 0.87/25332.23] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":0}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14272.417] [M: 25339.73] [ET: 0.614/14249.38] [MU: 2.97/25339.29] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14273.177] [M: 25367.9] [ET: 0.604/14250.124] [MU: 22.05/25367.27] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp209)) OR (apr_area_type = 2 AND apr_area_id IN (:gp210)) OR (apr_area_type = 4 AND apr_area_id IN (:gp211)) OR (apr_area_type = 1 AND apr_area_id IN (:gp208))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp208":"31",":gp209":"30804",":gp210":"105",":gp211":"1","cab":"69"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14274.224] [M: 25418.62] [ET: 0.482/14251.188] [MU: 3.33/25418.18] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14276.627] [M: 25428.9] [ET: 2.28/14253.564] [MU: 3.41/25428.02] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp213)) OR (scr_area_type = 2 AND scr_area_id IN (:gp214)) OR (scr_area_type = 4 AND scr_area_id IN (:gp215)) OR (scr_area_type = 1 AND scr_area_id IN (:gp212)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp212":"31",":gp213":"30804",":gp214":"105",":gp215":"1","scv_id":"69"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14279.269] [M: 25456.6] [ET: 1.809/14256.204] [MU: 0.74/25448.6] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"nearest_route_30804_30726","sql":"(INDEX indx_nearest_rt_rutid (rut_id)) \r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, routeFrom.rut_name as fromAlias, \r\n\t\t\t\tNULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, \r\n\t\t\t\t0 as rank, routeFrom.rut_estm_time as startTime, 0 as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\tAND route.rut_to_city_id=30726 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 \r\n\t\t\t\tAND routeFrom.rut_from_city_id<>routeFrom.rut_to_city_id AND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\t\tAND (routeAlias.rut_to_city_id=route.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (1967,16216,47825,322451,3087761,3190710)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, NULL, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) \r\n\t\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\t0 AS extraStartDistance, 0, 0 as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND route.rut_from_city_id = 30804 AND route.rut_to_city_id=30726 \r\n\t\t\t\tAND routeTo.rut_from_city_id=30726\r\n\t\t\t\tAND route.rut_active = 1 AND routeTo.rut_active = 1 AND routeTo.rut_estm_distance < 50 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = route.rut_from_city_id) \r\n\t\t\t   AND (routeAlias.rut_to_city_id = routeTo.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (1967,16216,47825,322451,3087761,3190710)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, \r\n\t\t\t\trouteFrom.rut_name, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t+ IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) \r\n\t\t\t\tAS extraDistance, IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, 0, \r\n\t\t\t\trouteFrom.rut_estm_time as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\t\tAND route.rut_to_city_id=30726 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 AND routeFrom.rut_from_city_id <> routeFrom.rut_to_city_id\r\n\t\t\t\t\tAND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND routeTo.rut_estm_distance < 50 \r\n\t\t\t\t\tAND routeTo.rut_from_city_id=30726 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\tAND (routeAlias.rut_to_city_id=routeTo.rut_to_city_id) AND routeAlias.rut_active = 1 AND routeAlias.rut_from_city_id=30804  AND routeAlias.rut_id IN (1967,16216,47825,322451,3087761,3190710)"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14282.303] [M: 25460.71] [ET: 2.919/14259.237] [MU: 2.17/25460.27] 
	SQL: SELECT *, (rte_vendor_amount + extraDistance * 10.55) as totalCost FROM (SELECT * FROM nearest_route_30804_30726) a
					INNER JOIN rate ON a.rut_id = rate.rte_route_id AND rte_status=1 AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <>0
					WHERE 1 ORDER BY rank DESC, totalCost ASC LIMIT 0,1 
	 [params: {"cabType":"69"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14283.206] [M: 25468.73] [ET: 0.728/14260.132] [MU: 0.75/25466.73] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"getNearestRoute_30804_30726_70","sql":"(INDEX getNearestRoute_30804_30726_70_index_rut_id (rut_id))\r\n\t\t\t\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id AS start, routeAlias.rut_to_city_id AS end,\r\n\t\t\t\t\t\t\t\trouteFrom.rut_name AS fromAlias, NULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance AS quotedDistance,\r\n\t\t\t\t\t\t\t\trouteAlias.rut_estm_distance AS rateDistance, \r\n\t\t\t\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance)\r\n\t\t\t\t\t\t\t\t\t - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance,\r\n\t\t\t\t\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance,\r\n\t\t\t\t\t\t\t\t0 AS rank, routeFrom.rut_estm_time AS startTime, 0 AS endTime, route.rut_estm_time, \r\n\t\t\t\t\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraTravelDistance\r\n\t\t\t\t\t\tFROM   route\r\n\t\t\t\t\t\tINNER JOIN route routeTo ON routeTo.rut_to_city_id=route.rut_from_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_from_city_id=30804 AND routeTo.rut_active=1\r\n\t\t\t\t\t\t\t\tAND routeTo.rut_estm_distance<70 AND route.rut_active=1\r\n\t\t\t\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_from_city_id=route.rut_to_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_to_city_id=30726 AND routeFrom.rut_active = 1\r\n\t\t\t\t\t\t\t\tAND routeFrom.rut_estm_distance<70 AND route.rut_active = 1\r\n\t\t\t\t\t\tINNER JOIN route routeAlias ON routeAlias.rut_to_city_id=routeFrom.rut_to_city_id\r\n\t\t\t\t\t\t\tAND routeAlias.rut_from_city_id=routeTo.rut_from_city_id AND routeAlias.rut_active = 1"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14285.784] [M: 25474] [ET: 2.443/14262.704] [MU: 2.42/25473.38] 
	SQL: SELECT *, (rte_vendor_amount + extradistance * 10.55 ) AS totalCost, 
						ABS(quotedDistance-rateDistance) AS extraChargeableDistance
					FROM getNearestRoute_30804_30726_70 a
					INNER JOIN rate ON a.rut_id=rate.rte_route_id AND rte_status=1 
						AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <> 0
					WHERE  1
					ORDER  BY rank DESC, extraStartDistance, extraChargeableDistance ASC, totalcost ASC
					LIMIT  0, 1 
	 [params: {"cabType":"69"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14289.129] [M: 25489.09] [ET: 0.534/14266.076] [MU: 3.41/25488.21] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"45","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14290.707] [M: 25505.7] [ET: 0.479/14267.659] [MU: 3.78/25504.83] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"16","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14292.336] [M: 25524.1] [ET: 0.508/14269.297] [MU: 5.56/25523.23] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14293.055] [M: 25531.37] [ET: 0.474/14269.999] [MU: 0.9/25531.12] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14294.262] [M: 25541.96] [ET: 0.512/14271.226] [MU: 3.34/25541.52] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14296.7] [M: 25552.51] [ET: 2.302/14273.657] [MU: 3.54/25551.63] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp218)) OR (scr_area_type = 5 AND scr_area_id IN (:gp216)) OR (scr_area_type = 2 AND scr_area_id IN (:gp219)) OR (scr_area_type = 4 AND scr_area_id IN (:gp220)) OR (scr_area_type = 1 AND scr_area_id IN (:gp217)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp216":"908",":gp217":"31",":gp218":"908",":gp219":"105",":gp220":"1","scv_id":"16"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14297.985] [M: 25553.09] [ET: 0.771/14274.927] [MU: 0.9/25552.84] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14299.208] [M: 25563.31] [ET: 0.48/14276.171] [MU: 2.97/25562.88] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14301.22] [M: 25573.86] [ET: 1.901/14278.174] [MU: 3.53/25572.98] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp223)) OR (scr_area_type = 5 AND scr_area_id IN (:gp221)) OR (scr_area_type = 2 AND scr_area_id IN (:gp224)) OR (scr_area_type = 4 AND scr_area_id IN (:gp225)) OR (scr_area_type = 1 AND scr_area_id IN (:gp222)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp221":"908",":gp222":"31",":gp223":"908",":gp224":"105",":gp225":"1","scv_id":"45"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14302.178] [M: 25574.44] [ET: 0.549/14279.139] [MU: 0.9/25574.19] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14303.194] [M: 25584.66] [ET: 0.483/14280.158] [MU: 2.97/25584.23] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14305.197] [M: 25595.21] [ET: 1.895/14282.15] [MU: 3.53/25594.34] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp228)) OR (scr_area_type = 5 AND scr_area_id IN (:gp226)) OR (scr_area_type = 2 AND scr_area_id IN (:gp229)) OR (scr_area_type = 4 AND scr_area_id IN (:gp230)) OR (scr_area_type = 1 AND scr_area_id IN (:gp227)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp226":"908",":gp227":"31",":gp228":"908",":gp229":"105",":gp230":"1","scv_id":"69"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14306.008] [M: 25593.8] [ET: 0.521/14282.966] [MU: 0.9/25593.55] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14307.113] [M: 25606.15] [ET: 0.456/14284.076] [MU: 2.97/25605.71] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14307.712] [M: 25635.32] [ET: 0.49/14284.675] [MU: 22.53/25634.57] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp233)) OR (apr_area_type = 5 AND apr_area_id IN (:gp231)) OR (apr_area_type = 2 AND apr_area_id IN (:gp234)) OR (apr_area_type = 4 AND apr_area_id IN (:gp235)) OR (apr_area_type = 1 AND apr_area_id IN (:gp232))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp231":"908",":gp232":"31",":gp233":"30804",":gp234":"105",":gp235":"1","cab":"69"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14309.198] [M: 25622.34] [ET: 0.489/14286.161] [MU: 3.33/25621.9] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14311.541] [M: 25632.88] [ET: 2.22/14288.479] [MU: 3.53/25632.01] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp238)) OR (scr_area_type = 5 AND scr_area_id IN (:gp236)) OR (scr_area_type = 2 AND scr_area_id IN (:gp239)) OR (scr_area_type = 4 AND scr_area_id IN (:gp240)) OR (scr_area_type = 1 AND scr_area_id IN (:gp237)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp236":"908",":gp237":"31",":gp238":"908",":gp239":"105",":gp240":"1","scv_id":"69"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14312.601] [M: 25637.63] [ET: 0.621/14289.546] [MU: 3.84/25636.76] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14313.341] [M: 25645.45] [ET: 0.598/14290.275] [MU: 4.21/25644.57] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14313.819] [M: 25649.59] [ET: 0.37/14290.772] [MU: 2.98/25649.48] 
	BookingRoute::calculateDistance
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14316.746] [M: 25655.87] [ET: 2.628/14293.679] [MU: 2.4/25655.49] 
	SQL: SELECT *
				FROM   partner_rate prt 
				JOIN route rut ON prt.prt_route_id = rut.rut_id AND rut.rut_active = 1
				AND  rut.rut_from_city_id  = 30804 
				AND  rut.rut_to_city_id  = 30726 
				 WHERE prt_vehicletype_id = 69
				AND prt_partner_id = 1249
				AND prt_status = 1
				 
	 [params: []]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14317.695] [M: 25661.09] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30726","cabType":"3","tripDistance":"","tripDuration":"","multiCityData":"","bookingType":"1","pickupAddress":"","pickupDate":"24\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","sccId":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30726&cabType=3&tripDistance=&tripDuration=&multiCityData=&bookingType=1&pickupAddress=&pickupDate=24%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&sccId=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14318.141] [M: 25677.94] [ET: 1.024/14295.108] [MU: 18.05/25677.83] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14318.184] [M: 25679.62] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14319.178] [M: 25693.08] [ET: 0.846/14296.108] [MU: 2.99/25690.58] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+5845),(IF((cpm_value_type=2),(5845+(5845*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30726 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30726) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-24 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=69 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14320.698] [M: 25735.3] [ET: 3.66/14297.659] [MU: 75.87/25735.15] 
	RouteRates::calculate for CAB 69 2024-10-24 18:00:00 - Trip Type: 1 935011574
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14320.92] [M: 25714.92] [ET: 53.218/14297.89] [MU: 393.69/25714.77] 
	Quote::calculateOneWay  for CAB 69 Date: 2024-10-24 18:00:00
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14321.196] [M: 25710.43] [ET: 0.205/14298.162] [MU: 0.9/25710.18] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"69"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14321.269] [M: 25711.68] [ET: 60.364/14298.239] [MU: 437.67/25711.59] 
	Quote For CabType: 69
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14322.45] [M: 25721.66] [ET: 0.391/14299.412] [MU: 2.97/25721.22] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14322.859] [M: 25727.48] [ET: 0.339/14299.824] [MU: 3.34/25727.04] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14323.433] [M: 25730.41] [ET: 0.503/14300.395] [MU: 0.9/25730.16] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14324.011] [M: 25762.77] [ET: 0.466/14300.964] [MU: 24.22/25761.27] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (101) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30726) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp241)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp244,:gp245)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp242,:gp243)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp246,:gp247))
			OR (scr_area_type = 5 AND scr_area_id IN (908))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (70)
		ORDER BY rank DESC
		 
	 [params: {":gp241":"31",":gp242":"30804",":gp243":"30726",":gp244":"105",":gp245":"101",":gp246":"1",":gp247":"1","tripType":"1"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14324.686] [M: 25742.95] [ET: 0.207/14301.651] [MU: 0.84/25742.76] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14325.04] [M: 25745.82] [ET: 0.281/14302.006] [MU: 0.96/25745.51] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"4"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14326.168] [M: 25758.79] [ET: 0.34/14303.132] [MU: 2.05/25758.29] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"70"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14328.86] [M: 25768.17] [ET: 2.461/14305.791] [MU: 3.53/25767.3] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"70","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14329.897] [M: 25771.42] [ET: 0.703/14306.827] [MU: 0.87/25771.2] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":0}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14330.813] [M: 25778.7] [ET: 0.639/14307.747] [MU: 2.97/25778.27] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14331.694] [M: 25806.88] [ET: 0.596/14308.654] [MU: 22.04/25806.25] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp249)) OR (apr_area_type = 2 AND apr_area_id IN (:gp250)) OR (apr_area_type = 4 AND apr_area_id IN (:gp251)) OR (apr_area_type = 1 AND apr_area_id IN (:gp248))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp248":"31",":gp249":"30804",":gp250":"105",":gp251":"1","cab":"70"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14332.772] [M: 25793.59] [ET: 0.472/14309.737] [MU: 3.34/25793.16] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14335.031] [M: 25803.88] [ET: 2.132/14311.965] [MU: 3.4/25803] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp253)) OR (scr_area_type = 2 AND scr_area_id IN (:gp254)) OR (scr_area_type = 4 AND scr_area_id IN (:gp255)) OR (scr_area_type = 1 AND scr_area_id IN (:gp252)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp252":"31",":gp253":"30804",":gp254":"105",":gp255":"1","scv_id":"70"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14338.928] [M: 25831.58] [ET: 2.918/14315.843] [MU: 0.74/25823.58] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"nearest_route_30804_30726","sql":"(INDEX indx_nearest_rt_rutid (rut_id)) \r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, routeFrom.rut_name as fromAlias, \r\n\t\t\t\tNULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, \r\n\t\t\t\t0 as rank, routeFrom.rut_estm_time as startTime, 0 as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\tAND route.rut_to_city_id=30726 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 \r\n\t\t\t\tAND routeFrom.rut_from_city_id<>routeFrom.rut_to_city_id AND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\t\tAND (routeAlias.rut_to_city_id=route.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (1967,16216,47825,322451,3087761,3190710)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, NULL, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) \r\n\t\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\t0 AS extraStartDistance, 0, 0 as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND route.rut_from_city_id = 30804 AND route.rut_to_city_id=30726 \r\n\t\t\t\tAND routeTo.rut_from_city_id=30726\r\n\t\t\t\tAND route.rut_active = 1 AND routeTo.rut_active = 1 AND routeTo.rut_estm_distance < 50 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = route.rut_from_city_id) \r\n\t\t\t   AND (routeAlias.rut_to_city_id = routeTo.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (1967,16216,47825,322451,3087761,3190710)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, \r\n\t\t\t\trouteFrom.rut_name, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t+ IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) \r\n\t\t\t\tAS extraDistance, IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, 0, \r\n\t\t\t\trouteFrom.rut_estm_time as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\t\tAND route.rut_to_city_id=30726 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 AND routeFrom.rut_from_city_id <> routeFrom.rut_to_city_id\r\n\t\t\t\t\tAND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND routeTo.rut_estm_distance < 50 \r\n\t\t\t\t\tAND routeTo.rut_from_city_id=30726 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\tAND (routeAlias.rut_to_city_id=routeTo.rut_to_city_id) AND routeAlias.rut_active = 1 AND routeAlias.rut_from_city_id=30804  AND routeAlias.rut_id IN (1967,16216,47825,322451,3087761,3190710)"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14341.631] [M: 25835.69] [ET: 2.563/14318.566] [MU: 2.16/25835.25] 
	SQL: SELECT *, (rte_vendor_amount + extraDistance * 10.55) as totalCost FROM (SELECT * FROM nearest_route_30804_30726) a
					INNER JOIN rate ON a.rut_id = rate.rte_route_id AND rte_status=1 AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <>0
					WHERE 1 ORDER BY rank DESC, totalCost ASC LIMIT 0,1 
	 [params: {"cabType":"70"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14342.481] [M: 25843.71] [ET: 0.66/14319.387] [MU: 0.74/25841.71] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"getNearestRoute_30804_30726_70","sql":"(INDEX getNearestRoute_30804_30726_70_index_rut_id (rut_id))\r\n\t\t\t\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id AS start, routeAlias.rut_to_city_id AS end,\r\n\t\t\t\t\t\t\t\trouteFrom.rut_name AS fromAlias, NULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance AS quotedDistance,\r\n\t\t\t\t\t\t\t\trouteAlias.rut_estm_distance AS rateDistance, \r\n\t\t\t\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance)\r\n\t\t\t\t\t\t\t\t\t - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance,\r\n\t\t\t\t\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance,\r\n\t\t\t\t\t\t\t\t0 AS rank, routeFrom.rut_estm_time AS startTime, 0 AS endTime, route.rut_estm_time, \r\n\t\t\t\t\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraTravelDistance\r\n\t\t\t\t\t\tFROM   route\r\n\t\t\t\t\t\tINNER JOIN route routeTo ON routeTo.rut_to_city_id=route.rut_from_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_from_city_id=30804 AND routeTo.rut_active=1\r\n\t\t\t\t\t\t\t\tAND routeTo.rut_estm_distance<70 AND route.rut_active=1\r\n\t\t\t\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_from_city_id=route.rut_to_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_to_city_id=30726 AND routeFrom.rut_active = 1\r\n\t\t\t\t\t\t\t\tAND routeFrom.rut_estm_distance<70 AND route.rut_active = 1\r\n\t\t\t\t\t\tINNER JOIN route routeAlias ON routeAlias.rut_to_city_id=routeFrom.rut_to_city_id\r\n\t\t\t\t\t\t\tAND routeAlias.rut_from_city_id=routeTo.rut_from_city_id AND routeAlias.rut_active = 1"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14344.988] [M: 25848.98] [ET: 2.368/14321.906] [MU: 2.41/25848.35] 
	SQL: SELECT *, (rte_vendor_amount + extradistance * 10.55 ) AS totalCost, 
						ABS(quotedDistance-rateDistance) AS extraChargeableDistance
					FROM getNearestRoute_30804_30726_70 a
					INNER JOIN rate ON a.rut_id=rate.rte_route_id AND rte_status=1 
						AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <> 0
					WHERE  1
					ORDER  BY rank DESC, extraStartDistance, extraChargeableDistance ASC, totalcost ASC
					LIMIT  0, 1 
	 [params: {"cabType":"70"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14348.703] [M: 25864.06] [ET: 0.624/14325.648] [MU: 3.41/25863.19] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"45","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14350.493] [M: 25880.68] [ET: 0.601/14327.437] [MU: 3.78/25879.8] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"16","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14352.144] [M: 25899.08] [ET: 0.436/14329.107] [MU: 5.57/25898.2] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14352.804] [M: 25906.34] [ET: 0.424/14329.751] [MU: 0.9/25906.09] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14353.961] [M: 25916.94] [ET: 0.525/14330.925] [MU: 3.33/25916.5] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14356.507] [M: 25927.48] [ET: 2.396/14333.441] [MU: 3.53/25926.61] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp258)) OR (scr_area_type = 5 AND scr_area_id IN (:gp256)) OR (scr_area_type = 2 AND scr_area_id IN (:gp259)) OR (scr_area_type = 4 AND scr_area_id IN (:gp260)) OR (scr_area_type = 1 AND scr_area_id IN (:gp257)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp256":"908",":gp257":"31",":gp258":"908",":gp259":"105",":gp260":"1","scv_id":"16"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14357.468] [M: 25928.06] [ET: 0.571/14334.411] [MU: 0.9/25927.81] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14358.562] [M: 25938.29] [ET: 0.473/14335.524] [MU: 2.96/25937.85] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14360.973] [M: 25948.84] [ET: 2.279/14337.91] [MU: 3.53/25947.96] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp263)) OR (scr_area_type = 5 AND scr_area_id IN (:gp261)) OR (scr_area_type = 2 AND scr_area_id IN (:gp264)) OR (scr_area_type = 4 AND scr_area_id IN (:gp265)) OR (scr_area_type = 1 AND scr_area_id IN (:gp262)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp261":"908",":gp262":"31",":gp263":"908",":gp264":"105",":gp265":"1","scv_id":"45"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14362.016] [M: 25949.41] [ET: 0.528/14338.976] [MU: 0.9/25949.16] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14363.035] [M: 25959.64] [ET: 0.498/14339.999] [MU: 2.97/25959.2] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14365.511] [M: 25970.19] [ET: 2.353/14342.448] [MU: 3.54/25969.31] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp268)) OR (scr_area_type = 5 AND scr_area_id IN (:gp266)) OR (scr_area_type = 2 AND scr_area_id IN (:gp269)) OR (scr_area_type = 4 AND scr_area_id IN (:gp270)) OR (scr_area_type = 1 AND scr_area_id IN (:gp267)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp266":"908",":gp267":"31",":gp268":"908",":gp269":"105",":gp270":"1","scv_id":"70"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14366.396] [M: 25968.78] [ET: 0.51/14343.357] [MU: 0.89/25968.53] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14367.503] [M: 25981.13] [ET: 0.48/14344.467] [MU: 2.97/25980.69] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14368.16] [M: 26010.3] [ET: 0.553/14345.123] [MU: 22.53/26009.55] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp273)) OR (apr_area_type = 5 AND apr_area_id IN (:gp271)) OR (apr_area_type = 2 AND apr_area_id IN (:gp274)) OR (apr_area_type = 4 AND apr_area_id IN (:gp275)) OR (apr_area_type = 1 AND apr_area_id IN (:gp272))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp271":"908",":gp272":"31",":gp273":"30804",":gp274":"105",":gp275":"1","cab":"70"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14369.902] [M: 25997.31] [ET: 0.579/14346.849] [MU: 3.34/25996.88] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14372.092] [M: 26007.86] [ET: 2.041/14349.046] [MU: 3.53/26006.98] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp278)) OR (scr_area_type = 5 AND scr_area_id IN (:gp276)) OR (scr_area_type = 2 AND scr_area_id IN (:gp279)) OR (scr_area_type = 4 AND scr_area_id IN (:gp280)) OR (scr_area_type = 1 AND scr_area_id IN (:gp277)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp276":"908",":gp277":"31",":gp278":"908",":gp279":"105",":gp280":"1","scv_id":"70"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14372.928] [M: 26012.61] [ET: 0.537/14349.888] [MU: 3.85/26011.73] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14373.409] [M: 26020.42] [ET: 0.39/14350.372] [MU: 4.21/26019.55] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14373.701] [M: 26024.56] [ET: 0.227/14350.671] [MU: 2.98/26024.45] 
	BookingRoute::calculateDistance
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14376.048] [M: 26030.94] [ET: 2.166/14352.983] [MU: 2.41/26030.56] 
	SQL: SELECT *
				FROM   partner_rate prt 
				JOIN route rut ON prt.prt_route_id = rut.rut_id AND rut.rut_active = 1
				AND  rut.rut_from_city_id  = 30804 
				AND  rut.rut_to_city_id  = 30726 
				 WHERE prt_vehicletype_id = 70
				AND prt_partner_id = 1249
				AND prt_status = 1
				 
	 [params: []]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14376.965] [M: 26036.16] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30726","cabType":"3","tripDistance":"","tripDuration":"","multiCityData":"","bookingType":"1","pickupAddress":"","pickupDate":"24\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","sccId":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30726&cabType=3&tripDistance=&tripDuration=&multiCityData=&bookingType=1&pickupAddress=&pickupDate=24%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&sccId=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14377.407] [M: 26053.01] [ET: 0.991/14354.375] [MU: 18.05/26052.9] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14377.451] [M: 26054.69] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14378.631] [M: 26068.15] [ET: 1.04/14355.567] [MU: 2.99/26065.65] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+5845),(IF((cpm_value_type=2),(5845+(5845*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30726 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30726) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-24 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=70 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14380.069] [M: 26110.38] [ET: 3.72/14357.018] [MU: 75.87/26110.22] 
	RouteRates::calculate for CAB 70 2024-10-24 18:00:00 - Trip Type: 1 816093518
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14380.346] [M: 26089.99] [ET: 54.106/14357.316] [MU: 329.78/26089.84] 
	Quote::calculateOneWay  for CAB 70 Date: 2024-10-24 18:00:00
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14380.836] [M: 26085.59] [ET: 0.374/14357.752] [MU: 0.9/26085.34] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"70"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14381.005] [M: 26086.84] [ET: 59.668/14357.953] [MU: 373.86/26086.75] 
	Quote For CabType: 70
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14382.262] [M: 26096.82] [ET: 0.366/14359.225] [MU: 2.97/26096.38] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14382.656] [M: 26102.64] [ET: 0.326/14359.622] [MU: 3.35/26102.2] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14383.219] [M: 26105.58] [ET: 0.477/14360.165] [MU: 0.9/26105.33] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14383.866] [M: 26137.93] [ET: 0.49/14360.81] [MU: 24.22/26136.43] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (101) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30726) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp281)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp284,:gp285)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp282,:gp283)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp286,:gp287))
			OR (scr_area_type = 5 AND scr_area_id IN (908))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (73)
		ORDER BY rank DESC
		 
	 [params: {":gp281":"31",":gp282":"30804",":gp283":"30726",":gp284":"105",":gp285":"101",":gp286":"1",":gp287":"1","tripType":"1"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14384.597] [M: 26118.1] [ET: 0.203/14361.547] [MU: 0.84/26117.91] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14384.96] [M: 26120.95] [ET: 0.27/14361.927] [MU: 0.93/26120.63] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"6"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14390.538] [M: 26138.64] [ET: 4.661/14367.47] [MU: 3.53/26137.77] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"73","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14391.347] [M: 26141.89] [ET: 0.519/14368.278] [MU: 0.86/26141.67] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":0}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14392.273] [M: 26149.17] [ET: 0.642/14369.212] [MU: 2.97/26148.73] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14392.98] [M: 26177.34] [ET: 0.534/14369.941] [MU: 22.05/26176.72] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp289)) OR (apr_area_type = 2 AND apr_area_id IN (:gp290)) OR (apr_area_type = 4 AND apr_area_id IN (:gp291)) OR (apr_area_type = 1 AND apr_area_id IN (:gp288))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp288":"31",":gp289":"30804",":gp290":"105",":gp291":"1","cab":"73"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14394] [M: 26164.05] [ET: 0.452/14370.963] [MU: 3.34/26163.62] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14396.455] [M: 26174.34] [ET: 2.331/14373.39] [MU: 3.4/26173.46] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp293)) OR (scr_area_type = 2 AND scr_area_id IN (:gp294)) OR (scr_area_type = 4 AND scr_area_id IN (:gp295)) OR (scr_area_type = 1 AND scr_area_id IN (:gp292)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp292":"31",":gp293":"30804",":gp294":"105",":gp295":"1","scv_id":"73"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14400.347] [M: 26202.05] [ET: 2.824/14377.283] [MU: 0.74/26194.05] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"nearest_route_30804_30726","sql":"(INDEX indx_nearest_rt_rutid (rut_id)) \r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, routeFrom.rut_name as fromAlias, \r\n\t\t\t\tNULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, \r\n\t\t\t\t0 as rank, routeFrom.rut_estm_time as startTime, 0 as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\tAND route.rut_to_city_id=30726 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 \r\n\t\t\t\tAND routeFrom.rut_from_city_id<>routeFrom.rut_to_city_id AND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\t\tAND (routeAlias.rut_to_city_id=route.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (1967,16216,47825,322451,3087761,3190710)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, NULL, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) \r\n\t\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\t0 AS extraStartDistance, 0, 0 as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND route.rut_from_city_id = 30804 AND route.rut_to_city_id=30726 \r\n\t\t\t\tAND routeTo.rut_from_city_id=30726\r\n\t\t\t\tAND route.rut_active = 1 AND routeTo.rut_active = 1 AND routeTo.rut_estm_distance < 50 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = route.rut_from_city_id) \r\n\t\t\t   AND (routeAlias.rut_to_city_id = routeTo.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (1967,16216,47825,322451,3087761,3190710)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, \r\n\t\t\t\trouteFrom.rut_name, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t+ IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) \r\n\t\t\t\tAS extraDistance, IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, 0, \r\n\t\t\t\trouteFrom.rut_estm_time as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\t\tAND route.rut_to_city_id=30726 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 AND routeFrom.rut_from_city_id <> routeFrom.rut_to_city_id\r\n\t\t\t\t\tAND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND routeTo.rut_estm_distance < 50 \r\n\t\t\t\t\tAND routeTo.rut_from_city_id=30726 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\tAND (routeAlias.rut_to_city_id=routeTo.rut_to_city_id) AND routeAlias.rut_active = 1 AND routeAlias.rut_from_city_id=30804  AND routeAlias.rut_id IN (1967,16216,47825,322451,3087761,3190710)"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14403.951] [M: 26206.16] [ET: 3.497/14380.898] [MU: 2.16/26205.72] 
	SQL: SELECT *, (rte_vendor_amount + extraDistance * 10.55) as totalCost FROM (SELECT * FROM nearest_route_30804_30726) a
					INNER JOIN rate ON a.rut_id = rate.rte_route_id AND rte_status=1 AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <>0
					WHERE 1 ORDER BY rank DESC, totalCost ASC LIMIT 0,1 
	 [params: {"cabType":"73"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14404.687] [M: 26214.18] [ET: 0.6/14381.63] [MU: 0.74/26212.18] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"getNearestRoute_30804_30726_70","sql":"(INDEX getNearestRoute_30804_30726_70_index_rut_id (rut_id))\r\n\t\t\t\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id AS start, routeAlias.rut_to_city_id AS end,\r\n\t\t\t\t\t\t\t\trouteFrom.rut_name AS fromAlias, NULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance AS quotedDistance,\r\n\t\t\t\t\t\t\t\trouteAlias.rut_estm_distance AS rateDistance, \r\n\t\t\t\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance)\r\n\t\t\t\t\t\t\t\t\t - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance,\r\n\t\t\t\t\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance,\r\n\t\t\t\t\t\t\t\t0 AS rank, routeFrom.rut_estm_time AS startTime, 0 AS endTime, route.rut_estm_time, \r\n\t\t\t\t\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraTravelDistance\r\n\t\t\t\t\t\tFROM   route\r\n\t\t\t\t\t\tINNER JOIN route routeTo ON routeTo.rut_to_city_id=route.rut_from_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_from_city_id=30804 AND routeTo.rut_active=1\r\n\t\t\t\t\t\t\t\tAND routeTo.rut_estm_distance<70 AND route.rut_active=1\r\n\t\t\t\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_from_city_id=route.rut_to_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_to_city_id=30726 AND routeFrom.rut_active = 1\r\n\t\t\t\t\t\t\t\tAND routeFrom.rut_estm_distance<70 AND route.rut_active = 1\r\n\t\t\t\t\t\tINNER JOIN route routeAlias ON routeAlias.rut_to_city_id=routeFrom.rut_to_city_id\r\n\t\t\t\t\t\t\tAND routeAlias.rut_from_city_id=routeTo.rut_from_city_id AND routeAlias.rut_active = 1"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14409.093] [M: 26219.45] [ET: 4.303/14386.031] [MU: 2.41/26218.82] 
	SQL: SELECT *, (rte_vendor_amount + extradistance * 10.55 ) AS totalCost, 
						ABS(quotedDistance-rateDistance) AS extraChargeableDistance
					FROM getNearestRoute_30804_30726_70 a
					INNER JOIN rate ON a.rut_id=rate.rte_route_id AND rte_status=1 
						AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <> 0
					WHERE  1
					ORDER  BY rank DESC, extraStartDistance, extraChargeableDistance ASC, totalcost ASC
					LIMIT  0, 1 
	 [params: {"cabType":"73"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14412.124] [M: 26236.3] [ET: 0.512/14389.072] [MU: 5.19/26235.43] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14412.85] [M: 26243.57] [ET: 0.503/14389.809] [MU: 0.9/26243.32] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14413.824] [M: 26254.16] [ET: 0.458/14390.786] [MU: 3.34/26253.73] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14416.304] [M: 26264.71] [ET: 2.358/14393.253] [MU: 3.53/26263.84] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp298)) OR (scr_area_type = 5 AND scr_area_id IN (:gp296)) OR (scr_area_type = 2 AND scr_area_id IN (:gp299)) OR (scr_area_type = 4 AND scr_area_id IN (:gp300)) OR (scr_area_type = 1 AND scr_area_id IN (:gp297)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp296":"908",":gp297":"31",":gp298":"908",":gp299":"105",":gp300":"1","scv_id":"73"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14417.2] [M: 26263.31] [ET: 0.59/14394.135] [MU: 0.9/26263.06] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14418.49] [M: 26275.66] [ET: 0.493/14395.437] [MU: 2.97/26275.22] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14419.124] [M: 26304.83] [ET: 0.51/14396.066] [MU: 22.53/26304.08] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp303)) OR (apr_area_type = 5 AND apr_area_id IN (:gp301)) OR (apr_area_type = 2 AND apr_area_id IN (:gp304)) OR (apr_area_type = 4 AND apr_area_id IN (:gp305)) OR (apr_area_type = 1 AND apr_area_id IN (:gp302))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp301":"908",":gp302":"31",":gp303":"30804",":gp304":"105",":gp305":"1","cab":"73"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14420.665] [M: 26291.84] [ET: 0.472/14397.615] [MU: 3.33/26291.4] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14422.935] [M: 26302.38] [ET: 2.141/14399.868] [MU: 3.53/26301.51] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp308)) OR (scr_area_type = 5 AND scr_area_id IN (:gp306)) OR (scr_area_type = 2 AND scr_area_id IN (:gp309)) OR (scr_area_type = 4 AND scr_area_id IN (:gp310)) OR (scr_area_type = 1 AND scr_area_id IN (:gp307)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp306":"908",":gp307":"31",":gp308":"908",":gp309":"105",":gp310":"1","scv_id":"73"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14424.012] [M: 26307.14] [ET: 0.63/14400.955] [MU: 3.85/26306.27] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14424.59] [M: 26314.95] [ET: 0.449/14401.538] [MU: 4.21/26314.08] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14425.038] [M: 26319.09] [ET: 0.349/14401.989] [MU: 2.98/26318.98] 
	BookingRoute::calculateDistance
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14427.588] [M: 26325.47] [ET: 2.301/14404.516] [MU: 2.41/26325.09] 
	SQL: SELECT *
				FROM   partner_rate prt 
				JOIN route rut ON prt.prt_route_id = rut.rut_id AND rut.rut_active = 1
				AND  rut.rut_from_city_id  = 30804 
				AND  rut.rut_to_city_id  = 30726 
				 WHERE prt_vehicletype_id = 73
				AND prt_partner_id = 1249
				AND prt_status = 1
				 
	 [params: []]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14428.394] [M: 26330.7] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30726","cabType":"3","tripDistance":"","tripDuration":"","multiCityData":"","bookingType":"1","pickupAddress":"","pickupDate":"24\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","sccId":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30726&cabType=3&tripDistance=&tripDuration=&multiCityData=&bookingType=1&pickupAddress=&pickupDate=24%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&sccId=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14428.838] [M: 26347.54] [ET: 0.887/14405.806] [MU: 18.04/26347.43] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14428.885] [M: 26349.22] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14430.016] [M: 26362.68] [ET: 0.994/14406.954] [MU: 2.99/26360.18] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+5845),(IF((cpm_value_type=2),(5845+(5845*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30726 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30726) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-24 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=73 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14432.498] [M: 26404.91] [ET: 4.6/14409.438] [MU: 75.87/26404.75] 
	RouteRates::calculate for CAB 73 2024-10-24 18:00:00 - Trip Type: 1 925085249
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14432.866] [M: 26384.52] [ET: 47.14/14409.819] [MU: 253.84/26384.37] 
	Quote::calculateOneWay  for CAB 73 Date: 2024-10-24 18:00:00
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14433.352] [M: 26381.04] [ET: 0.368/14410.3] [MU: 0.9/26380.79] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"73"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14433.471] [M: 26382.6] [ET: 52.374/14410.418] [MU: 294.45/26382.51] 
	Quote For CabType: 73
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14435.139] [M: 26392.58] [ET: 0.596/14412.085] [MU: 2.97/26392.14] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14435.951] [M: 26398.4] [ET: 0.69/14412.898] [MU: 3.34/26397.96] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14436.687] [M: 26401.34] [ET: 0.627/14413.633] [MU: 0.9/26401.09] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14437.625] [M: 26433.69] [ET: 0.762/14414.555] [MU: 24.22/26432.19] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (101) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30726) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp311)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp314,:gp315)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp312,:gp313)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp316,:gp317))
			OR (scr_area_type = 5 AND scr_area_id IN (908))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (78)
		ORDER BY rank DESC
		 
	 [params: {":gp311":"31",":gp312":"30804",":gp313":"30726",":gp314":"105",":gp315":"101",":gp316":"1",":gp317":"1","tripType":"1"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14438.696] [M: 26413.88] [ET: 0.316/14415.643] [MU: 0.84/26413.69] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14439.315] [M: 26416.75] [ET: 0.493/14416.255] [MU: 0.96/26416.44] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"1"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14441.264] [M: 26429.52] [ET: 0.647/14418.202] [MU: 2.05/26429.02] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"78"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14444.778] [M: 26438.9] [ET: 3.141/14421.7] [MU: 3.54/26438.02] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"78","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14446.044] [M: 26442.15] [ET: 0.82/14422.966] [MU: 0.86/26441.93] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":0}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14447.074] [M: 26449.43] [ET: 0.726/14424.018] [MU: 2.96/26448.99] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14448.461] [M: 26477.6] [ET: 1.121/14425.396] [MU: 22.05/26476.98] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp319)) OR (apr_area_type = 2 AND apr_area_id IN (:gp320)) OR (apr_area_type = 4 AND apr_area_id IN (:gp321)) OR (apr_area_type = 1 AND apr_area_id IN (:gp318))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp318":"31",":gp319":"30804",":gp320":"105",":gp321":"1","cab":"78"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14450.241] [M: 26464.33] [ET: 0.755/14427.185] [MU: 3.33/26463.89] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14453.433] [M: 26474.61] [ET: 3.017/14430.371] [MU: 3.41/26473.73] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp323)) OR (scr_area_type = 2 AND scr_area_id IN (:gp324)) OR (scr_area_type = 4 AND scr_area_id IN (:gp325)) OR (scr_area_type = 1 AND scr_area_id IN (:gp322)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp322":"31",":gp323":"30804",":gp324":"105",":gp325":"1","scv_id":"78"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14457.754] [M: 26502.3] [ET: 3.127/14434.669] [MU: 0.74/26494.3] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"nearest_route_30804_30726","sql":"(INDEX indx_nearest_rt_rutid (rut_id)) \r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, routeFrom.rut_name as fromAlias, \r\n\t\t\t\tNULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, \r\n\t\t\t\t0 as rank, routeFrom.rut_estm_time as startTime, 0 as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\tAND route.rut_to_city_id=30726 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 \r\n\t\t\t\tAND routeFrom.rut_from_city_id<>routeFrom.rut_to_city_id AND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\t\tAND (routeAlias.rut_to_city_id=route.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (1967,16216,47825,322451,3087761,3190710)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, NULL, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) \r\n\t\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\t0 AS extraStartDistance, 0, 0 as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND route.rut_from_city_id = 30804 AND route.rut_to_city_id=30726 \r\n\t\t\t\tAND routeTo.rut_from_city_id=30726\r\n\t\t\t\tAND route.rut_active = 1 AND routeTo.rut_active = 1 AND routeTo.rut_estm_distance < 50 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = route.rut_from_city_id) \r\n\t\t\t   AND (routeAlias.rut_to_city_id = routeTo.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (1967,16216,47825,322451,3087761,3190710)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, \r\n\t\t\t\trouteFrom.rut_name, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t+ IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) \r\n\t\t\t\tAS extraDistance, IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, 0, \r\n\t\t\t\trouteFrom.rut_estm_time as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\t\tAND route.rut_to_city_id=30726 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 AND routeFrom.rut_from_city_id <> routeFrom.rut_to_city_id\r\n\t\t\t\t\tAND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND routeTo.rut_estm_distance < 50 \r\n\t\t\t\t\tAND routeTo.rut_from_city_id=30726 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\tAND (routeAlias.rut_to_city_id=routeTo.rut_to_city_id) AND routeAlias.rut_active = 1 AND routeAlias.rut_from_city_id=30804  AND routeAlias.rut_id IN (1967,16216,47825,322451,3087761,3190710)"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14461.03] [M: 26506.41] [ET: 3.119/14437.962] [MU: 2.16/26505.98] 
	SQL: SELECT *, (rte_vendor_amount + extraDistance * 10.55) as totalCost FROM (SELECT * FROM nearest_route_30804_30726) a
					INNER JOIN rate ON a.rut_id = rate.rte_route_id AND rte_status=1 AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <>0
					WHERE 1 ORDER BY rank DESC, totalCost ASC LIMIT 0,1 
	 [params: {"cabType":"78"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14462.144] [M: 26514.44] [ET: 0.929/14439.057] [MU: 0.74/26512.44] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"getNearestRoute_30804_30726_70","sql":"(INDEX getNearestRoute_30804_30726_70_index_rut_id (rut_id))\r\n\t\t\t\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id AS start, routeAlias.rut_to_city_id AS end,\r\n\t\t\t\t\t\t\t\trouteFrom.rut_name AS fromAlias, NULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance AS quotedDistance,\r\n\t\t\t\t\t\t\t\trouteAlias.rut_estm_distance AS rateDistance, \r\n\t\t\t\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance)\r\n\t\t\t\t\t\t\t\t\t - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance,\r\n\t\t\t\t\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance,\r\n\t\t\t\t\t\t\t\t0 AS rank, routeFrom.rut_estm_time AS startTime, 0 AS endTime, route.rut_estm_time, \r\n\t\t\t\t\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraTravelDistance\r\n\t\t\t\t\t\tFROM   route\r\n\t\t\t\t\t\tINNER JOIN route routeTo ON routeTo.rut_to_city_id=route.rut_from_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_from_city_id=30804 AND routeTo.rut_active=1\r\n\t\t\t\t\t\t\t\tAND routeTo.rut_estm_distance<70 AND route.rut_active=1\r\n\t\t\t\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_from_city_id=route.rut_to_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_to_city_id=30726 AND routeFrom.rut_active = 1\r\n\t\t\t\t\t\t\t\tAND routeFrom.rut_estm_distance<70 AND route.rut_active = 1\r\n\t\t\t\t\t\tINNER JOIN route routeAlias ON routeAlias.rut_to_city_id=routeFrom.rut_to_city_id\r\n\t\t\t\t\t\t\tAND routeAlias.rut_from_city_id=routeTo.rut_from_city_id AND routeAlias.rut_active = 1"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14465.463] [M: 26519.7] [ET: 3.146/14442.38] [MU: 2.41/26519.08] 
	SQL: SELECT *, (rte_vendor_amount + extradistance * 10.55 ) AS totalCost, 
						ABS(quotedDistance-rateDistance) AS extraChargeableDistance
					FROM getNearestRoute_30804_30726_70 a
					INNER JOIN rate ON a.rut_id=rate.rte_route_id AND rte_status=1 
						AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <> 0
					WHERE  1
					ORDER  BY rank DESC, extraStartDistance, extraChargeableDistance ASC, totalcost ASC
					LIMIT  0, 1 
	 [params: {"cabType":"78"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14470.495] [M: 26536.58] [ET: 0.814/14447.416] [MU: 5.2/26535.7] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14471.614] [M: 26543.84] [ET: 0.728/14448.548] [MU: 0.9/26543.59] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14473.159] [M: 26554.44] [ET: 0.666/14450.098] [MU: 3.33/26554] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14476.051] [M: 26564.98] [ET: 2.696/14452.976] [MU: 3.53/26564.11] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp328)) OR (scr_area_type = 5 AND scr_area_id IN (:gp326)) OR (scr_area_type = 2 AND scr_area_id IN (:gp329)) OR (scr_area_type = 4 AND scr_area_id IN (:gp330)) OR (scr_area_type = 1 AND scr_area_id IN (:gp327)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp326":"908",":gp327":"31",":gp328":"908",":gp329":"105",":gp330":"1","scv_id":"78"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14477.264] [M: 26563.57] [ET: 0.73/14454.196] [MU: 0.9/26563.32] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14479.009] [M: 26575.91] [ET: 0.682/14455.928] [MU: 2.97/26575.48] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14479.92] [M: 26605.09] [ET: 0.741/14456.869] [MU: 22.53/26604.34] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp333)) OR (apr_area_type = 5 AND apr_area_id IN (:gp331)) OR (apr_area_type = 2 AND apr_area_id IN (:gp334)) OR (apr_area_type = 4 AND apr_area_id IN (:gp335)) OR (apr_area_type = 1 AND apr_area_id IN (:gp332))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp331":"908",":gp332":"31",":gp333":"30804",":gp334":"105",":gp335":"1","cab":"78"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14482.483] [M: 26592.11] [ET: 0.707/14459.406] [MU: 3.33/26591.67] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14485.421] [M: 26602.66] [ET: 2.753/14462.354] [MU: 3.53/26601.78] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp338)) OR (scr_area_type = 5 AND scr_area_id IN (:gp336)) OR (scr_area_type = 2 AND scr_area_id IN (:gp339)) OR (scr_area_type = 4 AND scr_area_id IN (:gp340)) OR (scr_area_type = 1 AND scr_area_id IN (:gp337)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp336":"908",":gp337":"31",":gp338":"908",":gp339":"105",":gp340":"1","scv_id":"78"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14486.48] [M: 26607.4] [ET: 0.614/14463.424] [MU: 3.85/26606.52] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14487.051] [M: 26615.21] [ET: 0.449/14463.999] [MU: 4.21/26614.34] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14487.497] [M: 26619.35] [ET: 0.342/14464.451] [MU: 2.97/26619.24] 
	BookingRoute::calculateDistance
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14489.89] [M: 26625.73] [ET: 2.153/14466.829] [MU: 2.4/26625.35] 
	SQL: SELECT *
				FROM   partner_rate prt 
				JOIN route rut ON prt.prt_route_id = rut.rut_id AND rut.rut_active = 1
				AND  rut.rut_from_city_id  = 30804 
				AND  rut.rut_to_city_id  = 30726 
				 WHERE prt_vehicletype_id = 78
				AND prt_partner_id = 1249
				AND prt_status = 1
				 
	 [params: []]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14490.832] [M: 26630.95] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30726","cabType":"3","tripDistance":"","tripDuration":"","multiCityData":"","bookingType":"1","pickupAddress":"","pickupDate":"24\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","sccId":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30726&cabType=3&tripDistance=&tripDuration=&multiCityData=&bookingType=1&pickupAddress=&pickupDate=24%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&sccId=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14491.487] [M: 26647.8] [ET: 1.226/14468.439] [MU: 18.05/26647.69] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14491.549] [M: 26649.48] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14492.625] [M: 26662.94] [ET: 0.896/14469.561] [MU: 2.99/26660.44] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+5845),(IF((cpm_value_type=2),(5845+(5845*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30726 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30726) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-24 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=78 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14494.294] [M: 26705.16] [ET: 4.123/14471.252] [MU: 75.87/26705.01] 
	RouteRates::calculate for CAB 78 2024-10-24 18:00:00 - Trip Type: 1 964987777
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14494.526] [M: 26684.78] [ET: 53.151/14471.495] [MU: 253.85/26684.63] 
	Quote::calculateOneWay  for CAB 78 Date: 2024-10-24 18:00:00
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14494.82] [M: 26680.58] [ET: 0.223/14471.785] [MU: 0.9/26680.33] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"78"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14494.894] [M: 26682.14] [ET: 61.356/14471.863] [MU: 298.23/26682.05] 
	Quote For CabType: 78
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14496] [M: 26692.12] [ET: 0.368/14472.965] [MU: 2.97/26691.68] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14496.476] [M: 26697.94] [ET: 0.406/14473.437] [MU: 3.34/26697.5] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14497.159] [M: 26700.88] [ET: 0.592/14474.099] [MU: 0.9/26700.63] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14498.344] [M: 26733.23] [ET: 0.961/14475.245] [MU: 24.22/26731.73] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (101) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30726) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp341)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp344,:gp345)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp342,:gp343)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp346,:gp347))
			OR (scr_area_type = 5 AND scr_area_id IN (908))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (81)
		ORDER BY rank DESC
		 
	 [params: {":gp341":"31",":gp342":"30804",":gp343":"30726",":gp344":"105",":gp345":"101",":gp346":"1",":gp347":"1","tripType":"1"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14499.272] [M: 26713.41] [ET: 0.317/14476.215] [MU: 0.83/26713.22] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14499.853] [M: 26716.28] [ET: 0.455/14476.799] [MU: 0.96/26715.97] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"1"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14501.659] [M: 26729.05] [ET: 0.535/14478.616] [MU: 2.05/26728.55] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"81"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14506.403] [M: 26738.43] [ET: 4.49/14483.337] [MU: 3.53/26737.55] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"81","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14507.409] [M: 26741.68] [ET: 0.668/14484.361] [MU: 0.86/26741.46] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":0}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14508.145] [M: 26748.96] [ET: 0.538/14485.102] [MU: 2.97/26748.52] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14508.819] [M: 26777.13] [ET: 0.535/14485.781] [MU: 22.05/26776.51] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp349)) OR (apr_area_type = 2 AND apr_area_id IN (:gp350)) OR (apr_area_type = 4 AND apr_area_id IN (:gp351)) OR (apr_area_type = 1 AND apr_area_id IN (:gp348))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp348":"31",":gp349":"30804",":gp350":"105",":gp351":"1","cab":"81"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14509.966] [M: 26763.85] [ET: 0.528/14486.93] [MU: 3.34/26763.41] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14512.071] [M: 26774.13] [ET: 1.993/14489.027] [MU: 3.41/26773.26] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp353)) OR (scr_area_type = 2 AND scr_area_id IN (:gp354)) OR (scr_area_type = 4 AND scr_area_id IN (:gp355)) OR (scr_area_type = 1 AND scr_area_id IN (:gp352)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp352":"31",":gp353":"30804",":gp354":"105",":gp355":"1","scv_id":"81"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14515.397] [M: 26801.84] [ET: 2.54/14492.329] [MU: 0.74/26793.84] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"nearest_route_30804_30726","sql":"(INDEX indx_nearest_rt_rutid (rut_id)) \r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, routeFrom.rut_name as fromAlias, \r\n\t\t\t\tNULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, \r\n\t\t\t\t0 as rank, routeFrom.rut_estm_time as startTime, 0 as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\tAND route.rut_to_city_id=30726 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 \r\n\t\t\t\tAND routeFrom.rut_from_city_id<>routeFrom.rut_to_city_id AND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\t\tAND (routeAlias.rut_to_city_id=route.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (1967,16216,47825,322451,3087761,3190710)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, NULL, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) \r\n\t\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\t0 AS extraStartDistance, 0, 0 as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND route.rut_from_city_id = 30804 AND route.rut_to_city_id=30726 \r\n\t\t\t\tAND routeTo.rut_from_city_id=30726\r\n\t\t\t\tAND route.rut_active = 1 AND routeTo.rut_active = 1 AND routeTo.rut_estm_distance < 50 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = route.rut_from_city_id) \r\n\t\t\t   AND (routeAlias.rut_to_city_id = routeTo.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (1967,16216,47825,322451,3087761,3190710)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, \r\n\t\t\t\trouteFrom.rut_name, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t+ IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) \r\n\t\t\t\tAS extraDistance, IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, 0, \r\n\t\t\t\trouteFrom.rut_estm_time as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\t\tAND route.rut_to_city_id=30726 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 AND routeFrom.rut_from_city_id <> routeFrom.rut_to_city_id\r\n\t\t\t\t\tAND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND routeTo.rut_estm_distance < 50 \r\n\t\t\t\t\tAND routeTo.rut_from_city_id=30726 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\tAND (routeAlias.rut_to_city_id=routeTo.rut_to_city_id) AND routeAlias.rut_active = 1 AND routeAlias.rut_from_city_id=30804  AND routeAlias.rut_id IN (1967,16216,47825,322451,3087761,3190710)"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14518.157] [M: 26805.95] [ET: 2.607/14495.085] [MU: 2.16/26805.51] 
	SQL: SELECT *, (rte_vendor_amount + extraDistance * 10.55) as totalCost FROM (SELECT * FROM nearest_route_30804_30726) a
					INNER JOIN rate ON a.rut_id = rate.rte_route_id AND rte_status=1 AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <>0
					WHERE 1 ORDER BY rank DESC, totalCost ASC LIMIT 0,1 
	 [params: {"cabType":"81"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14518.983] [M: 26813.97] [ET: 0.652/14495.913] [MU: 0.74/26811.97] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"getNearestRoute_30804_30726_70","sql":"(INDEX getNearestRoute_30804_30726_70_index_rut_id (rut_id))\r\n\t\t\t\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id AS start, routeAlias.rut_to_city_id AS end,\r\n\t\t\t\t\t\t\t\trouteFrom.rut_name AS fromAlias, NULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance AS quotedDistance,\r\n\t\t\t\t\t\t\t\trouteAlias.rut_estm_distance AS rateDistance, \r\n\t\t\t\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance)\r\n\t\t\t\t\t\t\t\t\t - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance,\r\n\t\t\t\t\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance,\r\n\t\t\t\t\t\t\t\t0 AS rank, routeFrom.rut_estm_time AS startTime, 0 AS endTime, route.rut_estm_time, \r\n\t\t\t\t\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraTravelDistance\r\n\t\t\t\t\t\tFROM   route\r\n\t\t\t\t\t\tINNER JOIN route routeTo ON routeTo.rut_to_city_id=route.rut_from_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_from_city_id=30804 AND routeTo.rut_active=1\r\n\t\t\t\t\t\t\t\tAND routeTo.rut_estm_distance<70 AND route.rut_active=1\r\n\t\t\t\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_from_city_id=route.rut_to_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_to_city_id=30726 AND routeFrom.rut_active = 1\r\n\t\t\t\t\t\t\t\tAND routeFrom.rut_estm_distance<70 AND route.rut_active = 1\r\n\t\t\t\t\t\tINNER JOIN route routeAlias ON routeAlias.rut_to_city_id=routeFrom.rut_to_city_id\r\n\t\t\t\t\t\t\tAND routeAlias.rut_from_city_id=routeTo.rut_from_city_id AND routeAlias.rut_active = 1"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14521.35] [M: 26819.23] [ET: 2.258/14498.28] [MU: 2.41/26818.61] 
	SQL: SELECT *, (rte_vendor_amount + extradistance * 10.55 ) AS totalCost, 
						ABS(quotedDistance-rateDistance) AS extraChargeableDistance
					FROM getNearestRoute_30804_30726_70 a
					INNER JOIN rate ON a.rut_id=rate.rte_route_id AND rte_status=1 
						AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <> 0
					WHERE  1
					ORDER  BY rank DESC, extraStartDistance, extraChargeableDistance ASC, totalcost ASC
					LIMIT  0, 1 
	 [params: {"cabType":"81"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14524.438] [M: 26836.1] [ET: 0.506/14501.384] [MU: 5.2/26835.23] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14525.148] [M: 26843.37] [ET: 0.489/14502.111] [MU: 0.9/26843.12] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14526.142] [M: 26853.96] [ET: 0.465/14503.104] [MU: 3.34/26853.52] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14528.16] [M: 26864.51] [ET: 1.894/14505.112] [MU: 3.54/26863.63] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp358)) OR (scr_area_type = 5 AND scr_area_id IN (:gp356)) OR (scr_area_type = 2 AND scr_area_id IN (:gp359)) OR (scr_area_type = 4 AND scr_area_id IN (:gp360)) OR (scr_area_type = 1 AND scr_area_id IN (:gp357)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp356":"908",":gp357":"31",":gp358":"908",":gp359":"105",":gp360":"1","scv_id":"81"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14529.028] [M: 26863.1] [ET: 0.573/14505.97] [MU: 0.89/26862.85] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14530.28] [M: 26875.45] [ET: 0.474/14507.228] [MU: 2.97/26875.01] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14531.149] [M: 26904.62] [ET: 0.739/14508.082] [MU: 22.53/26903.87] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp363)) OR (apr_area_type = 5 AND apr_area_id IN (:gp361)) OR (apr_area_type = 2 AND apr_area_id IN (:gp364)) OR (apr_area_type = 4 AND apr_area_id IN (:gp365)) OR (apr_area_type = 1 AND apr_area_id IN (:gp362))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp361":"908",":gp362":"31",":gp363":"30804",":gp364":"105",":gp365":"1","cab":"81"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14532.969] [M: 26891.63] [ET: 0.631/14509.9] [MU: 3.34/26891.2] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14535.279] [M: 26902.18] [ET: 2.143/14512.214] [MU: 3.53/26901.3] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp368)) OR (scr_area_type = 5 AND scr_area_id IN (:gp366)) OR (scr_area_type = 2 AND scr_area_id IN (:gp369)) OR (scr_area_type = 4 AND scr_area_id IN (:gp370)) OR (scr_area_type = 1 AND scr_area_id IN (:gp367)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp366":"908",":gp367":"31",":gp368":"908",":gp369":"105",":gp370":"1","scv_id":"81"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14536.278] [M: 26906.93] [ET: 0.594/14513.239] [MU: 3.85/26906.05] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14536.759] [M: 26914.74] [ET: 0.394/14513.722] [MU: 4.21/26913.87] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14537.05] [M: 26918.88] [ET: 0.227/14514.021] [MU: 2.98/26918.77] 
	BookingRoute::calculateDistance
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14539.391] [M: 26925.16] [ET: 2.181/14516.346] [MU: 2.4/26924.79] 
	SQL: SELECT *
				FROM   partner_rate prt 
				JOIN route rut ON prt.prt_route_id = rut.rut_id AND rut.rut_active = 1
				AND  rut.rut_from_city_id  = 30804 
				AND  rut.rut_to_city_id  = 30726 
				 WHERE prt_vehicletype_id = 81
				AND prt_partner_id = 1249
				AND prt_status = 1
				 
	 [params: []]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14540.146] [M: 26930.39] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30726","cabType":"3","tripDistance":"","tripDuration":"","multiCityData":"","bookingType":"1","pickupAddress":"","pickupDate":"24\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","sccId":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30726&cabType=3&tripDistance=&tripDuration=&multiCityData=&bookingType=1&pickupAddress=&pickupDate=24%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&sccId=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14540.591] [M: 26947.23] [ET: 0.909/14517.56] [MU: 18.05/26947.13] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14540.634] [M: 26948.91] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14541.657] [M: 26962.38] [ET: 0.877/14518.591] [MU: 2.99/26959.88] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+5845),(IF((cpm_value_type=2),(5845+(5845*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30726 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30726) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-24 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=81 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14543.084] [M: 27004.6] [ET: 3.467/14520.049] [MU: 75.88/27004.45] 
	RouteRates::calculate for CAB 81 2024-10-24 18:00:00 - Trip Type: 1 848312294
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14543.3] [M: 26984.22] [ET: 41.559/14520.27] [MU: 253.75/26984.06] 
	Quote::calculateOneWay  for CAB 81 Date: 2024-10-24 18:00:00
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14543.556] [M: 26979.93] [ET: 0.19/14520.523] [MU: 0.9/26979.68] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"81"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14543.628] [M: 26981.49] [ET: 48.686/14520.599] [MU: 298.05/26981.4] 
	Quote For CabType: 81
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14544.935] [M: 26991.47] [ET: 0.587/14521.885] [MU: 2.96/26991.03] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14545.399] [M: 26997.29] [ET: 0.391/14522.364] [MU: 3.34/26996.85] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14545.998] [M: 27000.23] [ET: 0.529/14522.96] [MU: 0.9/26999.98] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14546.731] [M: 27032.58] [ET: 0.604/14523.667] [MU: 24.22/27031.08] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (101) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30726) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp371)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp374,:gp375)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp372,:gp373)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp376,:gp377))
			OR (scr_area_type = 5 AND scr_area_id IN (908))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (82)
		ORDER BY rank DESC
		 
	 [params: {":gp371":"31",":gp372":"30804",":gp373":"30726",":gp374":"105",":gp375":"101",":gp376":"1",":gp377":"1","tripType":"1"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14547.795] [M: 27012.76] [ET: 0.363/14524.744] [MU: 0.83/27012.57] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14548.408] [M: 27015.63] [ET: 0.491/14525.352] [MU: 0.96/27015.32] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"1"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14549.798] [M: 27028.4] [ET: 0.413/14526.743] [MU: 2.05/27027.9] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"82"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14552.607] [M: 27037.78] [ET: 2.506/14529.539] [MU: 3.53/27036.91] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"82","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14553.416] [M: 27041.03] [ET: 0.499/14530.368] [MU: 0.87/27040.81] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":0}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14554.106] [M: 27048.31] [ET: 0.501/14531.07] [MU: 2.97/27047.88] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14554.813] [M: 27076.48] [ET: 0.574/14531.775] [MU: 22.04/27075.86] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp379)) OR (apr_area_type = 2 AND apr_area_id IN (:gp380)) OR (apr_area_type = 4 AND apr_area_id IN (:gp381)) OR (apr_area_type = 1 AND apr_area_id IN (:gp378))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp378":"31",":gp379":"30804",":gp380":"105",":gp381":"1","cab":"82"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14556.04] [M: 27063.2] [ET: 0.573/14532.987] [MU: 3.34/27062.77] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14556.779] [M: 27073.73] [ET: 0.581/14533.726] [MU: 3.65/27072.86] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp383)) OR (scr_area_type = 2 AND scr_area_id IN (:gp384)) OR (scr_area_type = 4 AND scr_area_id IN (:gp385)) OR (scr_area_type = 1 AND scr_area_id IN (:gp382)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp382":"31",":gp383":"30804",":gp384":"105",":gp385":"1","scv_id":"82"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14559.339] [M: 27101.44] [ET: 1.867/14536.259] [MU: 0.74/27093.44] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"nearest_route_30804_30726","sql":"(INDEX indx_nearest_rt_rutid (rut_id)) \r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, routeFrom.rut_name as fromAlias, \r\n\t\t\t\tNULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, \r\n\t\t\t\t0 as rank, routeFrom.rut_estm_time as startTime, 0 as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\tAND route.rut_to_city_id=30726 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 \r\n\t\t\t\tAND routeFrom.rut_from_city_id<>routeFrom.rut_to_city_id AND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\t\tAND (routeAlias.rut_to_city_id=route.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (1967,16216,47825,322451,3087761,3190710)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, NULL, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) \r\n\t\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\t0 AS extraStartDistance, 0, 0 as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND route.rut_from_city_id = 30804 AND route.rut_to_city_id=30726 \r\n\t\t\t\tAND routeTo.rut_from_city_id=30726\r\n\t\t\t\tAND route.rut_active = 1 AND routeTo.rut_active = 1 AND routeTo.rut_estm_distance < 50 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = route.rut_from_city_id) \r\n\t\t\t   AND (routeAlias.rut_to_city_id = routeTo.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (1967,16216,47825,322451,3087761,3190710)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, \r\n\t\t\t\trouteFrom.rut_name, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t+ IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) \r\n\t\t\t\tAS extraDistance, IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, 0, \r\n\t\t\t\trouteFrom.rut_estm_time as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\t\tAND route.rut_to_city_id=30726 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 AND routeFrom.rut_from_city_id <> routeFrom.rut_to_city_id\r\n\t\t\t\t\tAND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND routeTo.rut_estm_distance < 50 \r\n\t\t\t\t\tAND routeTo.rut_from_city_id=30726 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\tAND (routeAlias.rut_to_city_id=routeTo.rut_to_city_id) AND routeAlias.rut_active = 1 AND routeAlias.rut_from_city_id=30804  AND routeAlias.rut_id IN (1967,16216,47825,322451,3087761,3190710)"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14561.916] [M: 27105.55] [ET: 2.441/14538.843] [MU: 2.16/27105.11] 
	SQL: SELECT *, (rte_vendor_amount + extraDistance * 10.55) as totalCost FROM (SELECT * FROM nearest_route_30804_30726) a
					INNER JOIN rate ON a.rut_id = rate.rte_route_id AND rte_status=1 AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <>0
					WHERE 1 ORDER BY rank DESC, totalCost ASC LIMIT 0,1 
	 [params: {"cabType":"82"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14562.692] [M: 27113.57] [ET: 0.618/14539.635] [MU: 0.74/27111.57] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"getNearestRoute_30804_30726_70","sql":"(INDEX getNearestRoute_30804_30726_70_index_rut_id (rut_id))\r\n\t\t\t\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id AS start, routeAlias.rut_to_city_id AS end,\r\n\t\t\t\t\t\t\t\trouteFrom.rut_name AS fromAlias, NULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance AS quotedDistance,\r\n\t\t\t\t\t\t\t\trouteAlias.rut_estm_distance AS rateDistance, \r\n\t\t\t\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance)\r\n\t\t\t\t\t\t\t\t\t - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance,\r\n\t\t\t\t\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance,\r\n\t\t\t\t\t\t\t\t0 AS rank, routeFrom.rut_estm_time AS startTime, 0 AS endTime, route.rut_estm_time, \r\n\t\t\t\t\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraTravelDistance\r\n\t\t\t\t\t\tFROM   route\r\n\t\t\t\t\t\tINNER JOIN route routeTo ON routeTo.rut_to_city_id=route.rut_from_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_from_city_id=30804 AND routeTo.rut_active=1\r\n\t\t\t\t\t\t\t\tAND routeTo.rut_estm_distance<70 AND route.rut_active=1\r\n\t\t\t\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_from_city_id=route.rut_to_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_to_city_id=30726 AND routeFrom.rut_active = 1\r\n\t\t\t\t\t\t\t\tAND routeFrom.rut_estm_distance<70 AND route.rut_active = 1\r\n\t\t\t\t\t\tINNER JOIN route routeAlias ON routeAlias.rut_to_city_id=routeFrom.rut_to_city_id\r\n\t\t\t\t\t\t\tAND routeAlias.rut_from_city_id=routeTo.rut_from_city_id AND routeAlias.rut_active = 1"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14565.457] [M: 27118.84] [ET: 2.656/14542.384] [MU: 2.41/27118.21] 
	SQL: SELECT *, (rte_vendor_amount + extradistance * 10.55 ) AS totalCost, 
						ABS(quotedDistance-rateDistance) AS extraChargeableDistance
					FROM getNearestRoute_30804_30726_70 a
					INNER JOIN rate ON a.rut_id=rate.rte_route_id AND rte_status=1 
						AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <> 0
					WHERE  1
					ORDER  BY rank DESC, extraStartDistance, extraChargeableDistance ASC, totalcost ASC
					LIMIT  0, 1 
	 [params: {"cabType":"82"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14568.449] [M: 27136.07] [ET: 0.494/14545.391] [MU: 5.56/27135.2] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14569.159] [M: 27143.34] [ET: 0.493/14546.121] [MU: 0.9/27143.09] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14570.396] [M: 27153.93] [ET: 0.634/14547.34] [MU: 3.33/27153.49] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14572.766] [M: 27164.48] [ET: 2.195/14549.695] [MU: 3.53/27163.6] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp388)) OR (scr_area_type = 5 AND scr_area_id IN (:gp386)) OR (scr_area_type = 2 AND scr_area_id IN (:gp389)) OR (scr_area_type = 4 AND scr_area_id IN (:gp390)) OR (scr_area_type = 1 AND scr_area_id IN (:gp387)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp386":"908",":gp387":"31",":gp388":"908",":gp389":"105",":gp390":"1","scv_id":"82"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14573.748] [M: 27163.07] [ET: 0.555/14550.691] [MU: 0.9/27162.82] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14574.998] [M: 27175.41] [ET: 0.491/14551.946] [MU: 2.97/27174.98] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14575.593] [M: 27204.59] [ET: 0.474/14552.537] [MU: 22.53/27203.84] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp393)) OR (apr_area_type = 5 AND apr_area_id IN (:gp391)) OR (apr_area_type = 2 AND apr_area_id IN (:gp394)) OR (apr_area_type = 4 AND apr_area_id IN (:gp395)) OR (apr_area_type = 1 AND apr_area_id IN (:gp392))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp391":"908",":gp392":"31",":gp393":"30804",":gp394":"105",":gp395":"1","cab":"82"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14577.321] [M: 27191.6] [ET: 0.593/14554.253] [MU: 3.34/27191.16] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14579.898] [M: 27202.15] [ET: 2.405/14556.826] [MU: 3.54/27201.27] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp398)) OR (scr_area_type = 5 AND scr_area_id IN (:gp396)) OR (scr_area_type = 2 AND scr_area_id IN (:gp399)) OR (scr_area_type = 4 AND scr_area_id IN (:gp400)) OR (scr_area_type = 1 AND scr_area_id IN (:gp397)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp396":"908",":gp397":"31",":gp398":"908",":gp399":"105",":gp400":"1","scv_id":"82"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14581.235] [M: 27206.9] [ET: 0.858/14558.177] [MU: 3.85/27206.02] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14581.989] [M: 27214.71] [ET: 0.615/14558.932] [MU: 4.21/27213.84] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14582.446] [M: 27218.85] [ET: 0.355/14559.398] [MU: 2.97/27218.74] 
	BookingRoute::calculateDistance
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14584.846] [M: 27225.23] [ET: 2.154/14561.783] [MU: 2.4/27224.85] 
	SQL: SELECT *
				FROM   partner_rate prt 
				JOIN route rut ON prt.prt_route_id = rut.rut_id AND rut.rut_active = 1
				AND  rut.rut_from_city_id  = 30804 
				AND  rut.rut_to_city_id  = 30726 
				 WHERE prt_vehicletype_id = 82
				AND prt_partner_id = 1249
				AND prt_status = 1
				 
	 [params: []]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14585.795] [M: 27230.45] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30726","cabType":"3","tripDistance":"","tripDuration":"","multiCityData":"","bookingType":"1","pickupAddress":"","pickupDate":"24\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","sccId":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30726&cabType=3&tripDistance=&tripDuration=&multiCityData=&bookingType=1&pickupAddress=&pickupDate=24%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&sccId=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14586.501] [M: 27247.3] [ET: 1.273/14563.453] [MU: 18.05/27247.19] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14586.563] [M: 27248.98] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14587.64] [M: 27262.44] [ET: 0.894/14564.577] [MU: 2.99/27259.94] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+5845),(IF((cpm_value_type=2),(5845+(5845*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30726 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30726) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-24 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=82 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14589.363] [M: 27304.66] [ET: 4.23/14566.328] [MU: 75.87/27304.51] 
	RouteRates::calculate for CAB 82 2024-10-24 18:00:00 - Trip Type: 1 723641349
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14589.58] [M: 27284.28] [ET: 39.691/14566.546] [MU: 254.46/27284.13] 
	Quote::calculateOneWay  for CAB 82 Date: 2024-10-24 18:00:00
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14589.827] [M: 27279.99] [ET: 0.179/14566.794] [MU: 0.89/27279.74] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"82"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14589.896] [M: 27281.55] [ET: 46.22/14566.867] [MU: 298.75/27281.46] 
	Quote For CabType: 82
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14590.993] [M: 27291.53] [ET: 0.367/14567.958] [MU: 2.97/27291.09] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14591.393] [M: 27297.35] [ET: 0.334/14568.359] [MU: 3.35/27296.91] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14591.936] [M: 27300.29] [ET: 0.472/14568.898] [MU: 0.9/27300.04] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14592.616] [M: 27332.64] [ET: 0.57/14569.576] [MU: 24.22/27331.14] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (101) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30726) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp401)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp404,:gp405)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp402,:gp403)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp406,:gp407))
			OR (scr_area_type = 5 AND scr_area_id IN (908))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (83)
		ORDER BY rank DESC
		 
	 [params: {":gp401":"31",":gp402":"30804",":gp403":"30726",":gp404":"105",":gp405":"101",":gp406":"1",":gp407":"1","tripType":"1"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14593.253] [M: 27312.82] [ET: 0.201/14570.221] [MU: 0.84/27312.63] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14593.617] [M: 27315.7] [ET: 0.278/14570.566] [MU: 0.97/27315.38] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"1"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14594.966] [M: 27328.46] [ET: 0.327/14571.93] [MU: 2.04/27327.96] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"83"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14598.147] [M: 27337.84] [ET: 2.954/14575.072] [MU: 3.53/27336.97] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"83","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14598.971] [M: 27341.09] [ET: 0.51/14575.923] [MU: 0.87/27340.88] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":0}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14599.651] [M: 27348.38] [ET: 0.496/14576.615] [MU: 2.97/27347.94] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14600.28] [M: 27376.55] [ET: 0.481/14577.222] [MU: 22.04/27375.92] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp409)) OR (apr_area_type = 2 AND apr_area_id IN (:gp410)) OR (apr_area_type = 4 AND apr_area_id IN (:gp411)) OR (apr_area_type = 1 AND apr_area_id IN (:gp408))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp408":"31",":gp409":"30804",":gp410":"105",":gp411":"1","cab":"83"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14601.439] [M: 27363.27] [ET: 0.452/14578.404] [MU: 3.34/27362.83] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14603.957] [M: 27373.55] [ET: 2.407/14580.911] [MU: 3.4/27372.67] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp413)) OR (scr_area_type = 2 AND scr_area_id IN (:gp414)) OR (scr_area_type = 4 AND scr_area_id IN (:gp415)) OR (scr_area_type = 1 AND scr_area_id IN (:gp412)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp412":"31",":gp413":"30804",":gp414":"105",":gp415":"1","scv_id":"83"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14606.632] [M: 27401.25] [ET: 1.846/14583.55] [MU: 0.74/27393.25] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"nearest_route_30804_30726","sql":"(INDEX indx_nearest_rt_rutid (rut_id)) \r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, routeFrom.rut_name as fromAlias, \r\n\t\t\t\tNULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, \r\n\t\t\t\t0 as rank, routeFrom.rut_estm_time as startTime, 0 as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\tAND route.rut_to_city_id=30726 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 \r\n\t\t\t\tAND routeFrom.rut_from_city_id<>routeFrom.rut_to_city_id AND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\t\tAND (routeAlias.rut_to_city_id=route.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (1967,16216,47825,322451,3087761,3190710)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, NULL, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) \r\n\t\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\t0 AS extraStartDistance, 0, 0 as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND route.rut_from_city_id = 30804 AND route.rut_to_city_id=30726 \r\n\t\t\t\tAND routeTo.rut_from_city_id=30726\r\n\t\t\t\tAND route.rut_active = 1 AND routeTo.rut_active = 1 AND routeTo.rut_estm_distance < 50 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = route.rut_from_city_id) \r\n\t\t\t   AND (routeAlias.rut_to_city_id = routeTo.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (1967,16216,47825,322451,3087761,3190710)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, \r\n\t\t\t\trouteFrom.rut_name, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t+ IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) \r\n\t\t\t\tAS extraDistance, IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, 0, \r\n\t\t\t\trouteFrom.rut_estm_time as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\t\tAND route.rut_to_city_id=30726 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 AND routeFrom.rut_from_city_id <> routeFrom.rut_to_city_id\r\n\t\t\t\t\tAND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND routeTo.rut_estm_distance < 50 \r\n\t\t\t\t\tAND routeTo.rut_from_city_id=30726 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\tAND (routeAlias.rut_to_city_id=routeTo.rut_to_city_id) AND routeAlias.rut_active = 1 AND routeAlias.rut_from_city_id=30804  AND routeAlias.rut_id IN (1967,16216,47825,322451,3087761,3190710)"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14609.23] [M: 27405.36] [ET: 2.466/14586.183] [MU: 2.16/27404.92] 
	SQL: SELECT *, (rte_vendor_amount + extraDistance * 10.55) as totalCost FROM (SELECT * FROM nearest_route_30804_30726) a
					INNER JOIN rate ON a.rut_id = rate.rte_route_id AND rte_status=1 AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <>0
					WHERE 1 ORDER BY rank DESC, totalCost ASC LIMIT 0,1 
	 [params: {"cabType":"83"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14609.985] [M: 27413.38] [ET: 0.626/14586.927] [MU: 0.75/27411.38] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"getNearestRoute_30804_30726_70","sql":"(INDEX getNearestRoute_30804_30726_70_index_rut_id (rut_id))\r\n\t\t\t\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id AS start, routeAlias.rut_to_city_id AS end,\r\n\t\t\t\t\t\t\t\trouteFrom.rut_name AS fromAlias, NULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance AS quotedDistance,\r\n\t\t\t\t\t\t\t\trouteAlias.rut_estm_distance AS rateDistance, \r\n\t\t\t\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance)\r\n\t\t\t\t\t\t\t\t\t - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance,\r\n\t\t\t\t\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance,\r\n\t\t\t\t\t\t\t\t0 AS rank, routeFrom.rut_estm_time AS startTime, 0 AS endTime, route.rut_estm_time, \r\n\t\t\t\t\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraTravelDistance\r\n\t\t\t\t\t\tFROM   route\r\n\t\t\t\t\t\tINNER JOIN route routeTo ON routeTo.rut_to_city_id=route.rut_from_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_from_city_id=30804 AND routeTo.rut_active=1\r\n\t\t\t\t\t\t\t\tAND routeTo.rut_estm_distance<70 AND route.rut_active=1\r\n\t\t\t\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_from_city_id=route.rut_to_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_to_city_id=30726 AND routeFrom.rut_active = 1\r\n\t\t\t\t\t\t\t\tAND routeFrom.rut_estm_distance<70 AND route.rut_active = 1\r\n\t\t\t\t\t\tINNER JOIN route routeAlias ON routeAlias.rut_to_city_id=routeFrom.rut_to_city_id\r\n\t\t\t\t\t\t\tAND routeAlias.rut_from_city_id=routeTo.rut_from_city_id AND routeAlias.rut_active = 1"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14612.28] [M: 27418.65] [ET: 2.195/14589.219] [MU: 2.42/27418.02] 
	SQL: SELECT *, (rte_vendor_amount + extradistance * 10.55 ) AS totalCost, 
						ABS(quotedDistance-rateDistance) AS extraChargeableDistance
					FROM getNearestRoute_30804_30726_70 a
					INNER JOIN rate ON a.rut_id=rate.rte_route_id AND rte_status=1 
						AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <> 0
					WHERE  1
					ORDER  BY rank DESC, extraStartDistance, extraChargeableDistance ASC, totalcost ASC
					LIMIT  0, 1 
	 [params: {"cabType":"83"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14616.074] [M: 27435.52] [ET: 0.649/14593.002] [MU: 5.19/27434.64] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14616.891] [M: 27442.78] [ET: 0.487/14593.836] [MU: 0.89/27442.53] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14618.168] [M: 27453.38] [ET: 0.584/14595.109] [MU: 3.34/27452.94] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14620.496] [M: 27463.92] [ET: 2.154/14597.428] [MU: 3.53/27463.05] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp418)) OR (scr_area_type = 5 AND scr_area_id IN (:gp416)) OR (scr_area_type = 2 AND scr_area_id IN (:gp419)) OR (scr_area_type = 4 AND scr_area_id IN (:gp420)) OR (scr_area_type = 1 AND scr_area_id IN (:gp417)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp416":"908",":gp417":"31",":gp418":"908",":gp419":"105",":gp420":"1","scv_id":"83"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14621.412] [M: 27462.52] [ET: 0.523/14598.37] [MU: 0.9/27462.27] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14622.546] [M: 27474.86] [ET: 0.524/14599.494] [MU: 2.96/27474.42] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14623.153] [M: 27504.03] [ET: 0.483/14600.095] [MU: 22.53/27503.28] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp423)) OR (apr_area_type = 5 AND apr_area_id IN (:gp421)) OR (apr_area_type = 2 AND apr_area_id IN (:gp424)) OR (apr_area_type = 4 AND apr_area_id IN (:gp425)) OR (apr_area_type = 1 AND apr_area_id IN (:gp422))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp421":"908",":gp422":"31",":gp423":"30804",":gp424":"105",":gp425":"1","cab":"83"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14624.717] [M: 27491.05] [ET: 0.472/14601.666] [MU: 3.33/27490.61] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14626.761] [M: 27501.59] [ET: 1.925/14603.714] [MU: 3.53/27500.72] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp428)) OR (scr_area_type = 5 AND scr_area_id IN (:gp426)) OR (scr_area_type = 2 AND scr_area_id IN (:gp429)) OR (scr_area_type = 4 AND scr_area_id IN (:gp430)) OR (scr_area_type = 1 AND scr_area_id IN (:gp427)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp426":"908",":gp427":"31",":gp428":"908",":gp429":"105",":gp430":"1","scv_id":"83"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14627.681] [M: 27506.34] [ET: 0.596/14604.622] [MU: 3.84/27505.47] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14628.17] [M: 27514.16] [ET: 0.392/14605.132] [MU: 4.21/27513.28] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14628.461] [M: 27518.3] [ET: 0.224/14605.428] [MU: 2.98/27518.19] 
	BookingRoute::calculateDistance
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14631.104] [M: 27524.58] [ET: 2.464/14608.037] [MU: 2.41/27524.2] 
	SQL: SELECT *
				FROM   partner_rate prt 
				JOIN route rut ON prt.prt_route_id = rut.rut_id AND rut.rut_active = 1
				AND  rut.rut_from_city_id  = 30804 
				AND  rut.rut_to_city_id  = 30726 
				 WHERE prt_vehicletype_id = 83
				AND prt_partner_id = 1249
				AND prt_status = 1
				 
	 [params: []]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14631.921] [M: 27529.8] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30726","cabType":"3","tripDistance":"","tripDuration":"","multiCityData":"","bookingType":"1","pickupAddress":"","pickupDate":"24\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","sccId":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30726&cabType=3&tripDistance=&tripDuration=&multiCityData=&bookingType=1&pickupAddress=&pickupDate=24%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&sccId=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14632.398] [M: 27674.66] [ET: 0.938/14609.362] [MU: 146.05/27674.54] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14632.442] [M: 27676.33] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14633.586] [M: 27689.79] [ET: 1.008/14610.526] [MU: 2.99/27687.29] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+5845),(IF((cpm_value_type=2),(5845+(5845*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30726 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30726) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-24 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=83 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14634.991] [M: 27732.02] [ET: 3.594/14611.956] [MU: 203.87/27731.86] 
	RouteRates::calculate for CAB 83 2024-10-24 18:00:00 - Trip Type: 1 316859976
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14635.209] [M: 27711.63] [ET: 40.174/14612.169] [MU: 381.75/27711.48] 
	Quote::calculateOneWay  for CAB 83 Date: 2024-10-24 18:00:00
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14635.47] [M: 27707.44] [ET: 0.192/14612.437] [MU: 0.9/27707.19] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"83"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14635.539] [M: 27709] [ET: 45.594/14612.51] [MU: 426.14/27708.91] 
	Quote For CabType: 83
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14636.631] [M: 27718.98] [ET: 0.383/14613.597] [MU: 2.97/27718.54] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14637.032] [M: 27724.8] [ET: 0.332/14613.998] [MU: 3.34/27724.36] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14637.615] [M: 27727.73] [ET: 0.498/14614.557] [MU: 0.9/27727.48] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14638.294] [M: 27760.09] [ET: 0.531/14615.249] [MU: 24.22/27758.59] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (101) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30726) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp431)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp434,:gp435)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp432,:gp433)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp436,:gp437))
			OR (scr_area_type = 5 AND scr_area_id IN (908))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (84)
		ORDER BY rank DESC
		 
	 [params: {":gp431":"31",":gp432":"30804",":gp433":"30726",":gp434":"105",":gp435":"101",":gp436":"1",":gp437":"1","tripType":"1"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14638.941] [M: 27740.27] [ET: 0.196/14615.907] [MU: 0.84/27740.08] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14639.293] [M: 27743.14] [ET: 0.269/14616.242] [MU: 0.96/27742.83] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"1"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14640.646] [M: 27755.91] [ET: 0.335/14617.61] [MU: 2.05/27755.41] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"84"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14643.204] [M: 27765.29] [ET: 2.351/14620.154] [MU: 3.53/27764.41] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"84","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14644.041] [M: 27768.54] [ET: 0.6/14620.993] [MU: 0.86/27768.32] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":0}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14644.728] [M: 27775.82] [ET: 0.492/14621.693] [MU: 2.97/27775.38] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14645.376] [M: 27803.99] [ET: 0.51/14622.34] [MU: 22.05/27803.37] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp439)) OR (apr_area_type = 2 AND apr_area_id IN (:gp440)) OR (apr_area_type = 4 AND apr_area_id IN (:gp441)) OR (apr_area_type = 1 AND apr_area_id IN (:gp438))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp438":"31",":gp439":"30804",":gp440":"105",":gp441":"1","cab":"84"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14646.387] [M: 27790.71] [ET: 0.467/14623.35] [MU: 3.34/27790.27] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14649.143] [M: 27800.99] [ET: 2.631/14626.079] [MU: 3.41/27800.12] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp443)) OR (scr_area_type = 2 AND scr_area_id IN (:gp444)) OR (scr_area_type = 4 AND scr_area_id IN (:gp445)) OR (scr_area_type = 1 AND scr_area_id IN (:gp442)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp442":"31",":gp443":"30804",":gp444":"105",":gp445":"1","scv_id":"84"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14652.379] [M: 27828.7] [ET: 2.434/14629.316] [MU: 0.74/27820.7] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"nearest_route_30804_30726","sql":"(INDEX indx_nearest_rt_rutid (rut_id)) \r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, routeFrom.rut_name as fromAlias, \r\n\t\t\t\tNULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, \r\n\t\t\t\t0 as rank, routeFrom.rut_estm_time as startTime, 0 as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\tAND route.rut_to_city_id=30726 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 \r\n\t\t\t\tAND routeFrom.rut_from_city_id<>routeFrom.rut_to_city_id AND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\t\tAND (routeAlias.rut_to_city_id=route.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (1967,16216,47825,322451,3087761,3190710)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, NULL, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) \r\n\t\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\t0 AS extraStartDistance, 0, 0 as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND route.rut_from_city_id = 30804 AND route.rut_to_city_id=30726 \r\n\t\t\t\tAND routeTo.rut_from_city_id=30726\r\n\t\t\t\tAND route.rut_active = 1 AND routeTo.rut_active = 1 AND routeTo.rut_estm_distance < 50 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = route.rut_from_city_id) \r\n\t\t\t   AND (routeAlias.rut_to_city_id = routeTo.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (1967,16216,47825,322451,3087761,3190710)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, \r\n\t\t\t\trouteFrom.rut_name, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t+ IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) \r\n\t\t\t\tAS extraDistance, IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, 0, \r\n\t\t\t\trouteFrom.rut_estm_time as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\t\tAND route.rut_to_city_id=30726 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 AND routeFrom.rut_from_city_id <> routeFrom.rut_to_city_id\r\n\t\t\t\t\tAND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND routeTo.rut_estm_distance < 50 \r\n\t\t\t\t\tAND routeTo.rut_from_city_id=30726 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\tAND (routeAlias.rut_to_city_id=routeTo.rut_to_city_id) AND routeAlias.rut_active = 1 AND routeAlias.rut_from_city_id=30804  AND routeAlias.rut_id IN (1967,16216,47825,322451,3087761,3190710)"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14654.69] [M: 27832.8] [ET: 2.196/14631.625] [MU: 2.16/27832.37] 
	SQL: SELECT *, (rte_vendor_amount + extraDistance * 10.55) as totalCost FROM (SELECT * FROM nearest_route_30804_30726) a
					INNER JOIN rate ON a.rut_id = rate.rte_route_id AND rte_status=1 AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <>0
					WHERE 1 ORDER BY rank DESC, totalCost ASC LIMIT 0,1 
	 [params: {"cabType":"84"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14655.625] [M: 27840.83] [ET: 0.759/14632.55] [MU: 0.74/27838.83] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"getNearestRoute_30804_30726_70","sql":"(INDEX getNearestRoute_30804_30726_70_index_rut_id (rut_id))\r\n\t\t\t\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id AS start, routeAlias.rut_to_city_id AS end,\r\n\t\t\t\t\t\t\t\trouteFrom.rut_name AS fromAlias, NULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance AS quotedDistance,\r\n\t\t\t\t\t\t\t\trouteAlias.rut_estm_distance AS rateDistance, \r\n\t\t\t\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance)\r\n\t\t\t\t\t\t\t\t\t - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance,\r\n\t\t\t\t\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance,\r\n\t\t\t\t\t\t\t\t0 AS rank, routeFrom.rut_estm_time AS startTime, 0 AS endTime, route.rut_estm_time, \r\n\t\t\t\t\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraTravelDistance\r\n\t\t\t\t\t\tFROM   route\r\n\t\t\t\t\t\tINNER JOIN route routeTo ON routeTo.rut_to_city_id=route.rut_from_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_from_city_id=30804 AND routeTo.rut_active=1\r\n\t\t\t\t\t\t\t\tAND routeTo.rut_estm_distance<70 AND route.rut_active=1\r\n\t\t\t\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_from_city_id=route.rut_to_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_to_city_id=30726 AND routeFrom.rut_active = 1\r\n\t\t\t\t\t\t\t\tAND routeFrom.rut_estm_distance<70 AND route.rut_active = 1\r\n\t\t\t\t\t\tINNER JOIN route routeAlias ON routeAlias.rut_to_city_id=routeFrom.rut_to_city_id\r\n\t\t\t\t\t\t\tAND routeAlias.rut_from_city_id=routeTo.rut_from_city_id AND routeAlias.rut_active = 1"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14658.063] [M: 27846.09] [ET: 2.318/14635.002] [MU: 2.41/27845.47] 
	SQL: SELECT *, (rte_vendor_amount + extradistance * 10.55 ) AS totalCost, 
						ABS(quotedDistance-rateDistance) AS extraChargeableDistance
					FROM getNearestRoute_30804_30726_70 a
					INNER JOIN rate ON a.rut_id=rate.rte_route_id AND rte_status=1 
						AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <> 0
					WHERE  1
					ORDER  BY rank DESC, extraStartDistance, extraChargeableDistance ASC, totalcost ASC
					LIMIT  0, 1 
	 [params: {"cabType":"84"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14661.248] [M: 27862.96] [ET: 0.495/14638.196] [MU: 5.2/27862.09] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14662.04] [M: 27870.2] [ET: 0.542/14639] [MU: 0.9/27869.98] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14663.059] [M: 27880.82] [ET: 0.503/14640.021] [MU: 3.34/27880.38] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14667.665] [M: 27891.37] [ET: 4.487/14644.614] [MU: 3.53/27890.49] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp448)) OR (scr_area_type = 5 AND scr_area_id IN (:gp446)) OR (scr_area_type = 2 AND scr_area_id IN (:gp449)) OR (scr_area_type = 4 AND scr_area_id IN (:gp450)) OR (scr_area_type = 1 AND scr_area_id IN (:gp447)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp446":"908",":gp447":"31",":gp448":"908",":gp449":"105",":gp450":"1","scv_id":"84"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14668.598] [M: 27889.96] [ET: 0.559/14645.559] [MU: 0.89/27889.71] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14669.927] [M: 27902.3] [ET: 0.622/14646.872] [MU: 2.97/27901.87] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14670.526] [M: 27931.48] [ET: 0.475/14647.469] [MU: 22.53/27930.73] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp453)) OR (apr_area_type = 5 AND apr_area_id IN (:gp451)) OR (apr_area_type = 2 AND apr_area_id IN (:gp454)) OR (apr_area_type = 4 AND apr_area_id IN (:gp455)) OR (apr_area_type = 1 AND apr_area_id IN (:gp452))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp451":"908",":gp452":"31",":gp453":"30804",":gp454":"105",":gp455":"1","cab":"84"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14672.172] [M: 27918.49] [ET: 0.48/14649.121] [MU: 3.34/27918.05] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14674.443] [M: 27929.04] [ET: 2.141/14651.375] [MU: 3.53/27928.16] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp458)) OR (scr_area_type = 5 AND scr_area_id IN (:gp456)) OR (scr_area_type = 2 AND scr_area_id IN (:gp459)) OR (scr_area_type = 4 AND scr_area_id IN (:gp460)) OR (scr_area_type = 1 AND scr_area_id IN (:gp457)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp456":"908",":gp457":"31",":gp458":"908",":gp459":"105",":gp460":"1","scv_id":"84"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14675.507] [M: 27933.79] [ET: 0.629/14652.452] [MU: 3.85/27932.91] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14676.079] [M: 27941.6] [ET: 0.449/14653.026] [MU: 4.21/27940.73] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14676.555] [M: 27945.74] [ET: 0.38/14653.508] [MU: 2.98/27945.63] 
	BookingRoute::calculateDistance
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14679.129] [M: 27952.02] [ET: 2.345/14656.084] [MU: 2.41/27951.65] 
	SQL: SELECT *
				FROM   partner_rate prt 
				JOIN route rut ON prt.prt_route_id = rut.rut_id AND rut.rut_active = 1
				AND  rut.rut_from_city_id  = 30804 
				AND  rut.rut_to_city_id  = 30726 
				 WHERE prt_vehicletype_id = 84
				AND prt_partner_id = 1249
				AND prt_status = 1
				 
	 [params: []]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14679.998] [M: 27957.25] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30726","cabType":"3","tripDistance":"","tripDuration":"","multiCityData":"","bookingType":"1","pickupAddress":"","pickupDate":"24\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","sccId":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30726&cabType=3&tripDistance=&tripDuration=&multiCityData=&bookingType=1&pickupAddress=&pickupDate=24%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&sccId=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14680.587] [M: 27974.09] [ET: 1.083/14657.487] [MU: 18.05/27973.98] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14680.703] [M: 27975.77] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14681.847] [M: 27989.23] [ET: 0.93/14658.782] [MU: 3/27986.73] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+5845),(IF((cpm_value_type=2),(5845+(5845*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30726 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30726) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-24 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=84 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14683.335] [M: 28031.46] [ET: 3.946/14660.299] [MU: 75.88/28031.3] 
	RouteRates::calculate for CAB 84 2024-10-24 18:00:00 - Trip Type: 1 988951569
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14683.546] [M: 28011.08] [ET: 42.833/14660.515] [MU: 253.75/28010.92] 
	Quote::calculateOneWay  for CAB 84 Date: 2024-10-24 18:00:00
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14683.787] [M: 28006.88] [ET: 0.173/14660.754] [MU: 0.9/28006.63] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"84"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14683.856] [M: 28008.45] [ET: 48.269/14660.827] [MU: 298.14/28008.35] 
	Quote For CabType: 84
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14684.904] [M: 28018.42] [ET: 0.351/14661.869] [MU: 2.97/28017.98] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14685.293] [M: 28024.24] [ET: 0.322/14662.259] [MU: 3.35/28023.8] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14685.843] [M: 28027.18] [ET: 0.48/14662.808] [MU: 0.9/28026.93] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14686.441] [M: 28059.53] [ET: 0.48/14663.382] [MU: 24.21/28058.03] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (101) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30726) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp461)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp464,:gp465)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp462,:gp463)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp466,:gp467))
			OR (scr_area_type = 5 AND scr_area_id IN (908))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (93)
		ORDER BY rank DESC
		 
	 [params: {":gp461":"31",":gp462":"30804",":gp463":"30726",":gp464":"105",":gp465":"101",":gp466":"1",":gp467":"1","tripType":"1"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14687.248] [M: 28039.72] [ET: 0.209/14664.207] [MU: 0.83/28039.53] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14687.614] [M: 28042.59] [ET: 0.277/14664.559] [MU: 0.96/28042.28] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"2"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14689.024] [M: 28055.34] [ET: 0.361/14665.986] [MU: 2.05/28054.84] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"93"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14691.715] [M: 28064.73] [ET: 2.476/14668.668] [MU: 3.53/28063.85] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"93","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14692.563] [M: 28067.98] [ET: 0.597/14669.508] [MU: 0.87/28067.76] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":0}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14693.226] [M: 28075.26] [ET: 0.474/14670.191] [MU: 2.97/28074.82] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14693.913] [M: 28103.43] [ET: 0.551/14670.876] [MU: 22.05/28102.8] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp469)) OR (apr_area_type = 2 AND apr_area_id IN (:gp470)) OR (apr_area_type = 4 AND apr_area_id IN (:gp471)) OR (apr_area_type = 1 AND apr_area_id IN (:gp468))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp468":"31",":gp469":"30804",":gp470":"105",":gp471":"1","cab":"93"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14694.866] [M: 28090.16] [ET: 0.42/14671.831] [MU: 3.33/28089.72] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14697.421] [M: 28100.44] [ET: 2.433/14674.356] [MU: 3.41/28099.56] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp473)) OR (scr_area_type = 2 AND scr_area_id IN (:gp474)) OR (scr_area_type = 4 AND scr_area_id IN (:gp475)) OR (scr_area_type = 1 AND scr_area_id IN (:gp472)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp472":"31",":gp473":"30804",":gp474":"105",":gp475":"1","scv_id":"93"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14700.18] [M: 28128.13] [ET: 1.823/14677.1] [MU: 0.75/28120.13] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"nearest_route_30804_30726","sql":"(INDEX indx_nearest_rt_rutid (rut_id)) \r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, routeFrom.rut_name as fromAlias, \r\n\t\t\t\tNULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, \r\n\t\t\t\t0 as rank, routeFrom.rut_estm_time as startTime, 0 as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\tAND route.rut_to_city_id=30726 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 \r\n\t\t\t\tAND routeFrom.rut_from_city_id<>routeFrom.rut_to_city_id AND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\t\tAND (routeAlias.rut_to_city_id=route.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (1967,16216,47825,322451,3087761,3190710)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, NULL, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) \r\n\t\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\t0 AS extraStartDistance, 0, 0 as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND route.rut_from_city_id = 30804 AND route.rut_to_city_id=30726 \r\n\t\t\t\tAND routeTo.rut_from_city_id=30726\r\n\t\t\t\tAND route.rut_active = 1 AND routeTo.rut_active = 1 AND routeTo.rut_estm_distance < 50 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = route.rut_from_city_id) \r\n\t\t\t   AND (routeAlias.rut_to_city_id = routeTo.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (1967,16216,47825,322451,3087761,3190710)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, \r\n\t\t\t\trouteFrom.rut_name, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t+ IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) \r\n\t\t\t\tAS extraDistance, IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, 0, \r\n\t\t\t\trouteFrom.rut_estm_time as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\t\tAND route.rut_to_city_id=30726 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 AND routeFrom.rut_from_city_id <> routeFrom.rut_to_city_id\r\n\t\t\t\t\tAND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND routeTo.rut_estm_distance < 50 \r\n\t\t\t\t\tAND routeTo.rut_from_city_id=30726 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\tAND (routeAlias.rut_to_city_id=routeTo.rut_to_city_id) AND routeAlias.rut_active = 1 AND routeAlias.rut_from_city_id=30804  AND routeAlias.rut_id IN (1967,16216,47825,322451,3087761,3190710)"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14702.722] [M: 28132.24] [ET: 2.402/14679.656] [MU: 2.17/28131.8] 
	SQL: SELECT *, (rte_vendor_amount + extraDistance * 10.55) as totalCost FROM (SELECT * FROM nearest_route_30804_30726) a
					INNER JOIN rate ON a.rut_id = rate.rte_route_id AND rte_status=1 AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <>0
					WHERE 1 ORDER BY rank DESC, totalCost ASC LIMIT 0,1 
	 [params: {"cabType":"93"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14703.616] [M: 28140.27] [ET: 0.723/14680.542] [MU: 0.74/28138.27] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"getNearestRoute_30804_30726_70","sql":"(INDEX getNearestRoute_30804_30726_70_index_rut_id (rut_id))\r\n\t\t\t\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id AS start, routeAlias.rut_to_city_id AS end,\r\n\t\t\t\t\t\t\t\trouteFrom.rut_name AS fromAlias, NULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance AS quotedDistance,\r\n\t\t\t\t\t\t\t\trouteAlias.rut_estm_distance AS rateDistance, \r\n\t\t\t\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance)\r\n\t\t\t\t\t\t\t\t\t - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance,\r\n\t\t\t\t\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance,\r\n\t\t\t\t\t\t\t\t0 AS rank, routeFrom.rut_estm_time AS startTime, 0 AS endTime, route.rut_estm_time, \r\n\t\t\t\t\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraTravelDistance\r\n\t\t\t\t\t\tFROM   route\r\n\t\t\t\t\t\tINNER JOIN route routeTo ON routeTo.rut_to_city_id=route.rut_from_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_from_city_id=30804 AND routeTo.rut_active=1\r\n\t\t\t\t\t\t\t\tAND routeTo.rut_estm_distance<70 AND route.rut_active=1\r\n\t\t\t\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_from_city_id=route.rut_to_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_to_city_id=30726 AND routeFrom.rut_active = 1\r\n\t\t\t\t\t\t\t\tAND routeFrom.rut_estm_distance<70 AND route.rut_active = 1\r\n\t\t\t\t\t\tINNER JOIN route routeAlias ON routeAlias.rut_to_city_id=routeFrom.rut_to_city_id\r\n\t\t\t\t\t\t\tAND routeAlias.rut_from_city_id=routeTo.rut_from_city_id AND routeAlias.rut_active = 1"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14706.064] [M: 28145.53] [ET: 2.312/14682.983] [MU: 2.42/28144.91] 
	SQL: SELECT *, (rte_vendor_amount + extradistance * 10.55 ) AS totalCost, 
						ABS(quotedDistance-rateDistance) AS extraChargeableDistance
					FROM getNearestRoute_30804_30726_70 a
					INNER JOIN rate ON a.rut_id=rate.rte_route_id AND rte_status=1 
						AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <> 0
					WHERE  1
					ORDER  BY rank DESC, extraStartDistance, extraChargeableDistance ASC, totalcost ASC
					LIMIT  0, 1 
	 [params: {"cabType":"93"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14708.838] [M: 28160.63] [ET: 0.518/14685.783] [MU: 3.41/28159.75] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"16","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14710.361] [M: 28179.02] [ET: 0.441/14687.324] [MU: 5.56/28178.15] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14711.104] [M: 28186.29] [ET: 0.498/14688.06] [MU: 0.9/28186.04] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14712.093] [M: 28196.88] [ET: 0.469/14689.049] [MU: 3.34/28196.45] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14714.888] [M: 28207.43] [ET: 2.659/14691.799] [MU: 3.53/28206.55] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp478)) OR (scr_area_type = 5 AND scr_area_id IN (:gp476)) OR (scr_area_type = 2 AND scr_area_id IN (:gp479)) OR (scr_area_type = 4 AND scr_area_id IN (:gp480)) OR (scr_area_type = 1 AND scr_area_id IN (:gp477)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp476":"908",":gp477":"31",":gp478":"908",":gp479":"105",":gp480":"1","scv_id":"16"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14716.191] [M: 28208.01] [ET: 0.683/14693.135] [MU: 0.9/28207.76] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14717.247] [M: 28218.23] [ET: 0.486/14694.208] [MU: 2.97/28217.8] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14719.581] [M: 28228.78] [ET: 2.203/14696.523] [MU: 3.53/28227.91] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp483)) OR (scr_area_type = 5 AND scr_area_id IN (:gp481)) OR (scr_area_type = 2 AND scr_area_id IN (:gp484)) OR (scr_area_type = 4 AND scr_area_id IN (:gp485)) OR (scr_area_type = 1 AND scr_area_id IN (:gp482)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp481":"908",":gp482":"31",":gp483":"908",":gp484":"105",":gp485":"1","scv_id":"93"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14720.41] [M: 28227.37] [ET: 0.517/14697.344] [MU: 0.9/28227.12] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14721.578] [M: 28239.71] [ET: 0.481/14698.526] [MU: 2.97/28239.27] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14722.24] [M: 28268.88] [ET: 0.553/14699.198] [MU: 22.54/28268.13] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp488)) OR (apr_area_type = 5 AND apr_area_id IN (:gp486)) OR (apr_area_type = 2 AND apr_area_id IN (:gp489)) OR (apr_area_type = 4 AND apr_area_id IN (:gp490)) OR (apr_area_type = 1 AND apr_area_id IN (:gp487))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp486":"908",":gp487":"31",":gp488":"30804",":gp489":"105",":gp490":"1","cab":"93"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14723.648] [M: 28255.91] [ET: 0.483/14700.598] [MU: 3.33/28255.47] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14726.141] [M: 28266.45] [ET: 2.367/14703.073] [MU: 3.53/28265.58] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp493)) OR (scr_area_type = 5 AND scr_area_id IN (:gp491)) OR (scr_area_type = 2 AND scr_area_id IN (:gp494)) OR (scr_area_type = 4 AND scr_area_id IN (:gp495)) OR (scr_area_type = 1 AND scr_area_id IN (:gp492)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp491":"908",":gp492":"31",":gp493":"908",":gp494":"105",":gp495":"1","scv_id":"93"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14727.124] [M: 28271.2] [ET: 0.557/14704.085] [MU: 3.84/28270.32] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14727.596] [M: 28279.01] [ET: 0.387/14704.56] [MU: 4.22/28278.13] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14727.881] [M: 28283.15] [ET: 0.22/14704.851] [MU: 2.97/28283.04] 
	BookingRoute::calculateDistance
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14730.156] [M: 28289.43] [ET: 2.097/14707.093] [MU: 2.41/28289.05] 
	SQL: SELECT *
				FROM   partner_rate prt 
				JOIN route rut ON prt.prt_route_id = rut.rut_id AND rut.rut_active = 1
				AND  rut.rut_from_city_id  = 30804 
				AND  rut.rut_to_city_id  = 30726 
				 WHERE prt_vehicletype_id = 93
				AND prt_partner_id = 1249
				AND prt_status = 1
				 
	 [params: []]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14731.268] [M: 28294.66] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30726","cabType":"3","tripDistance":"","tripDuration":"","multiCityData":"","bookingType":"1","pickupAddress":"","pickupDate":"24\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","sccId":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30726&cabType=3&tripDistance=&tripDuration=&multiCityData=&bookingType=1&pickupAddress=&pickupDate=24%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&sccId=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14731.779] [M: 28311.5] [ET: 1.126/14708.746] [MU: 18.04/28311.39] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14731.821] [M: 28313.18] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14732.861] [M: 28326.64] [ET: 0.872/14709.772] [MU: 2.99/28324.14] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+5845),(IF((cpm_value_type=2),(5845+(5845*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30726 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30726) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-24 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=93 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14734.505] [M: 28368.87] [ET: 3.959/14711.468] [MU: 75.87/28368.71] 
	RouteRates::calculate for CAB 93 2024-10-24 18:00:00 - Trip Type: 1 363644185
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14734.722] [M: 28348.48] [ET: 45.632/14711.693] [MU: 291.72/28348.33] 
	Quote::calculateOneWay  for CAB 93 Date: 2024-10-24 18:00:00
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14734.997] [M: 28344.3] [ET: 0.195/14711.942] [MU: 0.9/28344.05] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"93"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14735.109] [M: 28345.86] [ET: 51.19/14712.062] [MU: 336.11/28345.77] 
	Quote For CabType: 93
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14736.475] [M: 28355.84] [ET: 0.473/14713.424] [MU: 2.97/28355.4] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14736.993] [M: 28361.66] [ET: 0.416/14713.944] [MU: 3.34/28361.22] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14737.588] [M: 28364.59] [ET: 0.506/14714.552] [MU: 0.9/28364.34] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14738.176] [M: 28396.95] [ET: 0.466/14715.121] [MU: 24.22/28395.45] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (101) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30726) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp496)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp499,:gp500)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp497,:gp498)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp501,:gp502))
			OR (scr_area_type = 5 AND scr_area_id IN (908))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (96)
		ORDER BY rank DESC
		 
	 [params: {":gp496":"31",":gp497":"30804",":gp498":"30726",":gp499":"105",":gp500":"101",":gp501":"1",":gp502":"1","tripType":"1"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14738.934] [M: 28377.13] [ET: 0.191/14715.9] [MU: 0.84/28376.94] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14739.268] [M: 28380] [ET: 0.257/14716.235] [MU: 0.96/28379.69] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"2"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14740.466] [M: 28392.75] [ET: 0.381/14717.428] [MU: 2.04/28392.25] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"96"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14743.068] [M: 28402.13] [ET: 2.388/14720.019] [MU: 3.53/28401.26] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"96","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14743.924] [M: 28405.38] [ET: 0.606/14720.859] [MU: 0.87/28405.16] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":0}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14744.6] [M: 28412.66] [ET: 0.489/14721.565] [MU: 2.97/28412.23] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14745.3] [M: 28440.84] [ET: 0.567/14722.262] [MU: 22.04/28440.21] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp504)) OR (apr_area_type = 2 AND apr_area_id IN (:gp505)) OR (apr_area_type = 4 AND apr_area_id IN (:gp506)) OR (apr_area_type = 1 AND apr_area_id IN (:gp503))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp503":"31",":gp504":"30804",":gp505":"105",":gp506":"1","cab":"96"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14746.266] [M: 28427.55] [ET: 0.426/14723.231] [MU: 3.34/28427.12] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14748.958] [M: 28437.84] [ET: 2.571/14725.894] [MU: 3.4/28436.96] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp508)) OR (scr_area_type = 2 AND scr_area_id IN (:gp509)) OR (scr_area_type = 4 AND scr_area_id IN (:gp510)) OR (scr_area_type = 1 AND scr_area_id IN (:gp507)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp507":"31",":gp508":"30804",":gp509":"105",":gp510":"1","scv_id":"96"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14751.705] [M: 28465.54] [ET: 1.797/14728.642] [MU: 0.74/28457.54] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"nearest_route_30804_30726","sql":"(INDEX indx_nearest_rt_rutid (rut_id)) \r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, routeFrom.rut_name as fromAlias, \r\n\t\t\t\tNULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, \r\n\t\t\t\t0 as rank, routeFrom.rut_estm_time as startTime, 0 as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\tAND route.rut_to_city_id=30726 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 \r\n\t\t\t\tAND routeFrom.rut_from_city_id<>routeFrom.rut_to_city_id AND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\t\tAND (routeAlias.rut_to_city_id=route.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (1967,16216,47825,322451,3087761,3190710)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, NULL, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) \r\n\t\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\t0 AS extraStartDistance, 0, 0 as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND route.rut_from_city_id = 30804 AND route.rut_to_city_id=30726 \r\n\t\t\t\tAND routeTo.rut_from_city_id=30726\r\n\t\t\t\tAND route.rut_active = 1 AND routeTo.rut_active = 1 AND routeTo.rut_estm_distance < 50 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = route.rut_from_city_id) \r\n\t\t\t   AND (routeAlias.rut_to_city_id = routeTo.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (1967,16216,47825,322451,3087761,3190710)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, \r\n\t\t\t\trouteFrom.rut_name, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t+ IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) \r\n\t\t\t\tAS extraDistance, IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, 0, \r\n\t\t\t\trouteFrom.rut_estm_time as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\t\tAND route.rut_to_city_id=30726 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 AND routeFrom.rut_from_city_id <> routeFrom.rut_to_city_id\r\n\t\t\t\t\tAND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND routeTo.rut_estm_distance < 50 \r\n\t\t\t\t\tAND routeTo.rut_from_city_id=30726 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\tAND (routeAlias.rut_to_city_id=routeTo.rut_to_city_id) AND routeAlias.rut_active = 1 AND routeAlias.rut_from_city_id=30804  AND routeAlias.rut_id IN (1967,16216,47825,322451,3087761,3190710)"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14754.102] [M: 28469.65] [ET: 2.283/14731.036] [MU: 2.16/28469.21] 
	SQL: SELECT *, (rte_vendor_amount + extraDistance * 10.55) as totalCost FROM (SELECT * FROM nearest_route_30804_30726) a
					INNER JOIN rate ON a.rut_id = rate.rte_route_id AND rte_status=1 AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <>0
					WHERE 1 ORDER BY rank DESC, totalCost ASC LIMIT 0,1 
	 [params: {"cabType":"96"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14754.88] [M: 28477.67] [ET: 0.61/14731.825] [MU: 0.74/28475.67] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"getNearestRoute_30804_30726_70","sql":"(INDEX getNearestRoute_30804_30726_70_index_rut_id (rut_id))\r\n\t\t\t\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id AS start, routeAlias.rut_to_city_id AS end,\r\n\t\t\t\t\t\t\t\trouteFrom.rut_name AS fromAlias, NULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance AS quotedDistance,\r\n\t\t\t\t\t\t\t\trouteAlias.rut_estm_distance AS rateDistance, \r\n\t\t\t\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance)\r\n\t\t\t\t\t\t\t\t\t - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance,\r\n\t\t\t\t\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance,\r\n\t\t\t\t\t\t\t\t0 AS rank, routeFrom.rut_estm_time AS startTime, 0 AS endTime, route.rut_estm_time, \r\n\t\t\t\t\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraTravelDistance\r\n\t\t\t\t\t\tFROM   route\r\n\t\t\t\t\t\tINNER JOIN route routeTo ON routeTo.rut_to_city_id=route.rut_from_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_from_city_id=30804 AND routeTo.rut_active=1\r\n\t\t\t\t\t\t\t\tAND routeTo.rut_estm_distance<70 AND route.rut_active=1\r\n\t\t\t\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_from_city_id=route.rut_to_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_to_city_id=30726 AND routeFrom.rut_active = 1\r\n\t\t\t\t\t\t\t\tAND routeFrom.rut_estm_distance<70 AND route.rut_active = 1\r\n\t\t\t\t\t\tINNER JOIN route routeAlias ON routeAlias.rut_to_city_id=routeFrom.rut_to_city_id\r\n\t\t\t\t\t\t\tAND routeAlias.rut_from_city_id=routeTo.rut_from_city_id AND routeAlias.rut_active = 1"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14757.103] [M: 28482.94] [ET: 2.125/14734.041] [MU: 2.42/28482.31] 
	SQL: SELECT *, (rte_vendor_amount + extradistance * 10.55 ) AS totalCost, 
						ABS(quotedDistance-rateDistance) AS extraChargeableDistance
					FROM getNearestRoute_30804_30726_70 a
					INNER JOIN rate ON a.rut_id=rate.rte_route_id AND rte_status=1 
						AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <> 0
					WHERE  1
					ORDER  BY rank DESC, extraStartDistance, extraChargeableDistance ASC, totalcost ASC
					LIMIT  0, 1 
	 [params: {"cabType":"96"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14760.336] [M: 28498.02] [ET: 0.495/14737.282] [MU: 3.41/28497.15] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"16","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14761.795] [M: 28516.42] [ET: 0.433/14738.756] [MU: 5.56/28515.55] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14762.577] [M: 28523.69] [ET: 0.533/14739.528] [MU: 0.9/28523.44] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14764.019] [M: 28534.28] [ET: 0.804/14740.93] [MU: 3.34/28533.84] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14767.133] [M: 28544.83] [ET: 2.888/14744.034] [MU: 3.54/28543.95] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp513)) OR (scr_area_type = 5 AND scr_area_id IN (:gp511)) OR (scr_area_type = 2 AND scr_area_id IN (:gp514)) OR (scr_area_type = 4 AND scr_area_id IN (:gp515)) OR (scr_area_type = 1 AND scr_area_id IN (:gp512)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp511":"908",":gp512":"31",":gp513":"908",":gp514":"105",":gp515":"1","scv_id":"16"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14768.215] [M: 28545.41] [ET: 0.541/14745.16] [MU: 0.9/28545.16] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14769.233] [M: 28555.63] [ET: 0.495/14746.194] [MU: 2.97/28555.2] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14771.281] [M: 28566.18] [ET: 1.927/14748.221] [MU: 3.53/28565.3] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp518)) OR (scr_area_type = 5 AND scr_area_id IN (:gp516)) OR (scr_area_type = 2 AND scr_area_id IN (:gp519)) OR (scr_area_type = 4 AND scr_area_id IN (:gp520)) OR (scr_area_type = 1 AND scr_area_id IN (:gp517)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp516":"908",":gp517":"31",":gp518":"908",":gp519":"105",":gp520":"1","scv_id":"96"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14772.083] [M: 28564.77] [ET: 0.523/14749.04] [MU: 0.9/28564.52] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14773.259] [M: 28577.12] [ET: 0.499/14750.209] [MU: 2.97/28576.68] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14773.988] [M: 28606.29] [ET: 0.607/14750.928] [MU: 22.53/28605.54] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp523)) OR (apr_area_type = 5 AND apr_area_id IN (:gp521)) OR (apr_area_type = 2 AND apr_area_id IN (:gp524)) OR (apr_area_type = 4 AND apr_area_id IN (:gp525)) OR (apr_area_type = 1 AND apr_area_id IN (:gp522))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp521":"908",":gp522":"31",":gp523":"30804",":gp524":"105",":gp525":"1","cab":"96"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14775.558] [M: 28593.3] [ET: 0.464/14752.508] [MU: 3.34/28592.87] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14777.726] [M: 28603.85] [ET: 2.05/14754.673] [MU: 3.53/28602.98] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp528)) OR (scr_area_type = 5 AND scr_area_id IN (:gp526)) OR (scr_area_type = 2 AND scr_area_id IN (:gp529)) OR (scr_area_type = 4 AND scr_area_id IN (:gp530)) OR (scr_area_type = 1 AND scr_area_id IN (:gp527)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp526":"908",":gp527":"31",":gp528":"908",":gp529":"105",":gp530":"1","scv_id":"96"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14778.823] [M: 28608.6] [ET: 0.65/14755.768] [MU: 3.84/28607.73] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14779.422] [M: 28616.41] [ET: 0.468/14756.37] [MU: 4.21/28615.54] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14779.879] [M: 28620.55] [ET: 0.357/14756.831] [MU: 2.98/28620.45] 
	BookingRoute::calculateDistance
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14782.919] [M: 28626.93] [ET: 2.806/14759.869] [MU: 2.41/28626.55] 
	SQL: SELECT *
				FROM   partner_rate prt 
				JOIN route rut ON prt.prt_route_id = rut.rut_id AND rut.rut_active = 1
				AND  rut.rut_from_city_id  = 30804 
				AND  rut.rut_to_city_id  = 30726 
				 WHERE prt_vehicletype_id = 96
				AND prt_partner_id = 1249
				AND prt_status = 1
				 
	 [params: []]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14783.745] [M: 28632.16] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30726","cabType":"3","tripDistance":"","tripDuration":"","multiCityData":"","bookingType":"1","pickupAddress":"","pickupDate":"24\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","sccId":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30726&cabType=3&tripDistance=&tripDuration=&multiCityData=&bookingType=1&pickupAddress=&pickupDate=24%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&sccId=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14784.224] [M: 28649] [ET: 1.051/14761.193] [MU: 18.04/28648.89] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14784.272] [M: 28650.68] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14785.427] [M: 28664.14] [ET: 1.016/14762.366] [MU: 2.99/28661.64] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+5845),(IF((cpm_value_type=2),(5845+(5845*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30726 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30726) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-24 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=96 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14786.844] [M: 28706.37] [ET: 3.724/14763.808] [MU: 75.87/28706.21] 
	RouteRates::calculate for CAB 96 2024-10-24 18:00:00 - Trip Type: 1 979844851
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14787.06] [M: 28685.98] [ET: 46.527/14764.031] [MU: 291.81/28685.83] 
	Quote::calculateOneWay  for CAB 96 Date: 2024-10-24 18:00:00
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14787.318] [M: 28681.71] [ET: 0.19/14764.286] [MU: 0.89/28681.46] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"96"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14787.389] [M: 28683.27] [ET: 52.213/14764.36] [MU: 336.11/28683.18] 
	Quote For CabType: 96
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14788.477] [M: 28693.25] [ET: 0.363/14765.417] [MU: 2.97/28692.81] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14788.888] [M: 28699.07] [ET: 0.343/14765.854] [MU: 3.35/28698.63] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14789.471] [M: 28701.98] [ET: 0.5/14766.413] [MU: 0.9/28701.76] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14790.153] [M: 28734.36] [ET: 0.534/14767.113] [MU: 24.22/28732.86] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (101) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30726) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp531)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp534,:gp535)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp532,:gp533)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp536,:gp537))
			OR (scr_area_type = 5 AND scr_area_id IN (908))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (97)
		ORDER BY rank DESC
		 
	 [params: {":gp531":"31",":gp532":"30804",":gp533":"30726",":gp534":"105",":gp535":"101",":gp536":"1",":gp537":"1","tripType":"1"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14790.806] [M: 28714.54] [ET: 0.197/14767.765] [MU: 0.83/28714.35] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14791.179] [M: 28717.41] [ET: 0.283/14768.128] [MU: 0.96/28717.1] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"2"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14792.535] [M: 28730.16] [ET: 0.335/14769.494] [MU: 2.05/28729.66] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"97"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14795.074] [M: 28739.55] [ET: 2.332/14772.024] [MU: 3.53/28738.67] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"97","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14795.937] [M: 28742.8] [ET: 0.605/14772.867] [MU: 0.87/28742.58] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":0}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14796.628] [M: 28750.08] [ET: 0.486/14773.593] [MU: 2.97/28749.64] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14797.587] [M: 28778.25] [ET: 0.782/14774.523] [MU: 22.05/28777.63] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp539)) OR (apr_area_type = 2 AND apr_area_id IN (:gp540)) OR (apr_area_type = 4 AND apr_area_id IN (:gp541)) OR (apr_area_type = 1 AND apr_area_id IN (:gp538))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp538":"31",":gp539":"30804",":gp540":"105",":gp541":"1","cab":"97"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14798.832] [M: 28764.97] [ET: 0.473/14775.795] [MU: 3.33/28764.53] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14800.881] [M: 28775.25] [ET: 1.932/14777.835] [MU: 3.41/28774.38] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp543)) OR (scr_area_type = 2 AND scr_area_id IN (:gp544)) OR (scr_area_type = 4 AND scr_area_id IN (:gp545)) OR (scr_area_type = 1 AND scr_area_id IN (:gp542)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp542":"31",":gp543":"30804",":gp544":"105",":gp545":"1","scv_id":"97"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14804.052] [M: 28802.95] [ET: 2.402/14780.983] [MU: 0.75/28794.95] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"nearest_route_30804_30726","sql":"(INDEX indx_nearest_rt_rutid (rut_id)) \r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, routeFrom.rut_name as fromAlias, \r\n\t\t\t\tNULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, \r\n\t\t\t\t0 as rank, routeFrom.rut_estm_time as startTime, 0 as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\tAND route.rut_to_city_id=30726 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 \r\n\t\t\t\tAND routeFrom.rut_from_city_id<>routeFrom.rut_to_city_id AND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\t\tAND (routeAlias.rut_to_city_id=route.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (1967,16216,47825,322451,3087761,3190710)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, NULL, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) \r\n\t\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\t0 AS extraStartDistance, 0, 0 as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND route.rut_from_city_id = 30804 AND route.rut_to_city_id=30726 \r\n\t\t\t\tAND routeTo.rut_from_city_id=30726\r\n\t\t\t\tAND route.rut_active = 1 AND routeTo.rut_active = 1 AND routeTo.rut_estm_distance < 50 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = route.rut_from_city_id) \r\n\t\t\t   AND (routeAlias.rut_to_city_id = routeTo.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (1967,16216,47825,322451,3087761,3190710)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, \r\n\t\t\t\trouteFrom.rut_name, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t+ IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) \r\n\t\t\t\tAS extraDistance, IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, 0, \r\n\t\t\t\trouteFrom.rut_estm_time as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\t\tAND route.rut_to_city_id=30726 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 AND routeFrom.rut_from_city_id <> routeFrom.rut_to_city_id\r\n\t\t\t\t\tAND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND routeTo.rut_estm_distance < 50 \r\n\t\t\t\t\tAND routeTo.rut_from_city_id=30726 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\tAND (routeAlias.rut_to_city_id=routeTo.rut_to_city_id) AND routeAlias.rut_active = 1 AND routeAlias.rut_from_city_id=30804  AND routeAlias.rut_id IN (1967,16216,47825,322451,3087761,3190710)"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14806.378] [M: 28807.06] [ET: 2.208/14783.313] [MU: 2.17/28806.63] 
	SQL: SELECT *, (rte_vendor_amount + extraDistance * 10.55) as totalCost FROM (SELECT * FROM nearest_route_30804_30726) a
					INNER JOIN rate ON a.rut_id = rate.rte_route_id AND rte_status=1 AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <>0
					WHERE 1 ORDER BY rank DESC, totalCost ASC LIMIT 0,1 
	 [params: {"cabType":"97"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14807.275] [M: 28815.09] [ET: 0.726/14784.202] [MU: 0.74/28813.09] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"getNearestRoute_30804_30726_70","sql":"(INDEX getNearestRoute_30804_30726_70_index_rut_id (rut_id))\r\n\t\t\t\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id AS start, routeAlias.rut_to_city_id AS end,\r\n\t\t\t\t\t\t\t\trouteFrom.rut_name AS fromAlias, NULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance AS quotedDistance,\r\n\t\t\t\t\t\t\t\trouteAlias.rut_estm_distance AS rateDistance, \r\n\t\t\t\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance)\r\n\t\t\t\t\t\t\t\t\t - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance,\r\n\t\t\t\t\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance,\r\n\t\t\t\t\t\t\t\t0 AS rank, routeFrom.rut_estm_time AS startTime, 0 AS endTime, route.rut_estm_time, \r\n\t\t\t\t\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraTravelDistance\r\n\t\t\t\t\t\tFROM   route\r\n\t\t\t\t\t\tINNER JOIN route routeTo ON routeTo.rut_to_city_id=route.rut_from_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_from_city_id=30804 AND routeTo.rut_active=1\r\n\t\t\t\t\t\t\t\tAND routeTo.rut_estm_distance<70 AND route.rut_active=1\r\n\t\t\t\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_from_city_id=route.rut_to_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_to_city_id=30726 AND routeFrom.rut_active = 1\r\n\t\t\t\t\t\t\t\tAND routeFrom.rut_estm_distance<70 AND route.rut_active = 1\r\n\t\t\t\t\t\tINNER JOIN route routeAlias ON routeAlias.rut_to_city_id=routeFrom.rut_to_city_id\r\n\t\t\t\t\t\t\tAND routeAlias.rut_from_city_id=routeTo.rut_from_city_id AND routeAlias.rut_active = 1"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14809.813] [M: 28820.35] [ET: 2.399/14786.729] [MU: 2.41/28819.73] 
	SQL: SELECT *, (rte_vendor_amount + extradistance * 10.55 ) AS totalCost, 
						ABS(quotedDistance-rateDistance) AS extraChargeableDistance
					FROM getNearestRoute_30804_30726_70 a
					INNER JOIN rate ON a.rut_id=rate.rte_route_id AND rte_status=1 
						AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <> 0
					WHERE  1
					ORDER  BY rank DESC, extraStartDistance, extraChargeableDistance ASC, totalcost ASC
					LIMIT  0, 1 
	 [params: {"cabType":"97"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14813.084] [M: 28835.44] [ET: 0.527/14790.031] [MU: 3.42/28834.56] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"16","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14814.917] [M: 28853.84] [ET: 0.553/14791.878] [MU: 5.56/28852.96] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14815.769] [M: 28861.1] [ET: 0.553/14792.719] [MU: 0.89/28860.85] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14816.791] [M: 28871.7] [ET: 0.497/14793.746] [MU: 3.34/28871.26] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14819.098] [M: 28882.24] [ET: 2.179/14796.031] [MU: 3.53/28881.37] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp548)) OR (scr_area_type = 5 AND scr_area_id IN (:gp546)) OR (scr_area_type = 2 AND scr_area_id IN (:gp549)) OR (scr_area_type = 4 AND scr_area_id IN (:gp550)) OR (scr_area_type = 1 AND scr_area_id IN (:gp547)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp546":"908",":gp547":"31",":gp548":"908",":gp549":"105",":gp550":"1","scv_id":"16"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14820.211] [M: 28882.82] [ET: 0.593/14797.159] [MU: 0.9/28882.57] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14821.438] [M: 28893.05] [ET: 0.618/14798.377] [MU: 2.97/28892.61] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14823.807] [M: 28903.59] [ET: 2.201/14800.755] [MU: 3.53/28902.72] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp553)) OR (scr_area_type = 5 AND scr_area_id IN (:gp551)) OR (scr_area_type = 2 AND scr_area_id IN (:gp554)) OR (scr_area_type = 4 AND scr_area_id IN (:gp555)) OR (scr_area_type = 1 AND scr_area_id IN (:gp552)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp551":"908",":gp552":"31",":gp553":"908",":gp554":"105",":gp555":"1","scv_id":"97"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14824.682] [M: 28902.19] [ET: 0.579/14801.641] [MU: 0.9/28901.94] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14825.789] [M: 28914.53] [ET: 0.48/14802.737] [MU: 2.97/28914.09] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14826.447] [M: 28943.7] [ET: 0.554/14803.408] [MU: 22.54/28942.95] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp558)) OR (apr_area_type = 5 AND apr_area_id IN (:gp556)) OR (apr_area_type = 2 AND apr_area_id IN (:gp559)) OR (apr_area_type = 4 AND apr_area_id IN (:gp560)) OR (apr_area_type = 1 AND apr_area_id IN (:gp557))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp556":"908",":gp557":"31",":gp558":"30804",":gp559":"105",":gp560":"1","cab":"97"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14827.84] [M: 28930.72] [ET: 0.447/14804.79] [MU: 3.33/28930.28] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14830.083] [M: 28941.27] [ET: 2.127/14807.036] [MU: 3.53/28940.39] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp563)) OR (scr_area_type = 5 AND scr_area_id IN (:gp561)) OR (scr_area_type = 2 AND scr_area_id IN (:gp564)) OR (scr_area_type = 4 AND scr_area_id IN (:gp565)) OR (scr_area_type = 1 AND scr_area_id IN (:gp562)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp561":"908",":gp562":"31",":gp563":"908",":gp564":"105",":gp565":"1","scv_id":"97"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14831.391] [M: 28946.02] [ET: 0.681/14808.349] [MU: 3.84/28945.14] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14831.87] [M: 28953.83] [ET: 0.389/14808.832] [MU: 4.22/28952.95] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14832.168] [M: 28957.97] [ET: 0.232/14809.138] [MU: 2.97/28957.86] 
	BookingRoute::calculateDistance
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14834.401] [M: 28964.34] [ET: 2.058/14811.337] [MU: 2.4/28963.97] 
	SQL: SELECT *
				FROM   partner_rate prt 
				JOIN route rut ON prt.prt_route_id = rut.rut_id AND rut.rut_active = 1
				AND  rut.rut_from_city_id  = 30804 
				AND  rut.rut_to_city_id  = 30726 
				 WHERE prt_vehicletype_id = 97
				AND prt_partner_id = 1249
				AND prt_status = 1
				 
	 [params: []]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14835.376] [M: 28969.57] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30726","cabType":"3","tripDistance":"","tripDuration":"","multiCityData":"","bookingType":"1","pickupAddress":"","pickupDate":"24\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","sccId":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30726&cabType=3&tripDistance=&tripDuration=&multiCityData=&bookingType=1&pickupAddress=&pickupDate=24%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&sccId=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14836.045] [M: 28986.41] [ET: 1.252/14812.996] [MU: 18.05/28986.3] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14836.108] [M: 28988.09] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14837.187] [M: 29001.55] [ET: 0.895/14814.122] [MU: 2.99/28999.05] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+5845),(IF((cpm_value_type=2),(5845+(5845*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30726 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30726) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-24 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=97 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14838.937] [M: 29043.78] [ET: 4.24/14815.899] [MU: 75.88/29043.63] 
	RouteRates::calculate for CAB 97 2024-10-24 18:00:00 - Trip Type: 1 658086284
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14839.151] [M: 29023.4] [ET: 46.551/14816.121] [MU: 291.81/29023.24] 
	Quote::calculateOneWay  for CAB 97 Date: 2024-10-24 18:00:00
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14839.406] [M: 29019.13] [ET: 0.187/14816.373] [MU: 0.9/29018.88] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"97"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14839.478] [M: 29021.31] [ET: 52.039/14816.448] [MU: 336.73/29021.22] 
	Quote For CabType: 97
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14840.584] [M: 29031.29] [ET: 0.388/14817.548] [MU: 2.96/29030.85] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14840.987] [M: 29037.11] [ET: 0.332/14817.954] [MU: 3.34/29036.67] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14841.533] [M: 29040.05] [ET: 0.478/14818.495] [MU: 0.9/29039.8] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14842.09] [M: 29072.4] [ET: 0.449/14819.05] [MU: 24.22/29070.9] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (101) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30726) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp566)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp569,:gp570)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp567,:gp568)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp571,:gp572))
			OR (scr_area_type = 5 AND scr_area_id IN (908))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (98)
		ORDER BY rank DESC
		 
	 [params: {":gp566":"31",":gp567":"30804",":gp568":"30726",":gp569":"105",":gp570":"101",":gp571":"1",":gp572":"1","tripType":"1"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14842.771] [M: 29052.58] [ET: 0.215/14819.72] [MU: 0.83/29052.39] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14843.157] [M: 29055.45] [ET: 0.291/14820.124] [MU: 0.96/29055.14] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"2"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14844.261] [M: 29068.2] [ET: 0.333/14821.209] [MU: 2.05/29067.7] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"98"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14846.834] [M: 29077.59] [ET: 2.284/14823.775] [MU: 3.53/29076.71] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"98","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14848.1] [M: 29080.84] [ET: 0.757/14825.032] [MU: 0.87/29080.62] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":0}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14848.827] [M: 29088.12] [ET: 0.509/14825.792] [MU: 2.97/29087.68] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14849.529] [M: 29116.29] [ET: 0.571/14826.488] [MU: 22.05/29115.66] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp574)) OR (apr_area_type = 2 AND apr_area_id IN (:gp575)) OR (apr_area_type = 4 AND apr_area_id IN (:gp576)) OR (apr_area_type = 1 AND apr_area_id IN (:gp573))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp573":"31",":gp574":"30804",":gp575":"105",":gp576":"1","cab":"98"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14850.487] [M: 29103.01] [ET: 0.419/14827.453] [MU: 3.33/29102.57] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14852.708] [M: 29113.29] [ET: 2.094/14829.643] [MU: 3.41/29112.41] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp578)) OR (scr_area_type = 2 AND scr_area_id IN (:gp579)) OR (scr_area_type = 4 AND scr_area_id IN (:gp580)) OR (scr_area_type = 1 AND scr_area_id IN (:gp577)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp577":"31",":gp578":"30804",":gp579":"105",":gp580":"1","scv_id":"98"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14855.423] [M: 29140.99] [ET: 1.823/14832.362] [MU: 0.74/29132.99] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"nearest_route_30804_30726","sql":"(INDEX indx_nearest_rt_rutid (rut_id)) \r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, routeFrom.rut_name as fromAlias, \r\n\t\t\t\tNULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, \r\n\t\t\t\t0 as rank, routeFrom.rut_estm_time as startTime, 0 as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\tAND route.rut_to_city_id=30726 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 \r\n\t\t\t\tAND routeFrom.rut_from_city_id<>routeFrom.rut_to_city_id AND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\t\tAND (routeAlias.rut_to_city_id=route.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (1967,16216,47825,322451,3087761,3190710)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, NULL, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) \r\n\t\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\t0 AS extraStartDistance, 0, 0 as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND route.rut_from_city_id = 30804 AND route.rut_to_city_id=30726 \r\n\t\t\t\tAND routeTo.rut_from_city_id=30726\r\n\t\t\t\tAND route.rut_active = 1 AND routeTo.rut_active = 1 AND routeTo.rut_estm_distance < 50 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = route.rut_from_city_id) \r\n\t\t\t   AND (routeAlias.rut_to_city_id = routeTo.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (1967,16216,47825,322451,3087761,3190710)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, \r\n\t\t\t\trouteFrom.rut_name, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t+ IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) \r\n\t\t\t\tAS extraDistance, IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, 0, \r\n\t\t\t\trouteFrom.rut_estm_time as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\t\tAND route.rut_to_city_id=30726 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 AND routeFrom.rut_from_city_id <> routeFrom.rut_to_city_id\r\n\t\t\t\t\tAND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND routeTo.rut_estm_distance < 50 \r\n\t\t\t\t\tAND routeTo.rut_from_city_id=30726 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\tAND (routeAlias.rut_to_city_id=routeTo.rut_to_city_id) AND routeAlias.rut_active = 1 AND routeAlias.rut_from_city_id=30804  AND routeAlias.rut_id IN (1967,16216,47825,322451,3087761,3190710)"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14857.879] [M: 29145.1] [ET: 2.35/14834.815] [MU: 2.17/29144.66] 
	SQL: SELECT *, (rte_vendor_amount + extraDistance * 10.55) as totalCost FROM (SELECT * FROM nearest_route_30804_30726) a
					INNER JOIN rate ON a.rut_id = rate.rte_route_id AND rte_status=1 AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <>0
					WHERE 1 ORDER BY rank DESC, totalCost ASC LIMIT 0,1 
	 [params: {"cabType":"98"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14858.748] [M: 29153.13] [ET: 0.708/14835.693] [MU: 0.74/29151.13] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"getNearestRoute_30804_30726_70","sql":"(INDEX getNearestRoute_30804_30726_70_index_rut_id (rut_id))\r\n\t\t\t\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id AS start, routeAlias.rut_to_city_id AS end,\r\n\t\t\t\t\t\t\t\trouteFrom.rut_name AS fromAlias, NULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance AS quotedDistance,\r\n\t\t\t\t\t\t\t\trouteAlias.rut_estm_distance AS rateDistance, \r\n\t\t\t\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance)\r\n\t\t\t\t\t\t\t\t\t - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance,\r\n\t\t\t\t\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance,\r\n\t\t\t\t\t\t\t\t0 AS rank, routeFrom.rut_estm_time AS startTime, 0 AS endTime, route.rut_estm_time, \r\n\t\t\t\t\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraTravelDistance\r\n\t\t\t\t\t\tFROM   route\r\n\t\t\t\t\t\tINNER JOIN route routeTo ON routeTo.rut_to_city_id=route.rut_from_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_from_city_id=30804 AND routeTo.rut_active=1\r\n\t\t\t\t\t\t\t\tAND routeTo.rut_estm_distance<70 AND route.rut_active=1\r\n\t\t\t\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_from_city_id=route.rut_to_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_to_city_id=30726 AND routeFrom.rut_active = 1\r\n\t\t\t\t\t\t\t\tAND routeFrom.rut_estm_distance<70 AND route.rut_active = 1\r\n\t\t\t\t\t\tINNER JOIN route routeAlias ON routeAlias.rut_to_city_id=routeFrom.rut_to_city_id\r\n\t\t\t\t\t\t\tAND routeAlias.rut_from_city_id=routeTo.rut_from_city_id AND routeAlias.rut_active = 1"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14861.115] [M: 29158.39] [ET: 2.249/14838.031] [MU: 2.42/29157.77] 
	SQL: SELECT *, (rte_vendor_amount + extradistance * 10.55 ) AS totalCost, 
						ABS(quotedDistance-rateDistance) AS extraChargeableDistance
					FROM getNearestRoute_30804_30726_70 a
					INNER JOIN rate ON a.rut_id=rate.rte_route_id AND rte_status=1 
						AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <> 0
					WHERE  1
					ORDER  BY rank DESC, extraStartDistance, extraChargeableDistance ASC, totalcost ASC
					LIMIT  0, 1 
	 [params: {"cabType":"98"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14864.674] [M: 29173.48] [ET: 0.645/14841.619] [MU: 3.41/29172.6] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"16","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14866.225] [M: 29191.88] [ET: 0.444/14843.188] [MU: 5.56/29191] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14866.964] [M: 29199.14] [ET: 0.496/14843.92] [MU: 0.9/29198.89] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14867.964] [M: 29209.73] [ET: 0.484/14844.913] [MU: 3.34/29209.3] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14870.156] [M: 29220.28] [ET: 2.043/14847.06] [MU: 3.53/29219.41] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp583)) OR (scr_area_type = 5 AND scr_area_id IN (:gp581)) OR (scr_area_type = 2 AND scr_area_id IN (:gp584)) OR (scr_area_type = 4 AND scr_area_id IN (:gp585)) OR (scr_area_type = 1 AND scr_area_id IN (:gp582)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp581":"908",":gp582":"31",":gp583":"908",":gp584":"105",":gp585":"1","scv_id":"16"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14871.088] [M: 29220.86] [ET: 0.501/14848.01] [MU: 0.9/29220.61] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14872.199] [M: 29231.09] [ET: 0.47/14849.161] [MU: 2.97/29230.65] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14874.689] [M: 29241.63] [ET: 2.369/14851.64] [MU: 3.53/29240.76] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp588)) OR (scr_area_type = 5 AND scr_area_id IN (:gp586)) OR (scr_area_type = 2 AND scr_area_id IN (:gp589)) OR (scr_area_type = 4 AND scr_area_id IN (:gp590)) OR (scr_area_type = 1 AND scr_area_id IN (:gp587)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp586":"908",":gp587":"31",":gp588":"908",":gp589":"105",":gp590":"1","scv_id":"98"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14875.621] [M: 29240.23] [ET: 0.567/14852.58] [MU: 0.9/29239.98] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14876.716] [M: 29252.57] [ET: 0.467/14853.666] [MU: 2.97/29252.13] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14877.396] [M: 29281.74] [ET: 0.557/14854.352] [MU: 22.53/29280.99] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp593)) OR (apr_area_type = 5 AND apr_area_id IN (:gp591)) OR (apr_area_type = 2 AND apr_area_id IN (:gp594)) OR (apr_area_type = 4 AND apr_area_id IN (:gp595)) OR (apr_area_type = 1 AND apr_area_id IN (:gp592))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp591":"908",":gp592":"31",":gp593":"30804",":gp594":"105",":gp595":"1","cab":"98"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14878.862] [M: 29268.76] [ET: 0.461/14855.813] [MU: 3.33/29268.32] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14881.342] [M: 29279.3] [ET: 2.368/14858.293] [MU: 3.53/29278.43] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp598)) OR (scr_area_type = 5 AND scr_area_id IN (:gp596)) OR (scr_area_type = 2 AND scr_area_id IN (:gp599)) OR (scr_area_type = 4 AND scr_area_id IN (:gp600)) OR (scr_area_type = 1 AND scr_area_id IN (:gp597)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp596":"908",":gp597":"31",":gp598":"908",":gp599":"105",":gp600":"1","scv_id":"98"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14882.297] [M: 29284.05] [ET: 0.643/14859.256] [MU: 3.84/29283.18] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14882.769] [M: 29291.87] [ET: 0.384/14859.733] [MU: 4.21/29290.99] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14883.067] [M: 29296.01] [ET: 0.233/14860.036] [MU: 2.98/29295.9] 
	BookingRoute::calculateDistance
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14885.329] [M: 29302.29] [ET: 2.085/14862.267] [MU: 2.41/29301.91] 
	SQL: SELECT *
				FROM   partner_rate prt 
				JOIN route rut ON prt.prt_route_id = rut.rut_id AND rut.rut_active = 1
				AND  rut.rut_from_city_id  = 30804 
				AND  rut.rut_to_city_id  = 30726 
				 WHERE prt_vehicletype_id = 98
				AND prt_partner_id = 1249
				AND prt_status = 1
				 
	 [params: []]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14886.272] [M: 29307.52] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30726","cabType":"3","tripDistance":"","tripDuration":"","multiCityData":"","bookingType":"1","pickupAddress":"","pickupDate":"24\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","sccId":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30726&cabType=3&tripDistance=&tripDuration=&multiCityData=&bookingType=1&pickupAddress=&pickupDate=24%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&sccId=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14886.934] [M: 29324.36] [ET: 1.234/14863.885] [MU: 18.04/29324.25] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14886.997] [M: 29326.04] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14888.077] [M: 29339.5] [ET: 0.899/14865.012] [MU: 2.99/29337] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+5845),(IF((cpm_value_type=2),(5845+(5845*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30726 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30726) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-24 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=98 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14889.823] [M: 29381.73] [ET: 4.216/14866.786] [MU: 75.87/29381.57] 
	RouteRates::calculate for CAB 98 2024-10-24 18:00:00 - Trip Type: 1 37154254
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14890.044] [M: 29361.34] [ET: 45.695/14867.014] [MU: 291.72/29361.19] 
	Quote::calculateOneWay  for CAB 98 Date: 2024-10-24 18:00:00
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14890.319] [M: 29357.16] [ET: 0.189/14867.263] [MU: 0.9/29356.91] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"98"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14890.43] [M: 29359.35] [ET: 50.889/14867.382] [MU: 336.73/29359.26] 
	Quote For CabType: 98
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14891.807] [M: 29369.33] [ET: 0.484/14868.755] [MU: 2.97/29368.89] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14892.326] [M: 29375.15] [ET: 0.419/14869.276] [MU: 3.34/29374.71] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14892.903] [M: 29378.09] [ET: 0.487/14869.866] [MU: 0.9/29377.84] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14893.479] [M: 29410.44] [ET: 0.457/14870.418] [MU: 24.22/29408.94] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (101) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30726) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp601)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp604,:gp605)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp602,:gp603)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp606,:gp607))
			OR (scr_area_type = 5 AND scr_area_id IN (908))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (99)
		ORDER BY rank DESC
		 
	 [params: {":gp601":"31",":gp602":"30804",":gp603":"30726",":gp604":"105",":gp605":"101",":gp606":"1",":gp607":"1","tripType":"1"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14894.269] [M: 29390.62] [ET: 0.203/14871.235] [MU: 0.83/29390.43] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14894.623] [M: 29393.49] [ET: 0.27/14871.572] [MU: 0.96/29393.18] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"2"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14896.055] [M: 29406.24] [ET: 0.372/14873.019] [MU: 2.04/29405.74] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"99"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14899.213] [M: 29415.63] [ET: 2.937/14876.148] [MU: 3.53/29414.75] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"99","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14900.09] [M: 29418.88] [ET: 0.559/14877.041] [MU: 0.87/29418.66] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":0}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14900.778] [M: 29426.16] [ET: 0.494/14877.742] [MU: 2.97/29425.72] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14901.421] [M: 29454.33] [ET: 0.499/14878.379] [MU: 22.05/29453.7] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp609)) OR (apr_area_type = 2 AND apr_area_id IN (:gp610)) OR (apr_area_type = 4 AND apr_area_id IN (:gp611)) OR (apr_area_type = 1 AND apr_area_id IN (:gp608))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp608":"31",":gp609":"30804",":gp610":"105",":gp611":"1","cab":"99"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14902.485] [M: 29441.05] [ET: 0.487/14879.449] [MU: 3.33/29440.61] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14904.834] [M: 29451.33] [ET: 2.242/14881.781] [MU: 3.41/29450.45] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp613)) OR (scr_area_type = 2 AND scr_area_id IN (:gp614)) OR (scr_area_type = 4 AND scr_area_id IN (:gp615)) OR (scr_area_type = 1 AND scr_area_id IN (:gp612)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp612":"31",":gp613":"30804",":gp614":"105",":gp615":"1","scv_id":"99"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14907.705] [M: 29479.03] [ET: 2.033/14884.642] [MU: 0.74/29471.03] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"nearest_route_30804_30726","sql":"(INDEX indx_nearest_rt_rutid (rut_id)) \r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, routeFrom.rut_name as fromAlias, \r\n\t\t\t\tNULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, \r\n\t\t\t\t0 as rank, routeFrom.rut_estm_time as startTime, 0 as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\tAND route.rut_to_city_id=30726 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 \r\n\t\t\t\tAND routeFrom.rut_from_city_id<>routeFrom.rut_to_city_id AND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\t\tAND (routeAlias.rut_to_city_id=route.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (1967,16216,47825,322451,3087761,3190710)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, NULL, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) \r\n\t\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\t0 AS extraStartDistance, 0, 0 as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND route.rut_from_city_id = 30804 AND route.rut_to_city_id=30726 \r\n\t\t\t\tAND routeTo.rut_from_city_id=30726\r\n\t\t\t\tAND route.rut_active = 1 AND routeTo.rut_active = 1 AND routeTo.rut_estm_distance < 50 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = route.rut_from_city_id) \r\n\t\t\t   AND (routeAlias.rut_to_city_id = routeTo.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (1967,16216,47825,322451,3087761,3190710)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, \r\n\t\t\t\trouteFrom.rut_name, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t+ IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) \r\n\t\t\t\tAS extraDistance, IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, 0, \r\n\t\t\t\trouteFrom.rut_estm_time as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\t\tAND route.rut_to_city_id=30726 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 AND routeFrom.rut_from_city_id <> routeFrom.rut_to_city_id\r\n\t\t\t\t\tAND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND routeTo.rut_estm_distance < 50 \r\n\t\t\t\t\tAND routeTo.rut_from_city_id=30726 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\tAND (routeAlias.rut_to_city_id=routeTo.rut_to_city_id) AND routeAlias.rut_active = 1 AND routeAlias.rut_from_city_id=30804  AND routeAlias.rut_id IN (1967,16216,47825,322451,3087761,3190710)"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14910.032] [M: 29483.14] [ET: 2.235/14886.986] [MU: 2.17/29482.7] 
	SQL: SELECT *, (rte_vendor_amount + extraDistance * 10.55) as totalCost FROM (SELECT * FROM nearest_route_30804_30726) a
					INNER JOIN rate ON a.rut_id = rate.rte_route_id AND rte_status=1 AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <>0
					WHERE 1 ORDER BY rank DESC, totalCost ASC LIMIT 0,1 
	 [params: {"cabType":"99"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14910.777] [M: 29491.16] [ET: 0.617/14887.718] [MU: 0.75/29489.16] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"getNearestRoute_30804_30726_70","sql":"(INDEX getNearestRoute_30804_30726_70_index_rut_id (rut_id))\r\n\t\t\t\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id AS start, routeAlias.rut_to_city_id AS end,\r\n\t\t\t\t\t\t\t\trouteFrom.rut_name AS fromAlias, NULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance AS quotedDistance,\r\n\t\t\t\t\t\t\t\trouteAlias.rut_estm_distance AS rateDistance, \r\n\t\t\t\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance)\r\n\t\t\t\t\t\t\t\t\t - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance,\r\n\t\t\t\t\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance,\r\n\t\t\t\t\t\t\t\t0 AS rank, routeFrom.rut_estm_time AS startTime, 0 AS endTime, route.rut_estm_time, \r\n\t\t\t\t\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraTravelDistance\r\n\t\t\t\t\t\tFROM   route\r\n\t\t\t\t\t\tINNER JOIN route routeTo ON routeTo.rut_to_city_id=route.rut_from_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_from_city_id=30804 AND routeTo.rut_active=1\r\n\t\t\t\t\t\t\t\tAND routeTo.rut_estm_distance<70 AND route.rut_active=1\r\n\t\t\t\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_from_city_id=route.rut_to_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_to_city_id=30726 AND routeFrom.rut_active = 1\r\n\t\t\t\t\t\t\t\tAND routeFrom.rut_estm_distance<70 AND route.rut_active = 1\r\n\t\t\t\t\t\tINNER JOIN route routeAlias ON routeAlias.rut_to_city_id=routeFrom.rut_to_city_id\r\n\t\t\t\t\t\t\tAND routeAlias.rut_from_city_id=routeTo.rut_from_city_id AND routeAlias.rut_active = 1"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14913.142] [M: 29496.43] [ET: 2.25/14890.059] [MU: 2.42/29495.8] 
	SQL: SELECT *, (rte_vendor_amount + extradistance * 10.55 ) AS totalCost, 
						ABS(quotedDistance-rateDistance) AS extraChargeableDistance
					FROM getNearestRoute_30804_30726_70 a
					INNER JOIN rate ON a.rut_id=rate.rte_route_id AND rte_status=1 
						AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <> 0
					WHERE  1
					ORDER  BY rank DESC, extraStartDistance, extraChargeableDistance ASC, totalcost ASC
					LIMIT  0, 1 
	 [params: {"cabType":"99"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14917.451] [M: 29511.52] [ET: 0.705/14894.375] [MU: 3.41/29510.64] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"16","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14919.814] [M: 29529.91] [ET: 0.69/14896.773] [MU: 5.56/29529.04] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14920.67] [M: 29537.18] [ET: 0.551/14897.625] [MU: 0.9/29536.93] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14921.706] [M: 29547.77] [ET: 0.506/14898.662] [MU: 3.34/29547.34] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14924.244] [M: 29558.32] [ET: 2.401/14901.158] [MU: 3.53/29557.45] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp618)) OR (scr_area_type = 5 AND scr_area_id IN (:gp616)) OR (scr_area_type = 2 AND scr_area_id IN (:gp619)) OR (scr_area_type = 4 AND scr_area_id IN (:gp620)) OR (scr_area_type = 1 AND scr_area_id IN (:gp617)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp616":"908",":gp617":"31",":gp618":"908",":gp619":"105",":gp620":"1","scv_id":"16"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14925.293] [M: 29558.9] [ET: 0.577/14902.212] [MU: 0.9/29558.65] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14926.44] [M: 29569.13] [ET: 0.479/14903.401] [MU: 2.97/29568.69] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14928.828] [M: 29579.67] [ET: 2.252/14905.761] [MU: 3.53/29578.8] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp623)) OR (scr_area_type = 5 AND scr_area_id IN (:gp621)) OR (scr_area_type = 2 AND scr_area_id IN (:gp624)) OR (scr_area_type = 4 AND scr_area_id IN (:gp625)) OR (scr_area_type = 1 AND scr_area_id IN (:gp622)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp621":"908",":gp622":"31",":gp623":"908",":gp624":"105",":gp625":"1","scv_id":"99"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14929.879] [M: 29578.27] [ET: 0.66/14906.834] [MU: 0.9/29578.02] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14931.529] [M: 29590.61] [ET: 0.562/14908.456] [MU: 2.96/29590.17] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14932.26] [M: 29619.78] [ET: 0.621/14909.219] [MU: 22.53/29619.03] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp628)) OR (apr_area_type = 5 AND apr_area_id IN (:gp626)) OR (apr_area_type = 2 AND apr_area_id IN (:gp629)) OR (apr_area_type = 4 AND apr_area_id IN (:gp630)) OR (apr_area_type = 1 AND apr_area_id IN (:gp627))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp626":"908",":gp627":"31",":gp628":"30804",":gp629":"105",":gp630":"1","cab":"99"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14933.699] [M: 29606.8] [ET: 0.469/14910.649] [MU: 3.33/29606.36] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14935.725] [M: 29617.34] [ET: 1.917/14912.675] [MU: 3.53/29616.47] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp633)) OR (scr_area_type = 5 AND scr_area_id IN (:gp631)) OR (scr_area_type = 2 AND scr_area_id IN (:gp634)) OR (scr_area_type = 4 AND scr_area_id IN (:gp635)) OR (scr_area_type = 1 AND scr_area_id IN (:gp632)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp631":"908",":gp632":"31",":gp633":"908",":gp634":"105",":gp635":"1","scv_id":"99"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14936.671] [M: 29622.09] [ET: 0.617/14913.615] [MU: 3.84/29621.22] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14937.179] [M: 29629.91] [ET: 0.391/14914.143] [MU: 4.21/29629.03] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14937.472] [M: 29634.05] [ET: 0.227/14914.442] [MU: 2.98/29633.94] 
	BookingRoute::calculateDistance
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14939.913] [M: 29640.42] [ET: 2.256/14916.84] [MU: 2.41/29640.05] 
	SQL: SELECT *
				FROM   partner_rate prt 
				JOIN route rut ON prt.prt_route_id = rut.rut_id AND rut.rut_active = 1
				AND  rut.rut_from_city_id  = 30804 
				AND  rut.rut_to_city_id  = 30726 
				 WHERE prt_vehicletype_id = 99
				AND prt_partner_id = 1249
				AND prt_status = 1
				 
	 [params: []]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14940.714] [M: 29645.65] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30726","cabType":"3","tripDistance":"","tripDuration":"","multiCityData":"","bookingType":"1","pickupAddress":"","pickupDate":"24\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","sccId":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30726&cabType=3&tripDistance=&tripDuration=&multiCityData=&bookingType=1&pickupAddress=&pickupDate=24%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&sccId=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14941.164] [M: 29662.49] [ET: 0.9/14918.133] [MU: 18.05/29662.38] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14941.213] [M: 29664.17] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14942.374] [M: 29677.63] [ET: 1.005/14919.29] [MU: 3/29675.13] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+5845),(IF((cpm_value_type=2),(5845+(5845*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30726 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30726) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-24 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=99 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14944.043] [M: 29719.86] [ET: 3.849/14921.007] [MU: 75.88/29719.7] 
	RouteRates::calculate for CAB 99 2024-10-24 18:00:00 - Trip Type: 1 427128248
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14944.26] [M: 29699.48] [ET: 48.14/14921.23] [MU: 291.81/29699.32] 
	Quote::calculateOneWay  for CAB 99 Date: 2024-10-24 18:00:00
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14944.539] [M: 29695.2] [ET: 0.196/14921.488] [MU: 0.9/29694.95] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"99"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14944.651] [M: 29701.39] [ET: 54.142/14921.605] [MU: 340.73/29701.3] 
	Quote For CabType: 99
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14946.038] [M: 29711.37] [ET: 0.461/14922.982] [MU: 2.97/29710.93] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14946.555] [M: 29717.19] [ET: 0.418/14923.506] [MU: 3.34/29716.75] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14947.351] [M: 29720.13] [ET: 0.696/14924.303] [MU: 0.9/29719.88] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14948.117] [M: 29752.48] [ET: 0.638/14925.066] [MU: 24.22/29750.98] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (101) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30726) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp636)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp639,:gp640)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp637,:gp638)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp641,:gp642))
			OR (scr_area_type = 5 AND scr_area_id IN (908))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (108)
		ORDER BY rank DESC
		 
	 [params: {":gp636":"31",":gp637":"30804",":gp638":"30726",":gp639":"105",":gp640":"101",":gp641":"1",":gp642":"1","tripType":"1"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14948.852] [M: 29732.67] [ET: 0.214/14925.812] [MU: 0.84/29732.48] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14949.175] [M: 29735.52] [ET: 0.251/14926.141] [MU: 0.93/29735.2] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"6"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14950.376] [M: 29748.35] [ET: 0.398/14927.34] [MU: 2.04/29747.85] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"108"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14952.771] [M: 29757.73] [ET: 2.196/14929.724] [MU: 3.53/29756.86] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"108","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14953.537] [M: 29760.98] [ET: 0.534/14930.487] [MU: 0.87/29760.77] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":0}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14954.25] [M: 29768.27] [ET: 0.519/14931.213] [MU: 2.97/29767.83] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14954.895] [M: 29796.44] [ET: 0.494/14931.834] [MU: 22.05/29795.81] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp644)) OR (apr_area_type = 2 AND apr_area_id IN (:gp645)) OR (apr_area_type = 4 AND apr_area_id IN (:gp646)) OR (apr_area_type = 1 AND apr_area_id IN (:gp643))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp643":"31",":gp644":"30804",":gp645":"105",":gp646":"1","cab":"108"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14956.224] [M: 29783.17] [ET: 0.576/14933.171] [MU: 3.34/29782.73] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14958.448] [M: 29793.45] [ET: 2.073/14935.402] [MU: 3.41/29792.58] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp648)) OR (scr_area_type = 2 AND scr_area_id IN (:gp649)) OR (scr_area_type = 4 AND scr_area_id IN (:gp650)) OR (scr_area_type = 1 AND scr_area_id IN (:gp647)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp647":"31",":gp648":"30804",":gp649":"105",":gp650":"1","scv_id":"108"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14961.67] [M: 29821.14] [ET: 2.414/14938.602] [MU: 0.74/29813.14] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"nearest_route_30804_30726","sql":"(INDEX indx_nearest_rt_rutid (rut_id)) \r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, routeFrom.rut_name as fromAlias, \r\n\t\t\t\tNULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, \r\n\t\t\t\t0 as rank, routeFrom.rut_estm_time as startTime, 0 as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\tAND route.rut_to_city_id=30726 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 \r\n\t\t\t\tAND routeFrom.rut_from_city_id<>routeFrom.rut_to_city_id AND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\t\tAND (routeAlias.rut_to_city_id=route.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (1967,16216,47825,322451,3087761,3190710)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, NULL, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) \r\n\t\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\t0 AS extraStartDistance, 0, 0 as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND route.rut_from_city_id = 30804 AND route.rut_to_city_id=30726 \r\n\t\t\t\tAND routeTo.rut_from_city_id=30726\r\n\t\t\t\tAND route.rut_active = 1 AND routeTo.rut_active = 1 AND routeTo.rut_estm_distance < 50 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = route.rut_from_city_id) \r\n\t\t\t   AND (routeAlias.rut_to_city_id = routeTo.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (1967,16216,47825,322451,3087761,3190710)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, \r\n\t\t\t\trouteFrom.rut_name, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t+ IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) \r\n\t\t\t\tAS extraDistance, IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, 0, \r\n\t\t\t\trouteFrom.rut_estm_time as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\t\tAND route.rut_to_city_id=30726 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 AND routeFrom.rut_from_city_id <> routeFrom.rut_to_city_id\r\n\t\t\t\t\tAND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND routeTo.rut_estm_distance < 50 \r\n\t\t\t\t\tAND routeTo.rut_from_city_id=30726 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\tAND (routeAlias.rut_to_city_id=routeTo.rut_to_city_id) AND routeAlias.rut_active = 1 AND routeAlias.rut_from_city_id=30804  AND routeAlias.rut_id IN (1967,16216,47825,322451,3087761,3190710)"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14964.661] [M: 29825.25] [ET: 2.883/14941.59] [MU: 2.17/29824.81] 
	SQL: SELECT *, (rte_vendor_amount + extraDistance * 10.55) as totalCost FROM (SELECT * FROM nearest_route_30804_30726) a
					INNER JOIN rate ON a.rut_id = rate.rte_route_id AND rte_status=1 AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <>0
					WHERE 1 ORDER BY rank DESC, totalCost ASC LIMIT 0,1 
	 [params: {"cabType":"108"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14965.672] [M: 29833.27] [ET: 0.733/14942.613] [MU: 0.75/29831.27] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"getNearestRoute_30804_30726_70","sql":"(INDEX getNearestRoute_30804_30726_70_index_rut_id (rut_id))\r\n\t\t\t\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id AS start, routeAlias.rut_to_city_id AS end,\r\n\t\t\t\t\t\t\t\trouteFrom.rut_name AS fromAlias, NULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance AS quotedDistance,\r\n\t\t\t\t\t\t\t\trouteAlias.rut_estm_distance AS rateDistance, \r\n\t\t\t\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance)\r\n\t\t\t\t\t\t\t\t\t - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance,\r\n\t\t\t\t\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance,\r\n\t\t\t\t\t\t\t\t0 AS rank, routeFrom.rut_estm_time AS startTime, 0 AS endTime, route.rut_estm_time, \r\n\t\t\t\t\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraTravelDistance\r\n\t\t\t\t\t\tFROM   route\r\n\t\t\t\t\t\tINNER JOIN route routeTo ON routeTo.rut_to_city_id=route.rut_from_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_from_city_id=30804 AND routeTo.rut_active=1\r\n\t\t\t\t\t\t\t\tAND routeTo.rut_estm_distance<70 AND route.rut_active=1\r\n\t\t\t\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_from_city_id=route.rut_to_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_to_city_id=30726 AND routeFrom.rut_active = 1\r\n\t\t\t\t\t\t\t\tAND routeFrom.rut_estm_distance<70 AND route.rut_active = 1\r\n\t\t\t\t\t\tINNER JOIN route routeAlias ON routeAlias.rut_to_city_id=routeFrom.rut_to_city_id\r\n\t\t\t\t\t\t\tAND routeAlias.rut_from_city_id=routeTo.rut_from_city_id AND routeAlias.rut_active = 1"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14968.687] [M: 29838.54] [ET: 2.895/14945.601] [MU: 2.42/29837.91] 
	SQL: SELECT *, (rte_vendor_amount + extradistance * 10.55 ) AS totalCost, 
						ABS(quotedDistance-rateDistance) AS extraChargeableDistance
					FROM getNearestRoute_30804_30726_70 a
					INNER JOIN rate ON a.rut_id=rate.rte_route_id AND rte_status=1 
						AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <> 0
					WHERE  1
					ORDER  BY rank DESC, extraStartDistance, extraChargeableDistance ASC, totalcost ASC
					LIMIT  0, 1 
	 [params: {"cabType":"108"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14975.126] [M: 29853.64] [ET: 1.112/14952.05] [MU: 3.42/29852.77] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"73","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14977.395] [M: 29872.04] [ET: 0.477/14954.357] [MU: 5.57/29871.16] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14978.14] [M: 29879.3] [ET: 0.493/14955.096] [MU: 0.9/29879.05] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14979.221] [M: 29889.9] [ET: 0.524/14956.175] [MU: 3.33/29889.46] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14982.984] [M: 29900.45] [ET: 3.626/14959.899] [MU: 3.53/29899.57] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp653)) OR (scr_area_type = 5 AND scr_area_id IN (:gp651)) OR (scr_area_type = 2 AND scr_area_id IN (:gp654)) OR (scr_area_type = 4 AND scr_area_id IN (:gp655)) OR (scr_area_type = 1 AND scr_area_id IN (:gp652)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp651":"908",":gp652":"31",":gp653":"908",":gp654":"105",":gp655":"1","scv_id":"73"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14984.372] [M: 29901.02] [ET: 0.726/14961.287] [MU: 0.9/29900.77] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14985.923] [M: 29911.25] [ET: 0.625/14962.882] [MU: 2.97/29910.81] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14988.877] [M: 29921.8] [ET: 2.811/14965.809] [MU: 3.53/29920.92] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp658)) OR (scr_area_type = 5 AND scr_area_id IN (:gp656)) OR (scr_area_type = 2 AND scr_area_id IN (:gp659)) OR (scr_area_type = 4 AND scr_area_id IN (:gp660)) OR (scr_area_type = 1 AND scr_area_id IN (:gp657)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp656":"908",":gp657":"31",":gp658":"908",":gp659":"105",":gp660":"1","scv_id":"108"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14990.098] [M: 29920.38] [ET: 0.682/14967.055] [MU: 0.9/29920.13] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14991.544] [M: 29932.72] [ET: 0.647/14968.473] [MU: 2.96/29932.28] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14992.374] [M: 29961.89] [ET: 0.652/14969.307] [MU: 22.53/29961.14] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp663)) OR (apr_area_type = 5 AND apr_area_id IN (:gp661)) OR (apr_area_type = 2 AND apr_area_id IN (:gp664)) OR (apr_area_type = 4 AND apr_area_id IN (:gp665)) OR (apr_area_type = 1 AND apr_area_id IN (:gp662))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp661":"908",":gp662":"31",":gp663":"30804",":gp664":"105",":gp665":"1","cab":"108"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14995.237] [M: 29948.92] [ET: 0.561/14972.186] [MU: 3.34/29948.48] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14998.333] [M: 29959.47] [ET: 2.926/14975.222] [MU: 3.53/29958.59] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp668)) OR (scr_area_type = 5 AND scr_area_id IN (:gp666)) OR (scr_area_type = 2 AND scr_area_id IN (:gp669)) OR (scr_area_type = 4 AND scr_area_id IN (:gp670)) OR (scr_area_type = 1 AND scr_area_id IN (:gp667)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp666":"908",":gp667":"31",":gp668":"908",":gp669":"105",":gp670":"1","scv_id":"108"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 14999.809] [M: 29964.2] [ET: 0.832/14976.766] [MU: 3.84/29963.33] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15000.281] [M: 29972.02] [ET: 0.384/14977.244] [MU: 4.21/29971.14] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15000.575] [M: 29976.16] [ET: 0.227/14977.542] [MU: 2.98/29976.05] 
	BookingRoute::calculateDistance
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15003.25] [M: 29982.53] [ET: 2.512/14980.198] [MU: 2.41/29982.16] 
	SQL: SELECT *
				FROM   partner_rate prt 
				JOIN route rut ON prt.prt_route_id = rut.rut_id AND rut.rut_active = 1
				AND  rut.rut_from_city_id  = 30804 
				AND  rut.rut_to_city_id  = 30726 
				 WHERE prt_vehicletype_id = 108
				AND prt_partner_id = 1249
				AND prt_status = 1
				 
	 [params: []]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15004.133] [M: 29987.76] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30726","cabType":"3","tripDistance":"","tripDuration":"","multiCityData":"","bookingType":"1","pickupAddress":"","pickupDate":"24\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","sccId":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30726&cabType=3&tripDistance=&tripDuration=&multiCityData=&bookingType=1&pickupAddress=&pickupDate=24%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&sccId=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15004.582] [M: 30004.6] [ET: 0.984/14981.55] [MU: 18.04/30004.49] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15004.625] [M: 30006.28] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15005.638] [M: 30019.74] [ET: 0.875/14982.575] [MU: 2.99/30017.24] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+5845),(IF((cpm_value_type=2),(5845+(5845*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30726 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30726) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-24 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=108 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15007.118] [M: 30061.97] [ET: 3.596/14984.08] [MU: 75.88/30061.81] 
	RouteRates::calculate for CAB 108 2024-10-24 18:00:00 - Trip Type: 1 96132490
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15007.337] [M: 30041.59] [ET: 56.896/14984.307] [MU: 291.81/30041.43] 
	Quote::calculateOneWay  for CAB 108 Date: 2024-10-24 18:00:00
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15007.65] [M: 30037.3] [ET: 0.239/14984.611] [MU: 0.9/30037.05] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"108"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15007.724] [M: 30039.49] [ET: 63/14984.695] [MU: 336.8/30039.4] 
	Quote For CabType: 108
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15008.834] [M: 30049.47] [ET: 0.369/14985.798] [MU: 2.96/30049.03] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15009.325] [M: 30055.29] [ET: 0.403/14986.269] [MU: 3.34/30054.85] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15010.12] [M: 30058.2] [ET: 0.67/14987.05] [MU: 0.9/30057.98] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15011.009] [M: 30090.58] [ET: 0.676/14987.964] [MU: 24.22/30089.08] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (101) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30726) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp671)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp674,:gp675)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp672,:gp673)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp676,:gp677))
			OR (scr_area_type = 5 AND scr_area_id IN (908))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (111)
		ORDER BY rank DESC
		 
	 [params: {":gp671":"31",":gp672":"30804",":gp673":"30726",":gp674":"105",":gp675":"101",":gp676":"1",":gp677":"1","tripType":"1"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15011.71] [M: 30070.77] [ET: 0.218/14988.677] [MU: 0.84/30070.58] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15012.011] [M: 30073.61] [ET: 0.232/14988.98] [MU: 0.93/30073.3] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"6"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15013.155] [M: 30086.45] [ET: 0.382/14990.118] [MU: 2.05/30085.95] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"111"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15016.733] [M: 30095.83] [ET: 3.367/14993.679] [MU: 3.54/30094.95] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"111","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15017.625] [M: 30099.08] [ET: 0.626/14994.577] [MU: 0.87/30098.86] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":0}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15018.319] [M: 30106.36] [ET: 0.507/14995.282] [MU: 2.96/30105.92] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15019.002] [M: 30134.53] [ET: 0.55/14995.965] [MU: 22.05/30133.91] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp679)) OR (apr_area_type = 2 AND apr_area_id IN (:gp680)) OR (apr_area_type = 4 AND apr_area_id IN (:gp681)) OR (apr_area_type = 1 AND apr_area_id IN (:gp678))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp678":"31",":gp679":"30804",":gp680":"105",":gp681":"1","cab":"111"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15019.962] [M: 30121.26] [ET: 0.425/14996.927] [MU: 3.33/30120.82] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15022.051] [M: 30131.54] [ET: 1.956/14998.977] [MU: 3.41/30130.66] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp683)) OR (scr_area_type = 2 AND scr_area_id IN (:gp684)) OR (scr_area_type = 4 AND scr_area_id IN (:gp685)) OR (scr_area_type = 1 AND scr_area_id IN (:gp682)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp682":"31",":gp683":"30804",":gp684":"105",":gp685":"1","scv_id":"111"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15024.825] [M: 30159.23] [ET: 1.911/15001.756] [MU: 0.75/30151.23] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"nearest_route_30804_30726","sql":"(INDEX indx_nearest_rt_rutid (rut_id)) \r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, routeFrom.rut_name as fromAlias, \r\n\t\t\t\tNULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, \r\n\t\t\t\t0 as rank, routeFrom.rut_estm_time as startTime, 0 as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\tAND route.rut_to_city_id=30726 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 \r\n\t\t\t\tAND routeFrom.rut_from_city_id<>routeFrom.rut_to_city_id AND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\t\tAND (routeAlias.rut_to_city_id=route.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (1967,16216,47825,322451,3087761,3190710)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, NULL, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) \r\n\t\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\t0 AS extraStartDistance, 0, 0 as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND route.rut_from_city_id = 30804 AND route.rut_to_city_id=30726 \r\n\t\t\t\tAND routeTo.rut_from_city_id=30726\r\n\t\t\t\tAND route.rut_active = 1 AND routeTo.rut_active = 1 AND routeTo.rut_estm_distance < 50 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = route.rut_from_city_id) \r\n\t\t\t   AND (routeAlias.rut_to_city_id = routeTo.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (1967,16216,47825,322451,3087761,3190710)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, \r\n\t\t\t\trouteFrom.rut_name, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t+ IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) \r\n\t\t\t\tAS extraDistance, IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, 0, \r\n\t\t\t\trouteFrom.rut_estm_time as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\t\tAND route.rut_to_city_id=30726 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 AND routeFrom.rut_from_city_id <> routeFrom.rut_to_city_id\r\n\t\t\t\t\tAND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND routeTo.rut_estm_distance < 50 \r\n\t\t\t\t\tAND routeTo.rut_from_city_id=30726 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\tAND (routeAlias.rut_to_city_id=routeTo.rut_to_city_id) AND routeAlias.rut_active = 1 AND routeAlias.rut_from_city_id=30804  AND routeAlias.rut_id IN (1967,16216,47825,322451,3087761,3190710)"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15028.769] [M: 30163.34] [ET: 3.826/15005.703] [MU: 2.17/30162.91] 
	SQL: SELECT *, (rte_vendor_amount + extraDistance * 10.55) as totalCost FROM (SELECT * FROM nearest_route_30804_30726) a
					INNER JOIN rate ON a.rut_id = rate.rte_route_id AND rte_status=1 AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <>0
					WHERE 1 ORDER BY rank DESC, totalCost ASC LIMIT 0,1 
	 [params: {"cabType":"111"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15029.651] [M: 30171.37] [ET: 0.722/15006.596] [MU: 0.74/30169.37] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"getNearestRoute_30804_30726_70","sql":"(INDEX getNearestRoute_30804_30726_70_index_rut_id (rut_id))\r\n\t\t\t\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id AS start, routeAlias.rut_to_city_id AS end,\r\n\t\t\t\t\t\t\t\trouteFrom.rut_name AS fromAlias, NULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance AS quotedDistance,\r\n\t\t\t\t\t\t\t\trouteAlias.rut_estm_distance AS rateDistance, \r\n\t\t\t\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance)\r\n\t\t\t\t\t\t\t\t\t - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance,\r\n\t\t\t\t\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance,\r\n\t\t\t\t\t\t\t\t0 AS rank, routeFrom.rut_estm_time AS startTime, 0 AS endTime, route.rut_estm_time, \r\n\t\t\t\t\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraTravelDistance\r\n\t\t\t\t\t\tFROM   route\r\n\t\t\t\t\t\tINNER JOIN route routeTo ON routeTo.rut_to_city_id=route.rut_from_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_from_city_id=30804 AND routeTo.rut_active=1\r\n\t\t\t\t\t\t\t\tAND routeTo.rut_estm_distance<70 AND route.rut_active=1\r\n\t\t\t\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_from_city_id=route.rut_to_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_to_city_id=30726 AND routeFrom.rut_active = 1\r\n\t\t\t\t\t\t\t\tAND routeFrom.rut_estm_distance<70 AND route.rut_active = 1\r\n\t\t\t\t\t\tINNER JOIN route routeAlias ON routeAlias.rut_to_city_id=routeFrom.rut_to_city_id\r\n\t\t\t\t\t\t\tAND routeAlias.rut_from_city_id=routeTo.rut_from_city_id AND routeAlias.rut_active = 1"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15033.778] [M: 30176.63] [ET: 4.009/15010.691] [MU: 2.41/30176.01] 
	SQL: SELECT *, (rte_vendor_amount + extradistance * 10.55 ) AS totalCost, 
						ABS(quotedDistance-rateDistance) AS extraChargeableDistance
					FROM getNearestRoute_30804_30726_70 a
					INNER JOIN rate ON a.rut_id=rate.rte_route_id AND rte_status=1 
						AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <> 0
					WHERE  1
					ORDER  BY rank DESC, extraStartDistance, extraChargeableDistance ASC, totalcost ASC
					LIMIT  0, 1 
	 [params: {"cabType":"111"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15037.827] [M: 30191.73] [ET: 0.802/15014.742] [MU: 3.41/30190.85] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"73","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15039.848] [M: 30210.13] [ET: 0.506/15016.809] [MU: 5.56/30209.25] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15040.724] [M: 30217.39] [ET: 0.521/15017.657] [MU: 0.9/30217.14] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15041.968] [M: 30227.98] [ET: 0.584/15018.916] [MU: 3.34/30227.55] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15045.848] [M: 30238.53] [ET: 3.701/15022.764] [MU: 3.53/30237.66] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp688)) OR (scr_area_type = 5 AND scr_area_id IN (:gp686)) OR (scr_area_type = 2 AND scr_area_id IN (:gp689)) OR (scr_area_type = 4 AND scr_area_id IN (:gp690)) OR (scr_area_type = 1 AND scr_area_id IN (:gp687)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp686":"908",":gp687":"31",":gp688":"908",":gp689":"105",":gp690":"1","scv_id":"73"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15047.497] [M: 30239.11] [ET: 1.145/15024.415] [MU: 0.9/30238.86] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15049.212] [M: 30249.34] [ET: 0.721/15026.151] [MU: 2.97/30248.9] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15052.342] [M: 30259.88] [ET: 2.936/15029.272] [MU: 3.53/30259.01] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp693)) OR (scr_area_type = 5 AND scr_area_id IN (:gp691)) OR (scr_area_type = 2 AND scr_area_id IN (:gp694)) OR (scr_area_type = 4 AND scr_area_id IN (:gp695)) OR (scr_area_type = 1 AND scr_area_id IN (:gp692)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp691":"908",":gp692":"31",":gp693":"908",":gp694":"105",":gp695":"1","scv_id":"111"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15053.36] [M: 30258.47] [ET: 0.585/15030.295] [MU: 0.9/30258.22] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15054.832] [M: 30270.81] [ET: 0.639/15031.758] [MU: 2.97/30270.38] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15055.486] [M: 30299.98] [ET: 0.489/15032.444] [MU: 22.53/30299.23] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp698)) OR (apr_area_type = 5 AND apr_area_id IN (:gp696)) OR (apr_area_type = 2 AND apr_area_id IN (:gp699)) OR (apr_area_type = 4 AND apr_area_id IN (:gp700)) OR (apr_area_type = 1 AND apr_area_id IN (:gp697))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp696":"908",":gp697":"31",":gp698":"30804",":gp699":"105",":gp700":"1","cab":"111"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15057.159] [M: 30287.01] [ET: 0.568/15034.107] [MU: 3.33/30286.57] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15061.237] [M: 30297.55] [ET: 3.926/15038.159] [MU: 3.53/30296.68] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp703)) OR (scr_area_type = 5 AND scr_area_id IN (:gp701)) OR (scr_area_type = 2 AND scr_area_id IN (:gp704)) OR (scr_area_type = 4 AND scr_area_id IN (:gp705)) OR (scr_area_type = 1 AND scr_area_id IN (:gp702)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp701":"908",":gp702":"31",":gp703":"908",":gp704":"105",":gp705":"1","scv_id":"111"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15062.28] [M: 30302.3] [ET: 0.576/15039.241] [MU: 3.84/30301.42] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15062.76] [M: 30310.11] [ET: 0.393/15039.723] [MU: 4.21/30309.23] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15063.06] [M: 30314.25] [ET: 0.231/15040.03] [MU: 2.97/30314.14] 
	BookingRoute::calculateDistance
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15066.65] [M: 30320.53] [ET: 3.403/15043.585] [MU: 2.41/30320.16] 
	SQL: SELECT *
				FROM   partner_rate prt 
				JOIN route rut ON prt.prt_route_id = rut.rut_id AND rut.rut_active = 1
				AND  rut.rut_from_city_id  = 30804 
				AND  rut.rut_to_city_id  = 30726 
				 WHERE prt_vehicletype_id = 111
				AND prt_partner_id = 1249
				AND prt_status = 1
				 
	 [params: []]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15067.485] [M: 30325.76] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30726","cabType":"3","tripDistance":"","tripDuration":"","multiCityData":"","bookingType":"1","pickupAddress":"","pickupDate":"24\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","sccId":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30726&cabType=3&tripDistance=&tripDuration=&multiCityData=&bookingType=1&pickupAddress=&pickupDate=24%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&sccId=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15067.938] [M: 30342.6] [ET: 0.918/15044.906] [MU: 18.04/30342.49] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15067.981] [M: 30344.28] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15069.071] [M: 30357.74] [ET: 0.943/15046.004] [MU: 2.99/30355.24] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+5845),(IF((cpm_value_type=2),(5845+(5845*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30726 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30726) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-24 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=111 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15070.566] [M: 30399.97] [ET: 3.622/15047.529] [MU: 75.88/30399.81] 
	RouteRates::calculate for CAB 111 2024-10-24 18:00:00 - Trip Type: 1 110377099
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15070.785] [M: 30379.59] [ET: 57.562/15047.754] [MU: 291.72/30379.43] 
	Quote::calculateOneWay  for CAB 111 Date: 2024-10-24 18:00:00
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15071.075] [M: 30375.31] [ET: 0.222/15048.042] [MU: 0.9/30375.06] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"111"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15071.146] [M: 30377.5] [ET: 63.371/15048.116] [MU: 336.7/30377.41] 
	Quote For CabType: 111
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15072.283] [M: 30387.48] [ET: 0.368/15049.245] [MU: 2.97/30387.04] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15072.672] [M: 30393.3] [ET: 0.322/15049.638] [MU: 3.34/30392.86] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15073.242] [M: 30396.23] [ET: 0.503/15050.206] [MU: 0.9/30395.98] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15073.85] [M: 30428.59] [ET: 0.498/15050.809] [MU: 24.22/30427.09] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (101) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30726) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp706)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp709,:gp710)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp707,:gp708)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp711,:gp712))
			OR (scr_area_type = 5 AND scr_area_id IN (908))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (112)
		ORDER BY rank DESC
		 
	 [params: {":gp706":"31",":gp707":"30804",":gp708":"30726",":gp709":"105",":gp710":"101",":gp711":"1",":gp712":"1","tripType":"1"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15074.529] [M: 30408.77] [ET: 0.225/15051.497] [MU: 0.84/30408.59] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15074.838] [M: 30411.62] [ET: 0.233/15051.8] [MU: 0.93/30411.3] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"6"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15076.693] [M: 30424.45] [ET: 0.793/15053.632] [MU: 2.05/30423.95] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"112"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15079.721] [M: 30433.84] [ET: 2.66/15056.654] [MU: 3.53/30432.96] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"112","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15081.294] [M: 30437.09] [ET: 0.98/15058.217] [MU: 0.87/30436.87] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":0}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15082.622] [M: 30444.37] [ET: 0.932/15059.582] [MU: 2.97/30443.93] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15083.45] [M: 30472.54] [ET: 0.687/15060.411] [MU: 22.05/30471.91] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp714)) OR (apr_area_type = 2 AND apr_area_id IN (:gp715)) OR (apr_area_type = 4 AND apr_area_id IN (:gp716)) OR (apr_area_type = 1 AND apr_area_id IN (:gp713))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp713":"31",":gp714":"30804",":gp715":"105",":gp716":"1","cab":"112"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15084.607] [M: 30459.27] [ET: 0.546/15061.561] [MU: 3.34/30458.83] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15087.028] [M: 30469.55] [ET: 2.262/15063.954] [MU: 3.4/30468.67] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp718)) OR (scr_area_type = 2 AND scr_area_id IN (:gp719)) OR (scr_area_type = 4 AND scr_area_id IN (:gp720)) OR (scr_area_type = 1 AND scr_area_id IN (:gp717)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp717":"31",":gp718":"30804",":gp719":"105",":gp720":"1","scv_id":"112"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15090.033] [M: 30497.24] [ET: 2.097/15066.971] [MU: 0.74/30489.24] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"nearest_route_30804_30726","sql":"(INDEX indx_nearest_rt_rutid (rut_id)) \r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, routeFrom.rut_name as fromAlias, \r\n\t\t\t\tNULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, \r\n\t\t\t\t0 as rank, routeFrom.rut_estm_time as startTime, 0 as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\tAND route.rut_to_city_id=30726 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 \r\n\t\t\t\tAND routeFrom.rut_from_city_id<>routeFrom.rut_to_city_id AND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\t\tAND (routeAlias.rut_to_city_id=route.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (1967,16216,47825,322451,3087761,3190710)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, NULL, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) \r\n\t\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\t0 AS extraStartDistance, 0, 0 as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND route.rut_from_city_id = 30804 AND route.rut_to_city_id=30726 \r\n\t\t\t\tAND routeTo.rut_from_city_id=30726\r\n\t\t\t\tAND route.rut_active = 1 AND routeTo.rut_active = 1 AND routeTo.rut_estm_distance < 50 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = route.rut_from_city_id) \r\n\t\t\t   AND (routeAlias.rut_to_city_id = routeTo.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (1967,16216,47825,322451,3087761,3190710)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, \r\n\t\t\t\trouteFrom.rut_name, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t+ IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) \r\n\t\t\t\tAS extraDistance, IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, 0, \r\n\t\t\t\trouteFrom.rut_estm_time as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\t\tAND route.rut_to_city_id=30726 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 AND routeFrom.rut_from_city_id <> routeFrom.rut_to_city_id\r\n\t\t\t\t\tAND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND routeTo.rut_estm_distance < 50 \r\n\t\t\t\t\tAND routeTo.rut_from_city_id=30726 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\tAND (routeAlias.rut_to_city_id=routeTo.rut_to_city_id) AND routeAlias.rut_active = 1 AND routeAlias.rut_from_city_id=30804  AND routeAlias.rut_id IN (1967,16216,47825,322451,3087761,3190710)"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15093.523] [M: 30501.35] [ET: 3.368/15070.417] [MU: 2.17/30500.91] 
	SQL: SELECT *, (rte_vendor_amount + extraDistance * 10.55) as totalCost FROM (SELECT * FROM nearest_route_30804_30726) a
					INNER JOIN rate ON a.rut_id = rate.rte_route_id AND rte_status=1 AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <>0
					WHERE 1 ORDER BY rank DESC, totalCost ASC LIMIT 0,1 
	 [params: {"cabType":"112"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15094.769] [M: 30509.38] [ET: 1.012/15071.685] [MU: 0.74/30507.38] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"getNearestRoute_30804_30726_70","sql":"(INDEX getNearestRoute_30804_30726_70_index_rut_id (rut_id))\r\n\t\t\t\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id AS start, routeAlias.rut_to_city_id AS end,\r\n\t\t\t\t\t\t\t\trouteFrom.rut_name AS fromAlias, NULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance AS quotedDistance,\r\n\t\t\t\t\t\t\t\trouteAlias.rut_estm_distance AS rateDistance, \r\n\t\t\t\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance)\r\n\t\t\t\t\t\t\t\t\t - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance,\r\n\t\t\t\t\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance,\r\n\t\t\t\t\t\t\t\t0 AS rank, routeFrom.rut_estm_time AS startTime, 0 AS endTime, route.rut_estm_time, \r\n\t\t\t\t\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraTravelDistance\r\n\t\t\t\t\t\tFROM   route\r\n\t\t\t\t\t\tINNER JOIN route routeTo ON routeTo.rut_to_city_id=route.rut_from_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_from_city_id=30804 AND routeTo.rut_active=1\r\n\t\t\t\t\t\t\t\tAND routeTo.rut_estm_distance<70 AND route.rut_active=1\r\n\t\t\t\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_from_city_id=route.rut_to_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_to_city_id=30726 AND routeFrom.rut_active = 1\r\n\t\t\t\t\t\t\t\tAND routeFrom.rut_estm_distance<70 AND route.rut_active = 1\r\n\t\t\t\t\t\tINNER JOIN route routeAlias ON routeAlias.rut_to_city_id=routeFrom.rut_to_city_id\r\n\t\t\t\t\t\t\tAND routeAlias.rut_from_city_id=routeTo.rut_from_city_id AND routeAlias.rut_active = 1"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15098.341] [M: 30514.64] [ET: 3.392/15075.214] [MU: 2.42/30514.02] 
	SQL: SELECT *, (rte_vendor_amount + extradistance * 10.55 ) AS totalCost, 
						ABS(quotedDistance-rateDistance) AS extraChargeableDistance
					FROM getNearestRoute_30804_30726_70 a
					INNER JOIN rate ON a.rut_id=rate.rte_route_id AND rte_status=1 
						AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <> 0
					WHERE  1
					ORDER  BY rank DESC, extraStartDistance, extraChargeableDistance ASC, totalcost ASC
					LIMIT  0, 1 
	 [params: {"cabType":"112"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15101.716] [M: 30529.73] [ET: 0.532/15078.663] [MU: 3.41/30528.86] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"73","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15103.254] [M: 30548.13] [ET: 0.449/15080.218] [MU: 5.56/30547.26] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15103.959] [M: 30555.4] [ET: 0.455/15080.915] [MU: 0.9/30555.15] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15105.056] [M: 30565.99] [ET: 0.522/15082.01] [MU: 3.34/30565.55] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15107.628] [M: 30576.54] [ET: 2.448/15084.564] [MU: 3.53/30575.66] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp723)) OR (scr_area_type = 5 AND scr_area_id IN (:gp721)) OR (scr_area_type = 2 AND scr_area_id IN (:gp724)) OR (scr_area_type = 4 AND scr_area_id IN (:gp725)) OR (scr_area_type = 1 AND scr_area_id IN (:gp722)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp721":"908",":gp722":"31",":gp723":"908",":gp724":"105",":gp725":"1","scv_id":"73"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15108.756] [M: 30577.12] [ET: 0.692/15085.683] [MU: 0.9/30576.87] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15110.729] [M: 30587.34] [ET: 0.965/15087.681] [MU: 2.97/30586.91] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15113.252] [M: 30597.89] [ET: 2.374/15090.173] [MU: 3.53/30597.02] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp728)) OR (scr_area_type = 5 AND scr_area_id IN (:gp726)) OR (scr_area_type = 2 AND scr_area_id IN (:gp729)) OR (scr_area_type = 4 AND scr_area_id IN (:gp730)) OR (scr_area_type = 1 AND scr_area_id IN (:gp727)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp726":"908",":gp727":"31",":gp728":"908",":gp729":"105",":gp730":"1","scv_id":"112"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15115.485] [M: 30596.48] [ET: 1.407/15092.379] [MU: 0.9/30596.23] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15117.352] [M: 30608.82] [ET: 0.725/15094.252] [MU: 2.97/30608.38] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15118.067] [M: 30637.99] [ET: 0.553/15095.024] [MU: 22.53/30637.24] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp733)) OR (apr_area_type = 5 AND apr_area_id IN (:gp731)) OR (apr_area_type = 2 AND apr_area_id IN (:gp734)) OR (apr_area_type = 4 AND apr_area_id IN (:gp735)) OR (apr_area_type = 1 AND apr_area_id IN (:gp732))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp731":"908",":gp732":"31",":gp733":"30804",":gp734":"105",":gp735":"1","cab":"112"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15119.777] [M: 30625.02] [ET: 0.519/15096.725] [MU: 3.34/30624.58] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15122.085] [M: 30635.56] [ET: 2.184/15099.036] [MU: 3.53/30634.69] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp738)) OR (scr_area_type = 5 AND scr_area_id IN (:gp736)) OR (scr_area_type = 2 AND scr_area_id IN (:gp739)) OR (scr_area_type = 4 AND scr_area_id IN (:gp740)) OR (scr_area_type = 1 AND scr_area_id IN (:gp737)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp736":"908",":gp737":"31",":gp738":"908",":gp739":"105",":gp740":"1","scv_id":"112"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15123.025] [M: 30640.3] [ET: 0.611/15099.987] [MU: 3.84/30639.43] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15123.491] [M: 30648.12] [ET: 0.38/15100.455] [MU: 4.21/30647.24] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15123.779] [M: 30652.26] [ET: 0.22/15100.747] [MU: 2.98/30652.15] 
	BookingRoute::calculateDistance
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15126.791] [M: 30658.54] [ET: 2.803/15103.693] [MU: 2.41/30658.16] 
	SQL: SELECT *
				FROM   partner_rate prt 
				JOIN route rut ON prt.prt_route_id = rut.rut_id AND rut.rut_active = 1
				AND  rut.rut_from_city_id  = 30804 
				AND  rut.rut_to_city_id  = 30726 
				 WHERE prt_vehicletype_id = 112
				AND prt_partner_id = 1249
				AND prt_status = 1
				 
	 [params: []]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15128.332] [M: 30663.77] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30726","cabType":"3","tripDistance":"","tripDuration":"","multiCityData":"","bookingType":"1","pickupAddress":"","pickupDate":"24\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","sccId":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30726&cabType=3&tripDistance=&tripDuration=&multiCityData=&bookingType=1&pickupAddress=&pickupDate=24%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&sccId=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15129.015] [M: 30680.61] [ET: 1.457/15105.966] [MU: 18.04/30680.5] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15129.078] [M: 30682.29] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15130.796] [M: 30695.75] [ET: 1.489/15107.705] [MU: 2.99/30693.25] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+5845),(IF((cpm_value_type=2),(5845+(5845*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30726 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30726) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-24 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=112 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15133.266] [M: 30737.98] [ET: 5.888/15110.225] [MU: 75.87/30737.82] 
	RouteRates::calculate for CAB 112 2024-10-24 18:00:00 - Trip Type: 1 642035022
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15133.482] [M: 30717.59] [ET: 56.687/15110.452] [MU: 291.72/30717.44] 
	Quote::calculateOneWay  for CAB 112 Date: 2024-10-24 18:00:00
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15133.726] [M: 30713.32] [ET: 0.175/15110.694] [MU: 0.9/30713.07] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"112"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15133.802] [M: 30715.51] [ET: 62.603/15110.768] [MU: 336.71/30715.41] 
	Quote For CabType: 112
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15134.887] [M: 30725.48] [ET: 0.365/15111.852] [MU: 2.97/30725.05] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15135.289] [M: 30731.3] [ET: 0.332/15112.252] [MU: 3.34/30730.87] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15135.849] [M: 30734.24] [ET: 0.492/15112.811] [MU: 0.89/30733.99] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15136.405] [M: 30766.59] [ET: 0.45/15113.366] [MU: 24.22/30765.09] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (101) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30726) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp741)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp744,:gp745)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp742,:gp743)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp746,:gp747))
			OR (scr_area_type = 5 AND scr_area_id IN (908))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (113)
		ORDER BY rank DESC
		 
	 [params: {":gp741":"31",":gp742":"30804",":gp743":"30726",":gp744":"105",":gp745":"101",":gp746":"1",":gp747":"1","tripType":"1"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15137.052] [M: 30746.78] [ET: 0.203/15114.017] [MU: 0.84/30746.59] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15137.373] [M: 30749.63] [ET: 0.25/15114.34] [MU: 0.93/30749.31] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"6"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15138.466] [M: 30762.46] [ET: 0.353/15115.43] [MU: 2.04/30761.96] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"113"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15141.325] [M: 30771.84] [ET: 2.652/15118.274] [MU: 3.53/30770.97] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"113","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15142.439] [M: 30775.09] [ET: 0.796/15119.374] [MU: 0.87/30774.88] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":0}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15143.845] [M: 30782.38] [ET: 1.078/15120.757] [MU: 2.97/30781.94] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15144.877] [M: 30810.55] [ET: 0.795/15121.822] [MU: 22.04/30809.92] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp749)) OR (apr_area_type = 2 AND apr_area_id IN (:gp750)) OR (apr_area_type = 4 AND apr_area_id IN (:gp751)) OR (apr_area_type = 1 AND apr_area_id IN (:gp748))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp748":"31",":gp749":"30804",":gp750":"105",":gp751":"1","cab":"113"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15146.305] [M: 30797.27] [ET: 0.512/15123.266] [MU: 3.34/30796.84] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15150.11] [M: 30807.55] [ET: 3.676/15127.048] [MU: 3.4/30806.68] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp753)) OR (scr_area_type = 2 AND scr_area_id IN (:gp754)) OR (scr_area_type = 4 AND scr_area_id IN (:gp755)) OR (scr_area_type = 1 AND scr_area_id IN (:gp752)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp752":"31",":gp753":"30804",":gp754":"105",":gp755":"1","scv_id":"113"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15153.562] [M: 30835.25] [ET: 2.493/15130.476] [MU: 0.74/30827.25] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"nearest_route_30804_30726","sql":"(INDEX indx_nearest_rt_rutid (rut_id)) \r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, routeFrom.rut_name as fromAlias, \r\n\t\t\t\tNULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, \r\n\t\t\t\t0 as rank, routeFrom.rut_estm_time as startTime, 0 as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\tAND route.rut_to_city_id=30726 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 \r\n\t\t\t\tAND routeFrom.rut_from_city_id<>routeFrom.rut_to_city_id AND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\t\tAND (routeAlias.rut_to_city_id=route.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (1967,16216,47825,322451,3087761,3190710)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, NULL, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) \r\n\t\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\t0 AS extraStartDistance, 0, 0 as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND route.rut_from_city_id = 30804 AND route.rut_to_city_id=30726 \r\n\t\t\t\tAND routeTo.rut_from_city_id=30726\r\n\t\t\t\tAND route.rut_active = 1 AND routeTo.rut_active = 1 AND routeTo.rut_estm_distance < 50 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = route.rut_from_city_id) \r\n\t\t\t   AND (routeAlias.rut_to_city_id = routeTo.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (1967,16216,47825,322451,3087761,3190710)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, \r\n\t\t\t\trouteFrom.rut_name, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t+ IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) \r\n\t\t\t\tAS extraDistance, IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, 0, \r\n\t\t\t\trouteFrom.rut_estm_time as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\t\tAND route.rut_to_city_id=30726 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 AND routeFrom.rut_from_city_id <> routeFrom.rut_to_city_id\r\n\t\t\t\t\tAND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND routeTo.rut_estm_distance < 50 \r\n\t\t\t\t\tAND routeTo.rut_from_city_id=30726 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\tAND (routeAlias.rut_to_city_id=routeTo.rut_to_city_id) AND routeAlias.rut_active = 1 AND routeAlias.rut_from_city_id=30804  AND routeAlias.rut_id IN (1967,16216,47825,322451,3087761,3190710)"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15156.204] [M: 30839.36] [ET: 2.492/15133.137] [MU: 2.16/30838.92] 
	SQL: SELECT *, (rte_vendor_amount + extraDistance * 10.55) as totalCost FROM (SELECT * FROM nearest_route_30804_30726) a
					INNER JOIN rate ON a.rut_id = rate.rte_route_id AND rte_status=1 AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <>0
					WHERE 1 ORDER BY rank DESC, totalCost ASC LIMIT 0,1 
	 [params: {"cabType":"113"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15157.107] [M: 30847.38] [ET: 0.74/15134.051] [MU: 0.75/30845.38] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"getNearestRoute_30804_30726_70","sql":"(INDEX getNearestRoute_30804_30726_70_index_rut_id (rut_id))\r\n\t\t\t\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id AS start, routeAlias.rut_to_city_id AS end,\r\n\t\t\t\t\t\t\t\trouteFrom.rut_name AS fromAlias, NULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance AS quotedDistance,\r\n\t\t\t\t\t\t\t\trouteAlias.rut_estm_distance AS rateDistance, \r\n\t\t\t\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance)\r\n\t\t\t\t\t\t\t\t\t - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance,\r\n\t\t\t\t\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance,\r\n\t\t\t\t\t\t\t\t0 AS rank, routeFrom.rut_estm_time AS startTime, 0 AS endTime, route.rut_estm_time, \r\n\t\t\t\t\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraTravelDistance\r\n\t\t\t\t\t\tFROM   route\r\n\t\t\t\t\t\tINNER JOIN route routeTo ON routeTo.rut_to_city_id=route.rut_from_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_from_city_id=30804 AND routeTo.rut_active=1\r\n\t\t\t\t\t\t\t\tAND routeTo.rut_estm_distance<70 AND route.rut_active=1\r\n\t\t\t\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_from_city_id=route.rut_to_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_to_city_id=30726 AND routeFrom.rut_active = 1\r\n\t\t\t\t\t\t\t\tAND routeFrom.rut_estm_distance<70 AND route.rut_active = 1\r\n\t\t\t\t\t\tINNER JOIN route routeAlias ON routeAlias.rut_to_city_id=routeFrom.rut_to_city_id\r\n\t\t\t\t\t\t\tAND routeAlias.rut_from_city_id=routeTo.rut_from_city_id AND routeAlias.rut_active = 1"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15160.246] [M: 30852.65] [ET: 3.004/15137.132] [MU: 2.42/30852.02] 
	SQL: SELECT *, (rte_vendor_amount + extradistance * 10.55 ) AS totalCost, 
						ABS(quotedDistance-rateDistance) AS extraChargeableDistance
					FROM getNearestRoute_30804_30726_70 a
					INNER JOIN rate ON a.rut_id=rate.rte_route_id AND rte_status=1 
						AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <> 0
					WHERE  1
					ORDER  BY rank DESC, extraStartDistance, extraChargeableDistance ASC, totalcost ASC
					LIMIT  0, 1 
	 [params: {"cabType":"113"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15165.033] [M: 30867.74] [ET: 0.92/15141.925] [MU: 3.41/30866.87] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"73","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15167.105] [M: 30886.14] [ET: 0.518/15144.068] [MU: 5.56/30885.27] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15167.899] [M: 30893.41] [ET: 0.534/15144.854] [MU: 0.9/30893.16] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15168.929] [M: 30904] [ET: 0.494/15145.885] [MU: 3.34/30903.56] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15171.107] [M: 30914.55] [ET: 2.052/15148.045] [MU: 3.53/30913.67] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp758)) OR (scr_area_type = 5 AND scr_area_id IN (:gp756)) OR (scr_area_type = 2 AND scr_area_id IN (:gp759)) OR (scr_area_type = 4 AND scr_area_id IN (:gp760)) OR (scr_area_type = 1 AND scr_area_id IN (:gp757)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp756":"908",":gp757":"31",":gp758":"908",":gp759":"105",":gp760":"1","scv_id":"73"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15172.139] [M: 30915.13] [ET: 0.627/15149.086] [MU: 0.9/30914.88] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15173.17] [M: 30925.35] [ET: 0.459/15150.133] [MU: 2.97/30924.91] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15175.338] [M: 30935.9] [ET: 2.05/15152.291] [MU: 3.54/30935.02] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp763)) OR (scr_area_type = 5 AND scr_area_id IN (:gp761)) OR (scr_area_type = 2 AND scr_area_id IN (:gp764)) OR (scr_area_type = 4 AND scr_area_id IN (:gp765)) OR (scr_area_type = 1 AND scr_area_id IN (:gp762)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp761":"908",":gp762":"31",":gp763":"908",":gp764":"105",":gp765":"1","scv_id":"113"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15176.137] [M: 30934.48] [ET: 0.509/15153.094] [MU: 0.9/30934.23] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15177.935] [M: 30946.83] [ET: 0.732/15154.881] [MU: 2.97/30946.39] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15178.584] [M: 30976] [ET: 0.522/15155.526] [MU: 22.53/30975.25] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp768)) OR (apr_area_type = 5 AND apr_area_id IN (:gp766)) OR (apr_area_type = 2 AND apr_area_id IN (:gp769)) OR (apr_area_type = 4 AND apr_area_id IN (:gp770)) OR (apr_area_type = 1 AND apr_area_id IN (:gp767))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp766":"908",":gp767":"31",":gp768":"30804",":gp769":"105",":gp770":"1","cab":"113"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15181.02] [M: 30963.02] [ET: 1.04/15157.942] [MU: 3.34/30962.59] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15184.025] [M: 30973.57] [ET: 2.848/15160.977] [MU: 3.53/30972.7] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp773)) OR (scr_area_type = 5 AND scr_area_id IN (:gp771)) OR (scr_area_type = 2 AND scr_area_id IN (:gp774)) OR (scr_area_type = 4 AND scr_area_id IN (:gp775)) OR (scr_area_type = 1 AND scr_area_id IN (:gp772)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp771":"908",":gp772":"31",":gp773":"908",":gp774":"105",":gp775":"1","scv_id":"113"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15184.87] [M: 30978.31] [ET: 0.532/15161.83] [MU: 3.84/30977.44] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15185.313] [M: 30986.13] [ET: 0.351/15162.277] [MU: 4.21/30985.25] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15185.602] [M: 30990.27] [ET: 0.22/15162.573] [MU: 2.98/30990.16] 
	BookingRoute::calculateDistance
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15187.976] [M: 30996.55] [ET: 2.209/15164.931] [MU: 2.4/30996.17] 
	SQL: SELECT *
				FROM   partner_rate prt 
				JOIN route rut ON prt.prt_route_id = rut.rut_id AND rut.rut_active = 1
				AND  rut.rut_from_city_id  = 30804 
				AND  rut.rut_to_city_id  = 30726 
				 WHERE prt_vehicletype_id = 113
				AND prt_partner_id = 1249
				AND prt_status = 1
				 
	 [params: []]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15188.701] [M: 31001.77] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30726","cabType":"3","tripDistance":"","tripDuration":"","multiCityData":"","bookingType":"1","pickupAddress":"","pickupDate":"24\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","sccId":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30726&cabType=3&tripDistance=&tripDuration=&multiCityData=&bookingType=1&pickupAddress=&pickupDate=24%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&sccId=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15189.147] [M: 31018.62] [ET: 0.91/15166.115] [MU: 18.05/31018.51] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15189.19] [M: 31020.3] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15190.235] [M: 31033.76] [ET: 0.899/15167.17] [MU: 2.99/31031.26] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+5845),(IF((cpm_value_type=2),(5845+(5845*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30726 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30726) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-24 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=113 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15191.696] [M: 31075.98] [ET: 3.521/15168.657] [MU: 75.87/31075.83] 
	RouteRates::calculate for CAB 113 2024-10-24 18:00:00 - Trip Type: 1 333818138
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15191.916] [M: 31055.6] [ET: 53.385/15168.886] [MU: 291.72/31055.45] 
	Quote::calculateOneWay  for CAB 113 Date: 2024-10-24 18:00:00
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15192.206] [M: 31051.33] [ET: 0.216/15169.172] [MU: 0.9/31051.08] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"113"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15192.279] [M: 31053.52] [ET: 58.427/15169.249] [MU: 336.7/31053.42] 
	Quote For CabType: 113
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15193.353] [M: 31063.49] [ET: 0.365/15170.318] [MU: 2.97/31063.05] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15193.746] [M: 31069.31] [ET: 0.327/15170.712] [MU: 3.35/31068.88] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15194.252] [M: 31072.22] [ET: 0.437/15171.216] [MU: 0.9/31072] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15194.799] [M: 31104.6] [ET: 0.441/15171.759] [MU: 24.21/31103.1] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (101) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30726) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp776)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp779,:gp780)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp777,:gp778)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp781,:gp782))
			OR (scr_area_type = 5 AND scr_area_id IN (908))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (114)
		ORDER BY rank DESC
		 
	 [params: {":gp776":"31",":gp777":"30804",":gp778":"30726",":gp779":"105",":gp780":"101",":gp781":"1",":gp782":"1","tripType":"1"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15195.535] [M: 31084.79] [ET: 0.208/15172.501] [MU: 0.83/31084.6] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15195.839] [M: 31087.63] [ET: 0.232/15172.806] [MU: 0.93/31087.32] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"6"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15197.37] [M: 31100.47] [ET: 0.706/15174.326] [MU: 2.05/31099.97] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"114"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15200.111] [M: 31109.85] [ET: 2.488/15177.031] [MU: 3.53/31108.98] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"114","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15200.984] [M: 31113.1] [ET: 0.579/15177.937] [MU: 0.87/31112.88] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":0}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15201.639] [M: 31120.38] [ET: 0.471/15178.604] [MU: 2.97/31119.95] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15202.243] [M: 31148.55] [ET: 0.466/15179.207] [MU: 22.04/31147.93] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp784)) OR (apr_area_type = 2 AND apr_area_id IN (:gp785)) OR (apr_area_type = 4 AND apr_area_id IN (:gp786)) OR (apr_area_type = 1 AND apr_area_id IN (:gp783))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp783":"31",":gp784":"30804",":gp785":"105",":gp786":"1","cab":"114"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15203.262] [M: 31135.28] [ET: 0.445/15180.227] [MU: 3.34/31134.84] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15205.886] [M: 31145.56] [ET: 2.496/15182.824] [MU: 3.41/31144.69] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp788)) OR (scr_area_type = 2 AND scr_area_id IN (:gp789)) OR (scr_area_type = 4 AND scr_area_id IN (:gp790)) OR (scr_area_type = 1 AND scr_area_id IN (:gp787)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp787":"31",":gp788":"30804",":gp789":"105",":gp790":"1","scv_id":"114"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15208.562] [M: 31173.26] [ET: 1.868/15185.499] [MU: 0.74/31165.26] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"nearest_route_30804_30726","sql":"(INDEX indx_nearest_rt_rutid (rut_id)) \r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, routeFrom.rut_name as fromAlias, \r\n\t\t\t\tNULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, \r\n\t\t\t\t0 as rank, routeFrom.rut_estm_time as startTime, 0 as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\tAND route.rut_to_city_id=30726 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 \r\n\t\t\t\tAND routeFrom.rut_from_city_id<>routeFrom.rut_to_city_id AND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\t\tAND (routeAlias.rut_to_city_id=route.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (1967,16216,47825,322451,3087761,3190710)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, NULL, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) \r\n\t\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\t0 AS extraStartDistance, 0, 0 as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND route.rut_from_city_id = 30804 AND route.rut_to_city_id=30726 \r\n\t\t\t\tAND routeTo.rut_from_city_id=30726\r\n\t\t\t\tAND route.rut_active = 1 AND routeTo.rut_active = 1 AND routeTo.rut_estm_distance < 50 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = route.rut_from_city_id) \r\n\t\t\t   AND (routeAlias.rut_to_city_id = routeTo.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (1967,16216,47825,322451,3087761,3190710)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, \r\n\t\t\t\trouteFrom.rut_name, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t+ IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) \r\n\t\t\t\tAS extraDistance, IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, 0, \r\n\t\t\t\trouteFrom.rut_estm_time as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\t\tAND route.rut_to_city_id=30726 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 AND routeFrom.rut_from_city_id <> routeFrom.rut_to_city_id\r\n\t\t\t\t\tAND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND routeTo.rut_estm_distance < 50 \r\n\t\t\t\t\tAND routeTo.rut_from_city_id=30726 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\tAND (routeAlias.rut_to_city_id=routeTo.rut_to_city_id) AND routeAlias.rut_active = 1 AND routeAlias.rut_from_city_id=30804  AND routeAlias.rut_id IN (1967,16216,47825,322451,3087761,3190710)"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15210.911] [M: 31177.37] [ET: 2.248/15187.864] [MU: 2.16/31176.93] 
	SQL: SELECT *, (rte_vendor_amount + extraDistance * 10.55) as totalCost FROM (SELECT * FROM nearest_route_30804_30726) a
					INNER JOIN rate ON a.rut_id = rate.rte_route_id AND rte_status=1 AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <>0
					WHERE 1 ORDER BY rank DESC, totalCost ASC LIMIT 0,1 
	 [params: {"cabType":"114"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15211.712] [M: 31185.39] [ET: 0.671/15188.654] [MU: 0.74/31183.39] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"getNearestRoute_30804_30726_70","sql":"(INDEX getNearestRoute_30804_30726_70_index_rut_id (rut_id))\r\n\t\t\t\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id AS start, routeAlias.rut_to_city_id AS end,\r\n\t\t\t\t\t\t\t\trouteFrom.rut_name AS fromAlias, NULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance AS quotedDistance,\r\n\t\t\t\t\t\t\t\trouteAlias.rut_estm_distance AS rateDistance, \r\n\t\t\t\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance)\r\n\t\t\t\t\t\t\t\t\t - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance,\r\n\t\t\t\t\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance,\r\n\t\t\t\t\t\t\t\t0 AS rank, routeFrom.rut_estm_time AS startTime, 0 AS endTime, route.rut_estm_time, \r\n\t\t\t\t\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraTravelDistance\r\n\t\t\t\t\t\tFROM   route\r\n\t\t\t\t\t\tINNER JOIN route routeTo ON routeTo.rut_to_city_id=route.rut_from_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_from_city_id=30804 AND routeTo.rut_active=1\r\n\t\t\t\t\t\t\t\tAND routeTo.rut_estm_distance<70 AND route.rut_active=1\r\n\t\t\t\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_from_city_id=route.rut_to_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_to_city_id=30726 AND routeFrom.rut_active = 1\r\n\t\t\t\t\t\t\t\tAND routeFrom.rut_estm_distance<70 AND route.rut_active = 1\r\n\t\t\t\t\t\tINNER JOIN route routeAlias ON routeAlias.rut_to_city_id=routeFrom.rut_to_city_id\r\n\t\t\t\t\t\t\tAND routeAlias.rut_from_city_id=routeTo.rut_from_city_id AND routeAlias.rut_active = 1"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15214.464] [M: 31190.66] [ET: 2.638/15191.385] [MU: 2.41/31190.03] 
	SQL: SELECT *, (rte_vendor_amount + extradistance * 10.55 ) AS totalCost, 
						ABS(quotedDistance-rateDistance) AS extraChargeableDistance
					FROM getNearestRoute_30804_30726_70 a
					INNER JOIN rate ON a.rut_id=rate.rte_route_id AND rte_status=1 
						AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <> 0
					WHERE  1
					ORDER  BY rank DESC, extraStartDistance, extraChargeableDistance ASC, totalcost ASC
					LIMIT  0, 1 
	 [params: {"cabType":"114"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15217.613] [M: 31205.75] [ET: 0.502/15194.56] [MU: 3.42/31204.88] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"73","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15219.096] [M: 31224.15] [ET: 0.434/15196.059] [MU: 5.57/31223.27] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15219.823] [M: 31231.41] [ET: 0.483/15196.78] [MU: 0.9/31231.16] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15220.798] [M: 31242.01] [ET: 0.456/15197.748] [MU: 3.33/31241.57] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15222.931] [M: 31252.55] [ET: 2.014/15199.871] [MU: 3.53/31251.68] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp793)) OR (scr_area_type = 5 AND scr_area_id IN (:gp791)) OR (scr_area_type = 2 AND scr_area_id IN (:gp794)) OR (scr_area_type = 4 AND scr_area_id IN (:gp795)) OR (scr_area_type = 1 AND scr_area_id IN (:gp792)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp791":"908",":gp792":"31",":gp793":"908",":gp794":"105",":gp795":"1","scv_id":"73"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15223.952] [M: 31253.13] [ET: 0.564/15200.898] [MU: 0.9/31252.88] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15224.981] [M: 31263.36] [ET: 0.481/15201.945] [MU: 2.96/31262.92] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15227.099] [M: 31273.91] [ET: 1.998/15204.05] [MU: 3.53/31273.03] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp798)) OR (scr_area_type = 5 AND scr_area_id IN (:gp796)) OR (scr_area_type = 2 AND scr_area_id IN (:gp799)) OR (scr_area_type = 4 AND scr_area_id IN (:gp800)) OR (scr_area_type = 1 AND scr_area_id IN (:gp797)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp796":"908",":gp797":"31",":gp798":"908",":gp799":"105",":gp800":"1","scv_id":"114"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15228.073] [M: 31272.49] [ET: 0.607/15205.033] [MU: 0.89/31272.24] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15229.179] [M: 31284.84] [ET: 0.48/15206.127] [MU: 2.97/31284.4] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15229.849] [M: 31314.01] [ET: 0.555/15206.8] [MU: 22.53/31313.26] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp803)) OR (apr_area_type = 5 AND apr_area_id IN (:gp801)) OR (apr_area_type = 2 AND apr_area_id IN (:gp804)) OR (apr_area_type = 4 AND apr_area_id IN (:gp805)) OR (apr_area_type = 1 AND apr_area_id IN (:gp802))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp801":"908",":gp802":"31",":gp803":"30804",":gp804":"105",":gp805":"1","cab":"114"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15231.668] [M: 31301.03] [ET: 0.459/15208.619] [MU: 3.34/31300.59] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15233.951] [M: 31311.58] [ET: 2.171/15210.902] [MU: 3.54/31310.7] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp808)) OR (scr_area_type = 5 AND scr_area_id IN (:gp806)) OR (scr_area_type = 2 AND scr_area_id IN (:gp809)) OR (scr_area_type = 4 AND scr_area_id IN (:gp810)) OR (scr_area_type = 1 AND scr_area_id IN (:gp807)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp806":"908",":gp807":"31",":gp808":"908",":gp809":"105",":gp810":"1","scv_id":"114"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15234.888] [M: 31316.32] [ET: 0.567/15211.849] [MU: 3.85/31315.45] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30804"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15235.383] [M: 31324.13] [ET: 0.398/15212.327] [MU: 4.21/31323.26] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30726"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15235.809] [M: 31328.27] [ET: 0.333/15212.779] [MU: 2.98/31328.16] 
	BookingRoute::calculateDistance
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15238.025] [M: 31334.65] [ET: 2.054/15214.981] [MU: 2.41/31334.27] 
	SQL: SELECT *
				FROM   partner_rate prt 
				JOIN route rut ON prt.prt_route_id = rut.rut_id AND rut.rut_active = 1
				AND  rut.rut_from_city_id  = 30804 
				AND  rut.rut_to_city_id  = 30726 
				 WHERE prt_vehicletype_id = 114
				AND prt_partner_id = 1249
				AND prt_status = 1
				 
	 [params: []]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15238.842] [M: 31339.88] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30726","cabType":"3","tripDistance":"","tripDuration":"","multiCityData":"","bookingType":"1","pickupAddress":"","pickupDate":"24\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","sccId":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30726&cabType=3&tripDistance=&tripDuration=&multiCityData=&bookingType=1&pickupAddress=&pickupDate=24%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&sccId=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15239.331] [M: 31356.72] [ET: 1.047/15216.3] [MU: 18.04/31356.61] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15239.374] [M: 31358.4] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15240.504] [M: 31371.86] [ET: 0.969/15217.417] [MU: 2.99/31369.36] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+5845),(IF((cpm_value_type=2),(5845+(5845*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30726 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30726) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-24 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=114 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15242.155] [M: 31414.09] [ET: 3.93/15219.118] [MU: 75.87/31413.93] 
	RouteRates::calculate for CAB 114 2024-10-24 18:00:00 - Trip Type: 1 362857034
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15242.374] [M: 31393.7] [ET: 44.931/15219.344] [MU: 291.81/31393.55] 
	Quote::calculateOneWay  for CAB 114 Date: 2024-10-24 18:00:00
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15242.624] [M: 31389.43] [ET: 0.184/15219.593] [MU: 0.9/31389.18] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"114"}]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15242.697] [M: 31391.62] [ET: 50.364/15219.669] [MU: 336.8/31391.52] 
	Quote For CabType: 114
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15244.196] [M: 31433.64] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.QuotesDataCreated.setData START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30726","cabType":"3","tripDistance":"","tripDuration":"","multiCityData":"","bookingType":"1","pickupAddress":"","pickupDate":"24\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","sccId":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30726&cabType=3&tripDistance=&tripDuration=&multiCityData=&bookingType=1&pickupAddress=&pickupDate=24%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&sccId=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15281.857] [M: 31515] [ET: 20.469/15258.796] [MU: 15.61/31514.89] 
	QuotesDataPickup::setData for CAB Array
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15281.988] [M: 31510.58] [ET: 38.218/15258.937] [MU: 78.14/31510.47] 
	models.QuotesDataCreated.setData
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15282.043] [M: 31512.26] 
============================================================Profile models.QuotesDataCreated.setData DONE==================================================
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15282.193] [M: 31508.67] [ET: 14951.781/15259.144] [MU: 12698.67/31508.56] 
	models.Quote.getQuote
2024/10/17 14:04:41 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15282.367] [M: 31512.15] 
============================================================Profile models.Quote.getQuote DONE==================================================
2024/10/17 14:04:42 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15345.603] [M: 31906.1] [ET: 12.859/15322.544] [MU: 1.03/31905.73] 
	SQL: SELECT GROUP_CONCAT(zones.zon_id) as zones FROM cities c1
					INNER JOIN zone_cities ON zone_cities.zct_cty_id = c1.cty_id AND zct_active=1
					INNER JOIN zones ON zone_cities.zct_zon_id = zones.zon_id AND zon_active=1
					WHERE c1.cty_id = 30726 
	 [params: []]
2024/10/17 14:04:42 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15350.249] [M: 31911.69] [ET: 2.387/15327.18] [MU: 2.11/31911.31] 
	SQL: SELECT dzs_zone_type FROM dynamic_zone_surge WHERE dzs_fromzoneid IN (:gp811) AND dzs_tozoneid IN (:gp812,:gp813,:gp814) AND dzs_scv_id=:cab AND dzs_booking_type=:tripType  ORDER BY  dzs_zone_type ASC 
	 [params: {":gp812":"385",":gp813":"852",":gp814":"980",":gp811":"31","cab":3,"tripType":"1"}]
2024/10/17 14:04:42 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15357.063] [M: 31914.55] [ET: 6.133/15333.978] [MU: 1.24/31913.92] 
	SQL: SELECT prc_cancel_rule_id FROM `partner_cancel_rule` 
			WHERE (prc_zone_category = :zoneType OR prc_zone_category IS NULL)
		AND (prc_scc_id = :sccId OR prc_scc_id IS NULL)
		AND (prc_partner_id = :partnerId OR prc_partner_id IS NULL) 
		AND (prc_bkg_type = :tripType OR prc_bkg_type IS NULL) 
		 AND (prc_is_gozonow IS NULL) 
		AND prc_active=1  
		ORDER BY prc_partner_id DESC, prc_bkg_type DESC  
	 [params: {"zoneType":1,"sccId":"1","partnerId":null,"tripType":"1"}]
2024/10/17 14:04:42 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15360.022] [M: 31972.82] [ET: 0.532/15336.963] [MU: 2.97/31972.38] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:42 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15365.145] [M: 31979.7] [ET: 4.266/15342.069] [MU: 2.47/31979.32] 
	SQL: SELECT dzs_zone_type FROM dynamic_zone_surge WHERE dzs_fromzoneid IN (:gp815) AND dzs_tozoneid IN (:gp816,:gp817,:gp818) AND dzs_scv_id=:cab AND dzs_booking_type=:tripType  ORDER BY  dzs_zone_type ASC 
	 [params: {":gp816":"385",":gp817":"852",":gp818":"980",":gp815":"31","cab":3,"tripType":"1"}]
2024/10/17 14:04:42 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15370.722] [M: 32009.7] [ET: 5.406/15347.66] [MU: 25.27/32008.45] 
	SQL: SELECT addon_cancellation_policy.*,
								CASE
											WHEN acp_area_type=1 AND acp_area_id IN (31) THEN 5
											WHEN acp_area_type=2 AND acp_area_id IN (105) THEN 15
											WHEN acp_area_type=3 AND acp_area_id IN (30804) THEN 20
											WHEN acp_area_type=4 AND acp_area_id IN (1) THEN 1
											WHEN acp_area_type=5 AND acp_area_id IN (-1) THEN 10
											ELSE 0
											END AS rank FROM addon_cancellation_policy
						WHERE (
								(acp_area_type = 1 AND acp_area_id IN (:gp819))
								OR (acp_area_type = 2 AND acp_area_id IN (:gp821))
								OR (acp_area_type = 3 AND acp_area_id IN (:gp820))
								OR (acp_area_type = 4 AND acp_area_id IN (:gp822))
								OR (acp_area_type = 5 AND acp_area_id IN (-1))
								OR acp_area_type IS NULL)
							AND acp_cr_from = :defCanRuleId AND acp_active=1 AND acp_is_allowed = 1
						ORDER BY rank DESC 
	 [params: {":gp819":"31",":gp820":"30804",":gp821":"105",":gp822":"1","defCanRuleId":"4"}]
2024/10/17 14:04:42 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15373.979] [M: 32006.63] [ET: 0.561/15350.941] [MU: 2.81/32006.45] 
	SQL: SELECT acp_cr_to,acp_margin_data FROM `addon_cancellation_policy` WHERE `acp_id` = :id 
	 [params: {"id":"8"}]
2024/10/17 14:04:42 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15394.537] [M: 32046.65] [ET: 0.384/15371.474] [MU: 1.42/32046.46] 
	SQL: SELECT acp_cr_to,acp_margin_data FROM `addon_cancellation_policy` WHERE `acp_id` = :id 
	 [params: {"id":"9"}]
2024/10/17 14:04:42 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15398.4] [M: 32126.78] [ET: 0.572/15375.343] [MU: 3.34/32126.34] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:42 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15401.224] [M: 32133.53] [ET: 2.051/15378.162] [MU: 2.47/32133.16] 
	SQL: SELECT dzs_zone_type FROM dynamic_zone_surge WHERE dzs_fromzoneid IN (:gp823) AND dzs_tozoneid IN (:gp824,:gp825,:gp826) AND dzs_scv_id=:cab AND dzs_booking_type=:tripType  ORDER BY  dzs_zone_type ASC 
	 [params: {":gp824":"385",":gp825":"852",":gp826":"980",":gp823":"31","cab":3,"tripType":"1"}]
2024/10/17 14:04:42 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15405.914] [M: 32162.15] [ET: 4.531/15382.861] [MU: 24.25/32161.15] 
	SQL: SELECT addon_cab_models.*,
								CASE
											WHEN acm_area_type=1 AND acm_area_id IN (31) THEN 5
											WHEN acm_area_type=2 AND acm_area_id IN (105) THEN 15
											WHEN acm_area_type=3 AND acm_area_id IN (30804) THEN 20
											WHEN acm_area_type=4 AND acm_area_id IN (1) THEN 1
											WHEN acm_area_type=5 AND acm_area_id IN (-1) THEN 10
											ELSE 0
											END AS rank FROM addon_cab_models
						WHERE (
								(acm_area_type = 1 AND acm_area_id IN (:gp827))
								OR (acm_area_type = 2 AND acm_area_id IN (:gp829))
								OR (acm_area_type = 3 AND acm_area_id IN (:gp828))
								OR (acm_area_type = 4 AND acm_area_id IN (:gp830))
								OR (acm_area_type = 5 AND acm_area_id IN (-1))
								OR acm_area_type IS NULL)
							AND acm_scv_id_from = :svcId AND acm_active=1
						ORDER BY rank DESC 
	 [params: {":gp827":"31",":gp828":"30804",":gp829":"105",":gp830":"1","svcId":3}]
2024/10/17 14:04:42 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15408.366] [M: 32139.72] [ET: 0.425/15385.323] [MU: 1.34/32139.53] 
	SQL: SELECT acm_svc_id_to,acm_margin_data FROM `addon_cab_models` WHERE `acm_id` = :id 
	 [params: {"id":"1"}]
2024/10/17 14:04:42 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15409.119] [M: 32143.53] [ET: 0.25/15386.083] [MU: 1.35/32143.34] 
	SQL: SELECT acm_svc_id_to,acm_margin_data FROM `addon_cab_models` WHERE `acm_id` = :id 
	 [params: {"id":"2"}]
2024/10/17 14:04:42 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15409.802] [M: 32146.97] [ET: 0.207/15386.768] [MU: 1.34/32146.78] 
	SQL: SELECT acm_svc_id_to,acm_margin_data FROM `addon_cab_models` WHERE `acm_id` = :id 
	 [params: {"id":"3"}]
2024/10/17 14:04:42 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15410.414] [M: 32150.41] [ET: 0.201/15387.38] [MU: 1.34/32150.22] 
	SQL: SELECT acm_svc_id_to,acm_margin_data FROM `addon_cab_models` WHERE `acm_id` = :id 
	 [params: {"id":"4"}]
2024/10/17 14:04:42 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15429.46] [M: 32549.91] [ET: 11.724/15406.372] [MU: 48.95/32548.66] 
	SQL:  SELECT scv_id,scc_id, vct_id, scc_cancel_rule, scc_label,scc_rank, scv_label, scv_code, scc_model_year, 
								CONCAT(vct_label, ' (', scc_label , ')') label,
									vct_label,vct_rank, vct_desc, CONCAT(vct_label, ' ', vct_desc) vhcName, 
									vct_capacity, IF(vct_image IS NULL, 'images/cabs/no-image.png', vct_image) as vct_image, vct_big_bag_capacity, vct_small_bag_capacity, vcsc_small_bag, FLOOR(vcsc_small_bag/2) AS big_bag,
									scc_is_cng, scc_is_petrol_diesel, scc_id, scc_desc, IF( vct_id IN(5, 6), '1', '0' ) AS is_assured, scv_vct_id,scv_parent_id,scv_vct_id,scv_model,scv_scc_id
						FROM svc_class_vhc_cat
						INNER JOIN service_class ON scc_id = scv_scc_id
						INNER JOIN vehicle_category ON vct_id = scv_vct_id
						INNER JOIN vehicle_cat_svc_class on vcsc_ssc_id = scv_scc_id AND vcsc_vct_id = scv_vct_id
						WHERE scv_active = 1 
							AND scc_active = 1 
						AND vct_active = 1
		 AND scv_vct_id = 3 
	 [params: []]
2024/10/17 14:04:42 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15438.615] [M: 32492.59] [ET: 15349.428/15415.56] [MU: 22444.69/32492.47] 
	module.admin.controller.booking.getamountbyvehicle
2024/10/17 14:04:42 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15438.665] [M: 32493.24] 
*******************************************************module.admin.controller.booking.getamountbyvehicle ACTION DONE****************************************************************
2024/10/17 14:04:58 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 110.824] [M: 10054.5] 
------------------------------------------------------module.admin.controller.booking.getamountbyvehicle ACTION START------------------------------------------------------
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30726","cabType":"3","tripDistance":"375","tripDuration":"420","multiCityData":"[{\"pickup_city\":\"30804\",\"drop_city\":\"30726\",\"pickup_address\":\"\",\"drop_address\":null,\"date\":\"2024-10-24 18:00:00\",\"distance\":\"375\",\"duration\":\"420\"}]","bookingType":"1","pickupAddress":"","dropupAddress":"","routeDataArr":[{"locLatVal":"","locLonVal":"","brtLocationVal":""},{"locLatVal":"","locLonVal":"","brtLocationVal":""}],"pickupDate":"24\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30726&cabType=3&tripDistance=375&tripDuration=420&multiCityData=%5B%7B%22pickup_city%22%3A%2230804%22%2C%22drop_city%22%3A%2230726%22%2C%22pickup_address%22%3A%22%22%2C%22drop_address%22%3Anull%2C%22date%22%3A%222024-10-24+18%3A00%3A00%22%2C%22distance%22%3A%22375%22%2C%22duration%22%3A%22420%22%7D%5D&bookingType=1&pickupAddress=&dropupAddress=&routeDataArr%5B0%5D%5BlocLatVal%5D=&routeDataArr%5B0%5D%5BlocLonVal%5D=&routeDataArr%5B0%5D%5BbrtLocationVal%5D=&routeDataArr%5B1%5D%5BlocLatVal%5D=&routeDataArr%5B1%5D%5BlocLonVal%5D=&routeDataArr%5B1%5D%5BbrtLocationVal%5D=&pickupDate=24%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 14:04:58 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 145.861] [M: 11290.7] setLocationRequest start
2024/10/17 14:04:58 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 240.362] [M: 11291.21] setLocationRequest ends
2024/10/17 14:04:58 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 325.383] [M: 18116.59] [ET: 0.28/291.142] [MU: 0.84/18116.41] 
	SQL: SELECT COUNT(1) as cnt FROM cities WHERE cty_active=1 AND cty_service_active=1 AND cty_id=30804 
	 [params: []]
2024/10/17 14:04:58 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 325.643] [M: 18117.89] [ET: 0.192/291.408] [MU: 0.84/18117.7] 
	SQL: SELECT COUNT(1) as cnt FROM cities WHERE cty_active=1 AND cty_service_active=1 AND cty_id=30726 
	 [params: []]
2024/10/17 14:04:58 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 342.675] [M: 18604.77] [ET: 16.957/308.41] [MU: 486.78/18604.66] 
	BookingRoute::calculateDistance
2024/10/17 14:04:58 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 343.393] [M: 18602.19] [ET: 0.349/309.134] [MU: 5.12/18602.08] 
	BookingRoute::calculateDistance
2024/10/17 14:04:58 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 343.477] [M: 18598.23] [ET: 56.831/309.23] [MU: 5974.33/18598.14] 
	validateRoutes
2024/10/17 14:04:58 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 346.964] [M: 18831.35] [ET: 0.882/312.707] [MU: 27.08/18831.13] 
	SQL: SELECT scv_id FROM svc_class_vhc_cat WHERE scv_active = 1 AND scv_scc_id IN (1,2,4,6) ORDER BY scv_vct_id ASC,scv_scc_id ASC 
	 [params: []]
2024/10/17 14:04:58 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 348.973] [M: 18821.74] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.Quote.getQuote START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30726","cabType":"3","tripDistance":"375","tripDuration":"420","multiCityData":"[{\"pickup_city\":\"30804\",\"drop_city\":\"30726\",\"pickup_address\":\"\",\"drop_address\":null,\"date\":\"2024-10-24 18:00:00\",\"distance\":\"375\",\"duration\":\"420\"}]","bookingType":"1","pickupAddress":"","dropupAddress":"","routeDataArr":[{"locLatVal":"","locLonVal":"","brtLocationVal":""},{"locLatVal":"","locLonVal":"","brtLocationVal":""}],"pickupDate":"24\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30726&cabType=3&tripDistance=375&tripDuration=420&multiCityData=%5B%7B%22pickup_city%22%3A%2230804%22%2C%22drop_city%22%3A%2230726%22%2C%22pickup_address%22%3A%22%22%2C%22drop_address%22%3Anull%2C%22date%22%3A%222024-10-24+18%3A00%3A00%22%2C%22distance%22%3A%22375%22%2C%22duration%22%3A%22420%22%7D%5D&bookingType=1&pickupAddress=&dropupAddress=&routeDataArr%5B0%5D%5BlocLatVal%5D=&routeDataArr%5B0%5D%5BlocLonVal%5D=&routeDataArr%5B0%5D%5BbrtLocationVal%5D=&routeDataArr%5B1%5D%5BlocLatVal%5D=&routeDataArr%5B1%5D%5BlocLonVal%5D=&routeDataArr%5B1%5D%5BbrtLocationVal%5D=&pickupDate=24%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 14:04:58 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 352.091] [M: 18951.13] [ET: 0.601/317.833] [MU: 8.84/18950.69] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:58 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 352.691] [M: 18956.08] [ET: 0.503/318.438] [MU: 3.34/18955.64] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30726"}]
2024/10/17 14:04:58 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 353.306] [M: 18958.12] [ET: 0.523/319.036] [MU: 0.9/18957.9] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:58 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 354.571] [M: 19009.27] [ET: 1.086/320.256] [MU: 43.61/19007.77] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (101) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30726) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp0)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp3,:gp4)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp1,:gp2)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp5,:gp6))
			OR (scr_area_type = 5 AND scr_area_id IN (908))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (3)
		ORDER BY rank DESC
		 
	 [params: {":gp0":"31",":gp1":"30804",":gp2":"30726",":gp3":"105",":gp4":"101",":gp5":"1",":gp6":"1","tripType":"1"}]
2024/10/17 14:04:58 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 368.769] [M: 19059.63] [ET: 0.432/334.511] [MU: 0.84/19059.45] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 14:04:58 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 369.293] [M: 19061.92] [ET: 0.409/335.035] [MU: 0.96/19061.61] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"1"}]
2024/10/17 14:04:58 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 389.637] [M: 19514.46] [ET: 1.575/355.369] [MU: 5.85/19513.59] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:58 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 393.545] [M: 19681.42] [ET: 0.728/359.279] [MU: 0.9/19681.2] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:58 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 397.015] [M: 19809.02] [ET: 0.555/362.774] [MU: 3.34/19808.58] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:58 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 397.714] [M: 19840.88] [ET: 0.587/363.472] [MU: 25.35/19840.13] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp9)) OR (apr_area_type = 5 AND apr_area_id IN (:gp7)) OR (apr_area_type = 2 AND apr_area_id IN (:gp10)) OR (apr_area_type = 4 AND apr_area_id IN (:gp11)) OR (apr_area_type = 1 AND apr_area_id IN (:gp8))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp7":"908",":gp8":"31",":gp9":"30804",":gp10":"105",":gp11":"1","cab":"3"}]
2024/10/17 14:04:58 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 424.098] [M: 21389.67] [ET: 0.599/389.855] [MU: 4.21/21388.8] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30804"}]
2024/10/17 14:04:58 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 437.162] [M: 21437.85] [ET: 0.684/402.915] [MU: 4.21/21436.98] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30726"}]
2024/10/17 14:04:58 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 438.639] [M: 21459.43] [ET: 0.271/404.403] [MU: 7.12/21459.32] 
	BookingRoute::calculateDistance
2024/10/17 14:04:58 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 441.068] [M: 21497.16] [ET: 0.711/406.808] [MU: 2.65/21496.79] 
	SQL: SELECT *
				FROM   partner_rate prt 
				JOIN route rut ON prt.prt_route_id = rut.rut_id AND rut.rut_active = 1
				AND  rut.rut_from_city_id  = 30804 
				AND  rut.rut_to_city_id  = 30726 
				 WHERE prt_vehicletype_id = 3
				AND prt_partner_id = 1249
				AND prt_status = 1
				 
	 [params: []]
2024/10/17 14:04:58 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 442.011] [M: 21503.14] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30726","cabType":"3","tripDistance":"375","tripDuration":"420","multiCityData":"[{\"pickup_city\":\"30804\",\"drop_city\":\"30726\",\"pickup_address\":\"\",\"drop_address\":null,\"date\":\"2024-10-24 18:00:00\",\"distance\":\"375\",\"duration\":\"420\"}]","bookingType":"1","pickupAddress":"","dropupAddress":"","routeDataArr":[{"locLatVal":"","locLonVal":"","brtLocationVal":""},{"locLatVal":"","locLonVal":"","brtLocationVal":""}],"pickupDate":"24\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30726&cabType=3&tripDistance=375&tripDuration=420&multiCityData=%5B%7B%22pickup_city%22%3A%2230804%22%2C%22drop_city%22%3A%2230726%22%2C%22pickup_address%22%3A%22%22%2C%22drop_address%22%3Anull%2C%22date%22%3A%222024-10-24+18%3A00%3A00%22%2C%22distance%22%3A%22375%22%2C%22duration%22%3A%22420%22%7D%5D&bookingType=1&pickupAddress=&dropupAddress=&routeDataArr%5B0%5D%5BlocLatVal%5D=&routeDataArr%5B0%5D%5BlocLonVal%5D=&routeDataArr%5B0%5D%5BbrtLocationVal%5D=&routeDataArr%5B1%5D%5BlocLatVal%5D=&routeDataArr%5B1%5D%5BlocLonVal%5D=&routeDataArr%5B1%5D%5BbrtLocationVal%5D=&pickupDate=24%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 14:04:58 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 442.68] [M: 21522.23] [ET: 1.231/408.43] [MU: 21.05/21522.13] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 14:04:58 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 442.734] [M: 21523.91] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 14:04:58 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 445.162] [M: 21606.88] [ET: 1.004/410.913] [MU: 3.2/21604.38] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+5845),(IF((cpm_value_type=2),(5845+(5845*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30726 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30726) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-24 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=3 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 14:04:58 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 476.202] [M: 22960.32] [ET: 34.854/441.96] [MU: 1459.6/22960.16] 
	RouteRates::calculate for CAB 3 2024-10-24 18:00:00 - Trip Type: 1 982293377
2024/10/17 14:04:58 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 476.413] [M: 22939.23] [ET: 88.633/442.18] [MU: 3435.07/22939.1] 
	Quote::calculateOneWay  for CAB 3 Date: 2024-10-24 18:00:00
2024/10/17 14:04:58 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 476.683] [M: 22935.05] [ET: 0.204/442.447] [MU: 0.9/22934.8] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"3"}]
2024/10/17 14:04:58 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 476.752] [M: 22935.65] [ET: 127.696/442.52] [MU: 4110.67/22935.55] 
	Quote For CabType: 3
2024/10/17 14:04:58 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 477.836] [M: 22949.41] [ET: 0.372/443.598] [MU: 3.34/22948.98] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:58 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 478.223] [M: 22954.37] [ET: 0.326/443.988] [MU: 3.34/22953.93] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30726"}]
2024/10/17 14:04:58 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 478.746] [M: 22956.41] [ET: 0.457/444.509] [MU: 0.9/22956.19] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:58 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 479.304] [M: 22988.17] [ET: 0.454/445.063] [MU: 24.21/22986.67] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (101) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30726) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp12)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp15,:gp16)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp13,:gp14)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp17,:gp18))
			OR (scr_area_type = 5 AND scr_area_id IN (908))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (16)
		ORDER BY rank DESC
		 
	 [params: {":gp12":"31",":gp13":"30804",":gp14":"30726",":gp15":"105",":gp16":"101",":gp17":"1",":gp18":"1","tripType":"1"}]
2024/10/17 14:04:58 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 479.889] [M: 22966.48] [ET: 0.159/445.655] [MU: 0.83/22966.29] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 14:04:58 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 480.188] [M: 22968.77] [ET: 0.235/445.953] [MU: 0.97/22968.45] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"2"}]
2024/10/17 14:04:58 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 481.646] [M: 22993.88] [ET: 0.551/447.4] [MU: 3.78/22993.01] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"16","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:58 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 483.157] [M: 23012.28] [ET: 0.434/448.918] [MU: 5.56/23011.41] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:58 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 483.76] [M: 23019.52] [ET: 0.396/449.524] [MU: 0.9/23019.3] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:58 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 484.75] [M: 23030.14] [ET: 0.464/450.51] [MU: 3.34/23029.7] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:58 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 486.813] [M: 23040.85] [ET: 1.954/452.563] [MU: 3.7/23039.98] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp21)) OR (scr_area_type = 5 AND scr_area_id IN (:gp19)) OR (scr_area_type = 2 AND scr_area_id IN (:gp22)) OR (scr_area_type = 4 AND scr_area_id IN (:gp23)) OR (scr_area_type = 1 AND scr_area_id IN (:gp20)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp19":"908",":gp20":"31",":gp21":"908",":gp22":"105",":gp23":"1","scv_id":"16"}]
2024/10/17 14:04:58 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 487.863] [M: 23039.42] [ET: 0.702/453.597] [MU: 0.9/23039.2] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:58 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 489.532] [M: 23051.8] [ET: 0.834/455.29] [MU: 2.97/23051.36] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:58 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 490.238] [M: 23080.72] [ET: 0.586/455.992] [MU: 22.4/23079.97] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp26)) OR (apr_area_type = 5 AND apr_area_id IN (:gp24)) OR (apr_area_type = 2 AND apr_area_id IN (:gp27)) OR (apr_area_type = 4 AND apr_area_id IN (:gp28)) OR (apr_area_type = 1 AND apr_area_id IN (:gp25))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp24":"908",":gp25":"31",":gp26":"30804",":gp27":"105",":gp28":"1","cab":"16"}]
2024/10/17 14:04:58 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 491.685] [M: 23067.98] [ET: 0.472/457.44] [MU: 3.33/23067.54] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:58 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 494.046] [M: 23078.52] [ET: 2.236/459.77] [MU: 3.53/23077.65] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp31)) OR (scr_area_type = 5 AND scr_area_id IN (:gp29)) OR (scr_area_type = 2 AND scr_area_id IN (:gp32)) OR (scr_area_type = 4 AND scr_area_id IN (:gp33)) OR (scr_area_type = 1 AND scr_area_id IN (:gp30)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp29":"908",":gp30":"31",":gp31":"908",":gp32":"105",":gp33":"1","scv_id":"16"}]
2024/10/17 14:04:58 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 495.061] [M: 23083.28] [ET: 0.6/460.82] [MU: 3.84/23082.41] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30804"}]
2024/10/17 14:04:58 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 495.516] [M: 23091.09] [ET: 0.37/461.277] [MU: 4.21/23090.22] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30726"}]
2024/10/17 14:04:58 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 495.809] [M: 23099.36] [ET: 0.224/461.573] [MU: 7.1/23099.25] 
	BookingRoute::calculateDistance
2024/10/17 14:04:58 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 496.381] [M: 23102.14] [ET: 0.415/462.141] [MU: 2.66/23101.77] 
	SQL: SELECT *
				FROM   partner_rate prt 
				JOIN route rut ON prt.prt_route_id = rut.rut_id AND rut.rut_active = 1
				AND  rut.rut_from_city_id  = 30804 
				AND  rut.rut_to_city_id  = 30726 
				 WHERE prt_vehicletype_id = 16
				AND prt_partner_id = 1249
				AND prt_status = 1
				 
	 [params: []]
2024/10/17 14:04:58 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 496.975] [M: 23108.12] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30726","cabType":"3","tripDistance":"375","tripDuration":"420","multiCityData":"[{\"pickup_city\":\"30804\",\"drop_city\":\"30726\",\"pickup_address\":\"\",\"drop_address\":null,\"date\":\"2024-10-24 18:00:00\",\"distance\":\"375\",\"duration\":\"420\"}]","bookingType":"1","pickupAddress":"","dropupAddress":"","routeDataArr":[{"locLatVal":"","locLonVal":"","brtLocationVal":""},{"locLatVal":"","locLonVal":"","brtLocationVal":""}],"pickupDate":"24\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30726&cabType=3&tripDistance=375&tripDuration=420&multiCityData=%5B%7B%22pickup_city%22%3A%2230804%22%2C%22drop_city%22%3A%2230726%22%2C%22pickup_address%22%3A%22%22%2C%22drop_address%22%3Anull%2C%22date%22%3A%222024-10-24+18%3A00%3A00%22%2C%22distance%22%3A%22375%22%2C%22duration%22%3A%22420%22%7D%5D&bookingType=1&pickupAddress=&dropupAddress=&routeDataArr%5B0%5D%5BlocLatVal%5D=&routeDataArr%5B0%5D%5BlocLonVal%5D=&routeDataArr%5B0%5D%5BbrtLocationVal%5D=&routeDataArr%5B1%5D%5BlocLatVal%5D=&routeDataArr%5B1%5D%5BlocLonVal%5D=&routeDataArr%5B1%5D%5BbrtLocationVal%5D=&pickupDate=24%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 14:04:58 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 497.384] [M: 23127.21] [ET: 0.804/463.151] [MU: 21.04/23127.1] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 14:04:58 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 497.416] [M: 23128.89] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 14:04:58 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 498.393] [M: 23142.35] [ET: 0.845/464.125] [MU: 2.99/23139.85] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+5845),(IF((cpm_value_type=2),(5845+(5845*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30726 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30726) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-24 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=16 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 14:04:58 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 500.265] [M: 23184.58] [ET: 3.723/466.012] [MU: 78.87/23184.42] 
	RouteRates::calculate for CAB 16 2024-10-24 18:00:00 - Trip Type: 1 499943558
2024/10/17 14:04:58 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 500.581] [M: 23164.2] [ET: 19.613/466.331] [MU: 178.52/23164.04] 
	Quote::calculateOneWay  for CAB 16 Date: 2024-10-24 18:00:00
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 500.907] [M: 23160.8] [ET: 0.225/466.655] [MU: 0.9/23160.55] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"16"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 501.012] [M: 23162.05] [ET: 24.203/466.764] [MU: 225.59/23161.95] 
	Quote For CabType: 16
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 502.373] [M: 23172.39] [ET: 0.458/468.119] [MU: 3.34/23171.95] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 502.898] [M: 23178.21] [ET: 0.425/468.646] [MU: 3.35/23177.77] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 503.639] [M: 23181.12] [ET: 0.649/469.395] [MU: 0.9/23180.9] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 504.273] [M: 23213.5] [ET: 0.504/470.006] [MU: 24.22/23212] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (101) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30726) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp34)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp37,:gp38)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp35,:gp36)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp39,:gp40))
			OR (scr_area_type = 5 AND scr_area_id IN (908))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (45)
		ORDER BY rank DESC
		 
	 [params: {":gp34":"31",":gp35":"30804",":gp36":"30726",":gp37":"105",":gp38":"101",":gp39":"1",":gp40":"1","tripType":"1"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 505.07] [M: 23193.67] [ET: 0.214/470.832] [MU: 0.84/23193.48] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 505.511] [M: 23196.55] [ET: 0.344/471.248] [MU: 0.96/23196.23] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"4"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 508.18] [M: 23214.63] [ET: 0.638/473.939] [MU: 3.78/23213.75] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"45","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 510.086] [M: 23231.24] [ET: 0.669/475.826] [MU: 3.78/23230.37] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"16","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 511.86] [M: 23265.64] [ET: 0.455/477.619] [MU: 5.56/23264.77] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 512.551] [M: 23272.88] [ET: 0.457/478.292] [MU: 0.9/23272.66] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 513.727] [M: 23283.5] [ET: 0.508/479.486] [MU: 3.34/23283.06] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 514.292] [M: 23294.3] [ET: 0.462/480.053] [MU: 3.78/23293.42] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp43)) OR (scr_area_type = 5 AND scr_area_id IN (:gp41)) OR (scr_area_type = 2 AND scr_area_id IN (:gp44)) OR (scr_area_type = 4 AND scr_area_id IN (:gp45)) OR (scr_area_type = 1 AND scr_area_id IN (:gp42)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp41":"908",":gp42":"31",":gp43":"908",":gp44":"105",":gp45":"1","scv_id":"16"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 515.153] [M: 23294.84] [ET: 0.564/480.911] [MU: 0.9/23294.63] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 516.195] [M: 23305.47] [ET: 0.511/481.954] [MU: 3.33/23305.03] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 518.312] [M: 23316.02] [ET: 2.006/484.061] [MU: 3.53/23315.14] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp48)) OR (scr_area_type = 5 AND scr_area_id IN (:gp46)) OR (scr_area_type = 2 AND scr_area_id IN (:gp49)) OR (scr_area_type = 4 AND scr_area_id IN (:gp50)) OR (scr_area_type = 1 AND scr_area_id IN (:gp47)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp46":"908",":gp47":"31",":gp48":"908",":gp49":"105",":gp50":"1","scv_id":"45"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 519.167] [M: 23314.59] [ET: 0.568/484.923] [MU: 0.9/23314.37] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 520.312] [M: 23326.96] [ET: 0.49/486.066] [MU: 2.97/23326.52] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 520.927] [M: 23355.88] [ET: 0.51/486.686] [MU: 22.41/23355.13] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp53)) OR (apr_area_type = 5 AND apr_area_id IN (:gp51)) OR (apr_area_type = 2 AND apr_area_id IN (:gp54)) OR (apr_area_type = 4 AND apr_area_id IN (:gp55)) OR (apr_area_type = 1 AND apr_area_id IN (:gp52))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp51":"908",":gp52":"31",":gp53":"30804",":gp54":"105",":gp55":"1","cab":"45"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 522.697] [M: 23343.14] [ET: 0.719/488.454] [MU: 3.34/23342.7] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 525.289] [M: 23353.69] [ET: 2.456/491.02] [MU: 3.54/23352.81] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp58)) OR (scr_area_type = 5 AND scr_area_id IN (:gp56)) OR (scr_area_type = 2 AND scr_area_id IN (:gp59)) OR (scr_area_type = 4 AND scr_area_id IN (:gp60)) OR (scr_area_type = 1 AND scr_area_id IN (:gp57)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp56":"908",":gp57":"31",":gp58":"908",":gp59":"105",":gp60":"1","scv_id":"45"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 526.374] [M: 23358.45] [ET: 0.639/492.106] [MU: 3.84/23357.57] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 526.96] [M: 23366.26] [ET: 0.459/492.705] [MU: 4.22/23365.38] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 527.404] [M: 23374.52] [ET: 0.346/493.155] [MU: 7.1/23374.41] 
	BookingRoute::calculateDistance
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 528.132] [M: 23377.3] [ET: 0.5/493.88] [MU: 2.65/23376.93] 
	SQL: SELECT *
				FROM   partner_rate prt 
				JOIN route rut ON prt.prt_route_id = rut.rut_id AND rut.rut_active = 1
				AND  rut.rut_from_city_id  = 30804 
				AND  rut.rut_to_city_id  = 30726 
				 WHERE prt_vehicletype_id = 45
				AND prt_partner_id = 1249
				AND prt_status = 1
				 
	 [params: []]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 528.917] [M: 23383.28] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30726","cabType":"3","tripDistance":"375","tripDuration":"420","multiCityData":"[{\"pickup_city\":\"30804\",\"drop_city\":\"30726\",\"pickup_address\":\"\",\"drop_address\":null,\"date\":\"2024-10-24 18:00:00\",\"distance\":\"375\",\"duration\":\"420\"}]","bookingType":"1","pickupAddress":"","dropupAddress":"","routeDataArr":[{"locLatVal":"","locLonVal":"","brtLocationVal":""},{"locLatVal":"","locLonVal":"","brtLocationVal":""}],"pickupDate":"24\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30726&cabType=3&tripDistance=375&tripDuration=420&multiCityData=%5B%7B%22pickup_city%22%3A%2230804%22%2C%22drop_city%22%3A%2230726%22%2C%22pickup_address%22%3A%22%22%2C%22drop_address%22%3Anull%2C%22date%22%3A%222024-10-24+18%3A00%3A00%22%2C%22distance%22%3A%22375%22%2C%22duration%22%3A%22420%22%7D%5D&bookingType=1&pickupAddress=&dropupAddress=&routeDataArr%5B0%5D%5BlocLatVal%5D=&routeDataArr%5B0%5D%5BlocLonVal%5D=&routeDataArr%5B0%5D%5BbrtLocationVal%5D=&routeDataArr%5B1%5D%5BlocLatVal%5D=&routeDataArr%5B1%5D%5BlocLonVal%5D=&routeDataArr%5B1%5D%5BbrtLocationVal%5D=&pickupDate=24%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 529.527] [M: 23402.38] [ET: 1.097/495.277] [MU: 21.05/23402.27] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 529.578] [M: 23404.05] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 530.623] [M: 23417.52] [ET: 0.886/496.373] [MU: 2.99/23415.02] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+5845),(IF((cpm_value_type=2),(5845+(5845*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30726 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30726) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-24 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=45 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 532.384] [M: 23459.74] [ET: 4.036/498.146] [MU: 78.88/23459.59] 
	RouteRates::calculate for CAB 45 2024-10-24 18:00:00 - Trip Type: 1 963074300
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 532.631] [M: 23439.36] [ET: 25.275/498.398] [MU: 232.95/23439.2] 
	Quote::calculateOneWay  for CAB 45 Date: 2024-10-24 18:00:00
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 532.931] [M: 23435.74] [ET: 0.224/498.689] [MU: 0.89/23435.49] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"45"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 533.004] [M: 23436.99] [ET: 31.926/498.773] [MU: 273.64/23436.9] 
	Quote For CabType: 45
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 534.272] [M: 23447.34] [ET: 0.438/500.027] [MU: 3.33/23446.9] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 534.754] [M: 23453.16] [ET: 0.396/500.512] [MU: 3.34/23452.72] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 535.393] [M: 23456.06] [ET: 0.559/501.148] [MU: 0.9/23455.84] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 536.083] [M: 23488.45] [ET: 0.561/501.829] [MU: 24.22/23486.95] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (101) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30726) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp61)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp64,:gp65)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp62,:gp63)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp66,:gp67))
			OR (scr_area_type = 5 AND scr_area_id IN (908))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (54)
		ORDER BY rank DESC
		 
	 [params: {":gp61":"31",":gp62":"30804",":gp63":"30726",":gp64":"105",":gp65":"101",":gp66":"1",":gp67":"1","tripType":"1"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 536.756] [M: 23468.63] [ET: 0.192/502.514] [MU: 0.84/23468.45] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 537.254] [M: 23471.51] [ET: 0.413/503.009] [MU: 0.96/23471.2] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"4"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 538.542] [M: 23484.48] [ET: 0.365/504.298] [MU: 2.05/23483.98] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"54"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 539.944] [M: 23494.11] [ET: 1.066/505.694] [MU: 3.78/23493.23] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"54","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 541.941] [M: 23510.74] [ET: 0.59/507.684] [MU: 3.78/23509.87] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"45","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 543.678] [M: 23527.36] [ET: 0.499/509.432] [MU: 3.78/23526.48] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"16","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 545.286] [M: 23545.76] [ET: 0.498/511.041] [MU: 5.57/23544.88] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 546.053] [M: 23552.99] [ET: 0.519/511.809] [MU: 0.9/23552.77] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 547.352] [M: 23563.62] [ET: 0.591/513.107] [MU: 3.33/23563.18] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 549.959] [M: 23574.16] [ET: 2.464/515.692] [MU: 3.53/23573.29] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp70)) OR (scr_area_type = 5 AND scr_area_id IN (:gp68)) OR (scr_area_type = 2 AND scr_area_id IN (:gp71)) OR (scr_area_type = 4 AND scr_area_id IN (:gp72)) OR (scr_area_type = 1 AND scr_area_id IN (:gp69)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp68":"908",":gp69":"31",":gp70":"908",":gp71":"105",":gp72":"1","scv_id":"16"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 551.08] [M: 23574.74] [ET: 0.623/516.839] [MU: 0.89/23574.49] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 552.102] [M: 23584.97] [ET: 0.478/517.861] [MU: 2.96/23584.53] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 554.512] [M: 23595.52] [ET: 2.301/520.264] [MU: 3.53/23594.64] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp75)) OR (scr_area_type = 5 AND scr_area_id IN (:gp73)) OR (scr_area_type = 2 AND scr_area_id IN (:gp76)) OR (scr_area_type = 4 AND scr_area_id IN (:gp77)) OR (scr_area_type = 1 AND scr_area_id IN (:gp74)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp73":"908",":gp74":"31",":gp75":"908",":gp76":"105",":gp77":"1","scv_id":"45"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 555.719] [M: 23596.06] [ET: 0.852/521.453] [MU: 0.9/23595.84] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 557.05] [M: 23606.32] [ET: 0.482/522.81] [MU: 2.97/23605.88] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 559.357] [M: 23616.87] [ET: 2.183/525.089] [MU: 3.53/23615.99] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp80)) OR (scr_area_type = 5 AND scr_area_id IN (:gp78)) OR (scr_area_type = 2 AND scr_area_id IN (:gp81)) OR (scr_area_type = 4 AND scr_area_id IN (:gp82)) OR (scr_area_type = 1 AND scr_area_id IN (:gp79)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp78":"908",":gp79":"31",":gp80":"908",":gp81":"105",":gp82":"1","scv_id":"54"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 560.387] [M: 23615.42] [ET: 0.623/526.129] [MU: 0.9/23615.2] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 561.771] [M: 23627.8] [ET: 0.583/527.511] [MU: 2.97/23627.36] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 562.45] [M: 23656.72] [ET: 0.53/528.2] [MU: 22.4/23655.97] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp85)) OR (apr_area_type = 5 AND apr_area_id IN (:gp83)) OR (apr_area_type = 2 AND apr_area_id IN (:gp86)) OR (apr_area_type = 4 AND apr_area_id IN (:gp87)) OR (apr_area_type = 1 AND apr_area_id IN (:gp84))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp83":"908",":gp84":"31",":gp85":"30804",":gp86":"105",":gp87":"1","cab":"54"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 564.18] [M: 23643.99] [ET: 0.566/529.923] [MU: 3.34/23643.55] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 566.784] [M: 23654.54] [ET: 2.432/532.502] [MU: 3.53/23653.66] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp90)) OR (scr_area_type = 5 AND scr_area_id IN (:gp88)) OR (scr_area_type = 2 AND scr_area_id IN (:gp91)) OR (scr_area_type = 4 AND scr_area_id IN (:gp92)) OR (scr_area_type = 1 AND scr_area_id IN (:gp89)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp88":"908",":gp89":"31",":gp90":"908",":gp91":"105",":gp92":"1","scv_id":"54"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 567.856] [M: 23659.28] [ET: 0.618/533.608] [MU: 3.84/23658.41] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 568.485] [M: 23667.09] [ET: 0.524/534.237] [MU: 4.21/23666.22] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 568.85] [M: 23675.36] [ET: 0.276/534.608] [MU: 7.1/23675.25] 
	BookingRoute::calculateDistance
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 569.56] [M: 23678.14] [ET: 0.519/535.315] [MU: 2.66/23677.77] 
	SQL: SELECT *
				FROM   partner_rate prt 
				JOIN route rut ON prt.prt_route_id = rut.rut_id AND rut.rut_active = 1
				AND  rut.rut_from_city_id  = 30804 
				AND  rut.rut_to_city_id  = 30726 
				 WHERE prt_vehicletype_id = 54
				AND prt_partner_id = 1249
				AND prt_status = 1
				 
	 [params: []]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 570.243] [M: 23684.12] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30726","cabType":"3","tripDistance":"375","tripDuration":"420","multiCityData":"[{\"pickup_city\":\"30804\",\"drop_city\":\"30726\",\"pickup_address\":\"\",\"drop_address\":null,\"date\":\"2024-10-24 18:00:00\",\"distance\":\"375\",\"duration\":\"420\"}]","bookingType":"1","pickupAddress":"","dropupAddress":"","routeDataArr":[{"locLatVal":"","locLonVal":"","brtLocationVal":""},{"locLatVal":"","locLonVal":"","brtLocationVal":""}],"pickupDate":"24\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30726&cabType=3&tripDistance=375&tripDuration=420&multiCityData=%5B%7B%22pickup_city%22%3A%2230804%22%2C%22drop_city%22%3A%2230726%22%2C%22pickup_address%22%3A%22%22%2C%22drop_address%22%3Anull%2C%22date%22%3A%222024-10-24+18%3A00%3A00%22%2C%22distance%22%3A%22375%22%2C%22duration%22%3A%22420%22%7D%5D&bookingType=1&pickupAddress=&dropupAddress=&routeDataArr%5B0%5D%5BlocLatVal%5D=&routeDataArr%5B0%5D%5BlocLonVal%5D=&routeDataArr%5B0%5D%5BbrtLocationVal%5D=&routeDataArr%5B1%5D%5BlocLatVal%5D=&routeDataArr%5B1%5D%5BlocLonVal%5D=&routeDataArr%5B1%5D%5BbrtLocationVal%5D=&pickupDate=24%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 570.765] [M: 23703.21] [ET: 0.959/536.526] [MU: 21.04/23703.1] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 570.804] [M: 23704.89] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 572.037] [M: 23718.35] [ET: 1.028/537.725] [MU: 2.99/23715.85] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+5845),(IF((cpm_value_type=2),(5845+(5845*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30726 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30726) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-24 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=54 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 574.82] [M: 23760.58] [ET: 5.065/540.565] [MU: 78.87/23760.42] 
	RouteRates::calculate for CAB 54 2024-10-24 18:00:00 - Trip Type: 1 159566221
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 575.152] [M: 23772.2] [ET: 36.525/540.904] [MU: 286.3/23772.04] 
	Quote::calculateOneWay  for CAB 54 Date: 2024-10-24 18:00:00
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 575.507] [M: 23767.7] [ET: 0.251/541.252] [MU: 0.9/23767.45] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"54"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 575.615] [M: 23768.95] [ET: 42.548/541.366] [MU: 330.64/23768.85] 
	Quote For CabType: 54
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 576.976] [M: 23779.29] [ET: 0.462/542.722] [MU: 3.33/23778.85] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 577.502] [M: 23785.11] [ET: 0.425/543.249] [MU: 3.34/23784.67] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 578.087] [M: 23788.02] [ET: 0.484/543.832] [MU: 0.9/23787.8] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 578.81] [M: 23820.4] [ET: 0.578/544.554] [MU: 24.22/23818.9] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (101) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30726) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp93)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp96,:gp97)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp94,:gp95)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp98,:gp99))
			OR (scr_area_type = 5 AND scr_area_id IN (908))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (55)
		ORDER BY rank DESC
		 
	 [params: {":gp93":"31",":gp94":"30804",":gp95":"30726",":gp96":"105",":gp97":"101",":gp98":"1",":gp99":"1","tripType":"1"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 579.609] [M: 23800.58] [ET: 0.234/545.366] [MU: 0.83/23800.39] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 579.988] [M: 23803.45] [ET: 0.294/545.746] [MU: 0.96/23803.14] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"4"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 581.251] [M: 23816.42] [ET: 0.361/547.007] [MU: 2.04/23815.92] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"55"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 582.162] [M: 23826.05] [ET: 0.687/547.916] [MU: 3.78/23825.18] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"55","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 584.15] [M: 23842.68] [ET: 0.609/549.898] [MU: 3.78/23841.8] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"45","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 586.044] [M: 23859.3] [ET: 0.577/551.792] [MU: 3.78/23858.42] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"16","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 587.946] [M: 23877.7] [ET: 0.51/553.706] [MU: 5.56/23876.82] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 588.974] [M: 23884.96] [ET: 0.711/554.621] [MU: 0.89/23884.71] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 590.94] [M: 23895.55] [ET: 0.906/556.637] [MU: 3.34/23895.12] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 593.351] [M: 23906.1] [ET: 2.27/559.101] [MU: 3.53/23905.23] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp102)) OR (scr_area_type = 5 AND scr_area_id IN (:gp100)) OR (scr_area_type = 2 AND scr_area_id IN (:gp103)) OR (scr_area_type = 4 AND scr_area_id IN (:gp104)) OR (scr_area_type = 1 AND scr_area_id IN (:gp101)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp100":"908",":gp101":"31",":gp102":"908",":gp103":"105",":gp104":"1","scv_id":"16"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 594.403] [M: 23906.65] [ET: 0.686/560.16] [MU: 0.9/23906.43] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 595.439] [M: 23916.91] [ET: 0.465/561.201] [MU: 2.97/23916.47] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 598.128] [M: 23927.45] [ET: 2.57/563.858] [MU: 3.53/23926.58] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp107)) OR (scr_area_type = 5 AND scr_area_id IN (:gp105)) OR (scr_area_type = 2 AND scr_area_id IN (:gp108)) OR (scr_area_type = 4 AND scr_area_id IN (:gp109)) OR (scr_area_type = 1 AND scr_area_id IN (:gp106)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp105":"908",":gp106":"31",":gp107":"908",":gp108":"105",":gp109":"1","scv_id":"45"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 599.376] [M: 23928] [ET: 0.62/565.125] [MU: 0.89/23927.78] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 600.558] [M: 23938.26] [ET: 0.56/566.308] [MU: 2.97/23937.82] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 602.901] [M: 23948.8] [ET: 2.202/568.651] [MU: 3.53/23947.93] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp112)) OR (scr_area_type = 5 AND scr_area_id IN (:gp110)) OR (scr_area_type = 2 AND scr_area_id IN (:gp113)) OR (scr_area_type = 4 AND scr_area_id IN (:gp114)) OR (scr_area_type = 1 AND scr_area_id IN (:gp111)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp110":"908",":gp111":"31",":gp112":"908",":gp113":"105",":gp114":"1","scv_id":"55"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 603.879] [M: 23947.37] [ET: 0.68/569.62] [MU: 0.9/23947.15] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 605.189] [M: 23959.74] [ET: 0.475/570.949] [MU: 2.97/23959.3] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 606.204] [M: 23988.91] [ET: 0.891/571.944] [MU: 22.53/23988.16] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp117)) OR (apr_area_type = 5 AND apr_area_id IN (:gp115)) OR (apr_area_type = 2 AND apr_area_id IN (:gp118)) OR (apr_area_type = 4 AND apr_area_id IN (:gp119)) OR (apr_area_type = 1 AND apr_area_id IN (:gp116))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp115":"908",":gp116":"31",":gp117":"30804",":gp118":"105",":gp119":"1","cab":"55"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 608.078] [M: 23975.93] [ET: 0.599/573.822] [MU: 3.33/23975.49] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 610.68] [M: 23986.48] [ET: 2.437/576.414] [MU: 3.53/23985.6] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp122)) OR (scr_area_type = 5 AND scr_area_id IN (:gp120)) OR (scr_area_type = 2 AND scr_area_id IN (:gp123)) OR (scr_area_type = 4 AND scr_area_id IN (:gp124)) OR (scr_area_type = 1 AND scr_area_id IN (:gp121)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp120":"908",":gp121":"31",":gp122":"908",":gp123":"105",":gp124":"1","scv_id":"55"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 611.834] [M: 23991.23] [ET: 0.644/577.584] [MU: 3.84/23990.35] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 612.385] [M: 23999.04] [ET: 0.445/578.138] [MU: 4.21/23998.16] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 612.749] [M: 24007.29] [ET: 0.283/578.508] [MU: 7.1/24007.2] 
	BookingRoute::calculateDistance
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 613.449] [M: 24010.09] [ET: 0.507/579.204] [MU: 2.65/24009.71] 
	SQL: SELECT *
				FROM   partner_rate prt 
				JOIN route rut ON prt.prt_route_id = rut.rut_id AND rut.rut_active = 1
				AND  rut.rut_from_city_id  = 30804 
				AND  rut.rut_to_city_id  = 30726 
				 WHERE prt_vehicletype_id = 55
				AND prt_partner_id = 1249
				AND prt_status = 1
				 
	 [params: []]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 614.158] [M: 24016.06] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30726","cabType":"3","tripDistance":"375","tripDuration":"420","multiCityData":"[{\"pickup_city\":\"30804\",\"drop_city\":\"30726\",\"pickup_address\":\"\",\"drop_address\":null,\"date\":\"2024-10-24 18:00:00\",\"distance\":\"375\",\"duration\":\"420\"}]","bookingType":"1","pickupAddress":"","dropupAddress":"","routeDataArr":[{"locLatVal":"","locLonVal":"","brtLocationVal":""},{"locLatVal":"","locLonVal":"","brtLocationVal":""}],"pickupDate":"24\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30726&cabType=3&tripDistance=375&tripDuration=420&multiCityData=%5B%7B%22pickup_city%22%3A%2230804%22%2C%22drop_city%22%3A%2230726%22%2C%22pickup_address%22%3A%22%22%2C%22drop_address%22%3Anull%2C%22date%22%3A%222024-10-24+18%3A00%3A00%22%2C%22distance%22%3A%22375%22%2C%22duration%22%3A%22420%22%7D%5D&bookingType=1&pickupAddress=&dropupAddress=&routeDataArr%5B0%5D%5BlocLatVal%5D=&routeDataArr%5B0%5D%5BlocLonVal%5D=&routeDataArr%5B0%5D%5BbrtLocationVal%5D=&routeDataArr%5B1%5D%5BlocLatVal%5D=&routeDataArr%5B1%5D%5BlocLonVal%5D=&routeDataArr%5B1%5D%5BbrtLocationVal%5D=&pickupDate=24%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 614.677] [M: 24035.16] [ET: 0.975/580.436] [MU: 21.05/24035.05] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 614.717] [M: 24036.84] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 615.927] [M: 24050.3] [ET: 1.05/581.657] [MU: 2.99/24047.8] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+5845),(IF((cpm_value_type=2),(5845+(5845*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30726 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30726) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-24 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=55 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 617.796] [M: 24092.52] [ET: 4.148/583.542] [MU: 78.88/24092.37] 
	RouteRates::calculate for CAB 55 2024-10-24 18:00:00 - Trip Type: 1 787944723
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 618.124] [M: 24072.14] [ET: 36.789/583.871] [MU: 254.3/24071.98] 
	Quote::calculateOneWay  for CAB 55 Date: 2024-10-24 18:00:00
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 618.457] [M: 24067.65] [ET: 0.227/584.207] [MU: 0.9/24067.4] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"55"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 618.569] [M: 24068.9] [ET: 42.87/584.317] [MU: 298.65/24068.8] 
	Quote For CabType: 55
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 620.079] [M: 24079.24] [ET: 0.474/585.823] [MU: 3.34/24078.8] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 620.623] [M: 24085.06] [ET: 0.442/586.37] [MU: 3.35/24084.63] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 621.293] [M: 24087.97] [ET: 0.575/587.048] [MU: 0.9/24087.75] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 621.967] [M: 24120.35] [ET: 0.531/587.7] [MU: 24.21/24118.85] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (101) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30726) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp125)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp128,:gp129)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp126,:gp127)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp130,:gp131))
			OR (scr_area_type = 5 AND scr_area_id IN (908))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (57)
		ORDER BY rank DESC
		 
	 [params: {":gp125":"31",":gp126":"30804",":gp127":"30726",":gp128":"105",":gp129":"101",":gp130":"1",":gp131":"1","tripType":"1"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 623.738] [M: 24100.53] [ET: 0.603/589.462] [MU: 0.84/24100.34] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 624.411] [M: 24103.41] [ET: 0.54/590.167] [MU: 0.96/24103.09] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"4"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 626.195] [M: 24116.38] [ET: 0.503/591.953] [MU: 2.05/24115.88] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"57"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 627.004] [M: 24126.01] [ET: 0.604/592.763] [MU: 3.79/24125.13] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"57","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 628.825] [M: 24142.63] [ET: 0.638/594.574] [MU: 3.78/24141.76] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"45","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 630.598] [M: 24159.25] [ET: 0.432/596.359] [MU: 3.78/24158.38] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"16","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 632.125] [M: 24177.65] [ET: 0.47/597.885] [MU: 5.57/24176.77] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 632.905] [M: 24184.88] [ET: 0.56/598.668] [MU: 0.9/24184.66] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 634.254] [M: 24195.51] [ET: 0.769/599.98] [MU: 3.33/24195.07] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 636.714] [M: 24206.05] [ET: 2.293/602.445] [MU: 3.53/24205.18] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp134)) OR (scr_area_type = 5 AND scr_area_id IN (:gp132)) OR (scr_area_type = 2 AND scr_area_id IN (:gp135)) OR (scr_area_type = 4 AND scr_area_id IN (:gp136)) OR (scr_area_type = 1 AND scr_area_id IN (:gp133)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp132":"908",":gp133":"31",":gp134":"908",":gp135":"105",":gp136":"1","scv_id":"16"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 637.627] [M: 24206.6] [ET: 0.489/603.373] [MU: 0.9/24206.38] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 639.223] [M: 24216.86] [ET: 0.923/604.969] [MU: 2.96/24216.42] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 642.429] [M: 24227.41] [ET: 3.053/608.167] [MU: 3.53/24226.53] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp139)) OR (scr_area_type = 5 AND scr_area_id IN (:gp137)) OR (scr_area_type = 2 AND scr_area_id IN (:gp140)) OR (scr_area_type = 4 AND scr_area_id IN (:gp141)) OR (scr_area_type = 1 AND scr_area_id IN (:gp138)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp137":"908",":gp138":"31",":gp139":"908",":gp140":"105",":gp141":"1","scv_id":"45"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 643.442] [M: 24227.95] [ET: 0.574/609.185] [MU: 0.9/24227.73] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 644.74] [M: 24238.21] [ET: 0.618/610.477] [MU: 2.97/24237.77] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 647.264] [M: 24248.76] [ET: 2.349/612.98] [MU: 3.54/24247.88] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp144)) OR (scr_area_type = 5 AND scr_area_id IN (:gp142)) OR (scr_area_type = 2 AND scr_area_id IN (:gp145)) OR (scr_area_type = 4 AND scr_area_id IN (:gp146)) OR (scr_area_type = 1 AND scr_area_id IN (:gp143)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp142":"908",":gp143":"31",":gp144":"908",":gp145":"105",":gp146":"1","scv_id":"57"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 648.258] [M: 24247.32] [ET: 0.579/613.997] [MU: 0.89/24247.1] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 649.678] [M: 24259.7] [ET: 0.59/615.427] [MU: 2.97/24259.26] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 650.395] [M: 24288.87] [ET: 0.563/616.138] [MU: 22.53/24288.12] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp149)) OR (apr_area_type = 5 AND apr_area_id IN (:gp147)) OR (apr_area_type = 2 AND apr_area_id IN (:gp150)) OR (apr_area_type = 4 AND apr_area_id IN (:gp151)) OR (apr_area_type = 1 AND apr_area_id IN (:gp148))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp147":"908",":gp148":"31",":gp149":"30804",":gp150":"105",":gp151":"1","cab":"57"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 652.248] [M: 24275.88] [ET: 0.606/617.991] [MU: 3.34/24275.45] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 655.908] [M: 24286.43] [ET: 3.494/621.641] [MU: 3.53/24285.55] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp154)) OR (scr_area_type = 5 AND scr_area_id IN (:gp152)) OR (scr_area_type = 2 AND scr_area_id IN (:gp155)) OR (scr_area_type = 4 AND scr_area_id IN (:gp156)) OR (scr_area_type = 1 AND scr_area_id IN (:gp153)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp152":"908",":gp153":"31",":gp154":"908",":gp155":"105",":gp156":"1","scv_id":"57"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 657.145] [M: 24291.18] [ET: 0.804/622.878] [MU: 3.85/24290.3] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 657.944] [M: 24298.99] [ET: 0.663/623.688] [MU: 4.21/24298.12] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 658.483] [M: 24307.24] [ET: 0.432/624.23] [MU: 7.1/24307.15] 
	BookingRoute::calculateDistance
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 659.626] [M: 24310.04] [ET: 0.864/625.366] [MU: 2.66/24309.66] 
	SQL: SELECT *
				FROM   partner_rate prt 
				JOIN route rut ON prt.prt_route_id = rut.rut_id AND rut.rut_active = 1
				AND  rut.rut_from_city_id  = 30804 
				AND  rut.rut_to_city_id  = 30726 
				 WHERE prt_vehicletype_id = 57
				AND prt_partner_id = 1249
				AND prt_status = 1
				 
	 [params: []]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 660.641] [M: 24316.02] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30726","cabType":"3","tripDistance":"375","tripDuration":"420","multiCityData":"[{\"pickup_city\":\"30804\",\"drop_city\":\"30726\",\"pickup_address\":\"\",\"drop_address\":null,\"date\":\"2024-10-24 18:00:00\",\"distance\":\"375\",\"duration\":\"420\"}]","bookingType":"1","pickupAddress":"","dropupAddress":"","routeDataArr":[{"locLatVal":"","locLonVal":"","brtLocationVal":""},{"locLatVal":"","locLonVal":"","brtLocationVal":""}],"pickupDate":"24\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30726&cabType=3&tripDistance=375&tripDuration=420&multiCityData=%5B%7B%22pickup_city%22%3A%2230804%22%2C%22drop_city%22%3A%2230726%22%2C%22pickup_address%22%3A%22%22%2C%22drop_address%22%3Anull%2C%22date%22%3A%222024-10-24+18%3A00%3A00%22%2C%22distance%22%3A%22375%22%2C%22duration%22%3A%22420%22%7D%5D&bookingType=1&pickupAddress=&dropupAddress=&routeDataArr%5B0%5D%5BlocLatVal%5D=&routeDataArr%5B0%5D%5BlocLonVal%5D=&routeDataArr%5B0%5D%5BbrtLocationVal%5D=&routeDataArr%5B1%5D%5BlocLatVal%5D=&routeDataArr%5B1%5D%5BlocLonVal%5D=&routeDataArr%5B1%5D%5BbrtLocationVal%5D=&pickupDate=24%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 661.376] [M: 24335.11] [ET: 1.37/627.12] [MU: 21.04/24335] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 661.433] [M: 24336.79] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 663.025] [M: 24350.25] [ET: 1.367/628.738] [MU: 2.99/24347.75] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+5845),(IF((cpm_value_type=2),(5845+(5845*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30726 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30726) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-24 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=57 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 665.589] [M: 24392.48] [ET: 5.671/631.33] [MU: 78.87/24392.32] 
	RouteRates::calculate for CAB 57 2024-10-24 18:00:00 - Trip Type: 1 865828003
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 665.974] [M: 24372.09] [ET: 39.699/631.725] [MU: 254.3/24371.94] 
	Quote::calculateOneWay  for CAB 57 Date: 2024-10-24 18:00:00
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 666.572] [M: 24367.6] [ET: 0.474/632.31] [MU: 0.89/24367.35] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"57"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 666.697] [M: 24368.85] [ET: 48.047/632.446] [MU: 298.65/24368.76] 
	Quote For CabType: 57
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 668.636] [M: 24379.2] [ET: 0.759/634.371] [MU: 3.34/24378.76] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 669.537] [M: 24385.02] [ET: 0.779/635.279] [MU: 3.34/24384.58] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 670.402] [M: 24387.92] [ET: 0.734/636.136] [MU: 0.9/24387.7] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 671.461] [M: 24420.3] [ET: 0.858/637.183] [MU: 24.22/24418.8] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (101) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30726) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp157)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp160,:gp161)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp158,:gp159)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp162,:gp163))
			OR (scr_area_type = 5 AND scr_area_id IN (908))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (69)
		ORDER BY rank DESC
		 
	 [params: {":gp157":"31",":gp158":"30804",":gp159":"30726",":gp160":"105",":gp161":"101",":gp162":"1",":gp163":"1","tripType":"1"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 674.429] [M: 24400.48] [ET: 0.451/640.184] [MU: 0.84/24400.3] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 674.885] [M: 24403.36] [ET: 0.368/640.643] [MU: 0.96/24403.05] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"4"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 676.323] [M: 24416.33] [ET: 0.476/642.079] [MU: 2.05/24415.83] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"69"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 677.244] [M: 24425.96] [ET: 0.698/643.001] [MU: 3.78/24425.09] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"69","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 679.153] [M: 24442.59] [ET: 0.571/644.909] [MU: 3.78/24441.71] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"45","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 680.944] [M: 24459.2] [ET: 0.578/646.701] [MU: 3.78/24458.33] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"16","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 682.714] [M: 24477.6] [ET: 0.578/648.47] [MU: 5.56/24476.73] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 683.496] [M: 24484.84] [ET: 0.532/649.251] [MU: 0.9/24484.62] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 684.742] [M: 24495.46] [ET: 0.586/650.501] [MU: 3.34/24495.02] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 687.284] [M: 24506.01] [ET: 2.352/653.009] [MU: 3.54/24505.13] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp166)) OR (scr_area_type = 5 AND scr_area_id IN (:gp164)) OR (scr_area_type = 2 AND scr_area_id IN (:gp167)) OR (scr_area_type = 4 AND scr_area_id IN (:gp168)) OR (scr_area_type = 1 AND scr_area_id IN (:gp165)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp164":"908",":gp165":"31",":gp166":"908",":gp167":"105",":gp168":"1","scv_id":"16"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 688.847] [M: 24506.55] [ET: 0.965/654.585] [MU: 0.9/24506.34] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 690.778] [M: 24516.81] [ET: 0.945/656.512] [MU: 2.97/24516.38] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 693.947] [M: 24527.36] [ET: 2.975/659.675] [MU: 3.53/24526.48] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp171)) OR (scr_area_type = 5 AND scr_area_id IN (:gp169)) OR (scr_area_type = 2 AND scr_area_id IN (:gp172)) OR (scr_area_type = 4 AND scr_area_id IN (:gp173)) OR (scr_area_type = 1 AND scr_area_id IN (:gp170)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp169":"908",":gp170":"31",":gp171":"908",":gp172":"105",":gp173":"1","scv_id":"45"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 695.304] [M: 24527.91] [ET: 0.779/661.021] [MU: 0.9/24527.69] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 696.759] [M: 24538.16] [ET: 0.555/662.517] [MU: 2.97/24537.73] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 699.343] [M: 24548.71] [ET: 2.455/665.074] [MU: 3.53/24547.84] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp176)) OR (scr_area_type = 5 AND scr_area_id IN (:gp174)) OR (scr_area_type = 2 AND scr_area_id IN (:gp177)) OR (scr_area_type = 4 AND scr_area_id IN (:gp178)) OR (scr_area_type = 1 AND scr_area_id IN (:gp175)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp174":"908",":gp175":"31",":gp176":"908",":gp177":"105",":gp178":"1","scv_id":"69"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 700.639] [M: 24547.27] [ET: 0.866/666.376] [MU: 0.9/24547.05] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 702.408] [M: 24559.65] [ET: 0.654/668.141] [MU: 2.97/24559.21] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 703.186] [M: 24588.82] [ET: 0.601/668.924] [MU: 22.53/24588.07] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp181)) OR (apr_area_type = 5 AND apr_area_id IN (:gp179)) OR (apr_area_type = 2 AND apr_area_id IN (:gp182)) OR (apr_area_type = 4 AND apr_area_id IN (:gp183)) OR (apr_area_type = 1 AND apr_area_id IN (:gp180))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp179":"908",":gp180":"31",":gp181":"30804",":gp182":"105",":gp183":"1","cab":"69"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 706.014] [M: 24575.84] [ET: 1.06/671.754] [MU: 3.33/24575.4] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 708.534] [M: 24586.38] [ET: 2.355/674.281] [MU: 3.53/24585.51] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp186)) OR (scr_area_type = 5 AND scr_area_id IN (:gp184)) OR (scr_area_type = 2 AND scr_area_id IN (:gp187)) OR (scr_area_type = 4 AND scr_area_id IN (:gp188)) OR (scr_area_type = 1 AND scr_area_id IN (:gp185)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp184":"908",":gp185":"31",":gp186":"908",":gp187":"105",":gp188":"1","scv_id":"69"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 709.489] [M: 24591.13] [ET: 0.57/675.249] [MU: 3.84/24590.26] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 709.927] [M: 24598.95] [ET: 0.357/675.689] [MU: 4.21/24598.07] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 710.222] [M: 24607.2] [ET: 0.22/675.989] [MU: 7.1/24607.1] 
	BookingRoute::calculateDistance
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 710.783] [M: 24609.99] [ET: 0.41/676.546] [MU: 2.66/24609.62] 
	SQL: SELECT *
				FROM   partner_rate prt 
				JOIN route rut ON prt.prt_route_id = rut.rut_id AND rut.rut_active = 1
				AND  rut.rut_from_city_id  = 30804 
				AND  rut.rut_to_city_id  = 30726 
				 WHERE prt_vehicletype_id = 69
				AND prt_partner_id = 1249
				AND prt_status = 1
				 
	 [params: []]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 711.366] [M: 24615.97] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30726","cabType":"3","tripDistance":"375","tripDuration":"420","multiCityData":"[{\"pickup_city\":\"30804\",\"drop_city\":\"30726\",\"pickup_address\":\"\",\"drop_address\":null,\"date\":\"2024-10-24 18:00:00\",\"distance\":\"375\",\"duration\":\"420\"}]","bookingType":"1","pickupAddress":"","dropupAddress":"","routeDataArr":[{"locLatVal":"","locLonVal":"","brtLocationVal":""},{"locLatVal":"","locLonVal":"","brtLocationVal":""}],"pickupDate":"24\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30726&cabType=3&tripDistance=375&tripDuration=420&multiCityData=%5B%7B%22pickup_city%22%3A%2230804%22%2C%22drop_city%22%3A%2230726%22%2C%22pickup_address%22%3A%22%22%2C%22drop_address%22%3Anull%2C%22date%22%3A%222024-10-24+18%3A00%3A00%22%2C%22distance%22%3A%22375%22%2C%22duration%22%3A%22420%22%7D%5D&bookingType=1&pickupAddress=&dropupAddress=&routeDataArr%5B0%5D%5BlocLatVal%5D=&routeDataArr%5B0%5D%5BlocLonVal%5D=&routeDataArr%5B0%5D%5BbrtLocationVal%5D=&routeDataArr%5B1%5D%5BlocLatVal%5D=&routeDataArr%5B1%5D%5BlocLonVal%5D=&routeDataArr%5B1%5D%5BbrtLocationVal%5D=&pickupDate=24%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 711.767] [M: 24635.06] [ET: 0.778/677.534] [MU: 21.05/24634.95] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 711.797] [M: 24636.74] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 712.908] [M: 24650.2] [ET: 0.992/678.661] [MU: 3/24647.7] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+5845),(IF((cpm_value_type=2),(5845+(5845*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30726 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30726) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-24 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=69 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 714.319] [M: 24692.43] [ET: 3.383/680.083] [MU: 78.88/24692.27] 
	RouteRates::calculate for CAB 69 2024-10-24 18:00:00 - Trip Type: 1 186737546
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 714.525] [M: 24672.05] [ET: 38.127/680.293] [MU: 254.29/24671.89] 
	Quote::calculateOneWay  for CAB 69 Date: 2024-10-24 18:00:00
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 714.768] [M: 24667.55] [ET: 0.175/680.532] [MU: 0.9/24667.3] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"69"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 714.842] [M: 24668.8] [ET: 48.075/680.61] [MU: 298.64/24668.71] 
	Quote For CabType: 69
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 715.964] [M: 24679.15] [ET: 0.36/681.727] [MU: 3.33/24678.71] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 716.36] [M: 24684.97] [ET: 0.33/682.124] [MU: 3.34/24684.53] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 716.963] [M: 24687.88] [ET: 0.538/682.726] [MU: 0.9/24687.66] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 717.586] [M: 24720.26] [ET: 0.515/683.341] [MU: 24.22/24718.76] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (101) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30726) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp189)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp192,:gp193)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp190,:gp191)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp194,:gp195))
			OR (scr_area_type = 5 AND scr_area_id IN (908))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (70)
		ORDER BY rank DESC
		 
	 [params: {":gp189":"31",":gp190":"30804",":gp191":"30726",":gp192":"105",":gp193":"101",":gp194":"1",":gp195":"1","tripType":"1"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 718.187] [M: 24700.44] [ET: 0.181/683.951] [MU: 0.83/24700.25] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 718.56] [M: 24703.31] [ET: 0.298/684.316] [MU: 0.96/24703] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"4"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 719.872] [M: 24716.28] [ET: 0.514/685.629] [MU: 2.04/24715.78] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"70"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 720.738] [M: 24725.91] [ET: 0.645/686.498] [MU: 3.78/24725.04] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"70","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 722.654] [M: 24806.54] [ET: 0.735/688.405] [MU: 67.78/24805.66] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"45","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 724.226] [M: 24823.16] [ET: 0.435/689.986] [MU: 3.78/24822.28] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"16","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 725.657] [M: 24841.55] [ET: 0.457/691.417] [MU: 5.56/24840.68] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 726.294] [M: 24848.79] [ET: 0.419/692.053] [MU: 0.9/24848.57] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 727.288] [M: 24859.41] [ET: 0.478/693.049] [MU: 3.34/24858.98] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 729.33] [M: 24869.96] [ET: 1.935/695.082] [MU: 3.53/24869.09] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp198)) OR (scr_area_type = 5 AND scr_area_id IN (:gp196)) OR (scr_area_type = 2 AND scr_area_id IN (:gp199)) OR (scr_area_type = 4 AND scr_area_id IN (:gp200)) OR (scr_area_type = 1 AND scr_area_id IN (:gp197)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp196":"908",":gp197":"31",":gp198":"908",":gp199":"105",":gp200":"1","scv_id":"16"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 730.274] [M: 24870.51] [ET: 0.558/696.029] [MU: 0.9/24870.29] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 731.336] [M: 24880.77] [ET: 0.488/697.091] [MU: 2.97/24880.33] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 735.489] [M: 24891.31] [ET: 4.034/701.232] [MU: 3.53/24890.44] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp203)) OR (scr_area_type = 5 AND scr_area_id IN (:gp201)) OR (scr_area_type = 2 AND scr_area_id IN (:gp204)) OR (scr_area_type = 4 AND scr_area_id IN (:gp205)) OR (scr_area_type = 1 AND scr_area_id IN (:gp202)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp201":"908",":gp202":"31",":gp203":"908",":gp204":"105",":gp205":"1","scv_id":"45"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 736.482] [M: 24891.86] [ET: 0.557/702.236] [MU: 0.9/24891.64] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 737.518] [M: 24902.12] [ET: 0.483/703.269] [MU: 2.97/24901.68] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 740.724] [M: 24912.66] [ET: 3.074/706.451] [MU: 3.53/24911.79] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp208)) OR (scr_area_type = 5 AND scr_area_id IN (:gp206)) OR (scr_area_type = 2 AND scr_area_id IN (:gp209)) OR (scr_area_type = 4 AND scr_area_id IN (:gp210)) OR (scr_area_type = 1 AND scr_area_id IN (:gp207)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp206":"908",":gp207":"31",":gp208":"908",":gp209":"105",":gp210":"1","scv_id":"70"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 741.712] [M: 24911.23] [ET: 0.61/707.47] [MU: 0.9/24911.01] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 742.862] [M: 24923.6] [ET: 0.504/708.622] [MU: 2.97/24923.16] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 743.494] [M: 24952.77] [ET: 0.528/709.254] [MU: 22.54/24952.02] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp213)) OR (apr_area_type = 5 AND apr_area_id IN (:gp211)) OR (apr_area_type = 2 AND apr_area_id IN (:gp214)) OR (apr_area_type = 4 AND apr_area_id IN (:gp215)) OR (apr_area_type = 1 AND apr_area_id IN (:gp212))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp211":"908",":gp212":"31",":gp213":"30804",":gp214":"105",":gp215":"1","cab":"70"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 744.867] [M: 24939.79] [ET: 0.464/710.627] [MU: 3.33/24939.35] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 747.215] [M: 24950.34] [ET: 2.22/712.943] [MU: 3.53/24949.46] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp218)) OR (scr_area_type = 5 AND scr_area_id IN (:gp216)) OR (scr_area_type = 2 AND scr_area_id IN (:gp219)) OR (scr_area_type = 4 AND scr_area_id IN (:gp220)) OR (scr_area_type = 1 AND scr_area_id IN (:gp217)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp216":"908",":gp217":"31",":gp218":"908",":gp219":"105",":gp220":"1","scv_id":"70"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 748.103] [M: 24955.09] [ET: 0.533/713.854] [MU: 3.84/24954.21] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 748.558] [M: 24962.9] [ET: 0.371/714.319] [MU: 4.21/24962.02] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 748.851] [M: 24971.16] [ET: 0.222/714.618] [MU: 7.1/24971.05] 
	BookingRoute::calculateDistance
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 749.413] [M: 24973.95] [ET: 0.408/715.177] [MU: 2.65/24973.57] 
	SQL: SELECT *
				FROM   partner_rate prt 
				JOIN route rut ON prt.prt_route_id = rut.rut_id AND rut.rut_active = 1
				AND  rut.rut_from_city_id  = 30804 
				AND  rut.rut_to_city_id  = 30726 
				 WHERE prt_vehicletype_id = 70
				AND prt_partner_id = 1249
				AND prt_status = 1
				 
	 [params: []]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 749.995] [M: 24979.92] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30726","cabType":"3","tripDistance":"375","tripDuration":"420","multiCityData":"[{\"pickup_city\":\"30804\",\"drop_city\":\"30726\",\"pickup_address\":\"\",\"drop_address\":null,\"date\":\"2024-10-24 18:00:00\",\"distance\":\"375\",\"duration\":\"420\"}]","bookingType":"1","pickupAddress":"","dropupAddress":"","routeDataArr":[{"locLatVal":"","locLonVal":"","brtLocationVal":""},{"locLatVal":"","locLonVal":"","brtLocationVal":""}],"pickupDate":"24\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30726&cabType=3&tripDistance=375&tripDuration=420&multiCityData=%5B%7B%22pickup_city%22%3A%2230804%22%2C%22drop_city%22%3A%2230726%22%2C%22pickup_address%22%3A%22%22%2C%22drop_address%22%3Anull%2C%22date%22%3A%222024-10-24+18%3A00%3A00%22%2C%22distance%22%3A%22375%22%2C%22duration%22%3A%22420%22%7D%5D&bookingType=1&pickupAddress=&dropupAddress=&routeDataArr%5B0%5D%5BlocLatVal%5D=&routeDataArr%5B0%5D%5BlocLonVal%5D=&routeDataArr%5B0%5D%5BbrtLocationVal%5D=&routeDataArr%5B1%5D%5BlocLatVal%5D=&routeDataArr%5B1%5D%5BlocLonVal%5D=&routeDataArr%5B1%5D%5BbrtLocationVal%5D=&pickupDate=24%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 750.401] [M: 24999.02] [ET: 0.788/716.169] [MU: 21.05/24998.91] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 750.432] [M: 25000.7] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 751.385] [M: 25014.16] [ET: 0.811/717.109] [MU: 2.99/25011.66] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+5845),(IF((cpm_value_type=2),(5845+(5845*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30726 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30726) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-24 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=70 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 752.974] [M: 25056.38] [ET: 3.408/718.737] [MU: 78.88/25056.23] 
	RouteRates::calculate for CAB 70 2024-10-24 18:00:00 - Trip Type: 1 679997690
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 753.183] [M: 25035.97] [ET: 33.236/718.95] [MU: 318.3/25035.84] 
	Quote::calculateOneWay  for CAB 70 Date: 2024-10-24 18:00:00
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 753.483] [M: 25031.51] [ET: 0.194/719.229] [MU: 0.9/25031.26] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"70"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 753.604] [M: 25032.76] [ET: 38.689/719.344] [MU: 362.65/25032.66] 
	Quote For CabType: 70
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 754.963] [M: 25043.1] [ET: 0.418/720.717] [MU: 3.34/25042.66] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 755.77] [M: 25048.92] [ET: 0.723/721.515] [MU: 3.35/25048.48] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 756.584] [M: 25051.83] [ET: 0.649/722.275] [MU: 0.9/25051.61] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 757.477] [M: 25084.21] [ET: 0.727/723.23] [MU: 24.22/25082.71] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (101) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30726) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp221)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp224,:gp225)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp222,:gp223)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp226,:gp227))
			OR (scr_area_type = 5 AND scr_area_id IN (908))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (73)
		ORDER BY rank DESC
		 
	 [params: {":gp221":"31",":gp222":"30804",":gp223":"30726",":gp224":"105",":gp225":"101",":gp226":"1",":gp227":"1","tripType":"1"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 758.22] [M: 25064.38] [ET: 0.227/723.976] [MU: 0.84/25064.2] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 758.567] [M: 25067.23] [ET: 0.268/724.329] [MU: 0.93/25066.91] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"6"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 760.06] [M: 25085.17] [ET: 0.595/725.814] [MU: 3.78/25084.3] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"73","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 761.651] [M: 25103.57] [ET: 0.506/727.41] [MU: 5.56/25102.7] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 762.348] [M: 25110.8] [ET: 0.477/728.109] [MU: 0.9/25110.59] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 763.391] [M: 25121.43] [ET: 0.508/729.146] [MU: 3.33/25120.99] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 765.444] [M: 25131.98] [ET: 1.943/731.193] [MU: 3.53/25131.1] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp230)) OR (scr_area_type = 5 AND scr_area_id IN (:gp228)) OR (scr_area_type = 2 AND scr_area_id IN (:gp231)) OR (scr_area_type = 4 AND scr_area_id IN (:gp232)) OR (scr_area_type = 1 AND scr_area_id IN (:gp229)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp228":"908",":gp229":"31",":gp230":"908",":gp231":"105",":gp232":"1","scv_id":"73"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 766.299] [M: 25130.55] [ET: 0.547/732.057] [MU: 0.9/25130.33] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 767.375] [M: 25142.92] [ET: 0.461/733.134] [MU: 2.97/25142.48] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 768.008] [M: 25172.09] [ET: 0.532/733.769] [MU: 22.53/25171.34] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp235)) OR (apr_area_type = 5 AND apr_area_id IN (:gp233)) OR (apr_area_type = 2 AND apr_area_id IN (:gp236)) OR (apr_area_type = 4 AND apr_area_id IN (:gp237)) OR (apr_area_type = 1 AND apr_area_id IN (:gp234))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp233":"908",":gp234":"31",":gp235":"30804",":gp236":"105",":gp237":"1","cab":"73"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 769.479] [M: 25159.1] [ET: 0.454/735.239] [MU: 3.34/25158.66] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 772.844] [M: 25169.65] [ET: 3.247/738.581] [MU: 3.54/25168.77] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp240)) OR (scr_area_type = 5 AND scr_area_id IN (:gp238)) OR (scr_area_type = 2 AND scr_area_id IN (:gp241)) OR (scr_area_type = 4 AND scr_area_id IN (:gp242)) OR (scr_area_type = 1 AND scr_area_id IN (:gp239)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp238":"908",":gp239":"31",":gp240":"908",":gp241":"105",":gp242":"1","scv_id":"73"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 773.654] [M: 25174.41] [ET: 0.521/739.413] [MU: 3.84/25173.53] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 774.11] [M: 25182.22] [ET: 0.373/739.871] [MU: 4.21/25181.34] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 774.4] [M: 25190.48] [ET: 0.223/740.164] [MU: 7.1/25190.38] 
	BookingRoute::calculateDistance
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 774.966] [M: 25193.27] [ET: 0.408/740.724] [MU: 2.65/25192.89] 
	SQL: SELECT *
				FROM   partner_rate prt 
				JOIN route rut ON prt.prt_route_id = rut.rut_id AND rut.rut_active = 1
				AND  rut.rut_from_city_id  = 30804 
				AND  rut.rut_to_city_id  = 30726 
				 WHERE prt_vehicletype_id = 73
				AND prt_partner_id = 1249
				AND prt_status = 1
				 
	 [params: []]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 775.556] [M: 25199.24] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30726","cabType":"3","tripDistance":"375","tripDuration":"420","multiCityData":"[{\"pickup_city\":\"30804\",\"drop_city\":\"30726\",\"pickup_address\":\"\",\"drop_address\":null,\"date\":\"2024-10-24 18:00:00\",\"distance\":\"375\",\"duration\":\"420\"}]","bookingType":"1","pickupAddress":"","dropupAddress":"","routeDataArr":[{"locLatVal":"","locLonVal":"","brtLocationVal":""},{"locLatVal":"","locLonVal":"","brtLocationVal":""}],"pickupDate":"24\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30726&cabType=3&tripDistance=375&tripDuration=420&multiCityData=%5B%7B%22pickup_city%22%3A%2230804%22%2C%22drop_city%22%3A%2230726%22%2C%22pickup_address%22%3A%22%22%2C%22drop_address%22%3Anull%2C%22date%22%3A%222024-10-24+18%3A00%3A00%22%2C%22distance%22%3A%22375%22%2C%22duration%22%3A%22420%22%7D%5D&bookingType=1&pickupAddress=&dropupAddress=&routeDataArr%5B0%5D%5BlocLatVal%5D=&routeDataArr%5B0%5D%5BlocLonVal%5D=&routeDataArr%5B0%5D%5BbrtLocationVal%5D=&routeDataArr%5B1%5D%5BlocLatVal%5D=&routeDataArr%5B1%5D%5BlocLonVal%5D=&routeDataArr%5B1%5D%5BbrtLocationVal%5D=&pickupDate=24%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 775.96] [M: 25218.34] [ET: 0.796/741.727] [MU: 21.05/25218.23] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 775.995] [M: 25220.02] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 777.018] [M: 25233.48] [ET: 0.9/742.765] [MU: 2.99/25230.98] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+5845),(IF((cpm_value_type=2),(5845+(5845*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30726 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30726) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-24 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=73 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 778.654] [M: 25275.7] [ET: 3.536/744.412] [MU: 78.88/25275.55] 
	RouteRates::calculate for CAB 73 2024-10-24 18:00:00 - Trip Type: 1 254306247
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 778.9] [M: 25255.32] [ET: 19.577/744.662] [MU: 178.36/25255.16] 
	Quote::calculateOneWay  for CAB 73 Date: 2024-10-24 18:00:00
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 779.21] [M: 25251.84] [ET: 0.225/744.968] [MU: 0.9/25251.59] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"73"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 779.293] [M: 25253.4] [ET: 25.619/745.056] [MU: 219.34/25253.3] 
	Quote For CabType: 73
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 780.51] [M: 25263.74] [ET: 0.402/746.266] [MU: 3.34/25263.3] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 781.005] [M: 25269.56] [ET: 0.412/746.763] [MU: 3.35/25269.13] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 781.742] [M: 25272.47] [ET: 0.658/747.498] [MU: 0.9/25272.25] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 782.373] [M: 25304.85] [ET: 0.506/748.125] [MU: 24.21/25303.35] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (101) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30726) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp243)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp246,:gp247)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp244,:gp245)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp248,:gp249))
			OR (scr_area_type = 5 AND scr_area_id IN (908))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (78)
		ORDER BY rank DESC
		 
	 [params: {":gp243":"31",":gp244":"30804",":gp245":"30726",":gp246":"105",":gp247":"101",":gp248":"1",":gp249":"1","tripType":"1"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 783.143] [M: 25285.04] [ET: 0.208/748.898] [MU: 0.83/25284.85] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 783.522] [M: 25287.91] [ET: 0.297/749.281] [MU: 0.96/25287.6] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"1"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 784.831] [M: 25300.68] [ET: 0.377/750.587] [MU: 2.04/25300.18] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"78"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 785.981] [M: 25310.31] [ET: 0.914/751.721] [MU: 3.78/25309.44] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"78","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 788.191] [M: 25328.73] [ET: 0.622/753.945] [MU: 5.56/25327.85] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 789.33] [M: 25335.99] [ET: 0.807/755.069] [MU: 0.89/25335.74] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 790.739] [M: 25346.59] [ET: 0.548/756.497] [MU: 3.33/25346.15] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 793.479] [M: 25357.13] [ET: 2.615/759.228] [MU: 3.53/25356.26] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp252)) OR (scr_area_type = 5 AND scr_area_id IN (:gp250)) OR (scr_area_type = 2 AND scr_area_id IN (:gp253)) OR (scr_area_type = 4 AND scr_area_id IN (:gp254)) OR (scr_area_type = 1 AND scr_area_id IN (:gp251)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp250":"908",":gp251":"31",":gp252":"908",":gp253":"105",":gp254":"1","scv_id":"78"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 794.459] [M: 25355.69] [ET: 0.595/760.218] [MU: 0.9/25355.47] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 795.742] [M: 25368.06] [ET: 0.614/761.486] [MU: 2.97/25367.63] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 796.417] [M: 25397.23] [ET: 0.522/762.176] [MU: 22.53/25396.48] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp257)) OR (apr_area_type = 5 AND apr_area_id IN (:gp255)) OR (apr_area_type = 2 AND apr_area_id IN (:gp258)) OR (apr_area_type = 4 AND apr_area_id IN (:gp259)) OR (apr_area_type = 1 AND apr_area_id IN (:gp256))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp255":"908",":gp256":"31",":gp257":"30804",":gp258":"105",":gp259":"1","cab":"78"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 798.101] [M: 25384.26] [ET: 0.568/763.844] [MU: 3.33/25383.82] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 800.293] [M: 25394.8] [ET: 2.041/766.039] [MU: 3.53/25393.93] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp262)) OR (scr_area_type = 5 AND scr_area_id IN (:gp260)) OR (scr_area_type = 2 AND scr_area_id IN (:gp263)) OR (scr_area_type = 4 AND scr_area_id IN (:gp264)) OR (scr_area_type = 1 AND scr_area_id IN (:gp261)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp260":"908",":gp261":"31",":gp262":"908",":gp263":"105",":gp264":"1","scv_id":"78"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 801.301] [M: 25405.05] [ET: 0.676/767.054] [MU: 3.84/25404.17] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 801.817] [M: 25412.86] [ET: 0.42/767.573] [MU: 4.21/25411.98] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 802.14] [M: 25421.11] [ET: 0.25/767.904] [MU: 7.1/25421.02] 
	BookingRoute::calculateDistance
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 802.786] [M: 25423.91] [ET: 0.451/768.546] [MU: 2.65/25423.53] 
	SQL: SELECT *
				FROM   partner_rate prt 
				JOIN route rut ON prt.prt_route_id = rut.rut_id AND rut.rut_active = 1
				AND  rut.rut_from_city_id  = 30804 
				AND  rut.rut_to_city_id  = 30726 
				 WHERE prt_vehicletype_id = 78
				AND prt_partner_id = 1249
				AND prt_status = 1
				 
	 [params: []]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 803.423] [M: 25429.88] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30726","cabType":"3","tripDistance":"375","tripDuration":"420","multiCityData":"[{\"pickup_city\":\"30804\",\"drop_city\":\"30726\",\"pickup_address\":\"\",\"drop_address\":null,\"date\":\"2024-10-24 18:00:00\",\"distance\":\"375\",\"duration\":\"420\"}]","bookingType":"1","pickupAddress":"","dropupAddress":"","routeDataArr":[{"locLatVal":"","locLonVal":"","brtLocationVal":""},{"locLatVal":"","locLonVal":"","brtLocationVal":""}],"pickupDate":"24\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30726&cabType=3&tripDistance=375&tripDuration=420&multiCityData=%5B%7B%22pickup_city%22%3A%2230804%22%2C%22drop_city%22%3A%2230726%22%2C%22pickup_address%22%3A%22%22%2C%22drop_address%22%3Anull%2C%22date%22%3A%222024-10-24+18%3A00%3A00%22%2C%22distance%22%3A%22375%22%2C%22duration%22%3A%22420%22%7D%5D&bookingType=1&pickupAddress=&dropupAddress=&routeDataArr%5B0%5D%5BlocLatVal%5D=&routeDataArr%5B0%5D%5BlocLonVal%5D=&routeDataArr%5B0%5D%5BbrtLocationVal%5D=&routeDataArr%5B1%5D%5BlocLatVal%5D=&routeDataArr%5B1%5D%5BlocLonVal%5D=&routeDataArr%5B1%5D%5BbrtLocationVal%5D=&pickupDate=24%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 803.879] [M: 25448.98] [ET: 0.864/769.643] [MU: 21.05/25448.87] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 803.914] [M: 25450.66] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 804.934] [M: 25464.12] [ET: 0.874/770.667] [MU: 2.99/25461.62] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+5845),(IF((cpm_value_type=2),(5845+(5845*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30726 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30726) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-24 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=78 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 806.982] [M: 25506.34] [ET: 4.022/772.743] [MU: 78.87/25506.19] 
	RouteRates::calculate for CAB 78 2024-10-24 18:00:00 - Trip Type: 1 558609147
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 807.202] [M: 25485.96] [ET: 22.298/772.968] [MU: 183.86/25485.8] 
	Quote::calculateOneWay  for CAB 78 Date: 2024-10-24 18:00:00
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 807.452] [M: 25481.66] [ET: 0.18/773.217] [MU: 0.9/25481.41] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"78"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 807.525] [M: 25483.23] [ET: 28.176/773.292] [MU: 228.53/25483.13] 
	Quote For CabType: 78
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 808.623] [M: 25493.57] [ET: 0.376/774.384] [MU: 3.34/25493.13] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 809.036] [M: 25499.39] [ET: 0.344/774.798] [MU: 3.35/25498.95] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 809.583] [M: 25502.3] [ET: 0.479/775.345] [MU: 0.9/25502.08] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 810.186] [M: 25534.68] [ET: 0.497/775.943] [MU: 24.22/25533.18] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (101) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30726) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp265)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp268,:gp269)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp266,:gp267)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp270,:gp271))
			OR (scr_area_type = 5 AND scr_area_id IN (908))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (81)
		ORDER BY rank DESC
		 
	 [params: {":gp265":"31",":gp266":"30804",":gp267":"30726",":gp268":"105",":gp269":"101",":gp270":"1",":gp271":"1","tripType":"1"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 810.845] [M: 25514.86] [ET: 0.224/776.59] [MU: 0.83/25514.67] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 811.264] [M: 25517.73] [ET: 0.295/776.998] [MU: 0.96/25517.42] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"1"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 812.514] [M: 25530.5] [ET: 0.344/778.275] [MU: 2.04/25530] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"81"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 813.376] [M: 25540.13] [ET: 0.663/779.135] [MU: 3.78/25539.26] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"81","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 815.173] [M: 25558.54] [ET: 0.637/780.927] [MU: 5.57/25557.66] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 815.903] [M: 25565.77] [ET: 0.477/781.653] [MU: 0.9/25565.55] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 816.966] [M: 25576.4] [ET: 0.469/782.726] [MU: 3.33/25575.96] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 819.44] [M: 25586.95] [ET: 2.357/785.177] [MU: 3.53/25586.07] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp274)) OR (scr_area_type = 5 AND scr_area_id IN (:gp272)) OR (scr_area_type = 2 AND scr_area_id IN (:gp275)) OR (scr_area_type = 4 AND scr_area_id IN (:gp276)) OR (scr_area_type = 1 AND scr_area_id IN (:gp273)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp272":"908",":gp273":"31",":gp274":"908",":gp275":"105",":gp276":"1","scv_id":"81"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 820.369] [M: 25585.51] [ET: 0.655/786.127] [MU: 0.9/25585.29] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 821.51] [M: 25597.88] [ET: 0.463/787.272] [MU: 2.97/25597.45] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 822.391] [M: 25627.05] [ET: 0.76/788.139] [MU: 22.53/25626.3] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp279)) OR (apr_area_type = 5 AND apr_area_id IN (:gp277)) OR (apr_area_type = 2 AND apr_area_id IN (:gp280)) OR (apr_area_type = 4 AND apr_area_id IN (:gp281)) OR (apr_area_type = 1 AND apr_area_id IN (:gp278))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp277":"908",":gp278":"31",":gp279":"30804",":gp280":"105",":gp281":"1","cab":"81"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 824.558] [M: 25614.07] [ET: 0.55/790.317] [MU: 3.34/25613.63] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 827.234] [M: 25624.62] [ET: 2.563/792.984] [MU: 3.53/25623.74] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp284)) OR (scr_area_type = 5 AND scr_area_id IN (:gp282)) OR (scr_area_type = 2 AND scr_area_id IN (:gp285)) OR (scr_area_type = 4 AND scr_area_id IN (:gp286)) OR (scr_area_type = 1 AND scr_area_id IN (:gp283)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp282":"908",":gp283":"31",":gp284":"908",":gp285":"105",":gp286":"1","scv_id":"81"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 828.031] [M: 25629.37] [ET: 0.504/793.788] [MU: 3.84/25628.49] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 828.478] [M: 25637.18] [ET: 0.362/794.239] [MU: 4.21/25636.3] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 828.764] [M: 25645.45] [ET: 0.222/794.531] [MU: 7.1/25645.34] 
	BookingRoute::calculateDistance
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 829.312] [M: 25648.23] [ET: 0.393/795.077] [MU: 2.65/25647.85] 
	SQL: SELECT *
				FROM   partner_rate prt 
				JOIN route rut ON prt.prt_route_id = rut.rut_id AND rut.rut_active = 1
				AND  rut.rut_from_city_id  = 30804 
				AND  rut.rut_to_city_id  = 30726 
				 WHERE prt_vehicletype_id = 81
				AND prt_partner_id = 1249
				AND prt_status = 1
				 
	 [params: []]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 829.884] [M: 25654.2] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30726","cabType":"3","tripDistance":"375","tripDuration":"420","multiCityData":"[{\"pickup_city\":\"30804\",\"drop_city\":\"30726\",\"pickup_address\":\"\",\"drop_address\":null,\"date\":\"2024-10-24 18:00:00\",\"distance\":\"375\",\"duration\":\"420\"}]","bookingType":"1","pickupAddress":"","dropupAddress":"","routeDataArr":[{"locLatVal":"","locLonVal":"","brtLocationVal":""},{"locLatVal":"","locLonVal":"","brtLocationVal":""}],"pickupDate":"24\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30726&cabType=3&tripDistance=375&tripDuration=420&multiCityData=%5B%7B%22pickup_city%22%3A%2230804%22%2C%22drop_city%22%3A%2230726%22%2C%22pickup_address%22%3A%22%22%2C%22drop_address%22%3Anull%2C%22date%22%3A%222024-10-24+18%3A00%3A00%22%2C%22distance%22%3A%22375%22%2C%22duration%22%3A%22420%22%7D%5D&bookingType=1&pickupAddress=&dropupAddress=&routeDataArr%5B0%5D%5BlocLatVal%5D=&routeDataArr%5B0%5D%5BlocLonVal%5D=&routeDataArr%5B0%5D%5BbrtLocationVal%5D=&routeDataArr%5B1%5D%5BlocLatVal%5D=&routeDataArr%5B1%5D%5BlocLonVal%5D=&routeDataArr%5B1%5D%5BbrtLocationVal%5D=&pickupDate=24%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 830.294] [M: 25673.3] [ET: 0.785/796.061] [MU: 21.05/25673.19] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 830.326] [M: 25674.98] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 831.309] [M: 25688.44] [ET: 0.859/797.052] [MU: 2.99/25685.94] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+5845),(IF((cpm_value_type=2),(5845+(5845*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30726 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30726) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-24 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=81 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 832.878] [M: 25730.66] [ET: 3.418/798.642] [MU: 78.87/25730.51] 
	RouteRates::calculate for CAB 81 2024-10-24 18:00:00 - Trip Type: 1 226075189
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 833.085] [M: 25710.28] [ET: 20.505/798.853] [MU: 178.36/25710.13] 
	Quote::calculateOneWay  for CAB 81 Date: 2024-10-24 18:00:00
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 833.414] [M: 25705.99] [ET: 0.264/799.181] [MU: 0.89/25705.74] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"81"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 833.483] [M: 25707.55] [ET: 25.908/799.251] [MU: 223.02/25707.46] 
	Quote For CabType: 81
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 834.512] [M: 25717.9] [ET: 0.341/800.274] [MU: 3.33/25717.46] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 834.889] [M: 25723.72] [ET: 0.309/800.653] [MU: 3.34/25723.28] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 835.489] [M: 25726.63] [ET: 0.534/801.252] [MU: 0.9/25726.41] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 836.145] [M: 25759.01] [ET: 0.556/801.905] [MU: 24.22/25757.51] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (101) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30726) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp287)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp290,:gp291)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp288,:gp289)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp292,:gp293))
			OR (scr_area_type = 5 AND scr_area_id IN (908))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (82)
		ORDER BY rank DESC
		 
	 [params: {":gp287":"31",":gp288":"30804",":gp289":"30726",":gp290":"105",":gp291":"101",":gp292":"1",":gp293":"1","tripType":"1"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 836.875] [M: 25739.19] [ET: 0.262/802.64] [MU: 0.83/25739] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 837.221] [M: 25741.97] [ET: 0.275/802.986] [MU: 0.96/25741.66] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"1"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 839.119] [M: 25754.73] [ET: 0.756/804.84] [MU: 2.05/25754.23] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"82"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 840.479] [M: 25764.37] [ET: 0.915/806.223] [MU: 3.78/25763.49] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"82","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 842.191] [M: 25782.77] [ET: 0.471/807.952] [MU: 5.56/25781.9] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 842.856] [M: 25790.01] [ET: 0.443/808.606] [MU: 0.9/25789.79] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 844.248] [M: 25800.63] [ET: 0.677/809.995] [MU: 3.34/25800.2] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 847.066] [M: 25811.18] [ET: 2.652/812.804] [MU: 3.53/25810.3] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp296)) OR (scr_area_type = 5 AND scr_area_id IN (:gp294)) OR (scr_area_type = 2 AND scr_area_id IN (:gp297)) OR (scr_area_type = 4 AND scr_area_id IN (:gp298)) OR (scr_area_type = 1 AND scr_area_id IN (:gp295)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp294":"908",":gp295":"31",":gp296":"908",":gp297":"105",":gp298":"1","scv_id":"82"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 847.994] [M: 25809.74] [ET: 0.559/813.741] [MU: 0.9/25809.52] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 849.308] [M: 25822.12] [ET: 0.571/815.063] [MU: 2.97/25821.68] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 849.995] [M: 25851.29] [ET: 0.541/815.747] [MU: 22.53/25850.54] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp301)) OR (apr_area_type = 5 AND apr_area_id IN (:gp299)) OR (apr_area_type = 2 AND apr_area_id IN (:gp302)) OR (apr_area_type = 4 AND apr_area_id IN (:gp303)) OR (apr_area_type = 1 AND apr_area_id IN (:gp300))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp299":"908",":gp300":"31",":gp301":"30804",":gp302":"105",":gp303":"1","cab":"82"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 851.582] [M: 25838.3] [ET: 0.552/817.336] [MU: 3.34/25837.87] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 853.748] [M: 25848.85] [ET: 2.019/819.496] [MU: 3.53/25847.98] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp306)) OR (scr_area_type = 5 AND scr_area_id IN (:gp304)) OR (scr_area_type = 2 AND scr_area_id IN (:gp307)) OR (scr_area_type = 4 AND scr_area_id IN (:gp308)) OR (scr_area_type = 1 AND scr_area_id IN (:gp305)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp304":"908",":gp305":"31",":gp306":"908",":gp307":"105",":gp308":"1","scv_id":"82"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 854.893] [M: 25853.6] [ET: 0.726/820.642] [MU: 3.84/25852.73] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 855.946] [M: 25861.41] [ET: 0.932/821.63] [MU: 4.21/25860.54] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 856.743] [M: 25869.68] [ET: 0.603/822.475] [MU: 7.1/25869.57] 
	BookingRoute::calculateDistance
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 857.799] [M: 25872.46] [ET: 0.755/823.541] [MU: 2.66/25872.09] 
	SQL: SELECT *
				FROM   partner_rate prt 
				JOIN route rut ON prt.prt_route_id = rut.rut_id AND rut.rut_active = 1
				AND  rut.rut_from_city_id  = 30804 
				AND  rut.rut_to_city_id  = 30726 
				 WHERE prt_vehicletype_id = 82
				AND prt_partner_id = 1249
				AND prt_status = 1
				 
	 [params: []]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 858.69] [M: 25878.44] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30726","cabType":"3","tripDistance":"375","tripDuration":"420","multiCityData":"[{\"pickup_city\":\"30804\",\"drop_city\":\"30726\",\"pickup_address\":\"\",\"drop_address\":null,\"date\":\"2024-10-24 18:00:00\",\"distance\":\"375\",\"duration\":\"420\"}]","bookingType":"1","pickupAddress":"","dropupAddress":"","routeDataArr":[{"locLatVal":"","locLonVal":"","brtLocationVal":""},{"locLatVal":"","locLonVal":"","brtLocationVal":""}],"pickupDate":"24\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30726&cabType=3&tripDistance=375&tripDuration=420&multiCityData=%5B%7B%22pickup_city%22%3A%2230804%22%2C%22drop_city%22%3A%2230726%22%2C%22pickup_address%22%3A%22%22%2C%22drop_address%22%3Anull%2C%22date%22%3A%222024-10-24+18%3A00%3A00%22%2C%22distance%22%3A%22375%22%2C%22duration%22%3A%22420%22%7D%5D&bookingType=1&pickupAddress=&dropupAddress=&routeDataArr%5B0%5D%5BlocLatVal%5D=&routeDataArr%5B0%5D%5BlocLonVal%5D=&routeDataArr%5B0%5D%5BbrtLocationVal%5D=&routeDataArr%5B1%5D%5BlocLatVal%5D=&routeDataArr%5B1%5D%5BlocLonVal%5D=&routeDataArr%5B1%5D%5BbrtLocationVal%5D=&pickupDate=24%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 859.415] [M: 25897.53] [ET: 1.288/825.157] [MU: 21.04/25897.42] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 859.476] [M: 25899.21] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 860.91] [M: 25912.67] [ET: 1.218/826.636] [MU: 2.99/25910.17] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+5845),(IF((cpm_value_type=2),(5845+(5845*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30726 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30726) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-24 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=82 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 863.296] [M: 25954.9] [ET: 5.259/829.052] [MU: 78.87/25954.74] 
	RouteRates::calculate for CAB 82 2024-10-24 18:00:00 - Trip Type: 1 170539441
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 863.55] [M: 25934.52] [ET: 24.284/829.315] [MU: 178.36/25934.36] 
	Quote::calculateOneWay  for CAB 82 Date: 2024-10-24 18:00:00
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 863.899] [M: 25930.23] [ET: 0.271/829.656] [MU: 0.9/25929.98] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"82"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 863.989] [M: 25931.79] [ET: 30.455/829.754] [MU: 222.93/25931.7] 
	Quote For CabType: 82
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 865.411] [M: 25942.13] [ET: 0.647/831.143] [MU: 3.34/25941.7] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 866.148] [M: 25947.95] [ET: 0.615/831.886] [MU: 3.35/25947.52] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 866.862] [M: 25950.86] [ET: 0.587/832.574] [MU: 0.9/25950.64] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 867.646] [M: 25983.24] [ET: 0.612/833.362] [MU: 24.21/25981.74] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (101) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30726) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp309)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp312,:gp313)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp310,:gp311)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp314,:gp315))
			OR (scr_area_type = 5 AND scr_area_id IN (908))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (83)
		ORDER BY rank DESC
		 
	 [params: {":gp309":"31",":gp310":"30804",":gp311":"30726",":gp312":"105",":gp313":"101",":gp314":"1",":gp315":"1","tripType":"1"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 868.922] [M: 25963.42] [ET: 0.429/834.658] [MU: 0.84/25963.23] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 869.642] [M: 25966.3] [ET: 0.567/835.375] [MU: 0.96/25965.98] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"1"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 871.74] [M: 25979.06] [ET: 0.604/837.422] [MU: 2.05/25978.56] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"83"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 872.977] [M: 25988.7] [ET: 0.707/838.733] [MU: 3.78/25987.82] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"83","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 875.148] [M: 26007.1] [ET: 0.499/840.907] [MU: 5.56/26006.23] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 875.935] [M: 26014.34] [ET: 0.561/841.695] [MU: 0.9/26014.12] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 877.026] [M: 26024.96] [ET: 0.498/842.78] [MU: 3.34/26024.52] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 879.756] [M: 26035.51] [ET: 2.599/845.483] [MU: 3.54/26034.63] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp318)) OR (scr_area_type = 5 AND scr_area_id IN (:gp316)) OR (scr_area_type = 2 AND scr_area_id IN (:gp319)) OR (scr_area_type = 4 AND scr_area_id IN (:gp320)) OR (scr_area_type = 1 AND scr_area_id IN (:gp317)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp316":"908",":gp317":"31",":gp318":"908",":gp319":"105",":gp320":"1","scv_id":"83"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 880.595] [M: 26034.1] [ET: 0.522/846.331] [MU: 0.89/26033.85] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 881.787] [M: 26046.45] [ET: 0.445/847.547] [MU: 2.97/26046.01] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 882.409] [M: 26075.62] [ET: 0.499/848.146] [MU: 22.53/26074.87] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp323)) OR (apr_area_type = 5 AND apr_area_id IN (:gp321)) OR (apr_area_type = 2 AND apr_area_id IN (:gp324)) OR (apr_area_type = 4 AND apr_area_id IN (:gp325)) OR (apr_area_type = 1 AND apr_area_id IN (:gp322))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp321":"908",":gp322":"31",":gp323":"30804",":gp324":"105",":gp325":"1","cab":"83"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 883.971] [M: 26062.63] [ET: 0.443/849.73] [MU: 3.34/26062.2] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 886.394] [M: 26073.18] [ET: 2.289/852.121] [MU: 3.53/26072.3] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp328)) OR (scr_area_type = 5 AND scr_area_id IN (:gp326)) OR (scr_area_type = 2 AND scr_area_id IN (:gp329)) OR (scr_area_type = 4 AND scr_area_id IN (:gp330)) OR (scr_area_type = 1 AND scr_area_id IN (:gp327)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp326":"908",":gp327":"31",":gp328":"908",":gp329":"105",":gp330":"1","scv_id":"83"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 887.478] [M: 26077.93] [ET: 0.632/853.214] [MU: 3.85/26077.05] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 888.148] [M: 26085.74] [ET: 0.533/853.893] [MU: 4.21/26084.87] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 888.735] [M: 26093.99] [ET: 0.409/854.405] [MU: 7.1/26093.9] 
	BookingRoute::calculateDistance
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 889.737] [M: 26096.79] [ET: 0.723/855.476] [MU: 2.66/26096.41] 
	SQL: SELECT *
				FROM   partner_rate prt 
				JOIN route rut ON prt.prt_route_id = rut.rut_id AND rut.rut_active = 1
				AND  rut.rut_from_city_id  = 30804 
				AND  rut.rut_to_city_id  = 30726 
				 WHERE prt_vehicletype_id = 83
				AND prt_partner_id = 1249
				AND prt_status = 1
				 
	 [params: []]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 890.629] [M: 26102.77] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30726","cabType":"3","tripDistance":"375","tripDuration":"420","multiCityData":"[{\"pickup_city\":\"30804\",\"drop_city\":\"30726\",\"pickup_address\":\"\",\"drop_address\":null,\"date\":\"2024-10-24 18:00:00\",\"distance\":\"375\",\"duration\":\"420\"}]","bookingType":"1","pickupAddress":"","dropupAddress":"","routeDataArr":[{"locLatVal":"","locLonVal":"","brtLocationVal":""},{"locLatVal":"","locLonVal":"","brtLocationVal":""}],"pickupDate":"24\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30726&cabType=3&tripDistance=375&tripDuration=420&multiCityData=%5B%7B%22pickup_city%22%3A%2230804%22%2C%22drop_city%22%3A%2230726%22%2C%22pickup_address%22%3A%22%22%2C%22drop_address%22%3Anull%2C%22date%22%3A%222024-10-24+18%3A00%3A00%22%2C%22distance%22%3A%22375%22%2C%22duration%22%3A%22420%22%7D%5D&bookingType=1&pickupAddress=&dropupAddress=&routeDataArr%5B0%5D%5BlocLatVal%5D=&routeDataArr%5B0%5D%5BlocLonVal%5D=&routeDataArr%5B0%5D%5BbrtLocationVal%5D=&routeDataArr%5B1%5D%5BlocLatVal%5D=&routeDataArr%5B1%5D%5BlocLonVal%5D=&routeDataArr%5B1%5D%5BbrtLocationVal%5D=&pickupDate=24%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 891.325] [M: 26121.86] [ET: 1.233/857.072] [MU: 21.04/26121.75] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 891.381] [M: 26123.54] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 892.688] [M: 26137] [ET: 1.118/858.42] [MU: 2.99/26134.5] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+5845),(IF((cpm_value_type=2),(5845+(5845*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30726 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30726) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-24 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=83 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 894.344] [M: 26179.23] [ET: 4.348/860.106] [MU: 78.87/26179.07] 
	RouteRates::calculate for CAB 83 2024-10-24 18:00:00 - Trip Type: 1 830577648
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 894.56] [M: 26158.84] [ET: 22.586/860.328] [MU: 178.36/26158.69] 
	Quote::calculateOneWay  for CAB 83 Date: 2024-10-24 18:00:00
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 894.897] [M: 26154.55] [ET: 0.251/860.638] [MU: 0.9/26154.3] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"83"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 895.021] [M: 26156.12] [ET: 30.961/860.767] [MU: 223.03/26156.02] 
	Quote For CabType: 83
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 896.389] [M: 26166.46] [ET: 0.487/862.125] [MU: 3.34/26166.02] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 896.965] [M: 26172.28] [ET: 0.465/862.708] [MU: 3.35/26171.84] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 897.671] [M: 26175.19] [ET: 0.6/863.411] [MU: 0.9/26174.97] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 898.551] [M: 26207.57] [ET: 0.691/864.286] [MU: 24.22/26206.07] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (101) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30726) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp331)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp334,:gp335)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp332,:gp333)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp336,:gp337))
			OR (scr_area_type = 5 AND scr_area_id IN (908))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (84)
		ORDER BY rank DESC
		 
	 [params: {":gp331":"31",":gp332":"30804",":gp333":"30726",":gp334":"105",":gp335":"101",":gp336":"1",":gp337":"1","tripType":"1"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 899.487] [M: 26187.75] [ET: 0.268/865.248] [MU: 0.84/26187.56] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 899.89] [M: 26190.63] [ET: 0.319/865.65] [MU: 0.97/26190.31] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"1"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 901.244] [M: 26203.39] [ET: 0.478/866.982] [MU: 2.04/26202.89] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"84"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 902.286] [M: 26213.02] [ET: 0.716/868.024] [MU: 3.78/26212.15] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"84","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 904.786] [M: 26231.43] [ET: 0.731/870.517] [MU: 5.57/26230.55] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 906.238] [M: 26238.66] [ET: 0.729/871.97] [MU: 0.9/26238.45] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 907.926] [M: 26249.29] [ET: 0.723/873.66] [MU: 3.33/26248.85] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 911.333] [M: 26259.84] [ET: 3.24/877.06] [MU: 3.53/26258.96] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp340)) OR (scr_area_type = 5 AND scr_area_id IN (:gp338)) OR (scr_area_type = 2 AND scr_area_id IN (:gp341)) OR (scr_area_type = 4 AND scr_area_id IN (:gp342)) OR (scr_area_type = 1 AND scr_area_id IN (:gp339)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp338":"908",":gp339":"31",":gp340":"908",":gp341":"105",":gp342":"1","scv_id":"84"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 912.242] [M: 26258.4] [ET: 0.628/877.999] [MU: 0.9/26258.18] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 913.363] [M: 26270.77] [ET: 0.469/879.123] [MU: 2.97/26270.34] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 913.98] [M: 26299.95] [ET: 0.493/879.716] [MU: 22.53/26299.2] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp345)) OR (apr_area_type = 5 AND apr_area_id IN (:gp343)) OR (apr_area_type = 2 AND apr_area_id IN (:gp346)) OR (apr_area_type = 4 AND apr_area_id IN (:gp347)) OR (apr_area_type = 1 AND apr_area_id IN (:gp344))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp343":"908",":gp344":"31",":gp345":"30804",":gp346":"105",":gp347":"1","cab":"84"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 915.789] [M: 26286.96] [ET: 0.58/881.528] [MU: 3.34/26286.52] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 918.193] [M: 26297.51] [ET: 2.248/883.944] [MU: 3.54/26296.63] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp350)) OR (scr_area_type = 5 AND scr_area_id IN (:gp348)) OR (scr_area_type = 2 AND scr_area_id IN (:gp351)) OR (scr_area_type = 4 AND scr_area_id IN (:gp352)) OR (scr_area_type = 1 AND scr_area_id IN (:gp349)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp348":"908",":gp349":"31",":gp350":"908",":gp351":"105",":gp352":"1","scv_id":"84"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 919.151] [M: 26302.26] [ET: 0.559/884.91] [MU: 3.85/26301.38] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 919.614] [M: 26310.07] [ET: 0.379/885.374] [MU: 4.21/26309.2] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 919.901] [M: 26318.34] [ET: 0.222/885.669] [MU: 7.1/26318.23] 
	BookingRoute::calculateDistance
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 920.621] [M: 26321.12] [ET: 0.548/886.362] [MU: 2.65/26320.74] 
	SQL: SELECT *
				FROM   partner_rate prt 
				JOIN route rut ON prt.prt_route_id = rut.rut_id AND rut.rut_active = 1
				AND  rut.rut_from_city_id  = 30804 
				AND  rut.rut_to_city_id  = 30726 
				 WHERE prt_vehicletype_id = 84
				AND prt_partner_id = 1249
				AND prt_status = 1
				 
	 [params: []]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 921.439] [M: 26327.09] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30726","cabType":"3","tripDistance":"375","tripDuration":"420","multiCityData":"[{\"pickup_city\":\"30804\",\"drop_city\":\"30726\",\"pickup_address\":\"\",\"drop_address\":null,\"date\":\"2024-10-24 18:00:00\",\"distance\":\"375\",\"duration\":\"420\"}]","bookingType":"1","pickupAddress":"","dropupAddress":"","routeDataArr":[{"locLatVal":"","locLonVal":"","brtLocationVal":""},{"locLatVal":"","locLonVal":"","brtLocationVal":""}],"pickupDate":"24\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30726&cabType=3&tripDistance=375&tripDuration=420&multiCityData=%5B%7B%22pickup_city%22%3A%2230804%22%2C%22drop_city%22%3A%2230726%22%2C%22pickup_address%22%3A%22%22%2C%22drop_address%22%3Anull%2C%22date%22%3A%222024-10-24+18%3A00%3A00%22%2C%22distance%22%3A%22375%22%2C%22duration%22%3A%22420%22%7D%5D&bookingType=1&pickupAddress=&dropupAddress=&routeDataArr%5B0%5D%5BlocLatVal%5D=&routeDataArr%5B0%5D%5BlocLonVal%5D=&routeDataArr%5B0%5D%5BbrtLocationVal%5D=&routeDataArr%5B1%5D%5BlocLatVal%5D=&routeDataArr%5B1%5D%5BlocLonVal%5D=&routeDataArr%5B1%5D%5BbrtLocationVal%5D=&pickupDate=24%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 922.233] [M: 26346.19] [ET: 1.263/887.974] [MU: 21.05/26346.08] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 922.29] [M: 26347.87] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 923.738] [M: 26361.33] [ET: 1.208/889.443] [MU: 2.99/26358.83] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+5845),(IF((cpm_value_type=2),(5845+(5845*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30726 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30726) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-24 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=84 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 925.579] [M: 26403.55] [ET: 4.696/891.321] [MU: 78.87/26403.4] 
	RouteRates::calculate for CAB 84 2024-10-24 18:00:00 - Trip Type: 1 199950624
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 925.95] [M: 26383.17] [ET: 24.596/891.697] [MU: 178.36/26383.02] 
	Quote::calculateOneWay  for CAB 84 Date: 2024-10-24 18:00:00
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 926.337] [M: 26378.88] [ET: 0.272/892.081] [MU: 0.9/26378.63] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"84"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 926.456] [M: 26380.45] [ET: 31.342/892.204] [MU: 223.02/26380.35] 
	Quote For CabType: 84
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 927.841] [M: 26390.79] [ET: 0.506/893.602] [MU: 3.33/26390.35] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 928.29] [M: 26396.61] [ET: 0.38/894.053] [MU: 3.34/26396.17] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 928.891] [M: 26399.52] [ET: 0.512/894.627] [MU: 0.9/26399.3] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 929.798] [M: 26431.9] [ET: 0.715/895.528] [MU: 24.22/26430.4] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (101) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30726) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp353)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp356,:gp357)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp354,:gp355)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp358,:gp359))
			OR (scr_area_type = 5 AND scr_area_id IN (908))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (93)
		ORDER BY rank DESC
		 
	 [params: {":gp353":"31",":gp354":"30804",":gp355":"30726",":gp356":"105",":gp357":"101",":gp358":"1",":gp359":"1","tripType":"1"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 930.708] [M: 26412.09] [ET: 0.26/896.461] [MU: 0.83/26411.9] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 931.16] [M: 26414.96] [ET: 0.371/896.922] [MU: 0.96/26414.65] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"2"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 932.432] [M: 26427.71] [ET: 0.41/898.193] [MU: 2.04/26427.21] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"93"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 933.187] [M: 26437.34] [ET: 0.556/898.947] [MU: 3.78/26436.47] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"93","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 935.035] [M: 26453.98] [ET: 0.617/900.768] [MU: 3.78/26453.1] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"16","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 936.786] [M: 26472.38] [ET: 0.457/902.546] [MU: 5.56/26471.5] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 937.495] [M: 26479.61] [ET: 0.452/903.211] [MU: 0.9/26479.39] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 939.154] [M: 26490.23] [ET: 0.944/904.89] [MU: 3.34/26489.8] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 942.369] [M: 26500.78] [ET: 2.884/908.097] [MU: 3.53/26499.91] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp362)) OR (scr_area_type = 5 AND scr_area_id IN (:gp360)) OR (scr_area_type = 2 AND scr_area_id IN (:gp363)) OR (scr_area_type = 4 AND scr_area_id IN (:gp364)) OR (scr_area_type = 1 AND scr_area_id IN (:gp361)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp360":"908",":gp361":"31",":gp362":"908",":gp363":"105",":gp364":"1","scv_id":"16"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 943.315] [M: 26501.33] [ET: 0.534/909.05] [MU: 0.9/26501.11] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 944.514] [M: 26511.59] [ET: 0.465/910.273] [MU: 2.97/26511.15] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 947.295] [M: 26522.13] [ET: 2.672/913.048] [MU: 3.53/26521.26] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp367)) OR (scr_area_type = 5 AND scr_area_id IN (:gp365)) OR (scr_area_type = 2 AND scr_area_id IN (:gp368)) OR (scr_area_type = 4 AND scr_area_id IN (:gp369)) OR (scr_area_type = 1 AND scr_area_id IN (:gp366)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp365":"908",":gp366":"31",":gp367":"908",":gp368":"105",":gp369":"1","scv_id":"93"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 948.261] [M: 26520.69] [ET: 0.617/914.019] [MU: 0.9/26520.47] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 949.577] [M: 26533.06] [ET: 0.594/915.315] [MU: 2.97/26532.63] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 950.261] [M: 26562.23] [ET: 0.521/916.021] [MU: 22.53/26561.48] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp372)) OR (apr_area_type = 5 AND apr_area_id IN (:gp370)) OR (apr_area_type = 2 AND apr_area_id IN (:gp373)) OR (apr_area_type = 4 AND apr_area_id IN (:gp374)) OR (apr_area_type = 1 AND apr_area_id IN (:gp371))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp370":"908",":gp371":"31",":gp372":"30804",":gp373":"105",":gp374":"1","cab":"93"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 951.879] [M: 26549.26] [ET: 0.455/917.639] [MU: 3.33/26548.82] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 954.142] [M: 26559.8] [ET: 2.138/919.874] [MU: 3.53/26558.93] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp377)) OR (scr_area_type = 5 AND scr_area_id IN (:gp375)) OR (scr_area_type = 2 AND scr_area_id IN (:gp378)) OR (scr_area_type = 4 AND scr_area_id IN (:gp379)) OR (scr_area_type = 1 AND scr_area_id IN (:gp376)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp375":"908",":gp376":"31",":gp377":"908",":gp378":"105",":gp379":"1","scv_id":"93"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 955.443] [M: 26564.55] [ET: 0.804/921.175] [MU: 3.84/26563.67] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 956.405] [M: 26572.36] [ET: 0.728/922.057] [MU: 4.21/26571.48] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 956.749] [M: 26580.63] [ET: 0.272/922.516] [MU: 7.1/26580.52] 
	BookingRoute::calculateDistance
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 957.415] [M: 26583.41] [ET: 0.507/923.176] [MU: 2.65/26583.03] 
	SQL: SELECT *
				FROM   partner_rate prt 
				JOIN route rut ON prt.prt_route_id = rut.rut_id AND rut.rut_active = 1
				AND  rut.rut_from_city_id  = 30804 
				AND  rut.rut_to_city_id  = 30726 
				 WHERE prt_vehicletype_id = 93
				AND prt_partner_id = 1249
				AND prt_status = 1
				 
	 [params: []]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 958.009] [M: 26589.38] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30726","cabType":"3","tripDistance":"375","tripDuration":"420","multiCityData":"[{\"pickup_city\":\"30804\",\"drop_city\":\"30726\",\"pickup_address\":\"\",\"drop_address\":null,\"date\":\"2024-10-24 18:00:00\",\"distance\":\"375\",\"duration\":\"420\"}]","bookingType":"1","pickupAddress":"","dropupAddress":"","routeDataArr":[{"locLatVal":"","locLonVal":"","brtLocationVal":""},{"locLatVal":"","locLonVal":"","brtLocationVal":""}],"pickupDate":"24\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30726&cabType=3&tripDistance=375&tripDuration=420&multiCityData=%5B%7B%22pickup_city%22%3A%2230804%22%2C%22drop_city%22%3A%2230726%22%2C%22pickup_address%22%3A%22%22%2C%22drop_address%22%3Anull%2C%22date%22%3A%222024-10-24+18%3A00%3A00%22%2C%22distance%22%3A%22375%22%2C%22duration%22%3A%22420%22%7D%5D&bookingType=1&pickupAddress=&dropupAddress=&routeDataArr%5B0%5D%5BlocLatVal%5D=&routeDataArr%5B0%5D%5BlocLonVal%5D=&routeDataArr%5B0%5D%5BbrtLocationVal%5D=&routeDataArr%5B1%5D%5BlocLatVal%5D=&routeDataArr%5B1%5D%5BlocLonVal%5D=&routeDataArr%5B1%5D%5BbrtLocationVal%5D=&pickupDate=24%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 958.416] [M: 26608.48] [ET: 0.796/924.183] [MU: 21.05/26608.37] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 958.446] [M: 26610.16] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 959.467] [M: 26623.62] [ET: 0.881/925.192] [MU: 2.99/26621.12] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+5845),(IF((cpm_value_type=2),(5845+(5845*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30726 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30726) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-24 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=93 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 961.254] [M: 26665.84] [ET: 3.668/926.996] [MU: 78.87/26665.69] 
	RouteRates::calculate for CAB 93 2024-10-24 18:00:00 - Trip Type: 1 721799084
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 961.649] [M: 26645.46] [ET: 29.135/927.396] [MU: 216.33/26645.3] 
	Quote::calculateOneWay  for CAB 93 Date: 2024-10-24 18:00:00
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 962.055] [M: 26641.18] [ET: 0.282/927.796] [MU: 0.9/26640.93] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"93"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 962.178] [M: 26642.74] [ET: 35.63/927.922] [MU: 260.99/26642.65] 
	Quote For CabType: 93
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 963.587] [M: 26653.09] [ET: 0.508/929.328] [MU: 3.33/26652.65] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 964.169] [M: 26658.91] [ET: 0.473/929.913] [MU: 3.34/26658.47] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 964.827] [M: 26661.81] [ET: 0.553/930.579] [MU: 0.9/26661.59] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 965.474] [M: 26694.2] [ET: 0.513/931.21] [MU: 24.22/26692.7] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (101) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30726) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp380)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp383,:gp384)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp381,:gp382)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp385,:gp386))
			OR (scr_area_type = 5 AND scr_area_id IN (908))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (96)
		ORDER BY rank DESC
		 
	 [params: {":gp380":"31",":gp381":"30804",":gp382":"30726",":gp383":"105",":gp384":"101",":gp385":"1",":gp386":"1","tripType":"1"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 966.358] [M: 26674.38] [ET: 0.231/932.119] [MU: 0.84/26674.19] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 966.782] [M: 26677.25] [ET: 0.33/932.523] [MU: 0.96/26676.94] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"2"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 968.263] [M: 26690] [ET: 0.373/934.003] [MU: 2.04/26689.5] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"96"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 969.273] [M: 26699.63] [ET: 0.696/935.033] [MU: 3.78/26698.76] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"96","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 971.232] [M: 26716.26] [ET: 0.561/936.989] [MU: 3.79/26715.38] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"16","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 973.748] [M: 26734.66] [ET: 0.621/939.483] [MU: 5.56/26733.78] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 974.654] [M: 26741.92] [ET: 0.547/940.411] [MU: 0.89/26741.67] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 975.724] [M: 26752.52] [ET: 0.499/941.483] [MU: 3.34/26752.08] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 977.942] [M: 26763.06] [ET: 2.099/943.684] [MU: 3.53/26762.19] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp389)) OR (scr_area_type = 5 AND scr_area_id IN (:gp387)) OR (scr_area_type = 2 AND scr_area_id IN (:gp390)) OR (scr_area_type = 4 AND scr_area_id IN (:gp391)) OR (scr_area_type = 1 AND scr_area_id IN (:gp388)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp387":"908",":gp388":"31",":gp389":"908",":gp390":"105",":gp391":"1","scv_id":"16"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 979.032] [M: 26763.61] [ET: 0.607/944.791] [MU: 0.9/26763.39] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 980.28] [M: 26773.87] [ET: 0.59/946.013] [MU: 2.97/26773.43] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 982.775] [M: 26784.41] [ET: 2.314/948.5] [MU: 3.53/26783.54] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp394)) OR (scr_area_type = 5 AND scr_area_id IN (:gp392)) OR (scr_area_type = 2 AND scr_area_id IN (:gp395)) OR (scr_area_type = 4 AND scr_area_id IN (:gp396)) OR (scr_area_type = 1 AND scr_area_id IN (:gp393)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp392":"908",":gp393":"31",":gp394":"908",":gp395":"105",":gp396":"1","scv_id":"96"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 983.798] [M: 26782.98] [ET: 0.617/949.538] [MU: 0.9/26782.76] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 985.037] [M: 26923.35] [ET: 0.467/950.796] [MU: 130.97/26922.91] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 985.635] [M: 26952.52] [ET: 0.49/951.392] [MU: 22.54/26951.77] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp399)) OR (apr_area_type = 5 AND apr_area_id IN (:gp397)) OR (apr_area_type = 2 AND apr_area_id IN (:gp400)) OR (apr_area_type = 4 AND apr_area_id IN (:gp401)) OR (apr_area_type = 1 AND apr_area_id IN (:gp398))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp397":"908",":gp398":"31",":gp399":"30804",":gp400":"105",":gp401":"1","cab":"96"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 987.48] [M: 26939.54] [ET: 0.593/953.219] [MU: 3.33/26939.1] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 991.29] [M: 26950.09] [ET: 3.623/957.015] [MU: 3.53/26949.21] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp404)) OR (scr_area_type = 5 AND scr_area_id IN (:gp402)) OR (scr_area_type = 2 AND scr_area_id IN (:gp405)) OR (scr_area_type = 4 AND scr_area_id IN (:gp406)) OR (scr_area_type = 1 AND scr_area_id IN (:gp403)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp402":"908",":gp403":"31",":gp404":"908",":gp405":"105",":gp406":"1","scv_id":"96"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 992.388] [M: 26954.84] [ET: 0.656/958.128] [MU: 3.84/26953.96] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 992.982] [M: 26962.65] [ET: 0.478/958.741] [MU: 4.21/26961.77] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 993.273] [M: 26970.9] [ET: 0.224/959.039] [MU: 7.1/26970.8] 
	BookingRoute::calculateDistance
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 993.955] [M: 26973.7] [ET: 0.511/959.696] [MU: 2.65/26973.32] 
	SQL: SELECT *
				FROM   partner_rate prt 
				JOIN route rut ON prt.prt_route_id = rut.rut_id AND rut.rut_active = 1
				AND  rut.rut_from_city_id  = 30804 
				AND  rut.rut_to_city_id  = 30726 
				 WHERE prt_vehicletype_id = 96
				AND prt_partner_id = 1249
				AND prt_status = 1
				 
	 [params: []]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 994.844] [M: 26979.67] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30726","cabType":"3","tripDistance":"375","tripDuration":"420","multiCityData":"[{\"pickup_city\":\"30804\",\"drop_city\":\"30726\",\"pickup_address\":\"\",\"drop_address\":null,\"date\":\"2024-10-24 18:00:00\",\"distance\":\"375\",\"duration\":\"420\"}]","bookingType":"1","pickupAddress":"","dropupAddress":"","routeDataArr":[{"locLatVal":"","locLonVal":"","brtLocationVal":""},{"locLatVal":"","locLonVal":"","brtLocationVal":""}],"pickupDate":"24\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30726&cabType=3&tripDistance=375&tripDuration=420&multiCityData=%5B%7B%22pickup_city%22%3A%2230804%22%2C%22drop_city%22%3A%2230726%22%2C%22pickup_address%22%3A%22%22%2C%22drop_address%22%3Anull%2C%22date%22%3A%222024-10-24+18%3A00%3A00%22%2C%22distance%22%3A%22375%22%2C%22duration%22%3A%22420%22%7D%5D&bookingType=1&pickupAddress=&dropupAddress=&routeDataArr%5B0%5D%5BlocLatVal%5D=&routeDataArr%5B0%5D%5BlocLonVal%5D=&routeDataArr%5B0%5D%5BbrtLocationVal%5D=&routeDataArr%5B1%5D%5BlocLatVal%5D=&routeDataArr%5B1%5D%5BlocLonVal%5D=&routeDataArr%5B1%5D%5BbrtLocationVal%5D=&pickupDate=24%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 995.567] [M: 26998.77] [ET: 1.276/961.313] [MU: 21.05/26998.66] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 995.622] [M: 27000.45] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 997.034] [M: 27013.91] [ET: 1.218/962.765] [MU: 2.99/27011.41] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+5845),(IF((cpm_value_type=2),(5845+(5845*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30726 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30726) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-24 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=96 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 999.214] [M: 27056.13] [ET: 5.005/964.959] [MU: 78.88/27055.98] 
	RouteRates::calculate for CAB 96 2024-10-24 18:00:00 - Trip Type: 1 410363968
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 999.54] [M: 27035.75] [ET: 31.17/965.291] [MU: 344.33/27035.59] 
	Quote::calculateOneWay  for CAB 96 Date: 2024-10-24 18:00:00
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 999.924] [M: 27031.48] [ET: 0.274/965.667] [MU: 0.9/27031.23] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"96"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1000.046] [M: 27033.04] [ET: 37.779/965.793] [MU: 388.99/27032.95] 
	Quote For CabType: 96
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1001.398] [M: 27043.38] [ET: 0.448/967.151] [MU: 3.34/27042.95] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1001.999] [M: 27049.2] [ET: 0.498/967.744] [MU: 3.35/27048.77] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1002.711] [M: 27052.11] [ET: 0.605/968.452] [MU: 0.9/27051.89] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1003.486] [M: 27084.49] [ET: 0.608/969.228] [MU: 24.21/27082.99] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (101) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30726) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp407)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp410,:gp411)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp408,:gp409)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp412,:gp413))
			OR (scr_area_type = 5 AND scr_area_id IN (908))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (97)
		ORDER BY rank DESC
		 
	 [params: {":gp407":"31",":gp408":"30804",":gp409":"30726",":gp410":"105",":gp411":"101",":gp412":"1",":gp413":"1","tripType":"1"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1004.37] [M: 27064.67] [ET: 0.259/970.115] [MU: 0.84/27064.48] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1004.859] [M: 27067.55] [ET: 0.379/970.604] [MU: 0.96/27067.23] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"2"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1007.41] [M: 27080.3] [ET: 0.787/973.143] [MU: 2.05/27079.8] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"97"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1008.443] [M: 27089.93] [ET: 0.702/974.188] [MU: 3.78/27089.05] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"97","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1010.482] [M: 27106.55] [ET: 0.549/976.22] [MU: 3.78/27105.68] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"16","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1012.405] [M: 27124.95] [ET: 0.593/978.165] [MU: 5.56/27124.08] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1013.115] [M: 27132.19] [ET: 0.487/978.873] [MU: 0.9/27131.97] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1014.309] [M: 27142.81] [ET: 0.593/980.047] [MU: 3.34/27142.38] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1018.844] [M: 27153.36] [ET: 4.348/984.563] [MU: 3.53/27152.48] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp416)) OR (scr_area_type = 5 AND scr_area_id IN (:gp414)) OR (scr_area_type = 2 AND scr_area_id IN (:gp417)) OR (scr_area_type = 4 AND scr_area_id IN (:gp418)) OR (scr_area_type = 1 AND scr_area_id IN (:gp415)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp414":"908",":gp415":"31",":gp416":"908",":gp417":"105",":gp418":"1","scv_id":"16"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1019.95] [M: 27153.91] [ET: 0.575/985.707] [MU: 0.9/27153.69] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1021.07] [M: 27164.16] [ET: 0.541/986.827] [MU: 2.97/27163.73] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1023.71] [M: 27174.71] [ET: 2.513/989.443] [MU: 3.53/27173.84] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp421)) OR (scr_area_type = 5 AND scr_area_id IN (:gp419)) OR (scr_area_type = 2 AND scr_area_id IN (:gp422)) OR (scr_area_type = 4 AND scr_area_id IN (:gp423)) OR (scr_area_type = 1 AND scr_area_id IN (:gp420)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp419":"908",":gp420":"31",":gp421":"908",":gp422":"105",":gp423":"1","scv_id":"97"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1024.777] [M: 27173.27] [ET: 0.659/990.511] [MU: 0.9/27173.05] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1026.228] [M: 27185.65] [ET: 0.564/991.968] [MU: 2.97/27185.21] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1027.038] [M: 27214.82] [ET: 0.64/992.78] [MU: 22.53/27214.07] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp426)) OR (apr_area_type = 5 AND apr_area_id IN (:gp424)) OR (apr_area_type = 2 AND apr_area_id IN (:gp427)) OR (apr_area_type = 4 AND apr_area_id IN (:gp428)) OR (apr_area_type = 1 AND apr_area_id IN (:gp425))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp424":"908",":gp425":"31",":gp426":"30804",":gp427":"105",":gp428":"1","cab":"97"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1028.964] [M: 27201.84] [ET: 0.581/994.703] [MU: 3.33/27201.4] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1031.668] [M: 27212.38] [ET: 2.526/997.388] [MU: 3.53/27211.51] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp431)) OR (scr_area_type = 5 AND scr_area_id IN (:gp429)) OR (scr_area_type = 2 AND scr_area_id IN (:gp432)) OR (scr_area_type = 4 AND scr_area_id IN (:gp433)) OR (scr_area_type = 1 AND scr_area_id IN (:gp430)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp429":"908",":gp430":"31",":gp431":"908",":gp432":"105",":gp433":"1","scv_id":"97"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1032.746] [M: 27217.13] [ET: 0.631/998.503] [MU: 3.84/27216.26] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1033.299] [M: 27224.95] [ET: 0.451/999.039] [MU: 4.21/27224.07] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1033.802] [M: 27233.2] [ET: 0.39/999.548] [MU: 7.1/27233.1] 
	BookingRoute::calculateDistance
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1034.501] [M: 27235.99] [ET: 0.447/1000.259] [MU: 2.66/27235.62] 
	SQL: SELECT *
				FROM   partner_rate prt 
				JOIN route rut ON prt.prt_route_id = rut.rut_id AND rut.rut_active = 1
				AND  rut.rut_from_city_id  = 30804 
				AND  rut.rut_to_city_id  = 30726 
				 WHERE prt_vehicletype_id = 97
				AND prt_partner_id = 1249
				AND prt_status = 1
				 
	 [params: []]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1035.092] [M: 27241.97] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30726","cabType":"3","tripDistance":"375","tripDuration":"420","multiCityData":"[{\"pickup_city\":\"30804\",\"drop_city\":\"30726\",\"pickup_address\":\"\",\"drop_address\":null,\"date\":\"2024-10-24 18:00:00\",\"distance\":\"375\",\"duration\":\"420\"}]","bookingType":"1","pickupAddress":"","dropupAddress":"","routeDataArr":[{"locLatVal":"","locLonVal":"","brtLocationVal":""},{"locLatVal":"","locLonVal":"","brtLocationVal":""}],"pickupDate":"24\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30726&cabType=3&tripDistance=375&tripDuration=420&multiCityData=%5B%7B%22pickup_city%22%3A%2230804%22%2C%22drop_city%22%3A%2230726%22%2C%22pickup_address%22%3A%22%22%2C%22drop_address%22%3Anull%2C%22date%22%3A%222024-10-24+18%3A00%3A00%22%2C%22distance%22%3A%22375%22%2C%22duration%22%3A%22420%22%7D%5D&bookingType=1&pickupAddress=&dropupAddress=&routeDataArr%5B0%5D%5BlocLatVal%5D=&routeDataArr%5B0%5D%5BlocLonVal%5D=&routeDataArr%5B0%5D%5BbrtLocationVal%5D=&routeDataArr%5B1%5D%5BlocLatVal%5D=&routeDataArr%5B1%5D%5BlocLonVal%5D=&routeDataArr%5B1%5D%5BbrtLocationVal%5D=&pickupDate=24%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1035.507] [M: 27261.06] [ET: 0.805/1001.274] [MU: 21.05/27260.95] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1035.537] [M: 27262.74] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1036.672] [M: 27276.2] [ET: 0.996/1002.397] [MU: 3/27273.7] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+5845),(IF((cpm_value_type=2),(5845+(5845*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30726 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30726) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-24 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=97 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1039.119] [M: 27318.43] [ET: 4.45/1004.862] [MU: 78.88/27318.27] 
	RouteRates::calculate for CAB 97 2024-10-24 18:00:00 - Trip Type: 1 173918160
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1039.474] [M: 27298.05] [ET: 31.951/1005.224] [MU: 216.32/27297.89] 
	Quote::calculateOneWay  for CAB 97 Date: 2024-10-24 18:00:00
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1039.955] [M: 27293.77] [ET: 0.364/1005.695] [MU: 0.9/27293.52] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"97"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1040.084] [M: 27295.96] [ET: 39.957/1005.836] [MU: 261.62/27295.87] 
	Quote For CabType: 97
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1041.178] [M: 27306.3] [ET: 0.399/1006.939] [MU: 3.34/27305.87] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1041.607] [M: 27312.13] [ET: 0.361/1007.37] [MU: 3.34/27311.69] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1042.148] [M: 27315.06] [ET: 0.472/1007.907] [MU: 0.9/27314.81] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1042.721] [M: 27347.41] [ET: 0.457/1008.478] [MU: 24.22/27345.91] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (101) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30726) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp434)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp437,:gp438)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp435,:gp436)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp439,:gp440))
			OR (scr_area_type = 5 AND scr_area_id IN (908))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (98)
		ORDER BY rank DESC
		 
	 [params: {":gp434":"31",":gp435":"30804",":gp436":"30726",":gp437":"105",":gp438":"101",":gp439":"1",":gp440":"1","tripType":"1"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1043.42] [M: 27327.59] [ET: 0.216/1009.181] [MU: 0.84/27327.41] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1043.795] [M: 27330.47] [ET: 0.302/1009.557] [MU: 0.96/27330.16] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"2"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1044.962] [M: 27351.22] [ET: 0.36/1010.721] [MU: 2.05/27350.72] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"98"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1045.807] [M: 27360.85] [ET: 0.633/1011.549] [MU: 3.78/27359.98] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"98","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1047.621] [M: 27377.48] [ET: 0.487/1013.38] [MU: 3.78/27376.6] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"16","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1049.162] [M: 27395.88] [ET: 0.481/1014.921] [MU: 5.56/27395] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1049.838] [M: 27403.14] [ET: 0.454/1015.597] [MU: 0.9/27402.89] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1051.155] [M: 27413.73] [ET: 0.624/1016.914] [MU: 3.34/27413.3] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1053.881] [M: 27424.28] [ET: 2.596/1019.607] [MU: 3.53/27423.41] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp443)) OR (scr_area_type = 5 AND scr_area_id IN (:gp441)) OR (scr_area_type = 2 AND scr_area_id IN (:gp444)) OR (scr_area_type = 4 AND scr_area_id IN (:gp445)) OR (scr_area_type = 1 AND scr_area_id IN (:gp442)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp441":"908",":gp442":"31",":gp443":"908",":gp444":"105",":gp445":"1","scv_id":"16"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1055.202] [M: 27424.86] [ET: 0.687/1020.899] [MU: 0.9/27424.61] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1057.138] [M: 27435.09] [ET: 0.695/1022.895] [MU: 2.97/27434.65] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1059.499] [M: 27445.63] [ET: 2.245/1025.249] [MU: 3.53/27444.76] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp448)) OR (scr_area_type = 5 AND scr_area_id IN (:gp446)) OR (scr_area_type = 2 AND scr_area_id IN (:gp449)) OR (scr_area_type = 4 AND scr_area_id IN (:gp450)) OR (scr_area_type = 1 AND scr_area_id IN (:gp447)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp446":"908",":gp447":"31",":gp448":"908",":gp449":"105",":gp450":"1","scv_id":"98"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1060.398] [M: 27444.23] [ET: 0.627/1026.154] [MU: 0.9/27443.98] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1061.496] [M: 27456.57] [ET: 0.446/1027.257] [MU: 2.97/27456.13] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1062.192] [M: 27485.74] [ET: 0.589/1027.951] [MU: 22.53/27484.99] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp453)) OR (apr_area_type = 5 AND apr_area_id IN (:gp451)) OR (apr_area_type = 2 AND apr_area_id IN (:gp454)) OR (apr_area_type = 4 AND apr_area_id IN (:gp455)) OR (apr_area_type = 1 AND apr_area_id IN (:gp452))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp451":"908",":gp452":"31",":gp453":"30804",":gp454":"105",":gp455":"1","cab":"98"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1063.578] [M: 27472.76] [ET: 0.434/1029.34] [MU: 3.33/27472.32] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1066.38] [M: 27483.3] [ET: 2.693/1032.13] [MU: 3.53/27482.43] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp458)) OR (scr_area_type = 5 AND scr_area_id IN (:gp456)) OR (scr_area_type = 2 AND scr_area_id IN (:gp459)) OR (scr_area_type = 4 AND scr_area_id IN (:gp460)) OR (scr_area_type = 1 AND scr_area_id IN (:gp457)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp456":"908",":gp457":"31",":gp458":"908",":gp459":"105",":gp460":"1","scv_id":"98"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1067.195] [M: 27488.05] [ET: 0.503/1032.953] [MU: 3.84/27487.18] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1067.69] [M: 27495.87] [ET: 0.401/1033.448] [MU: 4.21/27494.99] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1067.987] [M: 27504.13] [ET: 0.231/1033.754] [MU: 7.11/27504.02] 
	BookingRoute::calculateDistance
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1068.792] [M: 27506.91] [ET: 0.625/1034.523] [MU: 2.65/27506.54] 
	SQL: SELECT *
				FROM   partner_rate prt 
				JOIN route rut ON prt.prt_route_id = rut.rut_id AND rut.rut_active = 1
				AND  rut.rut_from_city_id  = 30804 
				AND  rut.rut_to_city_id  = 30726 
				 WHERE prt_vehicletype_id = 98
				AND prt_partner_id = 1249
				AND prt_status = 1
				 
	 [params: []]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1069.689] [M: 27512.89] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30726","cabType":"3","tripDistance":"375","tripDuration":"420","multiCityData":"[{\"pickup_city\":\"30804\",\"drop_city\":\"30726\",\"pickup_address\":\"\",\"drop_address\":null,\"date\":\"2024-10-24 18:00:00\",\"distance\":\"375\",\"duration\":\"420\"}]","bookingType":"1","pickupAddress":"","dropupAddress":"","routeDataArr":[{"locLatVal":"","locLonVal":"","brtLocationVal":""},{"locLatVal":"","locLonVal":"","brtLocationVal":""}],"pickupDate":"24\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30726&cabType=3&tripDistance=375&tripDuration=420&multiCityData=%5B%7B%22pickup_city%22%3A%2230804%22%2C%22drop_city%22%3A%2230726%22%2C%22pickup_address%22%3A%22%22%2C%22drop_address%22%3Anull%2C%22date%22%3A%222024-10-24+18%3A00%3A00%22%2C%22distance%22%3A%22375%22%2C%22duration%22%3A%22420%22%7D%5D&bookingType=1&pickupAddress=&dropupAddress=&routeDataArr%5B0%5D%5BlocLatVal%5D=&routeDataArr%5B0%5D%5BlocLonVal%5D=&routeDataArr%5B0%5D%5BbrtLocationVal%5D=&routeDataArr%5B1%5D%5BlocLatVal%5D=&routeDataArr%5B1%5D%5BlocLonVal%5D=&routeDataArr%5B1%5D%5BbrtLocationVal%5D=&pickupDate=24%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1070.392] [M: 27531.98] [ET: 1.242/1036.134] [MU: 21.05/27531.88] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1070.449] [M: 27533.66] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1071.8] [M: 27547.13] [ET: 1.122/1037.472] [MU: 2.99/27544.63] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+5845),(IF((cpm_value_type=2),(5845+(5845*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30726 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30726) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-24 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=98 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1074.254] [M: 27589.35] [ET: 5.207/1040.016] [MU: 78.88/27589.2] 
	RouteRates::calculate for CAB 98 2024-10-24 18:00:00 - Trip Type: 1 113165506
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1074.473] [M: 27568.97] [ET: 29.438/1040.235] [MU: 216.33/27568.81] 
	Quote::calculateOneWay  for CAB 98 Date: 2024-10-24 18:00:00
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1074.777] [M: 27564.7] [ET: 0.221/1040.522] [MU: 0.9/27564.45] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"98"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1074.904] [M: 27566.88] [ET: 34.752/1040.646] [MU: 269.62/27566.79] 
	Quote For CabType: 98
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1076.305] [M: 27577.23] [ET: 0.506/1042.046] [MU: 3.33/27576.79] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1076.898] [M: 27583.05] [ET: 0.48/1042.641] [MU: 3.34/27582.61] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1077.466] [M: 27585.98] [ET: 0.472/1043.227] [MU: 0.9/27585.73] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1078.068] [M: 27618.34] [ET: 0.478/1043.803] [MU: 24.22/27616.84] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (101) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30726) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp461)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp464,:gp465)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp462,:gp463)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp466,:gp467))
			OR (scr_area_type = 5 AND scr_area_id IN (908))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (99)
		ORDER BY rank DESC
		 
	 [params: {":gp461":"31",":gp462":"30804",":gp463":"30726",":gp464":"105",":gp465":"101",":gp466":"1",":gp467":"1","tripType":"1"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1078.952] [M: 27598.52] [ET: 0.225/1044.714] [MU: 0.84/27598.33] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1079.34] [M: 27601.39] [ET: 0.298/1045.083] [MU: 0.96/27601.08] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"2"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1080.997] [M: 27614.14] [ET: 0.48/1046.735] [MU: 2.04/27613.64] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"99"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1082.065] [M: 27623.77] [ET: 0.738/1047.806] [MU: 3.78/27622.9] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"99","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1083.818] [M: 27640.4] [ET: 0.455/1049.578] [MU: 3.79/27639.52] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"16","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1085.3] [M: 27658.8] [ET: 0.462/1051.06] [MU: 5.56/27657.92] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1086.067] [M: 27666.06] [ET: 0.541/1051.822] [MU: 0.9/27665.81] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1087.397] [M: 27676.66] [ET: 0.738/1053.129] [MU: 3.33/27676.22] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1090.337] [M: 27687.2] [ET: 2.753/1056.067] [MU: 3.53/27686.33] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp470)) OR (scr_area_type = 5 AND scr_area_id IN (:gp468)) OR (scr_area_type = 2 AND scr_area_id IN (:gp471)) OR (scr_area_type = 4 AND scr_area_id IN (:gp472)) OR (scr_area_type = 1 AND scr_area_id IN (:gp469)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp468":"908",":gp469":"31",":gp470":"908",":gp471":"105",":gp472":"1","scv_id":"16"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1091.509] [M: 27687.78] [ET: 0.628/1057.268] [MU: 0.89/27687.53] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1092.562] [M: 27698.01] [ET: 0.464/1058.322] [MU: 2.97/27697.57] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1095.011] [M: 27708.55] [ET: 2.325/1060.735] [MU: 3.53/27707.68] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp475)) OR (scr_area_type = 5 AND scr_area_id IN (:gp473)) OR (scr_area_type = 2 AND scr_area_id IN (:gp476)) OR (scr_area_type = 4 AND scr_area_id IN (:gp477)) OR (scr_area_type = 1 AND scr_area_id IN (:gp474)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp473":"908",":gp474":"31",":gp475":"908",":gp476":"105",":gp477":"1","scv_id":"99"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1096.034] [M: 27707.12] [ET: 0.625/1061.775] [MU: 0.9/27706.9] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1097.516] [M: 27719.49] [ET: 0.59/1063.253] [MU: 2.97/27719.05] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1098.352] [M: 27748.66] [ET: 0.658/1064.087] [MU: 22.53/27747.91] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp480)) OR (apr_area_type = 5 AND apr_area_id IN (:gp478)) OR (apr_area_type = 2 AND apr_area_id IN (:gp481)) OR (apr_area_type = 4 AND apr_area_id IN (:gp482)) OR (apr_area_type = 1 AND apr_area_id IN (:gp479))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp478":"908",":gp479":"31",":gp480":"30804",":gp481":"105",":gp482":"1","cab":"99"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1100.255] [M: 27735.68] [ET: 0.593/1065.998] [MU: 3.33/27735.24] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1103.702] [M: 27746.23] [ET: 3.292/1069.44] [MU: 3.53/27745.35] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp485)) OR (scr_area_type = 5 AND scr_area_id IN (:gp483)) OR (scr_area_type = 2 AND scr_area_id IN (:gp486)) OR (scr_area_type = 4 AND scr_area_id IN (:gp487)) OR (scr_area_type = 1 AND scr_area_id IN (:gp484)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp483":"908",":gp484":"31",":gp485":"908",":gp486":"105",":gp487":"1","scv_id":"99"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1104.728] [M: 27750.98] [ET: 0.702/1070.485] [MU: 3.84/27750.1] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1105.774] [M: 27758.79] [ET: 0.931/1071.508] [MU: 4.21/27757.91] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1106.466] [M: 27767.05] [ET: 0.54/1072.214] [MU: 7.1/27766.95] 
	BookingRoute::calculateDistance
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1107.556] [M: 27769.84] [ET: 0.798/1073.295] [MU: 2.65/27769.46] 
	SQL: SELECT *
				FROM   partner_rate prt 
				JOIN route rut ON prt.prt_route_id = rut.rut_id AND rut.rut_active = 1
				AND  rut.rut_from_city_id  = 30804 
				AND  rut.rut_to_city_id  = 30726 
				 WHERE prt_vehicletype_id = 99
				AND prt_partner_id = 1249
				AND prt_status = 1
				 
	 [params: []]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1108.483] [M: 27775.81] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30726","cabType":"3","tripDistance":"375","tripDuration":"420","multiCityData":"[{\"pickup_city\":\"30804\",\"drop_city\":\"30726\",\"pickup_address\":\"\",\"drop_address\":null,\"date\":\"2024-10-24 18:00:00\",\"distance\":\"375\",\"duration\":\"420\"}]","bookingType":"1","pickupAddress":"","dropupAddress":"","routeDataArr":[{"locLatVal":"","locLonVal":"","brtLocationVal":""},{"locLatVal":"","locLonVal":"","brtLocationVal":""}],"pickupDate":"24\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30726&cabType=3&tripDistance=375&tripDuration=420&multiCityData=%5B%7B%22pickup_city%22%3A%2230804%22%2C%22drop_city%22%3A%2230726%22%2C%22pickup_address%22%3A%22%22%2C%22drop_address%22%3Anull%2C%22date%22%3A%222024-10-24+18%3A00%3A00%22%2C%22distance%22%3A%22375%22%2C%22duration%22%3A%22420%22%7D%5D&bookingType=1&pickupAddress=&dropupAddress=&routeDataArr%5B0%5D%5BlocLatVal%5D=&routeDataArr%5B0%5D%5BlocLonVal%5D=&routeDataArr%5B0%5D%5BbrtLocationVal%5D=&routeDataArr%5B1%5D%5BlocLatVal%5D=&routeDataArr%5B1%5D%5BlocLonVal%5D=&routeDataArr%5B1%5D%5BbrtLocationVal%5D=&pickupDate=24%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1109.2] [M: 27794.91] [ET: 1.287/1074.946] [MU: 21.05/27794.8] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1109.256] [M: 27796.59] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1110.523] [M: 27810.05] [ET: 1.078/1076.253] [MU: 2.99/27807.55] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+5845),(IF((cpm_value_type=2),(5845+(5845*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30726 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30726) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-24 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=99 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1112.755] [M: 27852.27] [ET: 4.944/1078.514] [MU: 78.88/27852.12] 
	RouteRates::calculate for CAB 99 2024-10-24 18:00:00 - Trip Type: 1 501921791
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1112.981] [M: 27831.89] [ET: 31.887/1078.748] [MU: 216.33/27831.73] 
	Quote::calculateOneWay  for CAB 99 Date: 2024-10-24 18:00:00
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1113.275] [M: 27827.62] [ET: 0.221/1079.038] [MU: 0.9/27827.37] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"99"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1113.351] [M: 27829.8] [ET: 38.374/1079.118] [MU: 261.61/27829.71] 
	Quote For CabType: 99
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1114.575] [M: 27840.15] [ET: 0.441/1080.335] [MU: 3.33/27839.71] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1114.995] [M: 27845.97] [ET: 0.351/1080.757] [MU: 3.34/27845.53] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1115.529] [M: 27848.91] [ET: 0.465/1081.288] [MU: 0.9/27848.66] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1116.096] [M: 27881.26] [ET: 0.449/1081.852] [MU: 24.22/27879.76] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (101) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30726) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp488)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp491,:gp492)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp489,:gp490)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp493,:gp494))
			OR (scr_area_type = 5 AND scr_area_id IN (908))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (108)
		ORDER BY rank DESC
		 
	 [params: {":gp488":"31",":gp489":"30804",":gp490":"30726",":gp491":"105",":gp492":"101",":gp493":"1",":gp494":"1","tripType":"1"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1116.792] [M: 27861.45] [ET: 0.221/1082.533] [MU: 0.84/27861.27] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1117.221] [M: 27864.3] [ET: 0.324/1082.983] [MU: 0.93/27863.98] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"6"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1118.388] [M: 27877.13] [ET: 0.36/1084.126] [MU: 2.05/27876.63] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"108"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1119.284] [M: 27886.77] [ET: 0.573/1085.044] [MU: 3.78/27885.89] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"108","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1120.868] [M: 27903.41] [ET: 0.462/1086.629] [MU: 3.78/27902.53] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"73","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1123.556] [M: 27921.8] [ET: 1.018/1089.293] [MU: 5.56/27920.93] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1124.458] [M: 27929.07] [ET: 0.536/1090.219] [MU: 0.9/27928.82] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1125.533] [M: 27939.66] [ET: 0.529/1091.292] [MU: 3.34/27939.23] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1127.78] [M: 27950.21] [ET: 2.114/1093.497] [MU: 3.53/27949.34] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp497)) OR (scr_area_type = 5 AND scr_area_id IN (:gp495)) OR (scr_area_type = 2 AND scr_area_id IN (:gp498)) OR (scr_area_type = 4 AND scr_area_id IN (:gp499)) OR (scr_area_type = 1 AND scr_area_id IN (:gp496)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp495":"908",":gp496":"31",":gp497":"908",":gp498":"105",":gp499":"1","scv_id":"73"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1128.84] [M: 27950.79] [ET: 0.548/1094.593] [MU: 0.9/27950.54] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1129.921] [M: 27961.02] [ET: 0.477/1095.681] [MU: 2.97/27960.58] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1132.224] [M: 27971.56] [ET: 2.177/1097.952] [MU: 3.53/27970.69] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp502)) OR (scr_area_type = 5 AND scr_area_id IN (:gp500)) OR (scr_area_type = 2 AND scr_area_id IN (:gp503)) OR (scr_area_type = 4 AND scr_area_id IN (:gp504)) OR (scr_area_type = 1 AND scr_area_id IN (:gp501)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp500":"908",":gp501":"31",":gp502":"908",":gp503":"105",":gp504":"1","scv_id":"108"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1133.079] [M: 27970.14] [ET: 0.509/1098.813] [MU: 0.9/27969.89] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1134.388] [M: 27982.48] [ET: 0.486/1100.148] [MU: 2.97/27982.05] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1135.048] [M: 28011.66] [ET: 0.536/1100.784] [MU: 22.53/28010.91] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp507)) OR (apr_area_type = 5 AND apr_area_id IN (:gp505)) OR (apr_area_type = 2 AND apr_area_id IN (:gp508)) OR (apr_area_type = 4 AND apr_area_id IN (:gp509)) OR (apr_area_type = 1 AND apr_area_id IN (:gp506))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp505":"908",":gp506":"31",":gp507":"30804",":gp508":"105",":gp509":"1","cab":"108"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1136.982] [M: 27998.69] [ET: 0.563/1102.714] [MU: 3.33/27998.25] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1140.017] [M: 28009.23] [ET: 2.875/1105.765] [MU: 3.53/28008.36] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp512)) OR (scr_area_type = 5 AND scr_area_id IN (:gp510)) OR (scr_area_type = 2 AND scr_area_id IN (:gp513)) OR (scr_area_type = 4 AND scr_area_id IN (:gp514)) OR (scr_area_type = 1 AND scr_area_id IN (:gp511)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp510":"908",":gp511":"31",":gp512":"908",":gp513":"105",":gp514":"1","scv_id":"108"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1140.981] [M: 28013.97] [ET: 0.653/1106.72] [MU: 3.85/28013.09] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1141.58] [M: 28021.78] [ET: 0.492/1107.331] [MU: 4.21/28020.91] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1141.889] [M: 28030.05] [ET: 0.235/1107.656] [MU: 7.1/28029.94] 
	BookingRoute::calculateDistance
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1142.544] [M: 28032.83] [ET: 0.494/1108.303] [MU: 2.66/28032.45] 
	SQL: SELECT *
				FROM   partner_rate prt 
				JOIN route rut ON prt.prt_route_id = rut.rut_id AND rut.rut_active = 1
				AND  rut.rut_from_city_id  = 30804 
				AND  rut.rut_to_city_id  = 30726 
				 WHERE prt_vehicletype_id = 108
				AND prt_partner_id = 1249
				AND prt_status = 1
				 
	 [params: []]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1143.28] [M: 28038.8] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30726","cabType":"3","tripDistance":"375","tripDuration":"420","multiCityData":"[{\"pickup_city\":\"30804\",\"drop_city\":\"30726\",\"pickup_address\":\"\",\"drop_address\":null,\"date\":\"2024-10-24 18:00:00\",\"distance\":\"375\",\"duration\":\"420\"}]","bookingType":"1","pickupAddress":"","dropupAddress":"","routeDataArr":[{"locLatVal":"","locLonVal":"","brtLocationVal":""},{"locLatVal":"","locLonVal":"","brtLocationVal":""}],"pickupDate":"24\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30726&cabType=3&tripDistance=375&tripDuration=420&multiCityData=%5B%7B%22pickup_city%22%3A%2230804%22%2C%22drop_city%22%3A%2230726%22%2C%22pickup_address%22%3A%22%22%2C%22drop_address%22%3Anull%2C%22date%22%3A%222024-10-24+18%3A00%3A00%22%2C%22distance%22%3A%22375%22%2C%22duration%22%3A%22420%22%7D%5D&bookingType=1&pickupAddress=&dropupAddress=&routeDataArr%5B0%5D%5BlocLatVal%5D=&routeDataArr%5B0%5D%5BlocLonVal%5D=&routeDataArr%5B0%5D%5BbrtLocationVal%5D=&routeDataArr%5B1%5D%5BlocLatVal%5D=&routeDataArr%5B1%5D%5BlocLonVal%5D=&routeDataArr%5B1%5D%5BbrtLocationVal%5D=&pickupDate=24%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1143.816] [M: 28057.9] [ET: 1.007/1109.578] [MU: 21.05/28057.79] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1143.854] [M: 28059.58] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1145.119] [M: 28073.04] [ET: 1.108/1110.86] [MU: 2.99/28070.54] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+5845),(IF((cpm_value_type=2),(5845+(5845*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30726 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30726) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-24 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=108 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1147.048] [M: 28115.27] [ET: 4.28/1112.783] [MU: 78.87/28115.11] 
	RouteRates::calculate for CAB 108 2024-10-24 18:00:00 - Trip Type: 1 7890346
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1147.447] [M: 28094.88] [ET: 28.948/1113.194] [MU: 216.33/28094.73] 
	Quote::calculateOneWay  for CAB 108 Date: 2024-10-24 18:00:00
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1147.936] [M: 28090.51] [ET: 0.369/1113.678] [MU: 0.9/28090.26] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"108"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1148.06] [M: 28092.7] [ET: 34.644/1113.809] [MU: 261.58/28092.6] 
	Quote For CabType: 108
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1149.27] [M: 28103.04] [ET: 0.457/1115.031] [MU: 3.33/28102.6] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1149.823] [M: 28108.86] [ET: 0.462/1115.565] [MU: 3.34/28108.42] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1150.528] [M: 28111.77] [ET: 0.6/1116.284] [MU: 0.9/28111.55] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1151.249] [M: 28144.15] [ET: 0.589/1116.993] [MU: 24.22/28142.65] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (101) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30726) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp515)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp518,:gp519)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp516,:gp517)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp520,:gp521))
			OR (scr_area_type = 5 AND scr_area_id IN (908))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (111)
		ORDER BY rank DESC
		 
	 [params: {":gp515":"31",":gp516":"30804",":gp517":"30726",":gp518":"105",":gp519":"101",":gp520":"1",":gp521":"1","tripType":"1"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1152.366] [M: 28124.34] [ET: 0.333/1118.105] [MU: 0.83/28124.15] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1152.934] [M: 28127.18] [ET: 0.442/1118.687] [MU: 0.93/28126.87] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"6"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1154.317] [M: 28140.02] [ET: 0.411/1120.059] [MU: 2.05/28139.52] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"111"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1155.785] [M: 28149.65] [ET: 1.09/1121.48] [MU: 3.79/28148.77] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"111","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1158.508] [M: 28166.28] [ET: 0.573/1124.25] [MU: 3.78/28165.41] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"73","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1160.438] [M: 28184.68] [ET: 0.565/1126.175] [MU: 5.57/28183.8] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1161.364] [M: 28191.91] [ET: 0.556/1127.12] [MU: 0.9/28191.7] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1162.681] [M: 28202.54] [ET: 0.603/1128.416] [MU: 3.33/28202.1] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1165.181] [M: 28213.09] [ET: 2.343/1130.932] [MU: 3.53/28212.21] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp524)) OR (scr_area_type = 5 AND scr_area_id IN (:gp522)) OR (scr_area_type = 2 AND scr_area_id IN (:gp525)) OR (scr_area_type = 4 AND scr_area_id IN (:gp526)) OR (scr_area_type = 1 AND scr_area_id IN (:gp523)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp522":"908",":gp523":"31",":gp524":"908",":gp525":"105",":gp526":"1","scv_id":"73"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1166.356] [M: 28213.66] [ET: 0.633/1132.112] [MU: 0.9/28213.41] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1167.566] [M: 28223.89] [ET: 0.518/1133.305] [MU: 2.97/28223.45] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1170.132] [M: 28234.44] [ET: 2.408/1135.879] [MU: 3.54/28233.56] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp529)) OR (scr_area_type = 5 AND scr_area_id IN (:gp527)) OR (scr_area_type = 2 AND scr_area_id IN (:gp530)) OR (scr_area_type = 4 AND scr_area_id IN (:gp531)) OR (scr_area_type = 1 AND scr_area_id IN (:gp528)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp527":"908",":gp528":"31",":gp529":"908",":gp530":"105",":gp531":"1","scv_id":"111"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1171.304] [M: 28233.02] [ET: 0.742/1137.057] [MU: 0.9/28232.77] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1173.464] [M: 28245.37] [ET: 0.85/1139.217] [MU: 2.97/28244.93] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1174.307] [M: 28274.54] [ET: 0.699/1140.042] [MU: 22.53/28273.79] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp534)) OR (apr_area_type = 5 AND apr_area_id IN (:gp532)) OR (apr_area_type = 2 AND apr_area_id IN (:gp535)) OR (apr_area_type = 4 AND apr_area_id IN (:gp536)) OR (apr_area_type = 1 AND apr_area_id IN (:gp533))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp532":"908",":gp533":"31",":gp534":"30804",":gp535":"105",":gp536":"1","cab":"111"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1176.367] [M: 28261.56] [ET: 0.49/1142.116] [MU: 3.34/28261.13] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1179.091] [M: 28272.11] [ET: 2.575/1144.821] [MU: 3.53/28271.23] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp539)) OR (scr_area_type = 5 AND scr_area_id IN (:gp537)) OR (scr_area_type = 2 AND scr_area_id IN (:gp540)) OR (scr_area_type = 4 AND scr_area_id IN (:gp541)) OR (scr_area_type = 1 AND scr_area_id IN (:gp538)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp537":"908",":gp538":"31",":gp539":"908",":gp540":"105",":gp541":"1","scv_id":"111"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1180.187] [M: 28276.85] [ET: 0.621/1145.927] [MU: 3.84/28275.98] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1180.804] [M: 28284.66] [ET: 0.491/1146.55] [MU: 4.21/28283.79] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1181.255] [M: 28292.93] [ET: 0.344/1147.003] [MU: 7.1/28292.82] 
	BookingRoute::calculateDistance
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1182.068] [M: 28295.71] [ET: 0.594/1147.807] [MU: 2.66/28295.34] 
	SQL: SELECT *
				FROM   partner_rate prt 
				JOIN route rut ON prt.prt_route_id = rut.rut_id AND rut.rut_active = 1
				AND  rut.rut_from_city_id  = 30804 
				AND  rut.rut_to_city_id  = 30726 
				 WHERE prt_vehicletype_id = 111
				AND prt_partner_id = 1249
				AND prt_status = 1
				 
	 [params: []]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1182.862] [M: 28301.69] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30726","cabType":"3","tripDistance":"375","tripDuration":"420","multiCityData":"[{\"pickup_city\":\"30804\",\"drop_city\":\"30726\",\"pickup_address\":\"\",\"drop_address\":null,\"date\":\"2024-10-24 18:00:00\",\"distance\":\"375\",\"duration\":\"420\"}]","bookingType":"1","pickupAddress":"","dropupAddress":"","routeDataArr":[{"locLatVal":"","locLonVal":"","brtLocationVal":""},{"locLatVal":"","locLonVal":"","brtLocationVal":""}],"pickupDate":"24\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30726&cabType=3&tripDistance=375&tripDuration=420&multiCityData=%5B%7B%22pickup_city%22%3A%2230804%22%2C%22drop_city%22%3A%2230726%22%2C%22pickup_address%22%3A%22%22%2C%22drop_address%22%3Anull%2C%22date%22%3A%222024-10-24+18%3A00%3A00%22%2C%22distance%22%3A%22375%22%2C%22duration%22%3A%22420%22%7D%5D&bookingType=1&pickupAddress=&dropupAddress=&routeDataArr%5B0%5D%5BlocLatVal%5D=&routeDataArr%5B0%5D%5BlocLonVal%5D=&routeDataArr%5B0%5D%5BbrtLocationVal%5D=&routeDataArr%5B1%5D%5BlocLatVal%5D=&routeDataArr%5B1%5D%5BlocLonVal%5D=&routeDataArr%5B1%5D%5BbrtLocationVal%5D=&pickupDate=24%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1183.519] [M: 28320.78] [ET: 1.152/1149.27] [MU: 21.04/28320.67] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1183.573] [M: 28322.46] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1184.958] [M: 28335.92] [ET: 1.194/1150.696] [MU: 2.99/28333.42] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+5845),(IF((cpm_value_type=2),(5845+(5845*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30726 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30726) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-24 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=111 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1191.701] [M: 28378.15] [ET: 9.405/1157.435] [MU: 78.87/28377.99] 
	RouteRates::calculate for CAB 111 2024-10-24 18:00:00 - Trip Type: 1 773973576
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1192.093] [M: 28357.77] [ET: 37.663/1157.837] [MU: 216.33/28357.61] 
	Quote::calculateOneWay  for CAB 111 Date: 2024-10-24 18:00:00
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1192.624] [M: 28353.4] [ET: 0.412/1158.364] [MU: 0.9/28353.15] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"111"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1192.766] [M: 28355.59] [ET: 44.603/1158.503] [MU: 261.58/28355.49] 
	Quote For CabType: 111
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1194.205] [M: 28365.93] [ET: 0.486/1159.946] [MU: 3.33/28365.49] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1195.026] [M: 28371.75] [ET: 0.698/1160.731] [MU: 3.35/28371.31] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1195.878] [M: 28374.69] [ET: 0.703/1161.596] [MU: 0.9/28374.44] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1196.753] [M: 28407.04] [ET: 0.674/1162.484] [MU: 24.22/28405.54] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (101) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30726) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp542)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp545,:gp546)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp543,:gp544)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp547,:gp548))
			OR (scr_area_type = 5 AND scr_area_id IN (908))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (112)
		ORDER BY rank DESC
		 
	 [params: {":gp542":"31",":gp543":"30804",":gp544":"30726",":gp545":"105",":gp546":"101",":gp547":"1",":gp548":"1","tripType":"1"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1197.812] [M: 28387.23] [ET: 0.338/1163.557] [MU: 0.83/28387.04] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1198.307] [M: 28390.07] [ET: 0.395/1164.047] [MU: 0.93/28389.76] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"6"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1200.118] [M: 28402.91] [ET: 0.578/1165.856] [MU: 2.05/28402.41] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"112"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1201.065] [M: 28412.54] [ET: 0.65/1166.824] [MU: 3.78/28411.66] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"112","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1203.346] [M: 28429.17] [ET: 0.612/1169.087] [MU: 3.78/28428.3] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"73","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1205.732] [M: 28447.57] [ET: 0.733/1171.462] [MU: 5.56/28446.7] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1206.862] [M: 28454.84] [ET: 0.696/1172.597] [MU: 0.9/28454.59] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1208.402] [M: 28465.43] [ET: 0.697/1174.141] [MU: 3.33/28464.99] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1211.031] [M: 28475.98] [ET: 2.449/1176.759] [MU: 3.53/28475.1] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp551)) OR (scr_area_type = 5 AND scr_area_id IN (:gp549)) OR (scr_area_type = 2 AND scr_area_id IN (:gp552)) OR (scr_area_type = 4 AND scr_area_id IN (:gp553)) OR (scr_area_type = 1 AND scr_area_id IN (:gp550)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp549":"908",":gp550":"31",":gp551":"908",":gp552":"105",":gp553":"1","scv_id":"73"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1212.28] [M: 28476.52] [ET: 0.673/1178.012] [MU: 0.9/28476.3] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1213.721] [M: 28486.78] [ET: 0.557/1179.459] [MU: 2.97/28486.34] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1216.314] [M: 28497.33] [ET: 2.419/1182.042] [MU: 3.54/28496.45] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp556)) OR (scr_area_type = 5 AND scr_area_id IN (:gp554)) OR (scr_area_type = 2 AND scr_area_id IN (:gp557)) OR (scr_area_type = 4 AND scr_area_id IN (:gp558)) OR (scr_area_type = 1 AND scr_area_id IN (:gp555)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp554":"908",":gp555":"31",":gp556":"908",":gp557":"105",":gp558":"1","scv_id":"112"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1217.346] [M: 28495.91] [ET: 0.596/1183.084] [MU: 0.9/28495.66] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1218.792] [M: 28508.26] [ET: 0.496/1184.546] [MU: 2.97/28507.82] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1219.546] [M: 28537.43] [ET: 0.632/1185.299] [MU: 22.53/28536.68] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp561)) OR (apr_area_type = 5 AND apr_area_id IN (:gp559)) OR (apr_area_type = 2 AND apr_area_id IN (:gp562)) OR (apr_area_type = 4 AND apr_area_id IN (:gp563)) OR (apr_area_type = 1 AND apr_area_id IN (:gp560))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp559":"908",":gp560":"31",":gp561":"30804",":gp562":"105",":gp563":"1","cab":"112"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1221.333] [M: 28524.45] [ET: 0.505/1187.087] [MU: 3.34/28524.02] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1224.736] [M: 28535] [ET: 3.168/1190.48] [MU: 3.53/28534.13] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp566)) OR (scr_area_type = 5 AND scr_area_id IN (:gp564)) OR (scr_area_type = 2 AND scr_area_id IN (:gp567)) OR (scr_area_type = 4 AND scr_area_id IN (:gp568)) OR (scr_area_type = 1 AND scr_area_id IN (:gp565)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp564":"908",":gp565":"31",":gp566":"908",":gp567":"105",":gp568":"1","scv_id":"112"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1225.737] [M: 28539.74] [ET: 0.638/1191.475] [MU: 3.84/28538.87] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1226.353] [M: 28547.55] [ET: 0.488/1192.104] [MU: 4.21/28546.68] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1226.722] [M: 28555.82] [ET: 0.292/1192.485] [MU: 7.1/28555.71] 
	BookingRoute::calculateDistance
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1227.447] [M: 28558.6] [ET: 0.521/1193.203] [MU: 2.66/28558.23] 
	SQL: SELECT *
				FROM   partner_rate prt 
				JOIN route rut ON prt.prt_route_id = rut.rut_id AND rut.rut_active = 1
				AND  rut.rut_from_city_id  = 30804 
				AND  rut.rut_to_city_id  = 30726 
				 WHERE prt_vehicletype_id = 112
				AND prt_partner_id = 1249
				AND prt_status = 1
				 
	 [params: []]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1228.181] [M: 28564.58] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30726","cabType":"3","tripDistance":"375","tripDuration":"420","multiCityData":"[{\"pickup_city\":\"30804\",\"drop_city\":\"30726\",\"pickup_address\":\"\",\"drop_address\":null,\"date\":\"2024-10-24 18:00:00\",\"distance\":\"375\",\"duration\":\"420\"}]","bookingType":"1","pickupAddress":"","dropupAddress":"","routeDataArr":[{"locLatVal":"","locLonVal":"","brtLocationVal":""},{"locLatVal":"","locLonVal":"","brtLocationVal":""}],"pickupDate":"24\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30726&cabType=3&tripDistance=375&tripDuration=420&multiCityData=%5B%7B%22pickup_city%22%3A%2230804%22%2C%22drop_city%22%3A%2230726%22%2C%22pickup_address%22%3A%22%22%2C%22drop_address%22%3Anull%2C%22date%22%3A%222024-10-24+18%3A00%3A00%22%2C%22distance%22%3A%22375%22%2C%22duration%22%3A%22420%22%7D%5D&bookingType=1&pickupAddress=&dropupAddress=&routeDataArr%5B0%5D%5BlocLatVal%5D=&routeDataArr%5B0%5D%5BlocLonVal%5D=&routeDataArr%5B0%5D%5BbrtLocationVal%5D=&routeDataArr%5B1%5D%5BlocLatVal%5D=&routeDataArr%5B1%5D%5BlocLonVal%5D=&routeDataArr%5B1%5D%5BbrtLocationVal%5D=&pickupDate=24%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1228.748] [M: 28583.67] [ET: 1.044/1194.513] [MU: 21.05/28583.56] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1228.78] [M: 28585.35] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1230.176] [M: 28598.81] [ET: 1.23/1195.896] [MU: 3/28596.31] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+5845),(IF((cpm_value_type=2),(5845+(5845*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30726 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30726) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-24 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=112 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1232.218] [M: 28641.04] [ET: 4.571/1197.976] [MU: 78.88/28640.88] 
	RouteRates::calculate for CAB 112 2024-10-24 18:00:00 - Trip Type: 1 997023105
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1232.448] [M: 28620.66] [ET: 32.223/1198.215] [MU: 216.33/28620.5] 
	Quote::calculateOneWay  for CAB 112 Date: 2024-10-24 18:00:00
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1232.76] [M: 28616.29] [ET: 0.232/1198.515] [MU: 0.9/28616.04] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"112"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1232.834] [M: 28618.48] [ET: 39.99/1198.602] [MU: 261.59/28618.38] 
	Quote For CabType: 112
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1234.015] [M: 28628.82] [ET: 0.462/1199.749] [MU: 3.34/28628.38] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1234.633] [M: 28634.64] [ET: 0.506/1200.376] [MU: 3.35/28634.2] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1235.228] [M: 28637.58] [ET: 0.498/1200.988] [MU: 0.9/28637.33] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1235.98] [M: 28669.93] [ET: 0.625/1201.718] [MU: 24.22/28668.43] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (101) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30726) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp569)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp572,:gp573)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp570,:gp571)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp574,:gp575))
			OR (scr_area_type = 5 AND scr_area_id IN (908))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (113)
		ORDER BY rank DESC
		 
	 [params: {":gp569":"31",":gp570":"30804",":gp571":"30726",":gp572":"105",":gp573":"101",":gp574":"1",":gp575":"1","tripType":"1"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1236.846] [M: 28650.12] [ET: 0.29/1202.607] [MU: 0.83/28649.93] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1237.29] [M: 28652.96] [ET: 0.353/1203.047] [MU: 0.93/28652.65] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"6"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1239.474] [M: 28665.8] [ET: 0.792/1205.213] [MU: 2.05/28665.3] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"113"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1240.563] [M: 28675.43] [ET: 0.669/1206.316] [MU: 3.78/28674.55] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"113","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1242.606] [M: 28692.06] [ET: 0.594/1208.345] [MU: 3.78/28691.19] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"73","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1244.567] [M: 28710.46] [ET: 0.549/1210.303] [MU: 5.56/28709.59] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1245.371] [M: 28717.73] [ET: 0.494/1211.127] [MU: 0.9/28717.48] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1246.6] [M: 28728.32] [ET: 0.555/1212.34] [MU: 3.34/28727.88] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1249.159] [M: 28738.87] [ET: 2.38/1214.887] [MU: 3.53/28737.99] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp578)) OR (scr_area_type = 5 AND scr_area_id IN (:gp576)) OR (scr_area_type = 2 AND scr_area_id IN (:gp579)) OR (scr_area_type = 4 AND scr_area_id IN (:gp580)) OR (scr_area_type = 1 AND scr_area_id IN (:gp577)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp576":"908",":gp577":"31",":gp578":"908",":gp579":"105",":gp580":"1","scv_id":"73"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1250.191] [M: 28739.41] [ET: 0.565/1215.946] [MU: 0.9/28739.2] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1251.507] [M: 28749.67] [ET: 0.562/1217.238] [MU: 2.97/28749.23] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1254.017] [M: 28760.22] [ET: 2.352/1219.74] [MU: 3.53/28759.34] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp583)) OR (scr_area_type = 5 AND scr_area_id IN (:gp581)) OR (scr_area_type = 2 AND scr_area_id IN (:gp584)) OR (scr_area_type = 4 AND scr_area_id IN (:gp585)) OR (scr_area_type = 1 AND scr_area_id IN (:gp582)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp581":"908",":gp582":"31",":gp583":"908",":gp584":"105",":gp585":"1","scv_id":"113"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1255.352] [M: 28758.8] [ET: 0.872/1221.088] [MU: 0.9/28758.55] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1256.908] [M: 28771.15] [ET: 0.552/1222.646] [MU: 2.97/28770.71] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1257.698] [M: 28800.32] [ET: 0.618/1223.447] [MU: 22.53/28799.57] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp588)) OR (apr_area_type = 5 AND apr_area_id IN (:gp586)) OR (apr_area_type = 2 AND apr_area_id IN (:gp589)) OR (apr_area_type = 4 AND apr_area_id IN (:gp590)) OR (apr_area_type = 1 AND apr_area_id IN (:gp587))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp586":"908",":gp587":"31",":gp588":"30804",":gp589":"105",":gp590":"1","cab":"113"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1259.485] [M: 28787.34] [ET: 0.487/1225.244] [MU: 3.34/28786.91] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1262.014] [M: 28797.89] [ET: 2.409/1227.763] [MU: 3.53/28797.02] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp593)) OR (scr_area_type = 5 AND scr_area_id IN (:gp591)) OR (scr_area_type = 2 AND scr_area_id IN (:gp594)) OR (scr_area_type = 4 AND scr_area_id IN (:gp595)) OR (scr_area_type = 1 AND scr_area_id IN (:gp592)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp591":"908",":gp592":"31",":gp593":"908",":gp594":"105",":gp595":"1","scv_id":"113"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1263.092] [M: 28802.63] [ET: 0.632/1228.83] [MU: 3.84/28801.76] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1263.707] [M: 28810.45] [ET: 0.495/1229.467] [MU: 4.21/28809.57] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1264.007] [M: 28818.71] [ET: 0.232/1229.773] [MU: 7.1/28818.6] 
	BookingRoute::calculateDistance
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1264.61] [M: 28821.49] [ET: 0.446/1230.372] [MU: 2.66/28821.12] 
	SQL: SELECT *
				FROM   partner_rate prt 
				JOIN route rut ON prt.prt_route_id = rut.rut_id AND rut.rut_active = 1
				AND  rut.rut_from_city_id  = 30804 
				AND  rut.rut_to_city_id  = 30726 
				 WHERE prt_vehicletype_id = 113
				AND prt_partner_id = 1249
				AND prt_status = 1
				 
	 [params: []]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1265.295] [M: 28827.47] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30726","cabType":"3","tripDistance":"375","tripDuration":"420","multiCityData":"[{\"pickup_city\":\"30804\",\"drop_city\":\"30726\",\"pickup_address\":\"\",\"drop_address\":null,\"date\":\"2024-10-24 18:00:00\",\"distance\":\"375\",\"duration\":\"420\"}]","bookingType":"1","pickupAddress":"","dropupAddress":"","routeDataArr":[{"locLatVal":"","locLonVal":"","brtLocationVal":""},{"locLatVal":"","locLonVal":"","brtLocationVal":""}],"pickupDate":"24\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30726&cabType=3&tripDistance=375&tripDuration=420&multiCityData=%5B%7B%22pickup_city%22%3A%2230804%22%2C%22drop_city%22%3A%2230726%22%2C%22pickup_address%22%3A%22%22%2C%22drop_address%22%3Anull%2C%22date%22%3A%222024-10-24+18%3A00%3A00%22%2C%22distance%22%3A%22375%22%2C%22duration%22%3A%22420%22%7D%5D&bookingType=1&pickupAddress=&dropupAddress=&routeDataArr%5B0%5D%5BlocLatVal%5D=&routeDataArr%5B0%5D%5BlocLonVal%5D=&routeDataArr%5B0%5D%5BbrtLocationVal%5D=&routeDataArr%5B1%5D%5BlocLatVal%5D=&routeDataArr%5B1%5D%5BlocLonVal%5D=&routeDataArr%5B1%5D%5BbrtLocationVal%5D=&pickupDate=24%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1265.78] [M: 28846.56] [ET: 0.933/1231.534] [MU: 21.05/28846.45] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1265.818] [M: 28848.24] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1267.16] [M: 28861.7] [ET: 1.168/1232.883] [MU: 3/28859.2] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+5845),(IF((cpm_value_type=2),(5845+(5845*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30726 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30726) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-24 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=113 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1269.163] [M: 28903.93] [ET: 4.392/1234.917] [MU: 78.88/28903.77] 
	RouteRates::calculate for CAB 113 2024-10-24 18:00:00 - Trip Type: 1 703798938
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1269.411] [M: 28883.55] [ET: 29.724/1235.177] [MU: 216.32/28883.39] 
	Quote::calculateOneWay  for CAB 113 Date: 2024-10-24 18:00:00
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1269.789] [M: 28879.18] [ET: 0.3/1235.548] [MU: 0.9/28878.93] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"113"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1269.881] [M: 28881.37] [ET: 36.996/1235.648] [MU: 261.59/28881.27] 
	Quote For CabType: 113
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1271.179] [M: 28891.71] [ET: 0.474/1236.927] [MU: 3.34/28891.27] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1271.962] [M: 28897.53] [ET: 0.68/1237.694] [MU: 3.35/28897.09] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1273.167] [M: 28900.47] [ET: 1.032/1238.918] [MU: 0.9/28900.22] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1274.165] [M: 28932.82] [ET: 0.827/1239.901] [MU: 24.22/28931.32] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (101) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30726) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp596)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp599,:gp600)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp597,:gp598)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp601,:gp602))
			OR (scr_area_type = 5 AND scr_area_id IN (908))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (114)
		ORDER BY rank DESC
		 
	 [params: {":gp596":"31",":gp597":"30804",":gp598":"30726",":gp599":"105",":gp600":"101",":gp601":"1",":gp602":"1","tripType":"1"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1275.146] [M: 28913.01] [ET: 0.337/1240.891] [MU: 0.83/28912.82] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1275.702] [M: 28915.85] [ET: 0.448/1241.441] [MU: 0.93/28915.54] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"6"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1277.427] [M: 28928.69] [ET: 0.528/1243.177] [MU: 2.05/28928.19] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"114"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1278.275] [M: 28938.32] [ET: 0.591/1244.027] [MU: 3.78/28937.45] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"114","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1280.114] [M: 28954.95] [ET: 0.497/1245.863] [MU: 3.78/28954.08] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"73","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1281.999] [M: 28973.35] [ET: 0.552/1247.749] [MU: 5.56/28972.48] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1282.909] [M: 28980.59] [ET: 0.597/1248.64] [MU: 0.9/28980.37] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1284.393] [M: 28991.21] [ET: 0.642/1250.132] [MU: 3.34/28990.77] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1289.477] [M: 29001.76] [ET: 4.863/1255.152] [MU: 3.54/29000.88] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp605)) OR (scr_area_type = 5 AND scr_area_id IN (:gp603)) OR (scr_area_type = 2 AND scr_area_id IN (:gp606)) OR (scr_area_type = 4 AND scr_area_id IN (:gp607)) OR (scr_area_type = 1 AND scr_area_id IN (:gp604)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp603":"908",":gp604":"31",":gp605":"908",":gp606":"105",":gp607":"1","scv_id":"73"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1290.716] [M: 29002.34] [ET: 0.679/1256.448] [MU: 0.9/29002.09] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1292.149] [M: 29012.56] [ET: 0.547/1257.905] [MU: 2.97/29012.13] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1294.656] [M: 29023.11] [ET: 2.352/1260.373] [MU: 3.53/29022.23] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp610)) OR (scr_area_type = 5 AND scr_area_id IN (:gp608)) OR (scr_area_type = 2 AND scr_area_id IN (:gp611)) OR (scr_area_type = 4 AND scr_area_id IN (:gp612)) OR (scr_area_type = 1 AND scr_area_id IN (:gp609)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp608":"908",":gp609":"31",":gp610":"908",":gp611":"105",":gp612":"1","scv_id":"114"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1295.781] [M: 29021.7] [ET: 0.657/1261.526] [MU: 0.9/29021.45] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1297.034] [M: 29034.04] [ET: 0.455/1262.788] [MU: 2.96/29033.6] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1297.786] [M: 29063.21] [ET: 0.636/1263.541] [MU: 22.53/29062.46] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp615)) OR (apr_area_type = 5 AND apr_area_id IN (:gp613)) OR (apr_area_type = 2 AND apr_area_id IN (:gp616)) OR (apr_area_type = 4 AND apr_area_id IN (:gp617)) OR (apr_area_type = 1 AND apr_area_id IN (:gp614))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp613":"908",":gp614":"31",":gp615":"30804",":gp616":"105",":gp617":"1","cab":"114"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1299.621] [M: 29050.23] [ET: 0.506/1265.366] [MU: 3.34/29049.8] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1302.003] [M: 29060.78] [ET: 2.242/1267.749] [MU: 3.53/29059.91] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp620)) OR (scr_area_type = 5 AND scr_area_id IN (:gp618)) OR (scr_area_type = 2 AND scr_area_id IN (:gp621)) OR (scr_area_type = 4 AND scr_area_id IN (:gp622)) OR (scr_area_type = 1 AND scr_area_id IN (:gp619)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp618":"908",":gp619":"31",":gp620":"908",":gp621":"105",":gp622":"1","scv_id":"114"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1302.98] [M: 29065.52] [ET: 0.585/1268.729] [MU: 3.84/29064.65] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30804"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1303.637] [M: 29073.34] [ET: 0.541/1269.372] [MU: 4.21/29072.46] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30726"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1304.142] [M: 29081.6] [ET: 0.381/1269.886] [MU: 7.1/29081.49] 
	BookingRoute::calculateDistance
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1305.307] [M: 29084.38] [ET: 0.871/1271.045] [MU: 2.66/29084.01] 
	SQL: SELECT *
				FROM   partner_rate prt 
				JOIN route rut ON prt.prt_route_id = rut.rut_id AND rut.rut_active = 1
				AND  rut.rut_from_city_id  = 30804 
				AND  rut.rut_to_city_id  = 30726 
				 WHERE prt_vehicletype_id = 114
				AND prt_partner_id = 1249
				AND prt_status = 1
				 
	 [params: []]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1306.352] [M: 29090.36] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30726","cabType":"3","tripDistance":"375","tripDuration":"420","multiCityData":"[{\"pickup_city\":\"30804\",\"drop_city\":\"30726\",\"pickup_address\":\"\",\"drop_address\":null,\"date\":\"2024-10-24 18:00:00\",\"distance\":\"375\",\"duration\":\"420\"}]","bookingType":"1","pickupAddress":"","dropupAddress":"","routeDataArr":[{"locLatVal":"","locLonVal":"","brtLocationVal":""},{"locLatVal":"","locLonVal":"","brtLocationVal":""}],"pickupDate":"24\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30726&cabType=3&tripDistance=375&tripDuration=420&multiCityData=%5B%7B%22pickup_city%22%3A%2230804%22%2C%22drop_city%22%3A%2230726%22%2C%22pickup_address%22%3A%22%22%2C%22drop_address%22%3Anull%2C%22date%22%3A%222024-10-24+18%3A00%3A00%22%2C%22distance%22%3A%22375%22%2C%22duration%22%3A%22420%22%7D%5D&bookingType=1&pickupAddress=&dropupAddress=&routeDataArr%5B0%5D%5BlocLatVal%5D=&routeDataArr%5B0%5D%5BlocLonVal%5D=&routeDataArr%5B0%5D%5BbrtLocationVal%5D=&routeDataArr%5B1%5D%5BlocLatVal%5D=&routeDataArr%5B1%5D%5BlocLonVal%5D=&routeDataArr%5B1%5D%5BbrtLocationVal%5D=&pickupDate=24%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1307.167] [M: 29109.45] [ET: 1.466/1272.909] [MU: 21.05/29109.34] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1307.23] [M: 29111.13] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1308.931] [M: 29124.59] [ET: 1.459/1274.647] [MU: 3/29122.09] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+5845),(IF((cpm_value_type=2),(5845+(5845*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30726 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30726) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-24 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=114 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1311.48] [M: 29166.82] [ET: 5.892/1277.24] [MU: 78.88/29166.66] 
	RouteRates::calculate for CAB 114 2024-10-24 18:00:00 - Trip Type: 1 580751243
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1311.705] [M: 29146.44] [ET: 34.192/1277.472] [MU: 216.32/29146.28] 
	Quote::calculateOneWay  for CAB 114 Date: 2024-10-24 18:00:00
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1311.997] [M: 29142.07] [ET: 0.222/1277.761] [MU: 0.9/29141.82] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"114"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1312.069] [M: 29144.26] [ET: 42.139/1277.837] [MU: 261.59/29144.16] 
	Quote For CabType: 114
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1313.762] [M: 29187.03] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.QuotesDataCreated.setData START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30726","cabType":"3","tripDistance":"375","tripDuration":"420","multiCityData":"[{\"pickup_city\":\"30804\",\"drop_city\":\"30726\",\"pickup_address\":\"\",\"drop_address\":null,\"date\":\"2024-10-24 18:00:00\",\"distance\":\"375\",\"duration\":\"420\"}]","bookingType":"1","pickupAddress":"","dropupAddress":"","routeDataArr":[{"locLatVal":"","locLonVal":"","brtLocationVal":""},{"locLatVal":"","locLonVal":"","brtLocationVal":""}],"pickupDate":"24\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30726&cabType=3&tripDistance=375&tripDuration=420&multiCityData=%5B%7B%22pickup_city%22%3A%2230804%22%2C%22drop_city%22%3A%2230726%22%2C%22pickup_address%22%3A%22%22%2C%22drop_address%22%3Anull%2C%22date%22%3A%222024-10-24+18%3A00%3A00%22%2C%22distance%22%3A%22375%22%2C%22duration%22%3A%22420%22%7D%5D&bookingType=1&pickupAddress=&dropupAddress=&routeDataArr%5B0%5D%5BlocLatVal%5D=&routeDataArr%5B0%5D%5BlocLonVal%5D=&routeDataArr%5B0%5D%5BbrtLocationVal%5D=&routeDataArr%5B1%5D%5BlocLatVal%5D=&routeDataArr%5B1%5D%5BlocLonVal%5D=&routeDataArr%5B1%5D%5BbrtLocationVal%5D=&pickupDate=24%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1344.465] [M: 29271.89] [ET: 15.224/1310.199] [MU: 15.61/29271.78] 
	QuotesDataPickup::setData for CAB Array
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1344.609] [M: 29267.47] [ET: 31.43/1310.356] [MU: 82.39/29267.36] 
	models.QuotesDataCreated.setData
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1344.674] [M: 29269.15] 
============================================================Profile models.QuotesDataCreated.setData DONE==================================================
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1344.839] [M: 29265.55] [ET: 996.272/1310.584] [MU: 10443.78/29265.45] 
	models.Quote.getQuote
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1345.036] [M: 29269.04] 
============================================================Profile models.Quote.getQuote DONE==================================================
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1404.144] [M: 29952.22] [ET: 4.144/1369.874] [MU: 2.47/29951.84] 
	SQL: SELECT dzs_zone_type FROM dynamic_zone_surge WHERE dzs_fromzoneid IN (:gp623) AND dzs_tozoneid IN (:gp624,:gp625,:gp626) AND dzs_scv_id=:cab AND dzs_booking_type=:tripType  ORDER BY  dzs_zone_type ASC 
	 [params: {":gp624":"385",":gp625":"852",":gp626":"980",":gp623":"31","cab":3,"tripType":"1"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1411.598] [M: 29955.08] [ET: 6.691/1377.325] [MU: 1.25/29954.45] 
	SQL: SELECT prc_cancel_rule_id FROM `partner_cancel_rule` 
			WHERE (prc_zone_category = :zoneType OR prc_zone_category IS NULL)
		AND (prc_scc_id = :sccId OR prc_scc_id IS NULL)
		AND (prc_partner_id = :partnerId OR prc_partner_id IS NULL) 
		AND (prc_bkg_type = :tripType OR prc_bkg_type IS NULL) 
		 AND (prc_is_gozonow IS NULL) 
		AND prc_active=1  
		ORDER BY prc_partner_id DESC, prc_bkg_type DESC  
	 [params: {"zoneType":1,"sccId":"1","partnerId":null,"tripType":"1"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1420.318] [M: 30031.47] [ET: 5.224/1386.03] [MU: 1.42/30031.28] 
	SQL: SELECT acp_cr_to,acp_margin_data FROM `addon_cancellation_policy` WHERE `acp_id` = :id 
	 [params: {"id":"8"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1442.809] [M: 30070.78] [ET: 0.445/1408.549] [MU: 1.43/30070.59] 
	SQL: SELECT acp_cr_to,acp_margin_data FROM `addon_cancellation_policy` WHERE `acp_id` = :id 
	 [params: {"id":"9"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1451.128] [M: 30149.42] [ET: 5.107/1416.862] [MU: 1.35/30149.23] 
	SQL: SELECT acm_svc_id_to,acm_margin_data FROM `addon_cab_models` WHERE `acm_id` = :id 
	 [params: {"id":"1"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1452.095] [M: 30153.23] [ET: 0.283/1417.837] [MU: 1.34/30153.05] 
	SQL: SELECT acm_svc_id_to,acm_margin_data FROM `addon_cab_models` WHERE `acm_id` = :id 
	 [params: {"id":"2"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1453.033] [M: 30156.67] [ET: 0.354/1418.776] [MU: 1.35/30156.48] 
	SQL: SELECT acm_svc_id_to,acm_margin_data FROM `addon_cab_models` WHERE `acm_id` = :id 
	 [params: {"id":"3"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1453.967] [M: 30160.11] [ET: 0.284/1419.71] [MU: 1.34/30159.92] 
	SQL: SELECT acm_svc_id_to,acm_margin_data FROM `addon_cab_models` WHERE `acm_id` = :id 
	 [params: {"id":"4"}]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1473.439] [M: 30495.18] [ET: 13.366/1439.168] [MU: 48.58/30493.93] 
	SQL:  SELECT scv_id,scc_id, vct_id, scc_cancel_rule, scc_label,scc_rank, scv_label, scv_code, scc_model_year, 
								CONCAT(vct_label, ' (', scc_label , ')') label,
									vct_label,vct_rank, vct_desc, CONCAT(vct_label, ' ', vct_desc) vhcName, 
									vct_capacity, IF(vct_image IS NULL, 'images/cabs/no-image.png', vct_image) as vct_image, vct_big_bag_capacity, vct_small_bag_capacity, vcsc_small_bag, FLOOR(vcsc_small_bag/2) AS big_bag,
									scc_is_cng, scc_is_petrol_diesel, scc_id, scc_desc, IF( vct_id IN(5, 6), '1', '0' ) AS is_assured, scv_vct_id,scv_parent_id,scv_vct_id,scv_model,scv_scc_id
						FROM svc_class_vhc_cat
						INNER JOIN service_class ON scc_id = scv_scc_id
						INNER JOIN vehicle_category ON vct_id = scv_vct_id
						INNER JOIN vehicle_cat_svc_class on vcsc_ssc_id = scv_scc_id AND vcsc_vct_id = scv_vct_id
						WHERE scv_active = 1 
							AND scc_active = 1 
						AND vct_active = 1
		 AND scv_vct_id = 3 
	 [params: []]
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1483.518] [M: 30438.05] [ET: 1372.612/1449.254] [MU: 20380.33/30437.93] 
	module.admin.controller.booking.getamountbyvehicle
2024/10/17 14:04:59 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1483.581] [M: 30438.7] 
*******************************************************module.admin.controller.booking.getamountbyvehicle ACTION DONE****************************************************************
