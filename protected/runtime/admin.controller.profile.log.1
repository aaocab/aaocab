2024/10/17 14:07:01 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 91.645] [M: 10054.59] 
------------------------------------------------------module.admin.controller.booking.getamountbyvehicle ACTION START------------------------------------------------------
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30726","cabType":"3","tripDistance":"375","tripDuration":"420","multiCityData":"[{\"pickup_city\":\"30804\",\"drop_city\":\"30726\",\"pickup_address\":\"\",\"drop_address\":null,\"date\":\"2024-10-24 18:00:00\",\"distance\":\"375\",\"duration\":\"420\"}]","bookingType":"1","pickupAddress":"","dropupAddress":"","routeDataArr":[{"locLatVal":"","locLonVal":"","brtLocationVal":""},{"locLatVal":"","locLonVal":"","brtLocationVal":""}],"pickupDate":"24\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","sccId":"1","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30726&cabType=3&tripDistance=375&tripDuration=420&multiCityData=%5B%7B%22pickup_city%22%3A%2230804%22%2C%22drop_city%22%3A%2230726%22%2C%22pickup_address%22%3A%22%22%2C%22drop_address%22%3Anull%2C%22date%22%3A%222024-10-24+18%3A00%3A00%22%2C%22distance%22%3A%22375%22%2C%22duration%22%3A%22420%22%7D%5D&bookingType=1&pickupAddress=&dropupAddress=&routeDataArr%5B0%5D%5BlocLatVal%5D=&routeDataArr%5B0%5D%5BlocLonVal%5D=&routeDataArr%5B0%5D%5BbrtLocationVal%5D=&routeDataArr%5B1%5D%5BlocLatVal%5D=&routeDataArr%5B1%5D%5BlocLonVal%5D=&routeDataArr%5B1%5D%5BbrtLocationVal%5D=&pickupDate=24%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&sccId=1&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 14:07:01 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 125.734] [M: 11290.8] setLocationRequest start
2024/10/17 14:07:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 217.303] [M: 11291.3] setLocationRequest ends
2024/10/17 14:07:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 328.056] [M: 18116.69] [ET: 0.328/301.924] [MU: 0.83/18116.5] 
	SQL: SELECT COUNT(1) as cnt FROM cities WHERE cty_active=1 AND cty_service_active=1 AND cty_id=30804 
	 [params: []]
2024/10/17 14:07:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 328.378] [M: 18117.98] [ET: 0.253/302.252] [MU: 0.84/18117.8] 
	SQL: SELECT COUNT(1) as cnt FROM cities WHERE cty_active=1 AND cty_service_active=1 AND cty_id=30726 
	 [params: []]
2024/10/17 14:07:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 346.145] [M: 18604.87] [ET: 17.707/320.012] [MU: 486.78/18604.76] 
	BookingRoute::calculateDistance
2024/10/17 14:07:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 346.575] [M: 18602.28] [ET: 0.212/320.45] [MU: 5.11/18602.17] 
	BookingRoute::calculateDistance
2024/10/17 14:07:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 346.631] [M: 18598.33] [ET: 65.07/320.507] [MU: 5974.34/18598.23] 
	validateRoutes
2024/10/17 14:07:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 349.639] [M: 18831.45] [ET: 0.824/323.488] [MU: 27.08/18831.23] 
	SQL: SELECT scv_id FROM svc_class_vhc_cat WHERE scv_active = 1 AND scv_scc_id IN (1,2,4,6) ORDER BY scv_vct_id ASC,scv_scc_id ASC 
	 [params: []]
2024/10/17 14:07:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 351.296] [M: 18819.77] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.Quote.getQuote START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30726","cabType":"3","tripDistance":"375","tripDuration":"420","multiCityData":"[{\"pickup_city\":\"30804\",\"drop_city\":\"30726\",\"pickup_address\":\"\",\"drop_address\":null,\"date\":\"2024-10-24 18:00:00\",\"distance\":\"375\",\"duration\":\"420\"}]","bookingType":"1","pickupAddress":"","dropupAddress":"","routeDataArr":[{"locLatVal":"","locLonVal":"","brtLocationVal":""},{"locLatVal":"","locLonVal":"","brtLocationVal":""}],"pickupDate":"24\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","sccId":"1","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30726&cabType=3&tripDistance=375&tripDuration=420&multiCityData=%5B%7B%22pickup_city%22%3A%2230804%22%2C%22drop_city%22%3A%2230726%22%2C%22pickup_address%22%3A%22%22%2C%22drop_address%22%3Anull%2C%22date%22%3A%222024-10-24+18%3A00%3A00%22%2C%22distance%22%3A%22375%22%2C%22duration%22%3A%22420%22%7D%5D&bookingType=1&pickupAddress=&dropupAddress=&routeDataArr%5B0%5D%5BlocLatVal%5D=&routeDataArr%5B0%5D%5BlocLonVal%5D=&routeDataArr%5B0%5D%5BbrtLocationVal%5D=&routeDataArr%5B1%5D%5BlocLatVal%5D=&routeDataArr%5B1%5D%5BlocLonVal%5D=&routeDataArr%5B1%5D%5BbrtLocationVal%5D=&pickupDate=24%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&sccId=1&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 14:07:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 355.018] [M: 18938.88] [ET: 0.712/328.862] [MU: 8.84/18938.45] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:07:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 355.737] [M: 18943.84] [ET: 0.61/329.59] [MU: 3.34/18943.4] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30726"}]
2024/10/17 14:07:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 356.337] [M: 18945.88] [ET: 0.51/330.205] [MU: 0.9/18945.66] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:07:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 357.37] [M: 18997.03] [ET: 0.91/331.217] [MU: 43.61/18995.53] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (101) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30726) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp0)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp3,:gp4)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp1,:gp2)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp5,:gp6))
			OR (scr_area_type = 5 AND scr_area_id IN (908))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (3)
		ORDER BY rank DESC
		 
	 [params: {":gp0":"31",":gp1":"30804",":gp2":"30726",":gp3":"105",":gp4":"101",":gp5":"1",":gp6":"1","tripType":"1"}]
2024/10/17 14:07:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 358.573] [M: 18988.15] [ET: 0.444/332.429] [MU: 3.33/18987.71] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:07:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 359.088] [M: 18993.1] [ET: 0.416/332.946] [MU: 3.35/18992.66] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30726"}]
2024/10/17 14:07:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 359.71] [M: 18995.14] [ET: 0.539/333.58] [MU: 0.89/18994.92] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:07:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 360.246] [M: 19026.91] [ET: 0.431/334.113] [MU: 24.22/19025.41] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (101) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30726) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp7)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp10,:gp11)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp8,:gp9)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp12,:gp13))
			OR (scr_area_type = 5 AND scr_area_id IN (908))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (3)
		ORDER BY rank DESC
		 
	 [params: {":gp7":"31",":gp8":"30804",":gp9":"30726",":gp10":"105",":gp11":"101",":gp12":"1",":gp13":"1","tripType":"1"}]
2024/10/17 14:07:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 375.346] [M: 19077.27] [ET: 0.505/349.197] [MU: 0.84/19077.08] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 14:07:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 375.985] [M: 19079.55] [ET: 0.517/349.834] [MU: 0.96/19079.24] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"1"}]
2024/10/17 14:07:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 394.889] [M: 19532.09] [ET: 0.786/368.731] [MU: 5.84/19531.22] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30726"}]
2024/10/17 14:07:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 398.085] [M: 19699.05] [ET: 0.628/371.935] [MU: 0.9/19698.84] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30726"}]
2024/10/17 14:07:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 401.45] [M: 19830.65] [ET: 0.503/375.319] [MU: 3.33/19830.21] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 14:07:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 402.204] [M: 19862.51] [ET: 0.631/376.05] [MU: 25.34/19861.76] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp16)) OR (apr_area_type = 5 AND apr_area_id IN (:gp14)) OR (apr_area_type = 2 AND apr_area_id IN (:gp17)) OR (apr_area_type = 4 AND apr_area_id IN (:gp18)) OR (apr_area_type = 1 AND apr_area_id IN (:gp15))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp14":"908",":gp15":"31",":gp16":"30804",":gp17":"105",":gp18":"1","cab":"3"}]
2024/10/17 14:07:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 427.302] [M: 21407.3] [ET: 0.664/401.168] [MU: 4.21/21406.43] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30804"}]
2024/10/17 14:07:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 441.999] [M: 21455.48] [ET: 0.769/415.864] [MU: 4.21/21454.61] 
	SQL: SELECT *
				FROM 
                   (
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, 0 AS distance
							FROM cities_stats
							WHERE     cities_stats.cts_cty_id = :city	AND cities_stats.cts_vnd_cnt >= 2

							UNION
							SELECT cities_stats.cts_cty_id AS vnd_city, cities_stats.cts_vnd_cnt AS cnt, IFNULL(rut_actual_distance, rut_estm_distance) AS distance
							FROM route
							INNER JOIN cities_stats  ON  cities_stats.cts_cty_id = route.rut_from_city_id AND cities_stats.cts_vnd_cnt >= 2 AND IFNULL(rut_actual_distance, rut_estm_distance) < 40
							WHERE rut_to_city_id = :city
							GROUP BY cities_stats.cts_cty_id   
                    ) a
				ORDER BY DISTANCE ASC 
	 [params: {":city":"30726"}]
2024/10/17 14:07:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 443.384] [M: 21477.06] [ET: 0.252/417.26] [MU: 7.13/21476.95] 
	BookingRoute::calculateDistance
2024/10/17 14:07:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 444.988] [M: 21514.8] [ET: 0.543/418.856] [MU: 2.65/21514.42] 
	SQL: SELECT *
				FROM   partner_rate prt 
				JOIN route rut ON prt.prt_route_id = rut.rut_id AND rut.rut_active = 1
				AND  rut.rut_from_city_id  = 30804 
				AND  rut.rut_to_city_id  = 30726 
				 WHERE prt_vehicletype_id = 3
				AND prt_partner_id = 1249
				AND prt_status = 1
				 
	 [params: []]
2024/10/17 14:07:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 445.652] [M: 21520.77] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30726","cabType":"3","tripDistance":"375","tripDuration":"420","multiCityData":"[{\"pickup_city\":\"30804\",\"drop_city\":\"30726\",\"pickup_address\":\"\",\"drop_address\":null,\"date\":\"2024-10-24 18:00:00\",\"distance\":\"375\",\"duration\":\"420\"}]","bookingType":"1","pickupAddress":"","dropupAddress":"","routeDataArr":[{"locLatVal":"","locLonVal":"","brtLocationVal":""},{"locLatVal":"","locLonVal":"","brtLocationVal":""}],"pickupDate":"24\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","sccId":"1","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30726&cabType=3&tripDistance=375&tripDuration=420&multiCityData=%5B%7B%22pickup_city%22%3A%2230804%22%2C%22drop_city%22%3A%2230726%22%2C%22pickup_address%22%3A%22%22%2C%22drop_address%22%3Anull%2C%22date%22%3A%222024-10-24+18%3A00%3A00%22%2C%22distance%22%3A%22375%22%2C%22duration%22%3A%22420%22%7D%5D&bookingType=1&pickupAddress=&dropupAddress=&routeDataArr%5B0%5D%5BlocLatVal%5D=&routeDataArr%5B0%5D%5BlocLonVal%5D=&routeDataArr%5B0%5D%5BbrtLocationVal%5D=&routeDataArr%5B1%5D%5BlocLatVal%5D=&routeDataArr%5B1%5D%5BlocLonVal%5D=&routeDataArr%5B1%5D%5BbrtLocationVal%5D=&pickupDate=24%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&sccId=1&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 14:07:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 446.07] [M: 21539.87] [ET: 0.839/419.948] [MU: 21.05/21539.76] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 14:07:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 446.102] [M: 21541.55] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 14:07:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 448.128] [M: 21624.51] [ET: 0.873/421.985] [MU: 3.19/21622.01] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+5845),(IF((cpm_value_type=2),(5845+(5845*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30726 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30726) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-24 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=3 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 14:07:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 479.025] [M: 22977.95] [ET: 33.843/452.893] [MU: 1459.59/22977.8] 
	RouteRates::calculate for CAB 3 2024-10-24 18:00:00 - Trip Type: 1 992751931
2024/10/17 14:07:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 479.247] [M: 22956.89] [ET: 85.419/453.124] [MU: 3435.07/22956.73] 
	Quote::calculateOneWay  for CAB 3 Date: 2024-10-24 18:00:00
2024/10/17 14:07:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 479.546] [M: 22952.68] [ET: 0.223/453.42] [MU: 0.9/22952.43] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"3"}]
2024/10/17 14:07:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 479.615] [M: 22953.28] [ET: 122.136/453.493] [MU: 3983.27/22953.19] 
	Quote For CabType: 3
2024/10/17 14:07:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 480.967] [M: 22995.56] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.QuotesDataCreated.setData START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30726","cabType":"3","tripDistance":"375","tripDuration":"420","multiCityData":"[{\"pickup_city\":\"30804\",\"drop_city\":\"30726\",\"pickup_address\":\"\",\"drop_address\":null,\"date\":\"2024-10-24 18:00:00\",\"distance\":\"375\",\"duration\":\"420\"}]","bookingType":"1","pickupAddress":"","dropupAddress":"","routeDataArr":[{"locLatVal":"","locLonVal":"","brtLocationVal":""},{"locLatVal":"","locLonVal":"","brtLocationVal":""}],"pickupDate":"24\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","sccId":"1","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30726&cabType=3&tripDistance=375&tripDuration=420&multiCityData=%5B%7B%22pickup_city%22%3A%2230804%22%2C%22drop_city%22%3A%2230726%22%2C%22pickup_address%22%3A%22%22%2C%22drop_address%22%3Anull%2C%22date%22%3A%222024-10-24+18%3A00%3A00%22%2C%22distance%22%3A%22375%22%2C%22duration%22%3A%22420%22%7D%5D&bookingType=1&pickupAddress=&dropupAddress=&routeDataArr%5B0%5D%5BlocLatVal%5D=&routeDataArr%5B0%5D%5BlocLonVal%5D=&routeDataArr%5B0%5D%5BbrtLocationVal%5D=&routeDataArr%5B1%5D%5BlocLatVal%5D=&routeDataArr%5B1%5D%5BlocLonVal%5D=&routeDataArr%5B1%5D%5BbrtLocationVal%5D=&pickupDate=24%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&sccId=1&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 14:07:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 613.464] [M: 23085.41] [ET: 112.111/587.305] [MU: 16.66/23085.3] 
	QuotesDataPickup::setData for CAB 3
2024/10/17 14:07:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 613.581] [M: 23080.91] [ET: 133.007/587.442] [MU: 87.3/23080.8] 
	models.QuotesDataCreated.setData
2024/10/17 14:07:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 613.625] [M: 23081.97] 
============================================================Profile models.QuotesDataCreated.setData DONE==================================================
2024/10/17 14:07:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 613.756] [M: 23078.23] [ET: 262.779/587.617] [MU: 4258.43/23078.13] 
	models.Quote.getQuote
2024/10/17 14:07:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 613.893] [M: 23080.42] 
============================================================Profile models.Quote.getQuote DONE==================================================
2024/10/17 14:07:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 624.047] [M: 23540.54] [ET: 0.72/597.912] [MU: 1.14/23540.1] 
	SQL: SELECT zones.zon_id
                    FROM cities c1
                    INNER JOIN zone_cities ON zone_cities.zct_cty_id = c1.cty_id AND zct_active=1
                    INNER JOIN zones ON zone_cities.zct_zon_id = zones.zon_id AND zon_active=1
                    WHERE c1.cty_id = 30804 ORDER BY zones.zon_id DESC LIMIT 0,1 
	 [params: []]
2024/10/17 14:07:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 624.577] [M: 23542.37] [ET: 0.439/598.41] [MU: 1.15/23541.93] 
	SQL: SELECT zones.zon_id
                    FROM cities c1
                    INNER JOIN zone_cities ON zone_cities.zct_cty_id = c1.cty_id AND zct_active=1
                    INNER JOIN zones ON zone_cities.zct_zon_id = zones.zon_id AND zon_active=1
                    WHERE c1.cty_id = 30726 ORDER BY zones.zon_id DESC LIMIT 0,1 
	 [params: []]
2024/10/17 14:07:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 627.335] [M: 23631.24] [ET: 0.564/601.194] [MU: 1.31/23631.02] 
	SQL: SELECT stt.stt_zone FROM cities cty INNER JOIN states stt ON stt.stt_id = cty.cty_state_id WHERE cty.cty_id = 30804 
	 [params: []]
2024/10/17 14:07:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 627.64] [M: 23632.8] [ET: 0.223/601.507] [MU: 0.97/23632.42] 
	SQL: SELECT CONCAT('7','',LPAD(:regionId,2,'0'),'',LPAD(:fromZone,5,'0'),'',LPAD(:toZone,5,'0'),'',LPAD(:scv_id,3,'0'),'',LPAD(:tripType,2,'0')) AS rowIdentifier FROM DUAL 
	 [params: {"regionId":"1","fromZone":"31","toZone":"980","scv_id":"3","tripType":"1"}]
2024/10/17 14:07:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 649.205] [M: 23691.48] [ET: 0.653/623.058] [MU: 1.15/23691.05] 
	SQL: SELECT zones.zon_id
                    FROM cities c1
                    INNER JOIN zone_cities ON zone_cities.zct_cty_id = c1.cty_id AND zct_active=1
                    INNER JOIN zones ON zone_cities.zct_zon_id = zones.zon_id AND zon_active=1
                    WHERE c1.cty_id = 30804 ORDER BY zones.zon_id DESC LIMIT 0,1 
	 [params: []]
2024/10/17 14:07:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 649.727] [M: 23692.84] [ET: 0.425/623.587] [MU: 1.31/23692.63] 
	SQL: SELECT stt.stt_zone FROM cities cty INNER JOIN states stt ON stt.stt_id = cty.cty_state_id WHERE cty.cty_id = 30804 
	 [params: []]
2024/10/17 14:07:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 650.108] [M: 23694.11] [ET: 0.28/623.957] [MU: 0.9/23693.86] 
	SQL: SELECT CONCAT('7','',LPAD(:regionId,2,'0'),'',LPAD(:fromZone,5,'0'),LPAD(:tripType,2,'0')) AS demandIdentifier FROM DUAL 
	 [params: {"regionId":"1","fromZone":"31","tripType":2}]
2024/10/17 14:07:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 679.14] [M: 23991.25] [ET: 2.184/653.002] [MU: 2.47/23990.88] 
	SQL: SELECT dzs_zone_type FROM dynamic_zone_surge WHERE dzs_fromzoneid IN (:gp19) AND dzs_tozoneid IN (:gp20,:gp21,:gp22) AND dzs_scv_id=:cab AND dzs_booking_type=:tripType  ORDER BY  dzs_zone_type ASC 
	 [params: {":gp20":"385",":gp21":"852",":gp22":"980",":gp19":"31","cab":"3","tripType":"1"}]
2024/10/17 14:07:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 680.015] [M: 23993.34] [ET: 0.373/653.88] [MU: 1.24/23992.72] 
	SQL: SELECT prc_cancel_rule_id FROM `partner_cancel_rule` 
			WHERE (prc_zone_category = :zoneType OR prc_zone_category IS NULL)
		AND (prc_scc_id = :sccId OR prc_scc_id IS NULL)
		AND (prc_partner_id = :partnerId OR prc_partner_id IS NULL) 
		AND (prc_bkg_type = :tripType OR prc_bkg_type IS NULL) 
		 AND (prc_is_gozonow IS NULL) 
		AND prc_active=1  
		ORDER BY prc_partner_id DESC, prc_bkg_type DESC  
	 [params: {"zoneType":1,"sccId":"1","partnerId":null,"tripType":"1"}]
2024/10/17 14:07:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 682.815] [M: 24068.74] [ET: 0.333/656.684] [MU: 1.42/24068.55] 
	SQL: SELECT acp_cr_to,acp_margin_data FROM `addon_cancellation_policy` WHERE `acp_id` = :id 
	 [params: {"id":"8"}]
2024/10/17 14:07:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 696.279] [M: 24107.47] [ET: 0.372/670.132] [MU: 1.42/24107.28] 
	SQL: SELECT acp_cr_to,acp_margin_data FROM `addon_cancellation_policy` WHERE `acp_id` = :id 
	 [params: {"id":"9"}]
2024/10/17 14:07:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 700.315] [M: 24185.52] [ET: 0.437/674.165] [MU: 1.35/24185.34] 
	SQL: SELECT acm_svc_id_to,acm_margin_data FROM `addon_cab_models` WHERE `acm_id` = :id 
	 [params: {"id":"1"}]
2024/10/17 14:07:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 701.281] [M: 24188.75] [ET: 0.331/675.149] [MU: 1.35/24188.56] 
	SQL: SELECT acm_svc_id_to,acm_margin_data FROM `addon_cab_models` WHERE `acm_id` = :id 
	 [params: {"id":"2"}]
2024/10/17 14:07:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 702.352] [M: 24191.6] [ET: 0.478/676.207] [MU: 1.35/24191.41] 
	SQL: SELECT acm_svc_id_to,acm_margin_data FROM `addon_cab_models` WHERE `acm_id` = :id 
	 [params: {"id":"3"}]
2024/10/17 14:07:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 703.246] [M: 24194.45] [ET: 0.272/677.096] [MU: 1.35/24194.27] 
	SQL: SELECT acm_svc_id_to,acm_margin_data FROM `addon_cab_models` WHERE `acm_id` = :id 
	 [params: {"id":"4"}]
2024/10/17 14:07:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 709.361] [M: 24592.94] [ET: 0.886/683.206] [MU: 48.58/24591.69] 
	SQL:  SELECT scv_id,scc_id, vct_id, scc_cancel_rule, scc_label,scc_rank, scv_label, scv_code, scc_model_year, 
								CONCAT(vct_label, ' (', scc_label , ')') label,
									vct_label,vct_rank, vct_desc, CONCAT(vct_label, ' ', vct_desc) vhcName, 
									vct_capacity, IF(vct_image IS NULL, 'images/cabs/no-image.png', vct_image) as vct_image, vct_big_bag_capacity, vct_small_bag_capacity, vcsc_small_bag, FLOOR(vcsc_small_bag/2) AS big_bag,
									scc_is_cng, scc_is_petrol_diesel, scc_id, scc_desc, IF( vct_id IN(5, 6), '1', '0' ) AS is_assured, scv_vct_id,scv_parent_id,scv_vct_id,scv_model,scv_scc_id
						FROM svc_class_vhc_cat
						INNER JOIN service_class ON scc_id = scv_scc_id
						INNER JOIN vehicle_category ON vct_id = scv_vct_id
						INNER JOIN vehicle_cat_svc_class on vcsc_ssc_id = scv_scc_id AND vcsc_vct_id = scv_vct_id
						WHERE scv_active = 1 
							AND scc_active = 1 
						AND vct_active = 1
		 AND scv_vct_id = 3 
	 [params: []]
2024/10/17 14:07:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 715.441] [M: 24534.54] [ET: 623.733/689.312] [MU: 14476.72/24534.41] 
	module.admin.controller.booking.getamountbyvehicle
2024/10/17 14:07:02 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 715.47] [M: 24534.66] 
*******************************************************module.admin.controller.booking.getamountbyvehicle ACTION DONE****************************************************************
2024/10/17 14:07:44 [profile] [profile.module.admin.controller.booking.create] [T: 111.439] [M: 10083.73] 
------------------------------------------------------module.admin.controller.booking.create ACTION START------------------------------------------------------
	URL: [POST]/aaohome/booking/create
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","jsonData_vendorIns":"{\"trip_user\":\"1\",\"username\":\"9856321114\",\"bkg_contact_id\":\"\",\"bkg_user_id\":\"\",\"bkg_contact_no\":\"9856321114\",\"bkg_country_code\":\"91\",\"bkg_user_email\":\"pujdfveloper@gmail.com\",\"bkg_user_fname\":\"fddsfdsf\",\"bkg_user_lname\":\"dfdsfds\",\"bkg_booking_type\":\"1\",\"multicityAutoComTot\":\"\",\"multicityAutoComData\":\"\",\"bkg_from_city_id\":\"30804\",\"bkg_to_city_id\":\"30726\",\"routeProcessed\":\"Agra - Ajmer  (One Way)\",\"baseamount\":\"5894\",\"isGozonow\":\"0\",\"bkg_from_city_id1\":\"30804\",\"bkg_to_city_id1\":\"30726\",\"bkg_pickup_date_date\":\"24\\\/10\\\/2024\",\"bkg_pickup_date_time\":\"06:00 PM\",\"bkg_return_date_date\":\"\",\"bkg_return_date_time\":\"\",\"bkg_pickup_address\":\"\",\"bkg_drop_address\":\"\",\"tot_est_dist\":\"375\",\"tot_est_dur\":\"420\",\"bkg_vehicle_type_id\":\"3\",\"cabNotSupported\":1,\"bkg_service_class\":\"1\",\"paymentChangesData\":\"\",\"bkg_surge_differentiate_amount\":\"0\",\"bkgPricefactor\":{\"surgeFactorUsed\":0,\"regularBaseAmount\":5266,\"additional_param\":\"{\\\"defMarkupCab\\\":5845,\\\"partnerMinimumBasePrice\\\":5543}\",\"partner_soldout\":0},\"agtBkgCategory\":null,\"bkg_vht_id\":\"\",\"bkg_trip_distance\":\"375\",\"bkg_trip_duration\":\"420\",\"bkg_addon_ids\":\"\",\"bkg_addon_cab\":\"\",\"bkg_chargeable_distance\":\"0\",\"bkg_gozo_base_amount\":\"5894\",\"bkg_rate_per_km_extra\":\"12.25\",\"bkg_rate_per_km\":\"10.55\",\"bkg_base_amount\":\"5894\",\"bkg_addon_charges\":\"0\",\"bkg_additional_charge_remark\":\"\",\"bkg_additional_charge\":\"0\",\"bkg_promo1_code\":\"\",\"bkg_discount_amount\":\"0\",\"bkg_quoted_vendor_amount\":\"5857\",\"bkg_vendor_amount\":\"5857\",\"bkg_night_pickup_included\":\"0\",\"bkg_night_drop_included\":\"1\",\"bkg_driver_allowance_amount\":\"250\",\"bkg_parking_charge\":\"0\",\"bkg_is_toll_tax_included\":\"1\",\"bkg_toll_tax\":\"395\",\"bkg_is_state_tax_included\":\"1\",\"bkg_state_tax\":\"250\",\"bkg_airport_entry_fee\":\"0\",\"bkg_convenience_charge\":\"0\",\"bkg_service_tax_rate\":\"5\",\"bkg_service_tax\":\"339\",\"bkg_total_amount\":\"7128\",\"bkg_is_warned\":\"\",\"scvId\":\"3\",\"BookingRoute\":[{\"brt_from_latitude\":\"\",\"brt_from_longitude\":\"\",\"brt_from_place_id\":\"\",\"brt_from_formatted_address\":\"\",\"brt_from_city_is_airport\":\"0\",\"brt_from_city_is_poi\":\"0\",\"brt_from_location\":\"\"},{\"brt_to_latitude\":\"\",\"brt_to_longitude\":\"\",\"brt_to_place_id\":\"\",\"brt_to_formatted_address\":\"\",\"brt_to_city_is_airport\":\"0\",\"brt_to_city_is_poi\":\"0\",\"brt_to_location\":\"\"}],\"multicityjsondata\":[{\"pickup_city\":\"30804\",\"drop_city\":\"30726\",\"pickup_address\":\"\",\"drop_address\":\"\",\"date\":\"2024-10-24 18:00:00\",\"distance\":\"375\",\"duration\":\"420\"}],\"bkg_chk_others\":\"0\",\"bkg_add_my_trip\":\"0\",\"fileImage\":\"\",\"bkg_invoice\":\"0\",\"bkg_trip_otp_required\":\"1\",\"bkg_driver_app_required\":\"1\",\"bkg_duty_slip_required\":\"0\",\"bkg_water_bottles_required\":\"0\",\"bkg_is_cash_required\":\"0\",\"bkg_pref_req_other\":\"\",\"bkg_tentative_booking\":\"0\",\"bkg_send_email\":\"1\",\"bkg_send_sms\":\"1\",\"bkg_spl_req_senior_citizen_trvl\":\"0\",\"bkg_spl_req_kids_trvl\":\"0\",\"bkg_spl_req_woman_trvl\":\"0\",\"bkg_spl_req_carrier\":\"0\",\"bkg_spl_req_driver_hindi_speaking\":\"0\",\"bkg_spl_req_driver_english_speaking\":\"0\",\"bkg_spl_req_other\":\"\",\"bkg_spl_req_lunch_break_time\":\"0\",\"bkg_info_source\":\"\",\"bkg_flight_no\":\"\",\"bkg_info_source_desc\":\"\",\"bkg_user_trip_type\":\"1\",\"bkg_no_person\":\"3\",\"bkg_num_large_bag\":\"0\",\"bkg_num_small_bag\":\"1\",\"locale_followup_date\":\"17\\\/10\\\/2024\",\"locale_followup_time\":\"04:07 PM\",\"bkg_quote_expire_date\":\"18\\\/10\\\/2024\",\"bkg_quote_expire_time_1\":\"10:30 AM\"}","Booking":{"bkg_instruction_to_driver_vendor":""},"BookingPref":{"bkg_pref_req_other":""}}
	RawBody: YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&jsonData_vendorIns=%7B%22trip_user%22%3A%221%22%2C%22username%22%3A%229856321114%22%2C%22bkg_contact_id%22%3A%22%22%2C%22bkg_user_id%22%3A%22%22%2C%22bkg_contact_no%22%3A%229856321114%22%2C%22bkg_country_code%22%3A%2291%22%2C%22bkg_user_email%22%3A%22pujdfveloper%40gmail.com%22%2C%22bkg_user_fname%22%3A%22fddsfdsf%22%2C%22bkg_user_lname%22%3A%22dfdsfds%22%2C%22bkg_booking_type%22%3A%221%22%2C%22multicityAutoComTot%22%3A%22%22%2C%22multicityAutoComData%22%3A%22%22%2C%22bkg_from_city_id%22%3A%2230804%22%2C%22bkg_to_city_id%22%3A%2230726%22%2C%22routeProcessed%22%3A%22Agra+-+Ajmer++(One+Way)%22%2C%22baseamount%22%3A%225894%22%2C%22isGozonow%22%3A%220%22%2C%22bkg_from_city_id1%22%3A%2230804%22%2C%22bkg_to_city_id1%22%3A%2230726%22%2C%22bkg_pickup_date_date%22%3A%2224%5C%2F10%5C%2F2024%22%2C%22bkg_pickup_date_time%22%3A%2206%3A00+PM%22%2C%22bkg_return_date_date%22%3A%22%22%2C%22bkg_return_date_time%22%3A%22%22%2C%22bkg_pickup_address%22%3A%22%22%2C%22bkg_drop_address%22%3A%22%22%2C%22tot_est_dist%22%3A%22375%22%2C%22tot_est_dur%22%3A%22420%22%2C%22bkg_vehicle_type_id%22%3A%223%22%2C%22cabNotSupported%22%3A1%2C%22bkg_service_class%22%3A%221%22%2C%22paymentChangesData%22%3A%22%22%2C%22bkg_surge_differentiate_amount%22%3A%220%22%2C%22bkgPricefactor%22%3A%7B%22surgeFactorUsed%22%3A0%2C%22regularBaseAmount%22%3A5266%2C%22additional_param%22%3A%22%7B%5C%22defMarkupCab%5C%22%3A5845%2C%5C%22partnerMinimumBasePrice%5C%22%3A5543%7D%22%2C%22partner_soldout%22%3A0%7D%2C%22agtBkgCategory%22%3Anull%2C%22bkg_vht_id%22%3A%22%22%2C%22bkg_trip_distance%22%3A%22375%22%2C%22bkg_trip_duration%22%3A%22420%22%2C%22bkg_addon_ids%22%3A%22%22%2C%22bkg_addon_cab%22%3A%22%22%2C%22bkg_chargeable_distance%22%3A%220%22%2C%22bkg_gozo_base_amount%22%3A%225894%22%2C%22bkg_rate_per_km_extra%22%3A%2212.25%22%2C%22bkg_rate_per_km%22%3A%2210.55%22%2C%22bkg_base_amount%22%3A%225894%22%2C%22bkg_addon_charges%22%3A%220%22%2C%22bkg_additional_charge_remark%22%3A%22%22%2C%22bkg_additional_charge%22%3A%220%22%2C%22bkg_promo1_code%22%3A%22%22%2C%22bkg_discount_amount%22%3A%220%22%2C%22bkg_quoted_vendor_amount%22%3A%225857%22%2C%22bkg_vendor_amount%22%3A%225857%22%2C%22bkg_night_pickup_included%22%3A%220%22%2C%22bkg_night_drop_included%22%3A%221%22%2C%22bkg_driver_allowance_amount%22%3A%22250%22%2C%22bkg_parking_charge%22%3A%220%22%2C%22bkg_is_toll_tax_included%22%3A%221%22%2C%22bkg_toll_tax%22%3A%22395%22%2C%22bkg_is_state_tax_included%22%3A%221%22%2C%22bkg_state_tax%22%3A%22250%22%2C%22bkg_airport_entry_fee%22%3A%220%22%2C%22bkg_convenience_charge%22%3A%220%22%2C%22bkg_service_tax_rate%22%3A%225%22%2C%22bkg_service_tax%22%3A%22339%22%2C%22bkg_total_amount%22%3A%227128%22%2C%22bkg_is_warned%22%3A%22%22%2C%22scvId%22%3A%223%22%2C%22BookingRoute%22%3A%5B%7B%22brt_from_latitude%22%3A%22%22%2C%22brt_from_longitude%22%3A%22%22%2C%22brt_from_place_id%22%3A%22%22%2C%22brt_from_formatted_address%22%3A%22%22%2C%22brt_from_city_is_airport%22%3A%220%22%2C%22brt_from_city_is_poi%22%3A%220%22%2C%22brt_from_location%22%3A%22%22%7D%2C%7B%22brt_to_latitude%22%3A%22%22%2C%22brt_to_longitude%22%3A%22%22%2C%22brt_to_place_id%22%3A%22%22%2C%22brt_to_formatted_address%22%3A%22%22%2C%22brt_to_city_is_airport%22%3A%220%22%2C%22brt_to_city_is_poi%22%3A%220%22%2C%22brt_to_location%22%3A%22%22%7D%5D%2C%22multicityjsondata%22%3A%5B%7B%22pickup_city%22%3A%2230804%22%2C%22drop_city%22%3A%2230726%22%2C%22pickup_address%22%3A%22%22%2C%22drop_address%22%3A%22%22%2C%22date%22%3A%222024-10-24+18%3A00%3A00%22%2C%22distance%22%3A%22375%22%2C%22duration%22%3A%22420%22%7D%5D%2C%22bkg_chk_others%22%3A%220%22%2C%22bkg_add_my_trip%22%3A%220%22%2C%22fileImage%22%3A%22%22%2C%22bkg_invoice%22%3A%220%22%2C%22bkg_trip_otp_required%22%3A%221%22%2C%22bkg_driver_app_required%22%3A%221%22%2C%22bkg_duty_slip_required%22%3A%220%22%2C%22bkg_water_bottles_required%22%3A%220%22%2C%22bkg_is_cash_required%22%3A%220%22%2C%22bkg_pref_req_other%22%3A%22%22%2C%22bkg_tentative_booking%22%3A%220%22%2C%22bkg_send_email%22%3A%221%22%2C%22bkg_send_sms%22%3A%221%22%2C%22bkg_spl_req_senior_citizen_trvl%22%3A%220%22%2C%22bkg_spl_req_kids_trvl%22%3A%220%22%2C%22bkg_spl_req_woman_trvl%22%3A%220%22%2C%22bkg_spl_req_carrier%22%3A%220%22%2C%22bkg_spl_req_driver_hindi_speaking%22%3A%220%22%2C%22bkg_spl_req_driver_english_speaking%22%3A%220%22%2C%22bkg_spl_req_other%22%3A%22%22%2C%22bkg_spl_req_lunch_break_time%22%3A%220%22%2C%22bkg_info_source%22%3A%22%22%2C%22bkg_flight_no%22%3A%22%22%2C%22bkg_info_source_desc%22%3A%22%22%2C%22bkg_user_trip_type%22%3A%221%22%2C%22bkg_no_person%22%3A%223%22%2C%22bkg_num_large_bag%22%3A%220%22%2C%22bkg_num_small_bag%22%3A%221%22%2C%22locale_followup_date%22%3A%2217%5C%2F10%5C%2F2024%22%2C%22locale_followup_time%22%3A%2204%3A07+PM%22%2C%22bkg_quote_expire_date%22%3A%2218%5C%2F10%5C%2F2024%22%2C%22bkg_quote_expire_time_1%22%3A%2210%3A30+AM%22%7D&Booking%5Bbkg_instruction_to_driver_vendor%5D=&BookingPref%5Bbkg_pref_req_other%5D=
	[UserID: 30] [UserType: 4]
2024/10/17 14:07:44 [profile] [profile.module.admin.controller.booking.create] [T: 173.888] [M: 11319.93] setLocationRequest start
2024/10/17 14:07:44 [profile] [profile.module.admin.controller.booking.create] [T: 269.254] [M: 11320.44] setLocationRequest ends
2024/10/17 14:07:44 [profile] [profile.module.admin.controller.booking.create] [T: 613.412] [M: 26276.88] [ET: 0.745/572.236] [MU: 2.65/26276.57] 
	SQL: SELECT GROUP_CONCAT(zct_zon_id) as zones FROM zone_cities 
						INNER JOIN zones ON zon_id=zct_zon_id AND zon_active=1
						WHERE zct_cty_id=:city AND zct_active=1 
	 [params: {":city":"30804"}]
2024/10/17 14:07:44 [profile] [profile.module.admin.controller.booking.create] [T: 686.12] [M: 27612.53] Upload Attachment
2024/10/17 14:07:44 [profile] [profile.module.admin.controller.booking.create] [T: 694.754] [M: 27617.12] Booking Model Saved
2024/10/17 14:07:45 [profile] [profile.module.admin.controller.booking.create] [T: 748.058] [M: 29064.6] Additional Data Saved
2024/10/17 14:07:45 [profile] [profile.module.admin.controller.booking.create] [T: 757.14] [M: 29606.05] [ET: 0.237/715.985] [MU: 0.93/29605.86] 
	SQL: SELECT CalcWorkingMinutes('2024-10-17 14:07:44', '2024-10-24 18:00:00') FROM dual 
	 [params: []]
2024/10/17 14:07:45 [profile] [profile.module.admin.controller.booking.create] [T: 768.992] [M: 29667.89] Create traveller contact
2024/10/17 14:07:45 [profile] [profile.module.admin.controller.booking.create] [T: 783.687] [M: 30730.45] [ET: 0.717/742.523] [MU: 2.46/30728.7] 
	SQL: SELECT ctt1.ctt_id, IF(SOUNDEX(ctt.ctt_first_name)=SOUNDEX(:firstName),1,0) as firstNameScore, IF(SOUNDEX(ctt.ctt_last_name)=SOUNDEX(:lastName),1,0) as lastNameScore, 
							IF(cp.phn_is_primary=1, 1, 0) as phonePrimaryScore, IF(ce.eml_is_primary=1, 1,0) as emailPrimaryScore,
							IF(cp.phn_is_verified>0, 2,0) as phoneVerifyScore, IF(ce.eml_is_verified>0, 2,0) as emailVerifyScore,
							cp.phn_is_verified, ce.eml_is_verified
							FROM contact ctt
							INNER JOIN contact ctt1 ON ctt.ctt_ref_code=ctt1.ctt_id AND ctt1.ctt_active=1
							LEFT JOIN contact_phone cp ON cp.phn_contact_id=ctt.ctt_id AND cp.phn_active=1 AND cp.phn_phone_no IS NOT NULL AND cp.phn_phone_no<>'' AND cp.phn_full_number=:phone
							LEFT JOIN contact_email ce ON ce.eml_contact_id=ctt.ctt_id AND ce.eml_active=1 AND ce.eml_email_address IS NOT NULL AND ce.eml_email_address<>'' AND ce.eml_email_address=:email
							WHERE ctt.ctt_id IN (:gp0)  AND ctt.ctt_active=1 AND (cp.phn_id IS NOT NULL OR ce.eml_id IS NOT NULL)
							HAVING ((lastNameScore>0 AND firstNameScore>0) OR phoneVerifyScore>0 OR emailVerifyScore>0 OR phonePrimaryScore >0 OR emailPrimaryScore>0)
							ORDER BY (lastNameScore + firstNameScore + phonePrimaryScore + phoneVerifyScore + emailPrimaryScore + emailVerifyScore) DESC, firstNameScore DESC, lastNameScore DESC, phoneVerifyScore DESC, emailVerifyScore DESC 
	 [params: {"firstName":"fddsfdsf","lastName":"dfdsfds","phone":"+919856321114","email":"pujdfveloper@gmail.com",":gp0":"0"}]
2024/10/17 14:07:45 [profile] [profile.module.admin.controller.booking.create] [T: 834.183] [M: 30839.66] [ET: 1.452/793.006] [MU: 48.41/30837.16] 
	SQL: SELECT c1.ctt_id, IFNULL(cp1.cr_is_consumer, cp.cr_is_consumer) as userId,cp1.cr_is_driver as driverId,
						MAX(ce.eml_is_primary) as isPrimary, MAX(ce.eml_is_verified) AS isVerified,IFNULL(cp1.cr_is_vendor, cp.cr_is_vendor) as vendorId,
						IF((c1.ctt_name<>'' AND CONCAT(TRIM(:firstName), ' ', TRIM(:lastName))=c1.ctt_name)
						OR (c.ctt_name<>'' AND CONCAT(TRIM(:firstName), ' ', TRIM(:lastName))=c.ctt_name)
						OR (c.ctt_name<>'' AND SOUNDEX(CONCAT(TRIM(:firstName), ' ', TRIM(:lastName)))=SOUNDEX(c.ctt_name))
						OR (c1.ctt_name<>'' AND CONCAT(TRIM(:firstName), ' ', TRIM(:lastName)) LIKE CONCAT('%',c1.ctt_name,'%'))
						OR (c1.ctt_name<>'' AND c1.ctt_name LIKE CONCAT('%',CONCAT(TRIM(:firstName), ' ', TRIM(:lastName)),'%'))
						OR (c.ctt_name<>'' AND CONCAT(TRIM(:firstName), ' ', TRIM(:lastName)) LIKE CONCAT('%',c.ctt_name,'%'))
						OR (c.ctt_name<>'' AND c.ctt_name LIKE CONCAT('%',CONCAT(TRIM(:firstName), ' ', TRIM(:lastName)),'%')),
						1,0) as nameRank,
						CASE
						WHEN MAX(phn_is_primary)=1 AND MAX(phn_is_verified)=1 THEN 4
						WHEN MAX(phn_is_verified)=1 THEN 3
						WHEN MAX(phn_is_primary)=1 THEN 2
						WHEN phn_id IS NOT NULL THEN 1
						ELSE 0
						END as phoneRank,
						CASE
						WHEN MAX(ce.eml_is_primary)=1 AND MAX(ce.eml_is_verified)=1 THEN 4
						WHEN MAX(ce.eml_is_verified)=1 THEN 3
						WHEN MAX(ce.eml_is_primary)=1 THEN 2
						WHEN eml_id IS NOT NULL THEN 1
						ELSE 0
						END as emailRank,
						IF(cp1.cr_is_consumer IS NULL, 0, 1) as profileRank
					FROM contact_email ce
					INNER JOIN contact c ON ce.eml_contact_id=c.ctt_id AND eml_active=1
					LEFT JOIN contact_profile cp ON cp.cr_contact_id=c.ctt_id
					INNER JOIN contact c1 ON c1.ctt_id=c.ctt_ref_code AND c1.ctt_active = 1
					LEFT JOIN contact_profile cp1 ON cp1.cr_contact_id=c1.ctt_id
					LEFT JOIN contact_phone phn ON phn.phn_contact_id=c1.ctt_id AND phn_active=1 AND phn_full_number=:phone
					WHERE ce.eml_email_address=:email  
					GROUP BY c1.ctt_id HAVING (isPrimary + isVerified)>0
					ORDER BY (ce.eml_is_primary + ce.eml_is_verified) DESC, emailRank DESC,nameRank DESC,phoneRank DESC, ce.eml_is_verified DESC, profileRank DESC  
	 [params: {"email":"pujdfveloper@gmail.com","phone":"919856321114","firstName":"fddsfdsf","lastName":"dfdsfds"}]
2024/10/17 14:07:45 [profile] [profile.module.admin.controller.booking.create] [T: 835.371] [M: 30871.38] [ET: 1.089/794.195] [MU: 28.97/30868.88] 
	SQL: SELECT c1.ctt_id, IFNULL(cp1.cr_is_consumer, cp.cr_is_consumer) as userId,IFNULL(cp1.cr_is_driver, cp.cr_is_driver) as driverId,
					IFNULL(cp1.cr_is_vendor, cp.cr_is_vendor) as vendorId,
					MAX(ce.phn_is_primary) as isPrimary, MAX(ce.phn_is_verified) AS isVerified,
					IF((c1.ctt_name<>'' AND CONCAT(TRIM(:firstName), ' ', TRIM(:lastName))=c1.ctt_name)
							OR (c.ctt_name<>'' AND CONCAT(TRIM(:firstName), ' ', TRIM(:lastName))=c.ctt_name)
							OR (c.ctt_name<>'' AND SOUNDEX(CONCAT(TRIM(:firstName), ' ', TRIM(:lastName)))=SOUNDEX(c.ctt_name))
							OR (c1.ctt_name<>'' AND CONCAT(TRIM(:firstName), ' ', TRIM(:lastName)) LIKE CONCAT('%',c1.ctt_name,'%'))
							OR (c1.ctt_name<>'' AND c1.ctt_name LIKE CONCAT('%',CONCAT(TRIM(:firstName), ' ', TRIM(:lastName)),'%'))
							OR (c.ctt_name<>'' AND CONCAT(TRIM(:firstName), ' ', TRIM(:lastName)) LIKE CONCAT('%',c.ctt_name,'%'))
							OR (c.ctt_name<>'' AND c.ctt_name LIKE CONCAT('%',CONCAT(TRIM(:firstName), ' ', TRIM(:lastName)),'%')),
						1,0) as nameRank,
					CASE
						WHEN MAX(phn_is_primary)=1 AND MAX(phn_is_verified)=1 THEN 4
						WHEN MAX(phn_is_verified)=1 THEN 3
						WHEN MAX(phn_is_primary)=1 THEN 2
						WHEN phn_id IS NOT NULL THEN 1
						ELSE 0
					END as phoneRank,
					CASE
						WHEN MAX(eml.eml_is_primary)=1 AND MAX(eml.eml_is_verified)=1 THEN 4
						WHEN MAX(eml.eml_is_verified)=1 THEN 3
						WHEN MAX(eml.eml_is_primary)=1 THEN 2
						WHEN eml_id IS NOT NULL THEN 1
						ELSE 0
					END as emailRank,
					IF(cp1.cr_is_consumer IS NULL, 0, 1) as profileRank
					FROM contact_phone ce
					INNER JOIN contact c ON ce.phn_contact_id=c.ctt_id AND phn_active=1
					LEFT JOIN contact_profile cp ON cp.cr_contact_id=c.ctt_id
					INNER JOIN contact c1 ON c1.ctt_id=c.ctt_ref_code
					LEFT JOIN contact_profile cp1 ON cp1.cr_contact_id=c1.ctt_id
					LEFT JOIN contact_email eml ON eml.eml_contact_id=c1.ctt_id AND eml_active=1 AND eml_email_address=:email
					WHERE ce.phn_full_number=:phone
					GROUP BY c1.ctt_id HAVING (isPrimary + isVerified)>0
					ORDER BY (ce.phn_is_primary + ce.phn_is_verified) DESC, phoneRank DESC,nameRank DESC,emailRank DESC,ce.phn_is_verified DESC, profileRank DESC  
	 [params: {"email":"pujdfveloper@gmail.com","phone":"919856321114","firstName":"fddsfdsf","lastName":"dfdsfds"}]
2024/10/17 14:07:45 [profile] [profile.module.admin.controller.booking.create] [T: 839.376] [M: 30884.88] [ET: 0.538/798.21] [MU: 1.99/30883.38] 
	SQL: SELECT ctt1.ctt_id, 0 as firstNameScore, 0 as lastNameScore, 
							IF(cp.phn_is_primary=1, 1, 0) as phonePrimaryScore, IF(ce.eml_is_primary=1, 1,0) as emailPrimaryScore,
							IF(cp.phn_is_verified>0, 2,0) as phoneVerifyScore, IF(ce.eml_is_verified>0, 2,0) as emailVerifyScore,
							cp.phn_is_verified, ce.eml_is_verified
							FROM contact ctt
							INNER JOIN contact ctt1 ON ctt.ctt_ref_code=ctt1.ctt_id AND ctt1.ctt_active=1
							LEFT JOIN contact_phone cp ON cp.phn_contact_id=ctt.ctt_id AND cp.phn_active=1 AND cp.phn_phone_no IS NOT NULL AND cp.phn_phone_no<>'' AND cp.phn_full_number=:phone
							LEFT JOIN contact_email ce ON ce.eml_contact_id=ctt.ctt_id AND ce.eml_active=1 AND ce.eml_email_address IS NOT NULL AND ce.eml_email_address<>'' AND ce.eml_email_address=:email
							WHERE ctt.ctt_id IN (:gp1)  AND ctt.ctt_active=1 AND (cp.phn_id IS NOT NULL OR ce.eml_id IS NOT NULL)
							HAVING ((lastNameScore>0 AND firstNameScore>0) OR phoneVerifyScore>0 OR emailVerifyScore>0 OR phonePrimaryScore >0 OR emailPrimaryScore>0)
							ORDER BY (lastNameScore + firstNameScore + phonePrimaryScore + phoneVerifyScore + emailPrimaryScore + emailVerifyScore) DESC, firstNameScore DESC, lastNameScore DESC, phoneVerifyScore DESC, emailVerifyScore DESC 
	 [params: {"phone":"+919856321114","email":"pujdfveloper@gmail.com",":gp1":"0"}]
2024/10/17 14:07:45 [profile] [profile.module.admin.controller.booking.create] [T: 947.839] [M: 31138.88] ContactEmail:addNew Started
2024/10/17 14:07:46 [profile] [profile.module.admin.controller.booking.create] [T: 1961.648] [M: 31154.55] ContactEmail:addNew Ended
2024/10/17 14:07:47 [profile] [profile.module.admin.controller.booking.create] [T: 2986.56] [M: 31169.23] ContactPhone:add Ended
2024/10/17 14:07:47 [profile] [profile.module.admin.controller.booking.create] [T: 3006.102] [M: 31212.66] Contact::sendVerification Started
2024/10/17 14:07:47 [profile] [profile.module.admin.controller.booking.create] [T: 3048.352] [M: 32806.09] [ET: 4.557/3007.152] [MU: 0.87/32805.87] 
	SQL:   SELECT cr_is_driver as id FROM contact_profile  WHERE cr_contact_id = :contactId AND cr_status = 1 
	 [params: {"contactId":"1687749"}]
2024/10/17 14:07:47 [profile] [profile.module.admin.controller.booking.create] [T: 3048.967] [M: 32807.28] [ET: 0.484/3007.783] [MU: 0.86/32807.06] 
	SQL: UPDATE `contact_email` SET eml_is_expired = 0 WHERE `eml_email_address` =:email 
	 [params: {"email":"pujdfveloper@gmail.com"}]
2024/10/17 14:07:47 [profile] [profile.module.admin.controller.booking.create] [T: 3109.796] [M: 36414.73] Contact::sendVerification Ended
2024/10/17 14:07:47 [profile] [profile.module.admin.controller.booking.create] [T: 3109.866] [M: 36415.19] Contact::sendVerification Started
2024/10/17 14:07:47 [profile] [profile.module.admin.controller.booking.create] [T: 3120.791] [M: 37178.21] [ET: 0.486/3079.629] [MU: 0.86/37177.99] 
	SQL:   SELECT cr_is_driver as id FROM contact_profile  WHERE cr_contact_id = :contactId AND cr_status = 1 
	 [params: {"contactId":"1687749"}]
2024/10/17 14:07:47 [profile] [profile.module.admin.controller.booking.create] [T: 3132.348] [M: 37722.62] [ET: 0.872/3091.169] [MU: 2.4/37722.3] 
	SQL: SELECT * FROM whatsapp_templates WHERE wht_active = 1 AND wht_template_name = :templateName AND wht_lang_code = :lang 
	 [params: {"templateName":"update_vendor_driver_phoneno","lang":"en_US"}]
2024/10/17 14:07:47 [profile] [profile.module.admin.controller.booking.create] [T: 3132.927] [M: 37724.21] [ET: 0.469/3091.754] [MU: 1.03/37723.99] 
	SQL: SELECT * FROM whatsapp_templates WHERE wht_active = 1 AND wht_template_name = 'update_vendor_driver_phoneno' 
	 [params: []]
2024/10/17 14:07:47 [error] [profile.module.admin.controller.booking.create] [T: 3654.465] [M: 39236.5] 0: {"error":{"message":"Error validating access token: Session has expired on Tuesday, 26-Dec-23 23:00:00 PST. The current time is Thursday, 17-Oct-24 01:37:47 PDT.","type":"OAuthException","code":190,"error_subcode":463,"fbtrace_id":"A_Sqt0WvgYHdubof4usfOo8"}}
	URL: [POST]/aaohome/booking/create
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","jsonData_vendorIns":"{\"trip_user\":\"1\",\"username\":\"9856321114\",\"bkg_contact_id\":\"\",\"bkg_user_id\":\"\",\"bkg_contact_no\":\"9856321114\",\"bkg_country_code\":\"91\",\"bkg_user_email\":\"pujdfveloper@gmail.com\",\"bkg_user_fname\":\"fddsfdsf\",\"bkg_user_lname\":\"dfdsfds\",\"bkg_booking_type\":\"1\",\"multicityAutoComTot\":\"\",\"multicityAutoComData\":\"\",\"bkg_from_city_id\":\"30804\",\"bkg_to_city_id\":\"30726\",\"routeProcessed\":\"Agra - Ajmer  (One Way)\",\"baseamount\":\"5894\",\"isGozonow\":\"0\",\"bkg_from_city_id1\":\"30804\",\"bkg_to_city_id1\":\"30726\",\"bkg_pickup_date_date\":\"24\\\/10\\\/2024\",\"bkg_pickup_date_time\":\"06:00 PM\",\"bkg_return_date_date\":\"\",\"bkg_return_date_time\":\"\",\"bkg_pickup_address\":\"\",\"bkg_drop_address\":\"\",\"tot_est_dist\":\"375\",\"tot_est_dur\":\"420\",\"bkg_vehicle_type_id\":\"3\",\"cabNotSupported\":1,\"bkg_service_class\":\"1\",\"paymentChangesData\":\"\",\"bkg_surge_differentiate_amount\":\"0\",\"bkgPricefactor\":{\"surgeFactorUsed\":0,\"regularBaseAmount\":5266,\"additional_param\":\"{\\\"defMarkupCab\\\":5845,\\\"partnerMinimumBasePrice\\\":5543}\",\"partner_soldout\":0},\"agtBkgCategory\":null,\"bkg_vht_id\":\"\",\"bkg_trip_distance\":\"375\",\"bkg_trip_duration\":\"420\",\"bkg_addon_ids\":\"\",\"bkg_addon_cab\":\"\",\"bkg_chargeable_distance\":\"0\",\"bkg_gozo_base_amount\":\"5894\",\"bkg_rate_per_km_extra\":\"12.25\",\"bkg_rate_per_km\":\"10.55\",\"bkg_base_amount\":\"5894\",\"bkg_addon_charges\":\"0\",\"bkg_additional_charge_remark\":\"\",\"bkg_additional_charge\":\"0\",\"bkg_promo1_code\":\"\",\"bkg_discount_amount\":\"0\",\"bkg_quoted_vendor_amount\":\"5857\",\"bkg_vendor_amount\":\"5857\",\"bkg_night_pickup_included\":\"0\",\"bkg_night_drop_included\":\"1\",\"bkg_driver_allowance_amount\":\"250\",\"bkg_parking_charge\":\"0\",\"bkg_is_toll_tax_included\":\"1\",\"bkg_toll_tax\":\"395\",\"bkg_is_state_tax_included\":\"1\",\"bkg_state_tax\":\"250\",\"bkg_airport_entry_fee\":\"0\",\"bkg_convenience_charge\":\"0\",\"bkg_service_tax_rate\":\"5\",\"bkg_service_tax\":\"339\",\"bkg_total_amount\":\"7128\",\"bkg_is_warned\":\"\",\"scvId\":\"3\",\"BookingRoute\":[{\"brt_from_latitude\":\"\",\"brt_from_longitude\":\"\",\"brt_from_place_id\":\"\",\"brt_from_formatted_address\":\"\",\"brt_from_city_is_airport\":\"0\",\"brt_from_city_is_poi\":\"0\",\"brt_from_location\":\"\"},{\"brt_to_latitude\":\"\",\"brt_to_longitude\":\"\",\"brt_to_place_id\":\"\",\"brt_to_formatted_address\":\"\",\"brt_to_city_is_airport\":\"0\",\"brt_to_city_is_poi\":\"0\",\"brt_to_location\":\"\"}],\"multicityjsondata\":[{\"pickup_city\":\"30804\",\"drop_city\":\"30726\",\"pickup_address\":\"\",\"drop_address\":\"\",\"date\":\"2024-10-24 18:00:00\",\"distance\":\"375\",\"duration\":\"420\"}],\"bkg_chk_others\":\"0\",\"bkg_add_my_trip\":\"0\",\"fileImage\":\"\",\"bkg_invoice\":\"0\",\"bkg_trip_otp_required\":\"1\",\"bkg_driver_app_required\":\"1\",\"bkg_duty_slip_required\":\"0\",\"bkg_water_bottles_required\":\"0\",\"bkg_is_cash_required\":\"0\",\"bkg_pref_req_other\":\"\",\"bkg_tentative_booking\":\"0\",\"bkg_send_email\":\"1\",\"bkg_send_sms\":\"1\",\"bkg_spl_req_senior_citizen_trvl\":\"0\",\"bkg_spl_req_kids_trvl\":\"0\",\"bkg_spl_req_woman_trvl\":\"0\",\"bkg_spl_req_carrier\":\"0\",\"bkg_spl_req_driver_hindi_speaking\":\"0\",\"bkg_spl_req_driver_english_speaking\":\"0\",\"bkg_spl_req_other\":\"\",\"bkg_spl_req_lunch_break_time\":\"0\",\"bkg_info_source\":\"\",\"bkg_flight_no\":\"\",\"bkg_info_source_desc\":\"\",\"bkg_user_trip_type\":\"1\",\"bkg_no_person\":\"3\",\"bkg_num_large_bag\":\"0\",\"bkg_num_small_bag\":\"1\",\"locale_followup_date\":\"17\\\/10\\\/2024\",\"locale_followup_time\":\"04:07 PM\",\"bkg_quote_expire_date\":\"18\\\/10\\\/2024\",\"bkg_quote_expire_time_1\":\"10:30 AM\"}","Booking":{"bkg_instruction_to_driver_vendor":""},"BookingPref":{"bkg_pref_req_other":""}}
	RawBody: YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&jsonData_vendorIns=%7B%22trip_user%22%3A%221%22%2C%22username%22%3A%229856321114%22%2C%22bkg_contact_id%22%3A%22%22%2C%22bkg_user_id%22%3A%22%22%2C%22bkg_contact_no%22%3A%229856321114%22%2C%22bkg_country_code%22%3A%2291%22%2C%22bkg_user_email%22%3A%22pujdfveloper%40gmail.com%22%2C%22bkg_user_fname%22%3A%22fddsfdsf%22%2C%22bkg_user_lname%22%3A%22dfdsfds%22%2C%22bkg_booking_type%22%3A%221%22%2C%22multicityAutoComTot%22%3A%22%22%2C%22multicityAutoComData%22%3A%22%22%2C%22bkg_from_city_id%22%3A%2230804%22%2C%22bkg_to_city_id%22%3A%2230726%22%2C%22routeProcessed%22%3A%22Agra+-+Ajmer++(One+Way)%22%2C%22baseamount%22%3A%225894%22%2C%22isGozonow%22%3A%220%22%2C%22bkg_from_city_id1%22%3A%2230804%22%2C%22bkg_to_city_id1%22%3A%2230726%22%2C%22bkg_pickup_date_date%22%3A%2224%5C%2F10%5C%2F2024%22%2C%22bkg_pickup_date_time%22%3A%2206%3A00+PM%22%2C%22bkg_return_date_date%22%3A%22%22%2C%22bkg_return_date_time%22%3A%22%22%2C%22bkg_pickup_address%22%3A%22%22%2C%22bkg_drop_address%22%3A%22%22%2C%22tot_est_dist%22%3A%22375%22%2C%22tot_est_dur%22%3A%22420%22%2C%22bkg_vehicle_type_id%22%3A%223%22%2C%22cabNotSupported%22%3A1%2C%22bkg_service_class%22%3A%221%22%2C%22paymentChangesData%22%3A%22%22%2C%22bkg_surge_differentiate_amount%22%3A%220%22%2C%22bkgPricefactor%22%3A%7B%22surgeFactorUsed%22%3A0%2C%22regularBaseAmount%22%3A5266%2C%22additional_param%22%3A%22%7B%5C%22defMarkupCab%5C%22%3A5845%2C%5C%22partnerMinimumBasePrice%5C%22%3A5543%7D%22%2C%22partner_soldout%22%3A0%7D%2C%22agtBkgCategory%22%3Anull%2C%22bkg_vht_id%22%3A%22%22%2C%22bkg_trip_distance%22%3A%22375%22%2C%22bkg_trip_duration%22%3A%22420%22%2C%22bkg_addon_ids%22%3A%22%22%2C%22bkg_addon_cab%22%3A%22%22%2C%22bkg_chargeable_distance%22%3A%220%22%2C%22bkg_gozo_base_amount%22%3A%225894%22%2C%22bkg_rate_per_km_extra%22%3A%2212.25%22%2C%22bkg_rate_per_km%22%3A%2210.55%22%2C%22bkg_base_amount%22%3A%225894%22%2C%22bkg_addon_charges%22%3A%220%22%2C%22bkg_additional_charge_remark%22%3A%22%22%2C%22bkg_additional_charge%22%3A%220%22%2C%22bkg_promo1_code%22%3A%22%22%2C%22bkg_discount_amount%22%3A%220%22%2C%22bkg_quoted_vendor_amount%22%3A%225857%22%2C%22bkg_vendor_amount%22%3A%225857%22%2C%22bkg_night_pickup_included%22%3A%220%22%2C%22bkg_night_drop_included%22%3A%221%22%2C%22bkg_driver_allowance_amount%22%3A%22250%22%2C%22bkg_parking_charge%22%3A%220%22%2C%22bkg_is_toll_tax_included%22%3A%221%22%2C%22bkg_toll_tax%22%3A%22395%22%2C%22bkg_is_state_tax_included%22%3A%221%22%2C%22bkg_state_tax%22%3A%22250%22%2C%22bkg_airport_entry_fee%22%3A%220%22%2C%22bkg_convenience_charge%22%3A%220%22%2C%22bkg_service_tax_rate%22%3A%225%22%2C%22bkg_service_tax%22%3A%22339%22%2C%22bkg_total_amount%22%3A%227128%22%2C%22bkg_is_warned%22%3A%22%22%2C%22scvId%22%3A%223%22%2C%22BookingRoute%22%3A%5B%7B%22brt_from_latitude%22%3A%22%22%2C%22brt_from_longitude%22%3A%22%22%2C%22brt_from_place_id%22%3A%22%22%2C%22brt_from_formatted_address%22%3A%22%22%2C%22brt_from_city_is_airport%22%3A%220%22%2C%22brt_from_city_is_poi%22%3A%220%22%2C%22brt_from_location%22%3A%22%22%7D%2C%7B%22brt_to_latitude%22%3A%22%22%2C%22brt_to_longitude%22%3A%22%22%2C%22brt_to_place_id%22%3A%22%22%2C%22brt_to_formatted_address%22%3A%22%22%2C%22brt_to_city_is_airport%22%3A%220%22%2C%22brt_to_city_is_poi%22%3A%220%22%2C%22brt_to_location%22%3A%22%22%7D%5D%2C%22multicityjsondata%22%3A%5B%7B%22pickup_city%22%3A%2230804%22%2C%22drop_city%22%3A%2230726%22%2C%22pickup_address%22%3A%22%22%2C%22drop_address%22%3A%22%22%2C%22date%22%3A%222024-10-24+18%3A00%3A00%22%2C%22distance%22%3A%22375%22%2C%22duration%22%3A%22420%22%7D%5D%2C%22bkg_chk_others%22%3A%220%22%2C%22bkg_add_my_trip%22%3A%220%22%2C%22fileImage%22%3A%22%22%2C%22bkg_invoice%22%3A%220%22%2C%22bkg_trip_otp_required%22%3A%221%22%2C%22bkg_driver_app_required%22%3A%221%22%2C%22bkg_duty_slip_required%22%3A%220%22%2C%22bkg_water_bottles_required%22%3A%220%22%2C%22bkg_is_cash_required%22%3A%220%22%2C%22bkg_pref_req_other%22%3A%22%22%2C%22bkg_tentative_booking%22%3A%220%22%2C%22bkg_send_email%22%3A%221%22%2C%22bkg_send_sms%22%3A%221%22%2C%22bkg_spl_req_senior_citizen_trvl%22%3A%220%22%2C%22bkg_spl_req_kids_trvl%22%3A%220%22%2C%22bkg_spl_req_woman_trvl%22%3A%220%22%2C%22bkg_spl_req_carrier%22%3A%220%22%2C%22bkg_spl_req_driver_hindi_speaking%22%3A%220%22%2C%22bkg_spl_req_driver_english_speaking%22%3A%220%22%2C%22bkg_spl_req_other%22%3A%22%22%2C%22bkg_spl_req_lunch_break_time%22%3A%220%22%2C%22bkg_info_source%22%3A%22%22%2C%22bkg_flight_no%22%3A%22%22%2C%22bkg_info_source_desc%22%3A%22%22%2C%22bkg_user_trip_type%22%3A%221%22%2C%22bkg_no_person%22%3A%223%22%2C%22bkg_num_large_bag%22%3A%220%22%2C%22bkg_num_small_bag%22%3A%221%22%2C%22locale_followup_date%22%3A%2217%5C%2F10%5C%2F2024%22%2C%22locale_followup_time%22%3A%2204%3A07+PM%22%2C%22bkg_quote_expire_date%22%3A%2218%5C%2F10%5C%2F2024%22%2C%22bkg_quote_expire_time_1%22%3A%2210%3A30+AM%22%7D&Booking%5Bbkg_instruction_to_driver_vendor%5D=&BookingPref%5Bbkg_pref_req_other%5D=
	[UserID: 30] [UserType: 4]
in C:\Projects\Staging\protected\components\Logger.php (85)
in C:\Projects\Staging\protected\components\Logger.php (156)
in C:\Projects\Staging\protected\components\Whatsapp.php (86)
2024/10/17 14:07:47 [profile] [profile.module.admin.controller.booking.create] [T: 3675.16] [M: 39226.4] [ET: 10.153/3633.886] [MU: 1.93/39225.77] 
	SQL: SELECT 
				SUM(if(provider_type=1,1,0) ) AS `slg_provider_type_1`,
				SUM(if(provider_type=2,1,0) ) AS `slg_provider_type_2`,
				SUM(if(provider_type=3,1,0) ) AS `slg_provider_type_3`,
				SUM(if(provider_type=4,1,0) ) AS `slg_provider_type_4`
				FROM
				(
					SELECT 
							slg_provider_type AS provider_type
					FROM sms_log
					WHERE 1 
						AND slg_provider_type >0 
						AND status=1  
						  AND slg_phn_code = 91 
					ORDER BY id DESC 	
					LIMIT 0,10
				) AS temp   WHERE 1  
	 [params: []]
2024/10/17 14:07:48 [profile] [profile.module.admin.controller.booking.create] [T: 3707.339] [M: 39242.23] Contact::sendVerification Ended
2024/10/17 14:07:48 [profile] [profile.module.admin.controller.booking.create] [T: 3730.79] [M: 39192.3] ContactProfile:createProfile Started
2024/10/17 14:07:48 [profile] [profile.module.admin.controller.booking.create] [T: 3755.339] [M: 39241.99] ContactProfile:updateProfile Ended
2024/10/17 14:07:48 [profile] [profile.module.admin.controller.booking.create] [T: 3755.392] [M: 39201.94] Contact::createbyBookingUser DONE
2024/10/17 14:07:48 [profile] [profile.module.admin.controller.booking.create] [T: 3770.549] [M: 40242.54] [ET: 0.268/3729.392] [MU: 0.87/40242.23] 
	SQL: SELECT cr_contact_id, cr_is_vendor, cr_is_driver, cr_is_consumer, cr_is_partner
					FROM contact_profile WHERE cr_contact_id = :contactId AND cr_status = 1 
	 [params: {"contactId":"1687749"}]
2024/10/17 14:07:48 [profile] [profile.module.admin.controller.booking.create] [T: 3771.355] [M: 40279.55] [ET: 0.692/3730.19] [MU: 29.21/40277.05] 
	SQL: SELECT c1.ctt_id, IFNULL(cp1.cr_is_consumer, cp.cr_is_consumer) as userId,cp1.cr_is_driver as driverId,
						MAX(ce.eml_is_primary) as isPrimary, MAX(ce.eml_is_verified) AS isVerified,IFNULL(cp1.cr_is_vendor, cp.cr_is_vendor) as vendorId,
						IF((c1.ctt_name<>'' AND CONCAT(TRIM(:firstName), ' ', TRIM(:lastName))=c1.ctt_name)
						OR (c.ctt_name<>'' AND CONCAT(TRIM(:firstName), ' ', TRIM(:lastName))=c.ctt_name)
						OR (c.ctt_name<>'' AND SOUNDEX(CONCAT(TRIM(:firstName), ' ', TRIM(:lastName)))=SOUNDEX(c.ctt_name))
						OR (c1.ctt_name<>'' AND CONCAT(TRIM(:firstName), ' ', TRIM(:lastName)) LIKE CONCAT('%',c1.ctt_name,'%'))
						OR (c1.ctt_name<>'' AND c1.ctt_name LIKE CONCAT('%',CONCAT(TRIM(:firstName), ' ', TRIM(:lastName)),'%'))
						OR (c.ctt_name<>'' AND CONCAT(TRIM(:firstName), ' ', TRIM(:lastName)) LIKE CONCAT('%',c.ctt_name,'%'))
						OR (c.ctt_name<>'' AND c.ctt_name LIKE CONCAT('%',CONCAT(TRIM(:firstName), ' ', TRIM(:lastName)),'%')),
						1,0) as nameRank,
						CASE
						WHEN MAX(phn_is_primary)=1 AND MAX(phn_is_verified)=1 THEN 4
						WHEN MAX(phn_is_verified)=1 THEN 3
						WHEN MAX(phn_is_primary)=1 THEN 2
						WHEN phn_id IS NOT NULL THEN 1
						ELSE 0
						END as phoneRank,
						CASE
						WHEN MAX(ce.eml_is_primary)=1 AND MAX(ce.eml_is_verified)=1 THEN 4
						WHEN MAX(ce.eml_is_verified)=1 THEN 3
						WHEN MAX(ce.eml_is_primary)=1 THEN 2
						WHEN eml_id IS NOT NULL THEN 1
						ELSE 0
						END as emailRank,
						IF(cp1.cr_is_consumer IS NULL, 0, 1) as profileRank
					FROM contact_email ce
					INNER JOIN contact c ON ce.eml_contact_id=c.ctt_id AND eml_active=1
					LEFT JOIN contact_profile cp ON cp.cr_contact_id=c.ctt_id
					INNER JOIN contact c1 ON c1.ctt_id=c.ctt_ref_code AND c1.ctt_active = 1
					LEFT JOIN contact_profile cp1 ON cp1.cr_contact_id=c1.ctt_id
					LEFT JOIN contact_phone phn ON phn.phn_contact_id=c1.ctt_id AND phn_active=1 AND phn_full_number=:phone
					WHERE ce.eml_email_address=:email  
					GROUP BY c1.ctt_id HAVING (isPrimary + isVerified)>0
					ORDER BY (ce.eml_is_primary + ce.eml_is_verified) DESC, emailRank DESC,nameRank DESC,phoneRank DESC, ce.eml_is_verified DESC, profileRank DESC  
	 [params: {"email":"pujdfveloper@gmail.com","phone":"919856321114","firstName":"fddsfdsf","lastName":"dfdsfds"}]
2024/10/17 14:07:48 [profile] [profile.module.admin.controller.booking.create] [T: 3772.272] [M: 40311.51] [ET: 0.835/3731.11] [MU: 29.21/40309.01] 
	SQL: SELECT c1.ctt_id, IFNULL(cp1.cr_is_consumer, cp.cr_is_consumer) as userId,IFNULL(cp1.cr_is_driver, cp.cr_is_driver) as driverId,
					IFNULL(cp1.cr_is_vendor, cp.cr_is_vendor) as vendorId,
					MAX(ce.phn_is_primary) as isPrimary, MAX(ce.phn_is_verified) AS isVerified,
					IF((c1.ctt_name<>'' AND CONCAT(TRIM(:firstName), ' ', TRIM(:lastName))=c1.ctt_name)
							OR (c.ctt_name<>'' AND CONCAT(TRIM(:firstName), ' ', TRIM(:lastName))=c.ctt_name)
							OR (c.ctt_name<>'' AND SOUNDEX(CONCAT(TRIM(:firstName), ' ', TRIM(:lastName)))=SOUNDEX(c.ctt_name))
							OR (c1.ctt_name<>'' AND CONCAT(TRIM(:firstName), ' ', TRIM(:lastName)) LIKE CONCAT('%',c1.ctt_name,'%'))
							OR (c1.ctt_name<>'' AND c1.ctt_name LIKE CONCAT('%',CONCAT(TRIM(:firstName), ' ', TRIM(:lastName)),'%'))
							OR (c.ctt_name<>'' AND CONCAT(TRIM(:firstName), ' ', TRIM(:lastName)) LIKE CONCAT('%',c.ctt_name,'%'))
							OR (c.ctt_name<>'' AND c.ctt_name LIKE CONCAT('%',CONCAT(TRIM(:firstName), ' ', TRIM(:lastName)),'%')),
						1,0) as nameRank,
					CASE
						WHEN MAX(phn_is_primary)=1 AND MAX(phn_is_verified)=1 THEN 4
						WHEN MAX(phn_is_verified)=1 THEN 3
						WHEN MAX(phn_is_primary)=1 THEN 2
						WHEN phn_id IS NOT NULL THEN 1
						ELSE 0
					END as phoneRank,
					CASE
						WHEN MAX(eml.eml_is_primary)=1 AND MAX(eml.eml_is_verified)=1 THEN 4
						WHEN MAX(eml.eml_is_verified)=1 THEN 3
						WHEN MAX(eml.eml_is_primary)=1 THEN 2
						WHEN eml_id IS NOT NULL THEN 1
						ELSE 0
					END as emailRank,
					IF(cp1.cr_is_consumer IS NULL, 0, 1) as profileRank
					FROM contact_phone ce
					INNER JOIN contact c ON ce.phn_contact_id=c.ctt_id AND phn_active=1
					LEFT JOIN contact_profile cp ON cp.cr_contact_id=c.ctt_id
					INNER JOIN contact c1 ON c1.ctt_id=c.ctt_ref_code
					LEFT JOIN contact_profile cp1 ON cp1.cr_contact_id=c1.ctt_id
					LEFT JOIN contact_email eml ON eml.eml_contact_id=c1.ctt_id AND eml_active=1 AND eml_email_address=:email
					WHERE ce.phn_full_number=:phone
					GROUP BY c1.ctt_id HAVING (isPrimary + isVerified)>0
					ORDER BY (ce.phn_is_primary + ce.phn_is_verified) DESC, phoneRank DESC,nameRank DESC,emailRank DESC,ce.phn_is_verified DESC, profileRank DESC  
	 [params: {"email":"pujdfveloper@gmail.com","phone":"919856321114","firstName":"fddsfdsf","lastName":"dfdsfds"}]
2024/10/17 14:07:48 [profile] [profile.module.admin.controller.booking.create] [T: 4115.245] [M: 42492.37] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.AccountTransDetails.saveAll START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/create
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","jsonData_vendorIns":"{\"trip_user\":\"1\",\"username\":\"9856321114\",\"bkg_contact_id\":\"\",\"bkg_user_id\":\"\",\"bkg_contact_no\":\"9856321114\",\"bkg_country_code\":\"91\",\"bkg_user_email\":\"pujdfveloper@gmail.com\",\"bkg_user_fname\":\"fddsfdsf\",\"bkg_user_lname\":\"dfdsfds\",\"bkg_booking_type\":\"1\",\"multicityAutoComTot\":\"\",\"multicityAutoComData\":\"\",\"bkg_from_city_id\":\"30804\",\"bkg_to_city_id\":\"30726\",\"routeProcessed\":\"Agra - Ajmer  (One Way)\",\"baseamount\":\"5894\",\"isGozonow\":\"0\",\"bkg_from_city_id1\":\"30804\",\"bkg_to_city_id1\":\"30726\",\"bkg_pickup_date_date\":\"24\\\/10\\\/2024\",\"bkg_pickup_date_time\":\"06:00 PM\",\"bkg_return_date_date\":\"\",\"bkg_return_date_time\":\"\",\"bkg_pickup_address\":\"\",\"bkg_drop_address\":\"\",\"tot_est_dist\":\"375\",\"tot_est_dur\":\"420\",\"bkg_vehicle_type_id\":\"3\",\"cabNotSupported\":1,\"bkg_service_class\":\"1\",\"paymentChangesData\":\"\",\"bkg_surge_differentiate_amount\":\"0\",\"bkgPricefactor\":{\"surgeFactorUsed\":0,\"regularBaseAmount\":5266,\"additional_param\":\"{\\\"defMarkupCab\\\":5845,\\\"partnerMinimumBasePrice\\\":5543}\",\"partner_soldout\":0},\"agtBkgCategory\":null,\"bkg_vht_id\":\"\",\"bkg_trip_distance\":\"375\",\"bkg_trip_duration\":\"420\",\"bkg_addon_ids\":\"\",\"bkg_addon_cab\":\"\",\"bkg_chargeable_distance\":\"0\",\"bkg_gozo_base_amount\":\"5894\",\"bkg_rate_per_km_extra\":\"12.25\",\"bkg_rate_per_km\":\"10.55\",\"bkg_base_amount\":\"5894\",\"bkg_addon_charges\":\"0\",\"bkg_additional_charge_remark\":\"\",\"bkg_additional_charge\":\"0\",\"bkg_promo1_code\":\"\",\"bkg_discount_amount\":\"0\",\"bkg_quoted_vendor_amount\":\"5857\",\"bkg_vendor_amount\":\"5857\",\"bkg_night_pickup_included\":\"0\",\"bkg_night_drop_included\":\"1\",\"bkg_driver_allowance_amount\":\"250\",\"bkg_parking_charge\":\"0\",\"bkg_is_toll_tax_included\":\"1\",\"bkg_toll_tax\":\"395\",\"bkg_is_state_tax_included\":\"1\",\"bkg_state_tax\":\"250\",\"bkg_airport_entry_fee\":\"0\",\"bkg_convenience_charge\":\"0\",\"bkg_service_tax_rate\":\"5\",\"bkg_service_tax\":\"339\",\"bkg_total_amount\":\"7128\",\"bkg_is_warned\":\"\",\"scvId\":\"3\",\"BookingRoute\":[{\"brt_from_latitude\":\"\",\"brt_from_longitude\":\"\",\"brt_from_place_id\":\"\",\"brt_from_formatted_address\":\"\",\"brt_from_city_is_airport\":\"0\",\"brt_from_city_is_poi\":\"0\",\"brt_from_location\":\"\"},{\"brt_to_latitude\":\"\",\"brt_to_longitude\":\"\",\"brt_to_place_id\":\"\",\"brt_to_formatted_address\":\"\",\"brt_to_city_is_airport\":\"0\",\"brt_to_city_is_poi\":\"0\",\"brt_to_location\":\"\"}],\"multicityjsondata\":[{\"pickup_city\":\"30804\",\"drop_city\":\"30726\",\"pickup_address\":\"\",\"drop_address\":\"\",\"date\":\"2024-10-24 18:00:00\",\"distance\":\"375\",\"duration\":\"420\"}],\"bkg_chk_others\":\"0\",\"bkg_add_my_trip\":\"0\",\"fileImage\":\"\",\"bkg_invoice\":\"0\",\"bkg_trip_otp_required\":\"1\",\"bkg_driver_app_required\":\"1\",\"bkg_duty_slip_required\":\"0\",\"bkg_water_bottles_required\":\"0\",\"bkg_is_cash_required\":\"0\",\"bkg_pref_req_other\":\"\",\"bkg_tentative_booking\":\"0\",\"bkg_send_email\":\"1\",\"bkg_send_sms\":\"1\",\"bkg_spl_req_senior_citizen_trvl\":\"0\",\"bkg_spl_req_kids_trvl\":\"0\",\"bkg_spl_req_woman_trvl\":\"0\",\"bkg_spl_req_carrier\":\"0\",\"bkg_spl_req_driver_hindi_speaking\":\"0\",\"bkg_spl_req_driver_english_speaking\":\"0\",\"bkg_spl_req_other\":\"\",\"bkg_spl_req_lunch_break_time\":\"0\",\"bkg_info_source\":\"\",\"bkg_flight_no\":\"\",\"bkg_info_source_desc\":\"\",\"bkg_user_trip_type\":\"1\",\"bkg_no_person\":\"3\",\"bkg_num_large_bag\":\"0\",\"bkg_num_small_bag\":\"1\",\"locale_followup_date\":\"17\\\/10\\\/2024\",\"locale_followup_time\":\"04:07 PM\",\"bkg_quote_expire_date\":\"18\\\/10\\\/2024\",\"bkg_quote_expire_time_1\":\"10:30 AM\"}","Booking":{"bkg_instruction_to_driver_vendor":""},"BookingPref":{"bkg_pref_req_other":""}}
	RawBody: YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&jsonData_vendorIns=%7B%22trip_user%22%3A%221%22%2C%22username%22%3A%229856321114%22%2C%22bkg_contact_id%22%3A%22%22%2C%22bkg_user_id%22%3A%22%22%2C%22bkg_contact_no%22%3A%229856321114%22%2C%22bkg_country_code%22%3A%2291%22%2C%22bkg_user_email%22%3A%22pujdfveloper%40gmail.com%22%2C%22bkg_user_fname%22%3A%22fddsfdsf%22%2C%22bkg_user_lname%22%3A%22dfdsfds%22%2C%22bkg_booking_type%22%3A%221%22%2C%22multicityAutoComTot%22%3A%22%22%2C%22multicityAutoComData%22%3A%22%22%2C%22bkg_from_city_id%22%3A%2230804%22%2C%22bkg_to_city_id%22%3A%2230726%22%2C%22routeProcessed%22%3A%22Agra+-+Ajmer++(One+Way)%22%2C%22baseamount%22%3A%225894%22%2C%22isGozonow%22%3A%220%22%2C%22bkg_from_city_id1%22%3A%2230804%22%2C%22bkg_to_city_id1%22%3A%2230726%22%2C%22bkg_pickup_date_date%22%3A%2224%5C%2F10%5C%2F2024%22%2C%22bkg_pickup_date_time%22%3A%2206%3A00+PM%22%2C%22bkg_return_date_date%22%3A%22%22%2C%22bkg_return_date_time%22%3A%22%22%2C%22bkg_pickup_address%22%3A%22%22%2C%22bkg_drop_address%22%3A%22%22%2C%22tot_est_dist%22%3A%22375%22%2C%22tot_est_dur%22%3A%22420%22%2C%22bkg_vehicle_type_id%22%3A%223%22%2C%22cabNotSupported%22%3A1%2C%22bkg_service_class%22%3A%221%22%2C%22paymentChangesData%22%3A%22%22%2C%22bkg_surge_differentiate_amount%22%3A%220%22%2C%22bkgPricefactor%22%3A%7B%22surgeFactorUsed%22%3A0%2C%22regularBaseAmount%22%3A5266%2C%22additional_param%22%3A%22%7B%5C%22defMarkupCab%5C%22%3A5845%2C%5C%22partnerMinimumBasePrice%5C%22%3A5543%7D%22%2C%22partner_soldout%22%3A0%7D%2C%22agtBkgCategory%22%3Anull%2C%22bkg_vht_id%22%3A%22%22%2C%22bkg_trip_distance%22%3A%22375%22%2C%22bkg_trip_duration%22%3A%22420%22%2C%22bkg_addon_ids%22%3A%22%22%2C%22bkg_addon_cab%22%3A%22%22%2C%22bkg_chargeable_distance%22%3A%220%22%2C%22bkg_gozo_base_amount%22%3A%225894%22%2C%22bkg_rate_per_km_extra%22%3A%2212.25%22%2C%22bkg_rate_per_km%22%3A%2210.55%22%2C%22bkg_base_amount%22%3A%225894%22%2C%22bkg_addon_charges%22%3A%220%22%2C%22bkg_additional_charge_remark%22%3A%22%22%2C%22bkg_additional_charge%22%3A%220%22%2C%22bkg_promo1_code%22%3A%22%22%2C%22bkg_discount_amount%22%3A%220%22%2C%22bkg_quoted_vendor_amount%22%3A%225857%22%2C%22bkg_vendor_amount%22%3A%225857%22%2C%22bkg_night_pickup_included%22%3A%220%22%2C%22bkg_night_drop_included%22%3A%221%22%2C%22bkg_driver_allowance_amount%22%3A%22250%22%2C%22bkg_parking_charge%22%3A%220%22%2C%22bkg_is_toll_tax_included%22%3A%221%22%2C%22bkg_toll_tax%22%3A%22395%22%2C%22bkg_is_state_tax_included%22%3A%221%22%2C%22bkg_state_tax%22%3A%22250%22%2C%22bkg_airport_entry_fee%22%3A%220%22%2C%22bkg_convenience_charge%22%3A%220%22%2C%22bkg_service_tax_rate%22%3A%225%22%2C%22bkg_service_tax%22%3A%22339%22%2C%22bkg_total_amount%22%3A%227128%22%2C%22bkg_is_warned%22%3A%22%22%2C%22scvId%22%3A%223%22%2C%22BookingRoute%22%3A%5B%7B%22brt_from_latitude%22%3A%22%22%2C%22brt_from_longitude%22%3A%22%22%2C%22brt_from_place_id%22%3A%22%22%2C%22brt_from_formatted_address%22%3A%22%22%2C%22brt_from_city_is_airport%22%3A%220%22%2C%22brt_from_city_is_poi%22%3A%220%22%2C%22brt_from_location%22%3A%22%22%7D%2C%7B%22brt_to_latitude%22%3A%22%22%2C%22brt_to_longitude%22%3A%22%22%2C%22brt_to_place_id%22%3A%22%22%2C%22brt_to_formatted_address%22%3A%22%22%2C%22brt_to_city_is_airport%22%3A%220%22%2C%22brt_to_city_is_poi%22%3A%220%22%2C%22brt_to_location%22%3A%22%22%7D%5D%2C%22multicityjsondata%22%3A%5B%7B%22pickup_city%22%3A%2230804%22%2C%22drop_city%22%3A%2230726%22%2C%22pickup_address%22%3A%22%22%2C%22drop_address%22%3A%22%22%2C%22date%22%3A%222024-10-24+18%3A00%3A00%22%2C%22distance%22%3A%22375%22%2C%22duration%22%3A%22420%22%7D%5D%2C%22bkg_chk_others%22%3A%220%22%2C%22bkg_add_my_trip%22%3A%220%22%2C%22fileImage%22%3A%22%22%2C%22bkg_invoice%22%3A%220%22%2C%22bkg_trip_otp_required%22%3A%221%22%2C%22bkg_driver_app_required%22%3A%221%22%2C%22bkg_duty_slip_required%22%3A%220%22%2C%22bkg_water_bottles_required%22%3A%220%22%2C%22bkg_is_cash_required%22%3A%220%22%2C%22bkg_pref_req_other%22%3A%22%22%2C%22bkg_tentative_booking%22%3A%220%22%2C%22bkg_send_email%22%3A%221%22%2C%22bkg_send_sms%22%3A%221%22%2C%22bkg_spl_req_senior_citizen_trvl%22%3A%220%22%2C%22bkg_spl_req_kids_trvl%22%3A%220%22%2C%22bkg_spl_req_woman_trvl%22%3A%220%22%2C%22bkg_spl_req_carrier%22%3A%220%22%2C%22bkg_spl_req_driver_hindi_speaking%22%3A%220%22%2C%22bkg_spl_req_driver_english_speaking%22%3A%220%22%2C%22bkg_spl_req_other%22%3A%22%22%2C%22bkg_spl_req_lunch_break_time%22%3A%220%22%2C%22bkg_info_source%22%3A%22%22%2C%22bkg_flight_no%22%3A%22%22%2C%22bkg_info_source_desc%22%3A%22%22%2C%22bkg_user_trip_type%22%3A%221%22%2C%22bkg_no_person%22%3A%223%22%2C%22bkg_num_large_bag%22%3A%220%22%2C%22bkg_num_small_bag%22%3A%221%22%2C%22locale_followup_date%22%3A%2217%5C%2F10%5C%2F2024%22%2C%22locale_followup_time%22%3A%2204%3A07+PM%22%2C%22bkg_quote_expire_date%22%3A%2218%5C%2F10%5C%2F2024%22%2C%22bkg_quote_expire_time_1%22%3A%2210%3A30+AM%22%7D&Booking%5Bbkg_instruction_to_driver_vendor%5D=&BookingPref%5Bbkg_pref_req_other%5D=
	[UserID: 30] [UserType: 4]
2024/10/17 14:07:48 [profile] [profile.module.admin.controller.booking.create] [T: 4121.088] [M: 42535.76] [ET: 6.289/4079.921] [MU: 55.34/42535.65] 
	models.AccountTransDetails.saveAll
2024/10/17 14:07:48 [profile] [profile.module.admin.controller.booking.create] [T: 4121.135] [M: 42536.39] 
============================================================Profile models.AccountTransDetails.saveAll DONE==================================================
2024/10/17 14:07:48 [profile] [profile.module.admin.controller.booking.create] [T: 4123.419] [M: 42456.81] User Created and Linked
2024/10/17 14:07:48 [profile] [profile.module.admin.controller.booking.create] [T: 4127.498] [M: 42459.66] User Info Saved
2024/10/17 14:07:48 [profile] [profile.module.admin.controller.booking.create] [T: 4127.536] [M: 42460.11] BKG User Info Saved
2024/10/17 14:07:48 [profile] [profile.module.admin.controller.booking.create] [T: 4134.858] [M: 43252.04] Lead Converted to Booking
2024/10/17 14:07:48 [profile] [profile.module.admin.controller.booking.create] [T: 4137.126] [M: 43256.18] setBookingRouteInfo Saved
2024/10/17 14:07:48 [profile] [profile.module.admin.controller.booking.create] [T: 4165.508] [M: 44321.79] [ET: 0.461/4124.346] [MU: 1.53/44321.41] 
	SQL: SELECT
					MAX(date_add(brt_pickup_datetime,INTERVAL brt_trip_duration MINUTE)) drop_time,
					MIN(brt_pickup_datetime) pickup_time
					FROM booking_route
					WHERE brt_bkg_id IN(6) AND brt_active=1
					ORDER BY brt_pickup_datetime desc 
	 [params: []]
2024/10/17 14:07:48 [profile] [profile.module.admin.controller.booking.create] [T: 4210.26] [M: 44427.56] [ET: 0.653/4169.071] [MU: 6.17/44425.56] 
	SQL: SELECT bkg_regular_base_amount AS regular, 
				bkg_manual_base_amount AS manual,bkg_manual_surge_factor,
				bkg_ddbp_base_amount AS ddbp,
				bkg_dtbp_base_amount AS dtbp,bkg_dtbp_factor,								
                bkg_ddbp_surge_factor,
				bkg_profitability_base_amount  AS pb,
				bkg_profitability_surge_factor,
				bkg_dzpp_surge_factor,
				bkg_dzpp_base_amount,
				bkg_debp_surge_factor,
				bkg_debp_base_amount,
				bkg_durp_surge_factor,
				bkg_durp_base_amount,
				bkg_ddbpv2_base_amount,
				bkg_ddbpv2_surge_factor,
				bkg_ddsbp_base_amount,
				bkg_ddsbp_surge_factor,
				bkg_additional_param AS additionalParam,
				JSON_VALUE(booking_price_factor.bkg_additional_param,'$.srgManual.factor') AS srgManualFactor,
				JSON_VALUE(booking_price_factor.bkg_additional_param,'$.srgDZPP.factor') AS srgDZPPFactor,
				JSON_VALUE(booking_price_factor.bkg_additional_param,'$.srgDDBP.factor') AS srgDDBPFactor,
				JSON_VALUE(booking_price_factor.bkg_additional_param,'$.srgDEBP.factor') AS srgDEBPFactor,
				JSON_VALUE(booking_price_factor.bkg_additional_param,'$.srgDURP.factor') AS srgDURPFactor,
				JSON_VALUE(booking_price_factor.bkg_additional_param,'$.srgDDBPV2.factor') AS srgDDBPV2Factor,
				JSON_VALUE(booking_price_factor.bkg_additional_param,'$.srgDTBP.factor') AS srgDTBPFactor,
				JSON_VALUE(booking_price_factor.bkg_additional_param,'$.srgDTBP.surgeAmount') AS dtbpSurgeAmount,
				JSON_VALUE(booking_price_factor.bkg_additional_param,'$.srgDDSBP.factor') AS srgDDSBPFactor,
				(CASE bkg_surge_applied  WHEN 0 THEN 'R'  WHEN 1 THEN 'M'  WHEN 2 THEN 'DD'  WHEN 4 THEN 'DT'  WHEN 7 THEN 'DZ'  WHEN 8 THEN 'DUR'  WHEN 9 THEN 'DE'  WHEN 10 THEN 'DD(V2)'  WHEN 11 THEN 'DE+DD(V2)'  WHEN 12 THEN 'DDSBP'  ELSE '' END) AS QuoteFactor 
				FROM booking_price_factor WHERE  bpf_bkg_id =:bkgId 
	 [params: {"bkgId":"6"}]
2024/10/17 14:07:48 [profile] [profile.module.admin.controller.booking.create] [T: 4211.426] [M: 44421.41] BookingPriceFactor::getQuotedFactor
2024/10/17 14:07:48 [profile] [profile.module.admin.controller.booking.create] [T: 4211.496] [M: 44421.88] Promo Part Done
2024/10/17 14:07:48 [profile] [profile.module.admin.controller.booking.create] [T: 4291.89] [M: 44427.52] [ET: 0.739/4250.714] [MU: 2.54/44427.21] 
	SQL: SELECT GROUP_CONCAT(zct_zon_id) as zones FROM zone_cities 
						INNER JOIN zones ON zon_id=zct_zon_id AND zon_active=1
						WHERE zct_cty_id=:city AND zct_active=1 
	 [params: {":city":"30804"}]
2024/10/17 14:07:48 [profile] [profile.module.admin.controller.booking.create] [T: 4321.877] [M: 44453.98] [ET: 29.815/4280.682] [MU: 23.64/44452.73] 
	SQL:  SELECT scv_id,scc_id, vct_id, scc_cancel_rule, scc_label,scc_rank, scv_label, scv_code, scc_model_year, 
								CONCAT(vct_label, ' (', scc_label , ')') label,
									vct_label,vct_rank, vct_desc, CONCAT(vct_label, ' ', vct_desc) vhcName, 
									vct_capacity, IF(vct_image IS NULL, 'images/cabs/no-image.png', vct_image) as vct_image, vct_big_bag_capacity, vct_small_bag_capacity, vcsc_small_bag, FLOOR(vcsc_small_bag/2) AS big_bag,
									scc_is_cng, scc_is_petrol_diesel, scc_id, scc_desc, IF( vct_id IN(5, 6), '1', '0' ) AS is_assured, scv_vct_id,scv_parent_id,scv_vct_id,scv_model,scv_scc_id
						FROM svc_class_vhc_cat
						INNER JOIN service_class ON scc_id = scv_scc_id
						INNER JOIN vehicle_category ON vct_id = scv_vct_id
						INNER JOIN vehicle_cat_svc_class on vcsc_ssc_id = scv_scc_id AND vcsc_vct_id = scv_vct_id
						WHERE scv_active = 1 
							AND scc_active = 1 
						AND vct_active = 1
		 AND scv_id = 3 
	 [params: []]
2024/10/17 14:07:48 [profile] [profile.module.admin.controller.booking.create] [T: 4335.178] [M: 45078.2] [ET: 3.638/4293.976] [MU: 2.34/45077.83] 
	SQL: SELECT dzs_zone_type FROM dynamic_zone_surge WHERE dzs_fromzoneid IN (:gp2) AND dzs_tozoneid IN (:gp3,:gp4,:gp5) AND dzs_scv_id=:cab AND dzs_booking_type=:tripType  ORDER BY  dzs_zone_type ASC 
	 [params: {":gp3":"385",":gp4":"852",":gp5":"980",":gp2":"31","cab":"3","tripType":"1"}]
2024/10/17 14:07:48 [profile] [profile.module.admin.controller.booking.create] [T: 4341.601] [M: 45080.3] [ET: 5.818/4300.436] [MU: 1.24/45079.67] 
	SQL: SELECT prc_cancel_rule_id FROM `partner_cancel_rule` 
			WHERE (prc_zone_category = :zoneType OR prc_zone_category IS NULL)
		AND (prc_scc_id = :sccId OR prc_scc_id IS NULL)
		AND (prc_partner_id = :partnerId OR prc_partner_id IS NULL) 
		AND (prc_bkg_type = :tripType OR prc_bkg_type IS NULL) 
		 AND (prc_is_gozonow IS NULL) 
		AND prc_active=1  
		ORDER BY prc_partner_id DESC, prc_bkg_type DESC  
	 [params: {"zoneType":1,"sccId":"1","partnerId":null,"tripType":"1"}]
2024/10/17 14:07:48 [profile] [profile.module.admin.controller.booking.create] [T: 4354.45] [M: 45095.55] Cancellation Policy
2024/10/17 14:07:48 [profile] [profile.module.admin.controller.booking.create] [T: 4361.632] [M: 45098.66] Booking Saved
2024/10/17 14:07:48 [profile] [profile.module.admin.controller.booking.create] [T: 4386.072] [M: 45141.97] Booking Other Models Saved
2024/10/17 14:07:48 [profile] [profile.module.admin.controller.booking.create] [T: 4435.623] [M: 45259.2] Agent booking assignment test 1:	
2024/10/17 14:07:48 [profile] [profile.module.admin.controller.booking.create] [T: 4451.563] [M: 45799.59] [ET: 3765.936/4410.403] [MU: 18212.79/45799.5] 
	DBUtil::Transaction
2024/10/17 14:07:48 [profile] [profile.module.admin.controller.booking.create] [T: 4453.615] [M: 45874.33] [ET: 0.496/4412.44] [MU: 0.93/45874.02] 
	SQL: select bkg_id FROM booking bkg INNER JOIN booking_trail bkgTrail ON bkgTrail.btr_bkg_id = bkg.bkg_id WHERE 1
 			    AND bkgTrail.bkg_tags IS NOT NULL AND CONCAT(',', bkg_tags , ',') REGEXP ',(3),'  AND bkg.bkg_id = 6 
	 [params: []]
2024/10/17 14:07:48 [profile] [profile.module.admin.controller.booking.create] [T: 4454.039] [M: 45875.88] [ET: 0.34/4412.865] [MU: 0.93/45875.56] 
	SQL: select bkg_id FROM booking bkg INNER JOIN booking_trail bkgTrail ON bkgTrail.btr_bkg_id = bkg.bkg_id WHERE 1
 			    AND bkgTrail.bkg_tags IS NOT NULL AND CONCAT(',', bkg_tags , ',') REGEXP ',(2),'  AND bkg.bkg_id = 6 
	 [params: []]
2024/10/17 14:07:48 [profile] [profile.module.admin.controller.booking.create] [T: 4467.948] [M: 45936.63] [ET: 10.077/4426.767] [MU: 1.24/45936] 
	SQL: SELECT ucm_id,ucm_label,ucm_cash_trip_types,ucm_rel_manager,ucm_gozocoin_percent,ucm_coins 
					FROM contact_profile cp 
				INNER JOIN contact ON ctt_id = cp.cr_contact_id AND ctt_active = 1
				INNER JOIN contact_pref cpr ON cp.cr_contact_id = cpr.cpr_ctt_id 
				INNER JOIN user_category_master ucm ON ucm.ucm_id = cpr.cpr_category 
				WHERE cp.cr_status = 1 AND cp.cr_is_consumer = :user AND ucm_active = 1 
	 [params: {"user":"3"}]
2024/10/17 14:07:48 [profile] [profile.module.admin.controller.booking.create] [T: 4468.797] [M: 44813.59] [ET: 0.398/4427.62] [MU: 0.91/44813.43] 
	SQL: SELECT CalcWorkingMinutes(NOW(), '2024-10-24 18:00:00') FROM dual 
	 [params: []]
2024/10/17 14:07:48 [profile] [profile.module.admin.controller.booking.create] [T: 4469.647] [M: 44815.84] [ET: 0.256/4428.47] [MU: 0.93/44815.65] 
	SQL: SELECT CalcWorkingMinutes('2024-10-17 17:07:48', '2024-10-24 18:00:00') FROM dual 
	 [params: []]
2024/10/17 14:07:48 [profile] [profile.module.admin.controller.booking.create] [T: 4496.517] [M: 46189.45] [ET: 0.431/4455.344] [MU: 0.84/46189.27] 
	SQL: SELECT bkg_id FROM booking WHERE bkg_booking_id =:bkgId OR bkg_id=:bkgId  
	 [params: {"bkgId":"6"}]
2024/10/17 14:07:48 [profile] [profile.module.admin.controller.booking.create] [T: 4502.302] [M: 46206.45] [ET: 4.412/4461.12] [MU: 1/46206.14] 
	SQL: SELECT count(distinct scq_id)
					FROM service_call_queue
					WHERE scq_follow_up_queue_type = :refType 
					AND scq_follow_up_date_time<=NOW() AND scq_status IN (1,3) 
	 [params: {"refType":7}]
2024/10/17 14:07:48 [profile] [profile.module.admin.controller.booking.create] [T: 4509.929] [M: 46259.95] [ET: 5.531/4468.745] [MU: 0.87/46259.7] 
	SQL: SELECT tqm_tea_id FROM `team_queue_mapping` WHERE `tqm_active` = 1 AND tqm_queue_id=:refTypeId ORDER BY `tqm_priority` ASC LIMIT 0,1  
	 [params: {"refTypeId":7}]
2024/10/17 14:07:48 [profile] [profile.module.admin.controller.booking.create] [T: 4517.37] [M: 46267.16] [ET: 5.152/4476.194] [MU: 2.27/46265.41] 
	SQL: SELECT
					COUNT(DISTINCT  adm_id) as cnt
					FROM admins adm
					JOIN `admin_profiles` adp ON adp.adp_adm_id = adm.adm_id AND  adm.adm_active=1
					JOIN
					(
						SELECT  ado_admin_id, ado_status, ado_time
						FROM `admin_onoff`
						WHERE 1 AND ado_status = 1 AND
						ado_time > DATE_SUB(NOW(),INTERVAL :duration HOUR)
						GROUP BY ado_admin_id
						ORDER BY ado_time desc
					) aadmin_onoff on aadmin_onoff.ado_admin_id = adm.adm_id
					 JOIN
					(
						SELECT
						admin_profiles.adp_adm_id,
						JSON_UNQUOTE(JSON_EXTRACT(admin_profiles.adp_cdt_id, CONCAT("$[", pseudo_rows.row, "].cdtWeight"))) AS cdtWeight,
						JSON_UNQUOTE(JSON_EXTRACT(admin_profiles.adp_cdt_id, CONCAT("$[", pseudo_rows.row, "].cdtId"))) AS cdtId
						FROM admin_profiles
						JOIN pseudo_rows
						WHERE 1
						HAVING cdtId IS NOT NULL
					) temp ON temp.adp_adm_id=adp.adp_adm_id
					JOIN `cat_depart_team_map` cdt  ON temp.cdtId=cdt.cdt_id
					JOIN teams ON cdt.cdt_tea_id = teams.tea_id
					WHERE  teams.tea_id =:teamid
					AND
					(
						(tea_start_time IS NULL AND tea_stop_time IS NULL)
							OR
						(tea_start_time < tea_stop_time AND CURRENT_TIME() BETWEEN tea_start_time AND tea_stop_time)
							OR
						(tea_stop_time < tea_start_time AND CURRENT_TIME() < tea_start_time AND CURRENT_TIME() < tea_stop_time)
							OR
						(tea_stop_time < tea_start_time AND CURRENT_TIME() > tea_start_time)
					)
					ORDER BY temp.cdtWeight ASC LIMIT 0,1 
	 [params: {"teamid":false,"duration":4}]
2024/10/17 14:07:48 [profile] [profile.module.admin.controller.booking.create] [T: 4517.972] [M: 46267.42] [ET: 0.518/4476.816] [MU: 1.09/46267.05] 
	SQL: SELECT
					COUNT(DISTINCT scq_assigned_uid)
					FROM  service_call_queue
					WHERE  scq_follow_up_queue_type = :refType AND scq_active=1  AND scq_status IN (1,3) AND scq_follow_up_date_time > DATE_SUB(NOW(),INTERVAL :duration HOUR) 
	 [params: {"refType":7,"duration":4}]
2024/10/17 14:07:48 [profile] [profile.module.admin.controller.booking.create] [T: 4518.353] [M: 46268.77] [ET: 0.285/4477.199] [MU: 0.93/46268.45] 
	SQL: select bkg_id FROM booking bkg INNER JOIN booking_trail bkgTrail ON bkgTrail.btr_bkg_id = bkg.bkg_id WHERE 1
 			    AND bkgTrail.bkg_tags IS NOT NULL AND CONCAT(',', bkg_tags , ',') REGEXP ',(3),'  AND bkg.bkg_id = 6 
	 [params: []]
2024/10/17 14:07:48 [profile] [profile.module.admin.controller.booking.create] [T: 4518.631] [M: 46270.31] [ET: 0.224/4477.479] [MU: 0.93/46270] 
	SQL: select bkg_id FROM booking bkg INNER JOIN booking_trail bkgTrail ON bkgTrail.btr_bkg_id = bkg.bkg_id WHERE 1
 			    AND bkgTrail.bkg_tags IS NOT NULL AND CONCAT(',', bkg_tags , ',') REGEXP ',(2),'  AND bkg.bkg_id = 6 
	 [params: []]
2024/10/17 14:07:48 [profile] [profile.module.admin.controller.booking.create] [T: 4528.527] [M: 46299.22] [ET: 0.374/4487.371] [MU: 0.99/46298.91] 
	SQL: SELECT GROUP_CONCAT(tqm.tqm_tea_id) teamIds FROM `service_call_queue` scq
			INNER JOIN team_queue_mapping tqm ON
			tqm.tqm_queue_id=scq.scq_follow_up_queue_type
			AND tqm.tqm_active = 1
			WHERE `scq_id` = :scqId 
	 [params: {"scqId":"4"}]
2024/10/17 14:07:48 [profile] [profile.module.admin.controller.booking.create] [T: 4528.86] [M: 46300.83] [ET: 0.265/4487.707] [MU: 0.99/46300.52] 
	SQL: SELECT GROUP_CONCAT(tqm.tqm_tea_id) teamIds FROM `service_call_queue` scq
			INNER JOIN team_queue_mapping tqm ON
			tqm.tqm_queue_id=scq.scq_follow_up_queue_type
			AND tqm.tqm_active = 1
			WHERE `scq_id` = :scqId 
	 [params: {"scqId":"4"}]
2024/10/17 14:07:48 [profile] [profile.module.admin.controller.booking.create] [T: 4529.298] [M: 46303.39] [ET: 0.364/4488.132] [MU: 1.63/46302.89] 
	SQL: SELECT COUNT(DISTINCT scq_assigned_uid) countCSR, COUNT(DISTINCT scq_id) countClosedCalls
				FROM  service_call_queue
				WHERE  scq_to_be_followed_up_by_id = :teamId 
					AND	scq_to_be_followed_up_by_type=1 
					AND scq_active=1 AND scq_status IN (2) 
					AND scq_follow_up_date_time > DATE_SUB(NOW(),INTERVAL :duration HOUR) 
	 [params: {"teamId":null,"duration":1}]
2024/10/24 00:00:43 [profile] [profile.module.admin.controller.booking.create] [T: 603.416] [M: 9522.7] 
------------------------------------------------------module.admin.controller.booking.create ACTION START------------------------------------------------------
	URL: [GET]/aaohome/booking/create
	User IP: 192.168.255.12
	[UserID: 30] [UserType: 4]
2024/10/24 00:00:43 [profile] [profile.module.admin.controller.booking.create] [T: 660.274] [M: 10758.97] setLocationRequest start
2024/10/24 00:00:43 [profile] [profile.module.admin.controller.booking.create] [T: 753.394] [M: 10759.48] setLocationRequest ends
2024/10/24 00:00:45 [profile] [profile.module.admin.controller.booking.create] [T: 2970.985] [M: 20771.23] [ET: 1.064/2853.796] [MU: 2/20769.73] 
	SQL: SELECT  teams.tea_id 
					FROM   admins adm
					LEFT JOIN `admin_profiles` adp ON adp.adp_adm_id = adm.adm_id
					LEFT JOIN
					(
						SELECT 
						admin_profiles.adp_adm_id,
						JSON_UNQUOTE(JSON_EXTRACT(admin_profiles.adp_cdt_id, CONCAT('$[', pseudo_rows.row, '].cdtWeight'))) AS cdtWeight,
						JSON_UNQUOTE(JSON_EXTRACT(admin_profiles.adp_cdt_id, CONCAT('$[', pseudo_rows.row, '].cdtId'))) AS cdtId
						FROM admin_profiles
						JOIN pseudo_rows
						WHERE 1 AND  adp_adm_id = :admId
						HAVING cdtId IS NOT NULL
					) temp ON temp.adp_adm_id=adp.adp_adm_id
					LEFT JOIN `cat_depart_team_map` cdt  ON temp.cdtId=cdt.cdt_id
					LEFT JOIN teams ON cdt.cdt_tea_id = teams.tea_id								   
					WHERE  adm_id = :admId
					AND
					( 
						(tea_start_time IS NULL AND tea_stop_time IS NULL)
							OR           
						(tea_start_time < tea_stop_time AND CURRENT_TIME() BETWEEN tea_start_time AND tea_stop_time)
							OR
						(tea_stop_time < tea_start_time AND CURRENT_TIME() < tea_start_time AND CURRENT_TIME() < tea_stop_time)
							OR
						(tea_stop_time < tea_start_time AND CURRENT_TIME() > tea_start_time)
					)
					ORDER BY temp.cdtWeight  ASC LIMIT 0,1 
	 [params: {"admId":"30"}]
2024/10/24 00:00:45 [profile] [profile.module.admin.controller.booking.create] [T: 2971.563] [M: 20772.3] [ET: 0.488/2854.405] [MU: 1.2/20771.87] 
	SQL: SELECT  COUNT(*) as active_cbr_count_byId FROM `service_call_queue`
					WHERE 1 AND scq_status IN (1,3) AND scq_follow_up_queue_type=9
					AND scq_create_date >='2021-01-01 00:00:00'
					AND scq_active=1
				    AND scq_follow_up_date_time  < DATE_ADD(NOW(),INTERVAL 24 HOUR) AND scq_to_be_followed_up_by_id = :team_id 
	 [params: {"team_id":null}]
2024/10/24 00:00:45 [profile] [profile.module.admin.controller.booking.create] [T: 2971.928] [M: 20774.32] [ET: 0.256/2854.773] [MU: 1.15/20773.82] 
	SQL: SELECT  COUNT(*) as active_cbr_count_byId FROM `service_call_queue`
					WHERE 1 AND scq_status IN (1,3)  AND scq_follow_up_queue_type=9
					 AND scq_create_date >='2021-01-01 00:00:00'
					 AND scq_active=1
				   AND scq_follow_up_date_time  < DATE_ADD(NOW(),INTERVAL 24 HOUR) AND scq_to_be_followed_up_by_id = :adm_id AND scq_to_be_followed_up_by_type=2 
	 [params: {"adm_id":"30"}]
2024/10/24 00:00:45 [profile] [profile.module.admin.controller.booking.create] [T: 2997.319] [M: 21114.32] [ET: 0.841/2880.135] [MU: 1.99/21113.07] 
	SQL: SELECT cdt.cdt_id
			FROM admins adm
			LEFT JOIN `admin_profiles` adp ON adp.adp_adm_id = adm.adm_id
			LEFT JOIN
			(
				SELECT 
				admin_profiles.adp_adm_id,
				JSON_UNQUOTE(JSON_EXTRACT(admin_profiles.adp_cdt_id, CONCAT('$[', pseudo_rows.row, '].cdtWeight'))) AS cdtWeight,
				JSON_UNQUOTE(JSON_EXTRACT(admin_profiles.adp_cdt_id, CONCAT('$[', pseudo_rows.row, '].cdtId'))) AS cdtId
				FROM admin_profiles
				JOIN pseudo_rows
				WHERE 1
				HAVING cdtId IS NOT NULL
			) temp ON temp.adp_adm_id=adp.adp_adm_id
			LEFT JOIN `cat_depart_team_map` cdt  ON temp.cdtId=cdt.cdt_id
			LEFT JOIN teams ON cdt.cdt_tea_id = teams.tea_id
			WHERE cdt.cdt_id IN (:gp0)
			AND
			(
				(tea_start_time IS NULL AND tea_stop_time IS NULL)
				OR
				(tea_start_time < tea_stop_time AND CURRENT_TIME() BETWEEN tea_start_time AND tea_stop_time)
				OR
				(tea_stop_time < tea_start_time AND CURRENT_TIME() < tea_start_time AND CURRENT_TIME() < tea_stop_time)
				OR
				(tea_stop_time < tea_start_time AND CURRENT_TIME() > tea_start_time)
			)
			ORDER BY temp.cdtWeight ASC LIMIT 0,1 
	 [params: {":gp0":"1"}]
2024/10/24 00:00:45 [profile] [profile.module.admin.controller.booking.create] [T: 3120.422] [M: 21477.02] [ET: 2516.904/3003.245] [MU: 11952.77/21476.89] 
	module.admin.controller.booking.create
2024/10/24 00:00:45 [profile] [profile.module.admin.controller.booking.create] [T: 3120.468] [M: 21477.14] 
*******************************************************module.admin.controller.booking.create ACTION DONE****************************************************************
2024/10/24 00:01:48 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 105.598] [M: 10045.56] 
------------------------------------------------------module.admin.controller.booking.getamountbyvehicle ACTION START------------------------------------------------------
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.255.12
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"3","tripDistance":"","tripDuration":"","multiCityData":"","bookingType":"1","pickupAddress":"","pickupDate":"24\/10\/2024","pickupTime":"04:00 AM","isGozonow":"0","minTripDistance":"0","sccId":"0","tripUser":"1","YII_CSRF_TOKEN":"N3VxRE1WeG9UeHk5UWFBUFpPT216eWVyY0xWTVpoTkcUoJ2aBoup1fU2M5E4ePVZVcUNlKiYZZysUqEklNiKWw==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=3&tripDistance=&tripDuration=&multiCityData=&bookingType=1&pickupAddress=&pickupDate=24%2F10%2F2024&pickupTime=04%3A00+AM&isGozonow=0&minTripDistance=0&sccId=0&tripUser=1&YII_CSRF_TOKEN=N3VxRE1WeG9UeHk5UWFBUFpPT216eWVyY0xWTVpoTkcUoJ2aBoup1fU2M5E4ePVZVcUNlKiYZZysUqEklNiKWw%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/24 00:01:48 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 167.136] [M: 11281.77] setLocationRequest start
2024/10/24 00:01:48 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 261.693] [M: 11282.27] setLocationRequest ends
2024/10/24 00:01:48 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 352.244] [M: 18107.7] [ET: 10.897/318.239] [MU: 0.84/18107.52] 
	SQL: SELECT COUNT(1) as cnt FROM cities WHERE cty_active=1 AND cty_service_active=1 AND cty_id=30804 
	 [params: []]
2024/10/24 00:01:48 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 354.511] [M: 18109] [ET: 2.154/320.507] [MU: 0.84/18108.81] 
	SQL: SELECT COUNT(1) as cnt FROM cities WHERE cty_active=1 AND cty_service_active=1 AND cty_id=30711 
	 [params: []]
2024/10/24 00:01:49 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 434.257] [M: 18592.26] [ET: 79.651/400.25] [MU: 483.16/18592.15] 
	BookingRoute::calculateDistance
2024/10/24 00:01:49 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 434.914] [M: 18589.55] [ET: 0.22/400.938] [MU: 1.24/18589.44] 
	BookingRoute::calculateDistance
2024/10/24 00:01:49 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 434.967] [M: 18589.34] [ET: 131.099/400.993] [MU: 5974.33/18589.25] 
	validateRoutes
2024/10/24 00:01:49 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 446.502] [M: 18822.49] [ET: 9.56/412.494] [MU: 27.1/18822.27] 
	SQL: SELECT scv_id FROM svc_class_vhc_cat WHERE scv_active = 1 AND scv_scc_id IN (1,2,4,6) ORDER BY scv_vct_id ASC,scv_scc_id ASC 
	 [params: []]
2024/10/24 00:01:49 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 459.706] [M: 18810.1] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.Quote.getQuote START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.255.12
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"3","tripDistance":"","tripDuration":"","multiCityData":"","bookingType":"1","pickupAddress":"","pickupDate":"24\/10\/2024","pickupTime":"04:00 AM","isGozonow":"0","minTripDistance":"0","sccId":"0","tripUser":"1","YII_CSRF_TOKEN":"N3VxRE1WeG9UeHk5UWFBUFpPT216eWVyY0xWTVpoTkcUoJ2aBoup1fU2M5E4ePVZVcUNlKiYZZysUqEklNiKWw==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=3&tripDistance=&tripDuration=&multiCityData=&bookingType=1&pickupAddress=&pickupDate=24%2F10%2F2024&pickupTime=04%3A00+AM&isGozonow=0&minTripDistance=0&sccId=0&tripUser=1&YII_CSRF_TOKEN=N3VxRE1WeG9UeHk5UWFBUFpPT216eWVyY0xWTVpoTkcUoJ2aBoup1fU2M5E4ePVZVcUNlKiYZZysUqEklNiKWw%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/24 00:01:49 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 592.408] [M: 19261.87] [ET: 10.828/558.38] [MU: 1.89/19261.55] 
	SQL: SELECT GROUP_CONCAT(zct_zon_id) as zones FROM zone_cities 
						INNER JOIN zones ON zon_id=zct_zon_id AND zon_active=1
						WHERE zct_cty_id=:city AND zct_active=1 
	 [params: {":city":"30804"}]
2024/10/24 00:01:49 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 681.97] [M: 19674.77] [ET: 2.777/647.98] [MU: 2.85/19674.34] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:01:49 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 685.604] [M: 19679.23] [ET: 3.508/651.573] [MU: 2.84/19678.79] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30711"}]
2024/10/24 00:01:49 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 686.39] [M: 19681.27] [ET: 0.658/652.385] [MU: 0.9/19681.05] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/24 00:01:49 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 730.968] [M: 19732.43] [ET: 44.383/696.938] [MU: 43.61/19730.93] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (100) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30711) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp0)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp3,:gp4)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp1,:gp2)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp5,:gp6))
			OR (scr_area_type = 5 AND scr_area_id IN (3699))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (3)
		ORDER BY rank DESC
		 
	 [params: {":gp0":"31",":gp1":"30804",":gp2":"30711",":gp3":"105",":gp4":"100",":gp5":"1",":gp6":"1","tripType":"1"}]
2024/10/24 00:01:49 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 828.791] [M: 19782.85] [ET: 18.764/794.788] [MU: 0.84/19782.66] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/24 00:01:49 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 872.926] [M: 19785.14] [ET: 44.013/838.937] [MU: 0.96/19784.83] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"1"}]
2024/10/24 00:01:49 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 952.675] [M: 19925.74] [ET: 6.511/918.684] [MU: 3.45/19924.87] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30711"}]
2024/10/24 00:01:49 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1025.339] [M: 20090.66] [ET: 7.231/991.351] [MU: 0.87/20090.44] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":0}]
2024/10/24 00:01:49 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1053.806] [M: 20212.67] [ET: 0.664/1019.824] [MU: 3.02/20212.23] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:01:49 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1070.765] [M: 20247.75] [ET: 16.801/1036.73] [MU: 28.99/20247.13] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp8)) OR (apr_area_type = 2 AND apr_area_id IN (:gp9)) OR (apr_area_type = 4 AND apr_area_id IN (:gp10)) OR (apr_area_type = 1 AND apr_area_id IN (:gp7))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp7":"31",":gp8":"30804",":gp9":"105",":gp10":"1","cab":"3"}]
2024/10/24 00:01:52 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 3806.536] [M: 20322.68] [ET: 2706.024/3772.529] [MU: 0.74/20314.68] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"nearest_route_30804_30711","sql":"(INDEX indx_nearest_rt_rutid (rut_id)) \r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, routeFrom.rut_name as fromAlias, \r\n\t\t\t\tNULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, \r\n\t\t\t\t0 as rank, routeFrom.rut_estm_time as startTime, 0 as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 \r\n\t\t\t\tAND routeFrom.rut_from_city_id<>routeFrom.rut_to_city_id AND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\t\tAND (routeAlias.rut_to_city_id=route.rut_to_city_id) AND routeAlias.rut_active = 1 \r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, NULL, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) \r\n\t\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\t0 AS extraStartDistance, 0, 0 as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND route.rut_from_city_id = 30804 AND route.rut_to_city_id=30711 \r\n\t\t\t\tAND routeTo.rut_from_city_id=30711\r\n\t\t\t\tAND route.rut_active = 1 AND routeTo.rut_active = 1 AND routeTo.rut_estm_distance < 50 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = route.rut_from_city_id) \r\n\t\t\t   AND (routeAlias.rut_to_city_id = routeTo.rut_to_city_id) AND routeAlias.rut_active = 1 \r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, \r\n\t\t\t\trouteFrom.rut_name, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t+ IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) \r\n\t\t\t\tAS extraDistance, IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, 0, \r\n\t\t\t\trouteFrom.rut_estm_time as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 AND routeFrom.rut_from_city_id <> routeFrom.rut_to_city_id\r\n\t\t\t\t\tAND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND routeTo.rut_estm_distance < 50 \r\n\t\t\t\t\tAND routeTo.rut_from_city_id=30711 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\tAND (routeAlias.rut_to_city_id=routeTo.rut_to_city_id) AND routeAlias.rut_active = 1 AND routeAlias.rut_from_city_id=30804 "}]
2024/10/24 00:01:52 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 3806.937] [M: 20332.55] [ET: 0.326/3772.956] [MU: 0.88/20332.39] 
	SQL: SELECT GROUP_CONCAT(rut_id) as rutIds FROM nearest_route_30804_30711 
	 [params: []]
2024/10/24 00:01:52 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 3814.576] [M: 20330.57] [ET: 5.744/3780.57] [MU: 2.78/20330.13] 
	SQL: SELECT *, (rte_vendor_amount + extraDistance * 10.55) as totalCost FROM (SELECT * FROM nearest_route_30804_30711) a
					INNER JOIN rate ON a.rut_id = rate.rte_route_id AND rte_status=1 AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <>0
					WHERE 1 ORDER BY rank DESC, totalCost ASC LIMIT 0,1 
	 [params: {"cabType":"3"}]
2024/10/24 00:02:01 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 12970.534] [M: 20338.59] [ET: 9155.803/12936.535] [MU: 0.75/20336.59] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"getNearestRoute_30804_30711_70","sql":"(INDEX getNearestRoute_30804_30711_70_index_rut_id (rut_id))\r\n\t\t\t\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id AS start, routeAlias.rut_to_city_id AS end,\r\n\t\t\t\t\t\t\t\trouteFrom.rut_name AS fromAlias, NULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance AS quotedDistance,\r\n\t\t\t\t\t\t\t\trouteAlias.rut_estm_distance AS rateDistance, \r\n\t\t\t\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance)\r\n\t\t\t\t\t\t\t\t\t - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance,\r\n\t\t\t\t\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance,\r\n\t\t\t\t\t\t\t\t0 AS rank, routeFrom.rut_estm_time AS startTime, 0 AS endTime, route.rut_estm_time, \r\n\t\t\t\t\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraTravelDistance\r\n\t\t\t\t\t\tFROM   route\r\n\t\t\t\t\t\tINNER JOIN route routeTo ON routeTo.rut_to_city_id=route.rut_from_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_from_city_id=30804 AND routeTo.rut_active=1\r\n\t\t\t\t\t\t\t\tAND routeTo.rut_estm_distance<70 AND route.rut_active=1\r\n\t\t\t\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_from_city_id=route.rut_to_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_active = 1\r\n\t\t\t\t\t\t\t\tAND routeFrom.rut_estm_distance<70 AND route.rut_active = 1\r\n\t\t\t\t\t\tINNER JOIN route routeAlias ON routeAlias.rut_to_city_id=routeFrom.rut_to_city_id\r\n\t\t\t\t\t\t\tAND routeAlias.rut_from_city_id=routeTo.rut_from_city_id AND routeAlias.rut_active = 1"}]
2024/10/24 00:02:01 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 12976.156] [M: 20343.91] [ET: 5.504/12942.145] [MU: 2.46/20343.28] 
	SQL: SELECT *, (rte_vendor_amount + extradistance * 10.55 ) AS totalCost, 
						ABS(quotedDistance-rateDistance) AS extraChargeableDistance
					FROM getNearestRoute_30804_30711_70 a
					INNER JOIN rate ON a.rut_id=rate.rte_route_id AND rte_status=1 
						AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <> 0
					WHERE  1
					ORDER  BY rank DESC, extraStartDistance, extraChargeableDistance ASC, totalcost ASC
					LIMIT  0, 1 
	 [params: {"cabType":"3"}]
2024/10/24 00:02:01 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 12984.097] [M: 20352.13] [ET: 12038.74/12950.118] [MU: 434.26/20351.97] 
	Quote::calculateOneWay  for CAB 3 Date: 2024-10-24 04:00:00
2024/10/24 00:02:01 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 13050.867] [M: 20420.99] [ET: 66.645/13016.861] [MU: 2.18/20420.74] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/24 00:02:01 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 13054.545] [M: 20433.57] [ET: 0.637/13020.561] [MU: 3.02/20433.13] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:01 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 13055.251] [M: 20465.35] [ET: 0.594/13021.264] [MU: 25.26/20464.6] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp13)) OR (apr_area_type = 5 AND apr_area_id IN (:gp11)) OR (apr_area_type = 2 AND apr_area_id IN (:gp14)) OR (apr_area_type = 4 AND apr_area_id IN (:gp15)) OR (apr_area_type = 1 AND apr_area_id IN (:gp12))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp11":"3699",":gp12":"31",":gp13":"30804",":gp14":"105",":gp15":"1","cab":"3"}]
2024/10/24 00:02:01 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 13056.199] [M: 20447.2] [ET: 0.224/13022.224] [MU: 2.98/20447.09] 
	BookingRoute::calculateDistance
2024/10/24 00:02:01 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 13089.596] [M: 20481.8] [ET: 4.572/13055.573] [MU: 2.65/20481.18] 
	SQL: SELECT 
						fc.cty_id as c2id, 
						fc.cty_name as c2name, 
						fc.cty_garage_address as c2address,
						tc.cty_id as c4id,
						tc.cty_name as c4name, tc.cty_garage_address as c4address,
						0 as totalExtraDistance FROM route
						INNER JOIN cities fc ON rut_from_city_id=fc.cty_id
						INNER JOIN cities tc ON rut_to_city_id=tc.cty_id
						INNER JOIN rate on  rate.rte_route_id=route.rut_id  AND rate.rte_vehicletype_id IN (3)
						WHERE route.rut_from_city_id=30804 AND route.rut_to_city_id=30711 AND route.rut_active=1 
	 [params: []]
2024/10/24 00:02:03 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15317.341] [M: 20495.07] [ET: 2227.575/15283.296] [MU: 5.91/20493.07] 
	SQL: 
				SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address, tc.cty_id as c4id, 
				tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
					FROM
					 (
						(
							SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id,  
								r3.rut_to_city_id, route.rut_name , route.rut_id,
								(route.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, 
								r3.rut_estm_distance
							FROM route
							INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_from_city_id=30804  
									AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=route.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) 
									AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
						UNION
						(
							SELECT r3.rut_id, r3.rut_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,(route.rut_estm_distance + r1.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
							FROM route
							INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND  route.rut_to_city_id=30711 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND route.rut_to_city_id=r3.rut_to_city_id))	AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
                     ) a
					INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
					INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1 
	 [params: []]
2024/10/24 00:02:06 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 18117.183] [M: 20504.96] [ET: 2799.705/18083.172] [MU: 4.41/20503.46] 
	SQL: SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
                              tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
                        FROM (SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,
                                    (route.rut_estm_distance + r1.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
                                FROM route
								INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
								INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
								INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) AND r3.rut_active=1 
								INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3) LIMIT 1
							)a
                        INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
                        INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1
                         
	 [params: []]
2024/10/24 00:02:07 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 18820.437] [M: 20511.34] [ET: 703.12/18786.437] [MU: 0.74/20510.46] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"GarageRoute_30804_30711","sql":" (INDEX GarageRoute_30804_30711_index_rut_id (rut_id), INDEX GarageRoute_30804_30711_index_rut_from_city_id (rut_from_city_id), INDEX GarageRoute_30804_30711_index_rut_to_city_id (rut_to_city_id))\r\n\t\t\t\t\t\t\tSELECT route.rut_id, route.rut_from_city_id, route.rut_to_city_id, route.rut_name, rut_estm_distance FROM route \r\n\t\t\t\t\t\t\tINNER JOIN cities_stats   ON cities_stats.cts_cty_id = route.rut_from_city_id\r\n\t\t\t\t\t\t\tAND rut_estm_distance < 300\r\n\t\t\t\t\t\t\tAND rut_active = 1\r\n\t\t\t\t\t\t\tAND route.rut_to_city_id=30804\r\n\t\t\t\t\t\t\tAND cities_stats.cts_vnd_cnt >= 3\r\n\t\t\t\t\t\t\tORDER BY rut_estm_distance LIMIT 10"}]
2024/10/24 00:02:12 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23964.879] [M: 20523.15] [ET: 5144.315/23930.861] [MU: 6.58/20521.4] 
	SQL: SELECT a.*, fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
								tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address 
						FROM ((SELECT xyz.rut_from_city_id as startCity, r1.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r3.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_from_city_id
							INNER JOIN rate ON rate.rte_route_id=r1.rut_id  AND rate.rte_vehicletype_id IN (3)
							INNER JOIN route r2 ON r2.rut_to_city_id=r1.rut_to_city_id AND r2.rut_from_city_id=:dropCity AND r2.rut_active=1
							INNER JOIN route r3 ON r3.rut_from_city_id=xyz.rut_to_city_id AND r3.rut_to_city_id=r2.rut_from_city_id AND r3.rut_active=1
							ORDER BY ExtraDistance LIMIT 1
							)
							UNION
							(
							SELECT xyz.rut_from_city_id as startCity, r2.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r2.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_to_city_id AND r1.rut_to_city_id=:dropCity
							INNER JOIN route r2 ON r2.rut_to_city_id=xyz.rut_from_city_id AND r2.rut_from_city_id=r1.rut_to_city_id
							ORDER BY ExtraDistance ASC LIMIT 1
							)) a
						INNER JOIN cities fc ON startCity=fc.cty_id
						INNER JOIN cities tc ON endCity=tc.cty_id 
						ORDER BY ExtraDistance 
	 [params: {"pickupCity":"30804","dropCity":"30711"}]
2024/10/24 00:02:12 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24045.204] [M: 20534.06] [ET: 78.526/24011.218] [MU: 7.89/20533.95] 
	BookingRoute::calculateDistance
2024/10/24 00:02:12 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24059.772] [M: 20547.63] [ET: 14.415/24025.73] [MU: 8.27/20547.52] 
	BookingRoute::calculateDistance
2024/10/24 00:02:12 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24074.126] [M: 20555.26] [ET: 13.321/24040.113] [MU: 1/20554.88] 
	SQL: SELECT cts_airport_pickup_entry_fee
               FROM   cities
               INNER JOIN cities_stats
               ON cities.cty_id = cities_stats.cts_cty_id
               WHERE  cty_id = :cityId
               AND cty_is_airport = 1 AND cty_active = 1 
	 [params: {"cityId":"30804"}]
2024/10/24 00:02:12 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24077.284] [M: 20558.59] [ET: 0.432/24043.297] [MU: 0.74/20558.43] 
	SQL: CALL prcDropTempTable(:tableName) 
	 [table: GarageRoute184613986]
2024/10/24 00:02:13 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24845.469] [M: 20563.11] [ET: 768.087/24811.468] [MU: 0.74/20562.36] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"GarageRoute184613986","sql":" (INDEX my_index_name (rut_id), INDEX my_index_name1 (rut_from_city_id))\r\n\t\t\t\t\t\t\tSELECT route.rut_id, route.rut_from_city_id, route.rut_to_city_id, route.rut_name, rut_estm_distance, rut_estm_time\r\n\t\t\t\t\t\t\tFROM route \r\n\t\t\t\t\t\t\tINNER JOIN cities_stats   ON cities_stats.cts_cty_id = route.rut_from_city_id\r\n\t\t\t\t\t\t\tAND rut_estm_distance < 300\r\n\t\t\t\t\t\t\tAND rut_active = 1\r\n\t\t\t\t\t\t\tAND route.rut_to_city_id=30804\r\n\t\t\t\t\t\t\tAND cities_stats.cts_vnd_cnt >= 3\r\n\t\t\t\t\t\t\tORDER BY rut_estm_distance LIMIT 10"}]
2024/10/24 00:02:13 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24876.519] [M: 20573.98] [ET: 30.943/24842.508] [MU: 5.77/20572.73] 
	SQL: SELECT a.*, fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
								tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address 
						FROM (
							(
							SELECT xyz.rut_from_city_id as startCity, r2.rut_to_city_id as endCity, 
									xyz.rut_estm_distance as startDistance,
									IFNULL(r2.rut_actual_distance, r2.rut_estm_distance) as endDistance,
									xyz.rut_estm_time as startTime,
									IFNULL(r2.rut_actual_time, r2.rut_estm_time) as endTime,
									xyz.rut_name as startRoute, r1.rut_name as servingRoute, r2.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute184613986 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_to_city_id AND r1.rut_to_city_id=:dropCity
							INNER JOIN route r2 ON r2.rut_to_city_id=xyz.rut_from_city_id AND r2.rut_from_city_id=r1.rut_to_city_id
							ORDER BY ExtraDistance ASC LIMIT 1
							)) a
						INNER JOIN cities fc ON startCity=fc.cty_id
						INNER JOIN cities tc ON endCity=tc.cty_id 
						ORDER BY ExtraDistance 
	 [params: {"dropCity":"30711"}]
2024/10/24 00:02:13 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24879.195] [M: 20578.24] [ET: 0.72/24845.187] [MU: 0.74/20578.09] 
	SQL: CALL prcDropTempTable(:tableName) 
	 [table: GarageRoute184613986]
2024/10/24 00:02:13 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24939.647] [M: 20586.92] [ET: 60.246/24905.663] [MU: 8.14/20586.81] 
	BookingRoute::calculateDistance
2024/10/24 00:02:13 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24962.672] [M: 20594.76] [ET: 22.901/24928.668] [MU: 8.08/20594.65] 
	BookingRoute::calculateDistance
2024/10/24 00:02:13 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24974.667] [M: 20593.61] [ET: 11.862/24940.677] [MU: 0.9/20593.36] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/24 00:02:13 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24976.071] [M: 20606] [ET: 0.669/24942.087] [MU: 3.02/20605.56] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:13 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24976.892] [M: 20637.78] [ET: 0.706/24942.905] [MU: 25.26/20637.03] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp18)) OR (apr_area_type = 5 AND apr_area_id IN (:gp16)) OR (apr_area_type = 2 AND apr_area_id IN (:gp19)) OR (apr_area_type = 4 AND apr_area_id IN (:gp20)) OR (apr_area_type = 1 AND apr_area_id IN (:gp17))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp16":"3699",":gp17":"31",":gp18":"30804",":gp19":"105",":gp20":"1","cab":"3"}]
2024/10/24 00:02:13 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24978.263] [M: 20621.67] [ET: 0.224/24944.281] [MU: 2.98/20621.56] 
	BookingRoute::calculateDistance
2024/10/24 00:02:13 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24979.617] [M: 20634.79] [ET: 0.249/24945.641] [MU: 2.98/20634.68] 
	BookingRoute::calculateDistance
2024/10/24 00:02:13 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24979.988] [M: 20638.96] [ET: 0.288/24945.995] [MU: 2.97/20638.85] 
	BookingRoute::calculateDistance
2024/10/24 00:02:15 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 26769.616] [M: 20674.41] [ET: 1767.504/26735.622] [MU: 6.32/20672.41] 
	SQL: 
                SELECT cities.cty_id as c2id, cities.cty_name as c2name, cities.cty_garage_address as c2address,
                    cities.cty_id as c4id, cities.cty_name as c4name, cities.cty_garage_address as c4address,
                        (distance * 2) as totalExtraDistance
                 FROM (SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<40
                     INNER JOIN route r1 ON route.rut_to_city_id=r1.rut_from_city_id AND r1.rut_active=1
                     INNER JOIN rate ON r1.rut_id=rate.rte_route_id AND rate.rte_status=1  AND rate.rte_vehicletype_id IN (3) GROUP BY route.rut_id HAVING count(*) >30
                   UNION
                     SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<600
                     INNER JOIN cities tc ON tc.cty_id=route.rut_to_city_id AND tc.cty_service_active=1 AND CalcDistance(cities.cty_lat, cities.cty_long, tc.cty_lat, tc.cty_long)<=route.rut_estm_distance						 
                     INNER JOIN cities_stats ON cities_stats.cts_cty_id = route.rut_to_city_id AND cities_stats.cts_vnd_cnt >= 2
                   UNION
                    SELECT cts_cty_id AS city, 0 AS distance
					FROM cities_stats WHERE 1 AND cities_stats.cts_cty_id= 30817 and cities_stats.cts_vnd_cnt>1) a
                    INNER JOIN cities ON cities.cty_id=a.city
                    ORDER BY totalExtraDistance LIMIT 1 
	 [params: []]
2024/10/24 00:02:15 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 26773.269] [M: 20688.95] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.255.12
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"3","tripDistance":"","tripDuration":"","multiCityData":"","bookingType":"1","pickupAddress":"","pickupDate":"24\/10\/2024","pickupTime":"04:00 AM","isGozonow":"0","minTripDistance":"0","sccId":"0","tripUser":"1","YII_CSRF_TOKEN":"N3VxRE1WeG9UeHk5UWFBUFpPT216eWVyY0xWTVpoTkcUoJ2aBoup1fU2M5E4ePVZVcUNlKiYZZysUqEklNiKWw==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=3&tripDistance=&tripDuration=&multiCityData=&bookingType=1&pickupAddress=&pickupDate=24%2F10%2F2024&pickupTime=04%3A00+AM&isGozonow=0&minTripDistance=0&sccId=0&tripUser=1&YII_CSRF_TOKEN=N3VxRE1WeG9UeHk5UWFBUFpPT216eWVyY0xWTVpoTkcUoJ2aBoup1fU2M5E4ePVZVcUNlKiYZZysUqEklNiKWw%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/24 00:02:15 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 26774.136] [M: 20708.51] [ET: 1.506/26740.142] [MU: 20.76/20708.4] 
	models.RouteRates.calculateDriverAllowance
2024/10/24 00:02:15 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 26774.19] [M: 20710.19] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/24 00:02:15 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 26852.347] [M: 20793.15] [ET: 48.412/26818.345] [MU: 3.19/20790.65] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+10013),(IF((cpm_value_type=2),(10013+(10013*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30937 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30937) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-24 04:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=3 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/24 00:02:15 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 26967.93] [M: 22156.05] [ET: 195.534/26933.945] [MU: 1468.77/22155.9] 
	RouteRates::calculate for CAB 3 2024-10-24 04:00:00 - Trip Type: 1 437117092
2024/10/24 00:02:15 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 26968.09] [M: 22133.73] [ET: 13983.928/26934.116] [MU: 1716.06/22133.57] 
	Quote::calculateRules for CAB 3, From City Id: 30804, To city Id: 30711
2024/10/24 00:02:15 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 26968.407] [M: 22106.34] [ET: 0.239/26934.429] [MU: 0.9/22106.09] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"3"}]
2024/10/24 00:02:15 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 26968.481] [M: 22107.63] [ET: 26508.691/26934.506] [MU: 3295.03/22107.53] 
	Quote For CabType: 3
2024/10/24 00:02:15 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 26969.818] [M: 22121.56] [ET: 0.429/26935.838] [MU: 2.97/22121.13] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:15 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 26970.478] [M: 22127.38] [ET: 0.588/26936.494] [MU: 3.34/22126.94] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30711"}]
2024/10/24 00:02:15 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27024.414] [M: 22130.31] [ET: 53.855/26990.424] [MU: 0.9/22130.06] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/24 00:02:15 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27036.687] [M: 22162.67] [ET: 12.126/27002.67] [MU: 24.21/22161.17] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (100) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30711) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp21)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp24,:gp25)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp22,:gp23)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp26,:gp27))
			OR (scr_area_type = 5 AND scr_area_id IN (3699))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (16)
		ORDER BY rank DESC
		 
	 [params: {":gp21":"31",":gp22":"30804",":gp23":"30711",":gp24":"105",":gp25":"100",":gp26":"1",":gp27":"1","tripType":"1"}]
2024/10/24 00:02:15 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27037.71] [M: 22142.84] [ET: 0.3/27003.726] [MU: 0.84/22142.66] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/24 00:02:15 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27046.985] [M: 22145.72] [ET: 9.185/27012.995] [MU: 0.96/22145.41] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"2"}]
2024/10/24 00:02:15 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27054.499] [M: 22163.28] [ET: 6.298/27020.507] [MU: 3.49/22162.41] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"16","fromCity":"30804","toCity":"30711"}]
2024/10/24 00:02:15 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27062.971] [M: 22166.53] [ET: 7.53/27028.98] [MU: 0.87/22166.31] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":0}]
2024/10/24 00:02:15 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27063.882] [M: 22189.86] [ET: 0.723/27029.9] [MU: 3.01/22189.42] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:15 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27064.658] [M: 22218.03] [ET: 0.644/27030.653] [MU: 22.05/22217.41] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp29)) OR (apr_area_type = 2 AND apr_area_id IN (:gp30)) OR (apr_area_type = 4 AND apr_area_id IN (:gp31)) OR (apr_area_type = 1 AND apr_area_id IN (:gp28))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp28":"31",":gp29":"30804",":gp30":"105",":gp31":"1","cab":"16"}]
2024/10/24 00:02:15 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27066.272] [M: 22204.74] [ET: 0.607/27032.267] [MU: 3.34/22204.3] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:15 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27069.436] [M: 22215.02] [ET: 3.014/27035.447] [MU: 3.52/22214.14] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp33)) OR (scr_area_type = 2 AND scr_area_id IN (:gp34)) OR (scr_area_type = 4 AND scr_area_id IN (:gp35)) OR (scr_area_type = 1 AND scr_area_id IN (:gp32)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp32":"31",":gp33":"30804",":gp34":"105",":gp35":"1","scv_id":"16"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27432.335] [M: 22242.93] [ET: 361.889/27398.303] [MU: 0.74/22234.93] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"nearest_route_30804_30711","sql":"(INDEX indx_nearest_rt_rutid (rut_id)) \r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, routeFrom.rut_name as fromAlias, \r\n\t\t\t\tNULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, \r\n\t\t\t\t0 as rank, routeFrom.rut_estm_time as startTime, 0 as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 \r\n\t\t\t\tAND routeFrom.rut_from_city_id<>routeFrom.rut_to_city_id AND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\t\tAND (routeAlias.rut_to_city_id=route.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, NULL, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) \r\n\t\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\t0 AS extraStartDistance, 0, 0 as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND route.rut_from_city_id = 30804 AND route.rut_to_city_id=30711 \r\n\t\t\t\tAND routeTo.rut_from_city_id=30711\r\n\t\t\t\tAND route.rut_active = 1 AND routeTo.rut_active = 1 AND routeTo.rut_estm_distance < 50 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = route.rut_from_city_id) \r\n\t\t\t   AND (routeAlias.rut_to_city_id = routeTo.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, \r\n\t\t\t\trouteFrom.rut_name, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t+ IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) \r\n\t\t\t\tAS extraDistance, IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, 0, \r\n\t\t\t\trouteFrom.rut_estm_time as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 AND routeFrom.rut_from_city_id <> routeFrom.rut_to_city_id\r\n\t\t\t\t\tAND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND routeTo.rut_estm_distance < 50 \r\n\t\t\t\t\tAND routeTo.rut_from_city_id=30711 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\tAND (routeAlias.rut_to_city_id=routeTo.rut_to_city_id) AND routeAlias.rut_active = 1 AND routeAlias.rut_from_city_id=30804  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27437.479] [M: 22246.96] [ET: 5.011/27403.49] [MU: 2.12/22246.52] 
	SQL: SELECT *, (rte_vendor_amount + extraDistance * 10.55) as totalCost FROM (SELECT * FROM nearest_route_30804_30711) a
					INNER JOIN rate ON a.rut_id = rate.rte_route_id AND rte_status=1 AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <>0
					WHERE 1 ORDER BY rank DESC, totalCost ASC LIMIT 0,1 
	 [params: {"cabType":"16"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27438.262] [M: 22254.98] [ET: 0.664/27404.249] [MU: 0.75/22252.98] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"getNearestRoute_30804_30711_70","sql":"(INDEX getNearestRoute_30804_30711_70_index_rut_id (rut_id))\r\n\t\t\t\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id AS start, routeAlias.rut_to_city_id AS end,\r\n\t\t\t\t\t\t\t\trouteFrom.rut_name AS fromAlias, NULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance AS quotedDistance,\r\n\t\t\t\t\t\t\t\trouteAlias.rut_estm_distance AS rateDistance, \r\n\t\t\t\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance)\r\n\t\t\t\t\t\t\t\t\t - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance,\r\n\t\t\t\t\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance,\r\n\t\t\t\t\t\t\t\t0 AS rank, routeFrom.rut_estm_time AS startTime, 0 AS endTime, route.rut_estm_time, \r\n\t\t\t\t\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraTravelDistance\r\n\t\t\t\t\t\tFROM   route\r\n\t\t\t\t\t\tINNER JOIN route routeTo ON routeTo.rut_to_city_id=route.rut_from_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_from_city_id=30804 AND routeTo.rut_active=1\r\n\t\t\t\t\t\t\t\tAND routeTo.rut_estm_distance<70 AND route.rut_active=1\r\n\t\t\t\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_from_city_id=route.rut_to_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_active = 1\r\n\t\t\t\t\t\t\t\tAND routeFrom.rut_estm_distance<70 AND route.rut_active = 1\r\n\t\t\t\t\t\tINNER JOIN route routeAlias ON routeAlias.rut_to_city_id=routeFrom.rut_to_city_id\r\n\t\t\t\t\t\t\tAND routeAlias.rut_from_city_id=routeTo.rut_from_city_id AND routeAlias.rut_active = 1"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27441.531] [M: 22260.25] [ET: 3.149/27407.528] [MU: 2.42/22259.63] 
	SQL: SELECT *, (rte_vendor_amount + extradistance * 10.55 ) AS totalCost, 
						ABS(quotedDistance-rateDistance) AS extraChargeableDistance
					FROM getNearestRoute_30804_30711_70 a
					INNER JOIN rate ON a.rut_id=rate.rte_route_id AND rte_status=1 
						AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <> 0
					WHERE  1
					ORDER  BY rank DESC, extraStartDistance, extraChargeableDistance ASC, totalcost ASC
					LIMIT  0, 1 
	 [params: {"cabType":"16"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27444.685] [M: 22275.38] [ET: 0.592/27410.701] [MU: 3.46/22274.5] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27445.825] [M: 22285.63] [ET: 397.826/27411.849] [MU: 130.26/22285.47] 
	Quote::calculateOneWay  for CAB 16 Date: 2024-10-24 04:00:00
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27446.301] [M: 22289.22] [ET: 0.376/27412.313] [MU: 0.9/22288.97] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27447.525] [M: 22301.93] [ET: 0.565/27413.539] [MU: 3.33/22301.49] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27448.246] [M: 22330.85] [ET: 0.611/27414.256] [MU: 22.4/22330.1] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp38)) OR (apr_area_type = 5 AND apr_area_id IN (:gp36)) OR (apr_area_type = 2 AND apr_area_id IN (:gp39)) OR (apr_area_type = 4 AND apr_area_id IN (:gp40)) OR (apr_area_type = 1 AND apr_area_id IN (:gp37))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp36":"3699",":gp37":"31",":gp38":"30804",":gp39":"105",":gp40":"1","cab":"16"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27449.849] [M: 22318.11] [ET: 0.505/27415.868] [MU: 3.33/22317.67] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27453.265] [M: 22328.61] [ET: 3.29/27419.257] [MU: 3.49/22327.73] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp43)) OR (scr_area_type = 5 AND scr_area_id IN (:gp41)) OR (scr_area_type = 2 AND scr_area_id IN (:gp44)) OR (scr_area_type = 4 AND scr_area_id IN (:gp45)) OR (scr_area_type = 1 AND scr_area_id IN (:gp42)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp41":"3699",":gp42":"31",":gp43":"3699",":gp44":"105",":gp45":"1","scv_id":"16"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27453.802] [M: 22329.79] [ET: 0.236/27419.824] [MU: 2.97/22329.68] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27455.897] [M: 22340.04] [ET: 0.689/27421.913] [MU: 2.84/22339.41] 
	SQL: SELECT 
						fc.cty_id as c2id, 
						fc.cty_name as c2name, 
						fc.cty_garage_address as c2address,
						tc.cty_id as c4id,
						tc.cty_name as c4name, tc.cty_garage_address as c4address,
						0 as totalExtraDistance FROM route
						INNER JOIN cities fc ON rut_from_city_id=fc.cty_id
						INNER JOIN cities tc ON rut_to_city_id=tc.cty_id
						INNER JOIN rate on  rate.rte_route_id=route.rut_id  AND rate.rte_vehicletype_id IN (3)
						WHERE route.rut_from_city_id=30804 AND route.rut_to_city_id=30711 AND route.rut_active=1 
	 [params: []]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27456.405] [M: 22353.92] [ET: 0.429/27422.418] [MU: 6.53/22351.92] 
	SQL: 
				SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address, tc.cty_id as c4id, 
				tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
					FROM
					 (
						(
							SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id,  
								r3.rut_to_city_id, route.rut_name , route.rut_id,
								(route.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, 
								r3.rut_estm_distance
							FROM route
							INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_from_city_id=30804  
									AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=route.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) 
									AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
						UNION
						(
							SELECT r3.rut_id, r3.rut_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,(route.rut_estm_distance + r1.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
							FROM route
							INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND  route.rut_to_city_id=30711 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND route.rut_to_city_id=r3.rut_to_city_id))	AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
                     ) a
					INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
					INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1 
	 [params: []]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27456.864] [M: 22364.43] [ET: 0.389/27422.882] [MU: 5.03/22362.93] 
	SQL: SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
                              tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
                        FROM (SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,
                                    (route.rut_estm_distance + r1.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
                                FROM route
								INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
								INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
								INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) AND r3.rut_active=1 
								INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3) LIMIT 1
							)a
                        INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
                        INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1
                         
	 [params: []]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27457.402] [M: 22370.8] [ET: 0.466/27423.42] [MU: 0.74/22369.93] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"GarageRoute_30804_30711","sql":" (INDEX GarageRoute_30804_30711_index_rut_id (rut_id), INDEX GarageRoute_30804_30711_index_rut_from_city_id (rut_from_city_id), INDEX GarageRoute_30804_30711_index_rut_to_city_id (rut_to_city_id))\r\n\t\t\t\t\t\t\tSELECT route.rut_id, route.rut_from_city_id, route.rut_to_city_id, route.rut_name, rut_estm_distance FROM route \r\n\t\t\t\t\t\t\tINNER JOIN cities_stats   ON cities_stats.cts_cty_id = route.rut_from_city_id\r\n\t\t\t\t\t\t\tAND rut_estm_distance < 300\r\n\t\t\t\t\t\t\tAND rut_active = 1\r\n\t\t\t\t\t\t\tAND route.rut_to_city_id=30804\r\n\t\t\t\t\t\t\tAND cities_stats.cts_vnd_cnt >= 3\r\n\t\t\t\t\t\t\tORDER BY rut_estm_distance LIMIT 10"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27458.003] [M: 22382.73] [ET: 0.519/27424.011] [MU: 6.69/22380.98] 
	SQL: SELECT a.*, fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
								tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address 
						FROM ((SELECT xyz.rut_from_city_id as startCity, r1.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r3.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_from_city_id
							INNER JOIN rate ON rate.rte_route_id=r1.rut_id  AND rate.rte_vehicletype_id IN (3)
							INNER JOIN route r2 ON r2.rut_to_city_id=r1.rut_to_city_id AND r2.rut_from_city_id=:dropCity AND r2.rut_active=1
							INNER JOIN route r3 ON r3.rut_from_city_id=xyz.rut_to_city_id AND r3.rut_to_city_id=r2.rut_from_city_id AND r3.rut_active=1
							ORDER BY ExtraDistance LIMIT 1
							)
							UNION
							(
							SELECT xyz.rut_from_city_id as startCity, r2.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r2.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_to_city_id AND r1.rut_to_city_id=:dropCity
							INNER JOIN route r2 ON r2.rut_to_city_id=xyz.rut_from_city_id AND r2.rut_from_city_id=r1.rut_to_city_id
							ORDER BY ExtraDistance ASC LIMIT 1
							)) a
						INNER JOIN cities fc ON startCity=fc.cty_id
						INNER JOIN cities tc ON endCity=tc.cty_id 
						ORDER BY ExtraDistance 
	 [params: {"pickupCity":"30804","dropCity":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27463.535] [M: 22394.07] [ET: 4.001/27429.55] [MU: 7.88/22393.96] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27478.023] [M: 22399.55] [ET: 14.389/27444.035] [MU: 8.27/22399.44] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27479.032] [M: 22407.17] [ET: 0.435/27445.033] [MU: 0.99/22406.8] 
	SQL: SELECT cts_airport_pickup_entry_fee
               FROM   cities
               INNER JOIN cities_stats
               ON cities.cty_id = cities_stats.cts_cty_id
               WHERE  cty_id = :cityId
               AND cty_is_airport = 1 AND cty_active = 1 
	 [params: {"cityId":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27483.546] [M: 22421.09] [ET: 3.386/27449.539] [MU: 8.13/22420.98] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27485.077] [M: 22428.92] [ET: 1.382/27451.092] [MU: 8.08/22428.81] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27485.665] [M: 22428.35] [ET: 0.488/27451.676] [MU: 0.89/22428.1] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27487.05] [M: 22441.06] [ET: 0.779/27453.047] [MU: 3.34/22440.63] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27487.807] [M: 22469.98] [ET: 0.602/27453.817] [MU: 22.41/22469.23] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp48)) OR (apr_area_type = 5 AND apr_area_id IN (:gp46)) OR (apr_area_type = 2 AND apr_area_id IN (:gp49)) OR (apr_area_type = 4 AND apr_area_id IN (:gp50)) OR (apr_area_type = 1 AND apr_area_id IN (:gp47))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp46":"3699",":gp47":"31",":gp48":"30804",":gp49":"105",":gp50":"1","cab":"16"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27489.519] [M: 22457.24] [ET: 0.589/27455.534] [MU: 3.34/22456.8] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27492.926] [M: 22467.74] [ET: 3.272/27458.914] [MU: 3.48/22466.87] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp53)) OR (scr_area_type = 5 AND scr_area_id IN (:gp51)) OR (scr_area_type = 2 AND scr_area_id IN (:gp54)) OR (scr_area_type = 4 AND scr_area_id IN (:gp55)) OR (scr_area_type = 1 AND scr_area_id IN (:gp52)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp51":"3699",":gp52":"31",":gp53":"3699",":gp54":"105",":gp55":"1","scv_id":"16"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27493.601] [M: 22470.96] [ET: 0.246/27459.624] [MU: 2.97/22470.85] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27495.187] [M: 22484.07] [ET: 0.247/27461.21] [MU: 2.97/22483.96] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27495.475] [M: 22488.15] [ET: 0.214/27461.499] [MU: 2.97/22488.04] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27500.264] [M: 22522.25] [ET: 0.825/27466.256] [MU: 6.33/22520.25] 
	SQL: 
                SELECT cities.cty_id as c2id, cities.cty_name as c2name, cities.cty_garage_address as c2address,
                    cities.cty_id as c4id, cities.cty_name as c4name, cities.cty_garage_address as c4address,
                        (distance * 2) as totalExtraDistance
                 FROM (SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<40
                     INNER JOIN route r1 ON route.rut_to_city_id=r1.rut_from_city_id AND r1.rut_active=1
                     INNER JOIN rate ON r1.rut_id=rate.rte_route_id AND rate.rte_status=1  AND rate.rte_vehicletype_id IN (3) GROUP BY route.rut_id HAVING count(*) >30
                   UNION
                     SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<600
                     INNER JOIN cities tc ON tc.cty_id=route.rut_to_city_id AND tc.cty_service_active=1 AND CalcDistance(cities.cty_lat, cities.cty_long, tc.cty_lat, tc.cty_long)<=route.rut_estm_distance						 
                     INNER JOIN cities_stats ON cities_stats.cts_cty_id = route.rut_to_city_id AND cities_stats.cts_vnd_cnt >= 2
                   UNION
                    SELECT cts_cty_id AS city, 0 AS distance
					FROM cities_stats WHERE 1 AND cities_stats.cts_cty_id= 30817 and cities_stats.cts_vnd_cnt>1) a
                    INNER JOIN cities ON cities.cty_id=a.city
                    ORDER BY totalExtraDistance LIMIT 1 
	 [params: []]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27504.033] [M: 22537.06] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.255.12
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"3","tripDistance":"","tripDuration":"","multiCityData":"","bookingType":"1","pickupAddress":"","pickupDate":"24\/10\/2024","pickupTime":"04:00 AM","isGozonow":"0","minTripDistance":"0","sccId":"0","tripUser":"1","YII_CSRF_TOKEN":"N3VxRE1WeG9UeHk5UWFBUFpPT216eWVyY0xWTVpoTkcUoJ2aBoup1fU2M5E4ePVZVcUNlKiYZZysUqEklNiKWw==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=3&tripDistance=&tripDuration=&multiCityData=&bookingType=1&pickupAddress=&pickupDate=24%2F10%2F2024&pickupTime=04%3A00+AM&isGozonow=0&minTripDistance=0&sccId=0&tripUser=1&YII_CSRF_TOKEN=N3VxRE1WeG9UeHk5UWFBUFpPT216eWVyY0xWTVpoTkcUoJ2aBoup1fU2M5E4ePVZVcUNlKiYZZysUqEklNiKWw%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27504.899] [M: 22556.63] [ET: 1.539/27470.901] [MU: 20.77/22556.52] 
	models.RouteRates.calculateDriverAllowance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27504.957] [M: 22558.3] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27506.511] [M: 22571.77] [ET: 1.334/27472.485] [MU: 2.99/22569.27] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+10013),(IF((cpm_value_type=2),(10013+(10013*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30937 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30937) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-24 04:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=16 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27508.6] [M: 22613.99] [ET: 5.311/27474.582] [MU: 78.6/22613.84] 
	RouteRates::calculate for CAB 16 2024-10-24 04:00:00 - Trip Type: 1 600863058
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27508.872] [M: 22591.68] [ET: 62.937/27474.841] [MU: 304.5/22591.52] 
	Quote::calculateRules for CAB 16, From City Id: 30804, To city Id: 30711
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27509.428] [M: 22564.28] [ET: 0.42/27475.442] [MU: 0.89/22564.03] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"16"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27509.509] [M: 22565.53] [ET: 540.978/27475.534] [MU: 456.6/22565.44] 
	Quote For CabType: 16
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27511.029] [M: 22575.88] [ET: 0.523/27477.037] [MU: 3.34/22575.44] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27511.535] [M: 22581.69] [ET: 0.434/27477.554] [MU: 3.33/22581.25] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27512.067] [M: 22584.63] [ET: 0.455/27478.078] [MU: 0.9/22584.38] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27512.636] [M: 22616.98] [ET: 0.458/27478.647] [MU: 24.22/22615.48] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (100) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30711) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp56)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp59,:gp60)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp57,:gp58)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp61,:gp62))
			OR (scr_area_type = 5 AND scr_area_id IN (3699))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (45)
		ORDER BY rank DESC
		 
	 [params: {":gp56":"31",":gp57":"30804",":gp58":"30711",":gp59":"105",":gp60":"100",":gp61":"1",":gp62":"1","tripType":"1"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27513.3] [M: 22597.16] [ET: 0.196/27479.32] [MU: 0.83/22596.97] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27513.663] [M: 22600.03] [ET: 0.287/27479.683] [MU: 0.96/22599.72] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"4"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27518.033] [M: 22617.81] [ET: 3.456/27484.03] [MU: 3.48/22616.94] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"45","fromCity":"30804","toCity":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27519.29] [M: 22621.06] [ET: 0.637/27485.305] [MU: 0.87/22620.84] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":0}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27520.238] [M: 22628.39] [ET: 0.748/27486.237] [MU: 3.02/22627.95] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27521.088] [M: 22656.56] [ET: 0.696/27487.1] [MU: 22.05/22655.94] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp64)) OR (apr_area_type = 2 AND apr_area_id IN (:gp65)) OR (apr_area_type = 4 AND apr_area_id IN (:gp66)) OR (apr_area_type = 1 AND apr_area_id IN (:gp63))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp63":"31",":gp64":"30804",":gp65":"105",":gp66":"1","cab":"45"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27522.228] [M: 22642.9] [ET: 0.46/27488.248] [MU: 3.33/22642.46] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27525.381] [M: 22653.01] [ET: 3.027/27491.371] [MU: 3.36/22652.13] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp68)) OR (scr_area_type = 2 AND scr_area_id IN (:gp69)) OR (scr_area_type = 4 AND scr_area_id IN (:gp70)) OR (scr_area_type = 1 AND scr_area_id IN (:gp67)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp67":"31",":gp68":"30804",":gp69":"105",":gp70":"1","scv_id":"45"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27528.755] [M: 22680.92] [ET: 2.386/27494.742] [MU: 0.74/22672.92] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"nearest_route_30804_30711","sql":"(INDEX indx_nearest_rt_rutid (rut_id)) \r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, routeFrom.rut_name as fromAlias, \r\n\t\t\t\tNULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, \r\n\t\t\t\t0 as rank, routeFrom.rut_estm_time as startTime, 0 as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 \r\n\t\t\t\tAND routeFrom.rut_from_city_id<>routeFrom.rut_to_city_id AND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\t\tAND (routeAlias.rut_to_city_id=route.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, NULL, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) \r\n\t\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\t0 AS extraStartDistance, 0, 0 as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND route.rut_from_city_id = 30804 AND route.rut_to_city_id=30711 \r\n\t\t\t\tAND routeTo.rut_from_city_id=30711\r\n\t\t\t\tAND route.rut_active = 1 AND routeTo.rut_active = 1 AND routeTo.rut_estm_distance < 50 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = route.rut_from_city_id) \r\n\t\t\t   AND (routeAlias.rut_to_city_id = routeTo.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, \r\n\t\t\t\trouteFrom.rut_name, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t+ IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) \r\n\t\t\t\tAS extraDistance, IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, 0, \r\n\t\t\t\trouteFrom.rut_estm_time as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 AND routeFrom.rut_from_city_id <> routeFrom.rut_to_city_id\r\n\t\t\t\t\tAND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND routeTo.rut_estm_distance < 50 \r\n\t\t\t\t\tAND routeTo.rut_from_city_id=30711 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\tAND (routeAlias.rut_to_city_id=routeTo.rut_to_city_id) AND routeAlias.rut_active = 1 AND routeAlias.rut_from_city_id=30804  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27533.309] [M: 22684.95] [ET: 4.458/27499.314] [MU: 2.12/22684.52] 
	SQL: SELECT *, (rte_vendor_amount + extraDistance * 10.55) as totalCost FROM (SELECT * FROM nearest_route_30804_30711) a
					INNER JOIN rate ON a.rut_id = rate.rte_route_id AND rte_status=1 AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <>0
					WHERE 1 ORDER BY rank DESC, totalCost ASC LIMIT 0,1 
	 [params: {"cabType":"45"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27534.133] [M: 22692.98] [ET: 0.705/27500.132] [MU: 0.74/22690.98] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"getNearestRoute_30804_30711_70","sql":"(INDEX getNearestRoute_30804_30711_70_index_rut_id (rut_id))\r\n\t\t\t\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id AS start, routeAlias.rut_to_city_id AS end,\r\n\t\t\t\t\t\t\t\trouteFrom.rut_name AS fromAlias, NULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance AS quotedDistance,\r\n\t\t\t\t\t\t\t\trouteAlias.rut_estm_distance AS rateDistance, \r\n\t\t\t\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance)\r\n\t\t\t\t\t\t\t\t\t - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance,\r\n\t\t\t\t\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance,\r\n\t\t\t\t\t\t\t\t0 AS rank, routeFrom.rut_estm_time AS startTime, 0 AS endTime, route.rut_estm_time, \r\n\t\t\t\t\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraTravelDistance\r\n\t\t\t\t\t\tFROM   route\r\n\t\t\t\t\t\tINNER JOIN route routeTo ON routeTo.rut_to_city_id=route.rut_from_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_from_city_id=30804 AND routeTo.rut_active=1\r\n\t\t\t\t\t\t\t\tAND routeTo.rut_estm_distance<70 AND route.rut_active=1\r\n\t\t\t\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_from_city_id=route.rut_to_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_active = 1\r\n\t\t\t\t\t\t\t\tAND routeFrom.rut_estm_distance<70 AND route.rut_active = 1\r\n\t\t\t\t\t\tINNER JOIN route routeAlias ON routeAlias.rut_to_city_id=routeFrom.rut_to_city_id\r\n\t\t\t\t\t\t\tAND routeAlias.rut_from_city_id=routeTo.rut_from_city_id AND routeAlias.rut_active = 1"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27537.829] [M: 22698.24] [ET: 3.591/27503.824] [MU: 2.41/22697.62] 
	SQL: SELECT *, (rte_vendor_amount + extradistance * 10.55 ) AS totalCost, 
						ABS(quotedDistance-rateDistance) AS extraChargeableDistance
					FROM getNearestRoute_30804_30711_70 a
					INNER JOIN rate ON a.rut_id=rate.rte_route_id AND rte_status=1 
						AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <> 0
					WHERE  1
					ORDER  BY rank DESC, extraStartDistance, extraChargeableDistance ASC, totalcost ASC
					LIMIT  0, 1 
	 [params: {"cabType":"45"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27541.432] [M: 22713.37] [ET: 0.647/27507.449] [MU: 3.46/22712.49] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"16","fromCity":"30804","toCity":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27543.003] [M: 22761.98] [ET: 0.494/27509.021] [MU: 35.78/22761.11] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27544.276] [M: 22773.09] [ET: 29.855/27510.284] [MU: 163.2/22772.94] 
	Quote::calculateOneWay  for CAB 45 Date: 2024-10-24 04:00:00
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27544.842] [M: 22776.59] [ET: 0.439/27510.861] [MU: 0.9/22776.34] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27545.935] [M: 22789.3] [ET: 0.548/27511.955] [MU: 3.34/22788.87] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27546.523] [M: 22818.23] [ET: 0.487/27512.543] [MU: 22.41/22817.48] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp73)) OR (apr_area_type = 5 AND apr_area_id IN (:gp71)) OR (apr_area_type = 2 AND apr_area_id IN (:gp74)) OR (apr_area_type = 4 AND apr_area_id IN (:gp75)) OR (apr_area_type = 1 AND apr_area_id IN (:gp72))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp71":"3699",":gp72":"31",":gp73":"30804",":gp74":"105",":gp75":"1","cab":"45"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27548.092] [M: 22805.48] [ET: 0.614/27514.096] [MU: 3.34/22805.05] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27551.556] [M: 22815.98] [ET: 3.268/27517.546] [MU: 3.48/22815.11] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp78)) OR (scr_area_type = 5 AND scr_area_id IN (:gp76)) OR (scr_area_type = 2 AND scr_area_id IN (:gp79)) OR (scr_area_type = 4 AND scr_area_id IN (:gp80)) OR (scr_area_type = 1 AND scr_area_id IN (:gp77)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp76":"3699",":gp77":"31",":gp78":"3699",":gp79":"105",":gp80":"1","scv_id":"45"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27552.281] [M: 22817.16] [ET: 0.355/27518.304] [MU: 2.98/22817.05] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27554.299] [M: 22827.41] [ET: 0.714/27520.314] [MU: 2.83/22826.79] 
	SQL: SELECT 
						fc.cty_id as c2id, 
						fc.cty_name as c2name, 
						fc.cty_garage_address as c2address,
						tc.cty_id as c4id,
						tc.cty_name as c4name, tc.cty_garage_address as c4address,
						0 as totalExtraDistance FROM route
						INNER JOIN cities fc ON rut_from_city_id=fc.cty_id
						INNER JOIN cities tc ON rut_to_city_id=tc.cty_id
						INNER JOIN rate on  rate.rte_route_id=route.rut_id  AND rate.rte_vehicletype_id IN (3)
						WHERE route.rut_from_city_id=30804 AND route.rut_to_city_id=30711 AND route.rut_active=1 
	 [params: []]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27554.815] [M: 22841.3] [ET: 0.439/27520.828] [MU: 6.53/22839.3] 
	SQL: 
				SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address, tc.cty_id as c4id, 
				tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
					FROM
					 (
						(
							SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id,  
								r3.rut_to_city_id, route.rut_name , route.rut_id,
								(route.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, 
								r3.rut_estm_distance
							FROM route
							INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_from_city_id=30804  
									AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=route.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) 
									AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
						UNION
						(
							SELECT r3.rut_id, r3.rut_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,(route.rut_estm_distance + r1.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
							FROM route
							INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND  route.rut_to_city_id=30711 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND route.rut_to_city_id=r3.rut_to_city_id))	AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
                     ) a
					INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
					INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1 
	 [params: []]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27555.28] [M: 22851.8] [ET: 0.39/27521.295] [MU: 5.03/22850.3] 
	SQL: SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
                              tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
                        FROM (SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,
                                    (route.rut_estm_distance + r1.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
                                FROM route
								INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
								INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
								INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) AND r3.rut_active=1 
								INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3) LIMIT 1
							)a
                        INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
                        INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1
                         
	 [params: []]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27555.803] [M: 22858.18] [ET: 0.448/27521.82] [MU: 0.74/22857.3] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"GarageRoute_30804_30711","sql":" (INDEX GarageRoute_30804_30711_index_rut_id (rut_id), INDEX GarageRoute_30804_30711_index_rut_from_city_id (rut_from_city_id), INDEX GarageRoute_30804_30711_index_rut_to_city_id (rut_to_city_id))\r\n\t\t\t\t\t\t\tSELECT route.rut_id, route.rut_from_city_id, route.rut_to_city_id, route.rut_name, rut_estm_distance FROM route \r\n\t\t\t\t\t\t\tINNER JOIN cities_stats   ON cities_stats.cts_cty_id = route.rut_from_city_id\r\n\t\t\t\t\t\t\tAND rut_estm_distance < 300\r\n\t\t\t\t\t\t\tAND rut_active = 1\r\n\t\t\t\t\t\t\tAND route.rut_to_city_id=30804\r\n\t\t\t\t\t\t\tAND cities_stats.cts_vnd_cnt >= 3\r\n\t\t\t\t\t\t\tORDER BY rut_estm_distance LIMIT 10"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27556.469] [M: 22870.1] [ET: 0.571/27522.463] [MU: 6.68/22868.35] 
	SQL: SELECT a.*, fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
								tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address 
						FROM ((SELECT xyz.rut_from_city_id as startCity, r1.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r3.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_from_city_id
							INNER JOIN rate ON rate.rte_route_id=r1.rut_id  AND rate.rte_vehicletype_id IN (3)
							INNER JOIN route r2 ON r2.rut_to_city_id=r1.rut_to_city_id AND r2.rut_from_city_id=:dropCity AND r2.rut_active=1
							INNER JOIN route r3 ON r3.rut_from_city_id=xyz.rut_to_city_id AND r3.rut_to_city_id=r2.rut_from_city_id AND r3.rut_active=1
							ORDER BY ExtraDistance LIMIT 1
							)
							UNION
							(
							SELECT xyz.rut_from_city_id as startCity, r2.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r2.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_to_city_id AND r1.rut_to_city_id=:dropCity
							INNER JOIN route r2 ON r2.rut_to_city_id=xyz.rut_from_city_id AND r2.rut_from_city_id=r1.rut_to_city_id
							ORDER BY ExtraDistance ASC LIMIT 1
							)) a
						INNER JOIN cities fc ON startCity=fc.cty_id
						INNER JOIN cities tc ON endCity=tc.cty_id 
						ORDER BY ExtraDistance 
	 [params: {"pickupCity":"30804","dropCity":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27559.261] [M: 22881.45] [ET: 1.258/27525.279] [MU: 7.88/22881.34] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27560.325] [M: 22887.02] [ET: 0.971/27526.343] [MU: 8.27/22886.91] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27561.4] [M: 22894.64] [ET: 0.396/27527.42] [MU: 0.99/22894.27] 
	SQL: SELECT cts_airport_pickup_entry_fee
               FROM   cities
               INNER JOIN cities_stats
               ON cities.cty_id = cities_stats.cts_cty_id
               WHERE  cty_id = :cityId
               AND cty_is_airport = 1 AND cty_active = 1 
	 [params: {"cityId":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27562.988] [M: 22908.55] [ET: 0.955/27529.009] [MU: 8.13/22908.45] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27563.907] [M: 22916.39] [ET: 0.825/27529.931] [MU: 8.07/22916.28] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27564.602] [M: 22915.82] [ET: 0.583/27530.575] [MU: 0.9/22915.57] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27566.134] [M: 22928.53] [ET: 0.608/27532.153] [MU: 3.34/22928.09] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27566.823] [M: 22957.45] [ET: 0.582/27532.841] [MU: 22.41/22956.7] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp83)) OR (apr_area_type = 5 AND apr_area_id IN (:gp81)) OR (apr_area_type = 2 AND apr_area_id IN (:gp84)) OR (apr_area_type = 4 AND apr_area_id IN (:gp85)) OR (apr_area_type = 1 AND apr_area_id IN (:gp82))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp81":"3699",":gp82":"31",":gp83":"30804",":gp84":"105",":gp85":"1","cab":"45"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27568.188] [M: 22944.71] [ET: 0.463/27534.208] [MU: 3.34/22944.27] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27571.773] [M: 22955.21] [ET: 3.462/27537.764] [MU: 3.49/22954.34] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp88)) OR (scr_area_type = 5 AND scr_area_id IN (:gp86)) OR (scr_area_type = 2 AND scr_area_id IN (:gp89)) OR (scr_area_type = 4 AND scr_area_id IN (:gp90)) OR (scr_area_type = 1 AND scr_area_id IN (:gp87)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp86":"3699",":gp87":"31",":gp88":"3699",":gp89":"105",":gp90":"1","scv_id":"45"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27572.696] [M: 22958.43] [ET: 0.422/27538.7] [MU: 2.97/22958.32] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27574.273] [M: 22971.45] [ET: 0.247/27540.296] [MU: 2.98/22971.34] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27574.544] [M: 22975.62] [ET: 0.201/27540.569] [MU: 2.98/22975.51] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27579.067] [M: 23009.72] [ET: 0.753/27545.061] [MU: 6.33/23007.72] 
	SQL: 
                SELECT cities.cty_id as c2id, cities.cty_name as c2name, cities.cty_garage_address as c2address,
                    cities.cty_id as c4id, cities.cty_name as c4name, cities.cty_garage_address as c4address,
                        (distance * 2) as totalExtraDistance
                 FROM (SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<40
                     INNER JOIN route r1 ON route.rut_to_city_id=r1.rut_from_city_id AND r1.rut_active=1
                     INNER JOIN rate ON r1.rut_id=rate.rte_route_id AND rate.rte_status=1  AND rate.rte_vehicletype_id IN (3) GROUP BY route.rut_id HAVING count(*) >30
                   UNION
                     SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<600
                     INNER JOIN cities tc ON tc.cty_id=route.rut_to_city_id AND tc.cty_service_active=1 AND CalcDistance(cities.cty_lat, cities.cty_long, tc.cty_lat, tc.cty_long)<=route.rut_estm_distance						 
                     INNER JOIN cities_stats ON cities_stats.cts_cty_id = route.rut_to_city_id AND cities_stats.cts_vnd_cnt >= 2
                   UNION
                    SELECT cts_cty_id AS city, 0 AS distance
					FROM cities_stats WHERE 1 AND cities_stats.cts_cty_id= 30817 and cities_stats.cts_vnd_cnt>1) a
                    INNER JOIN cities ON cities.cty_id=a.city
                    ORDER BY totalExtraDistance LIMIT 1 
	 [params: []]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27582.257] [M: 23024.53] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.255.12
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"3","tripDistance":"","tripDuration":"","multiCityData":"","bookingType":"1","pickupAddress":"","pickupDate":"24\/10\/2024","pickupTime":"04:00 AM","isGozonow":"0","minTripDistance":"0","sccId":"0","tripUser":"1","YII_CSRF_TOKEN":"N3VxRE1WeG9UeHk5UWFBUFpPT216eWVyY0xWTVpoTkcUoJ2aBoup1fU2M5E4ePVZVcUNlKiYZZysUqEklNiKWw==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=3&tripDistance=&tripDuration=&multiCityData=&bookingType=1&pickupAddress=&pickupDate=24%2F10%2F2024&pickupTime=04%3A00+AM&isGozonow=0&minTripDistance=0&sccId=0&tripUser=1&YII_CSRF_TOKEN=N3VxRE1WeG9UeHk5UWFBUFpPT216eWVyY0xWTVpoTkcUoJ2aBoup1fU2M5E4ePVZVcUNlKiYZZysUqEklNiKWw%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27582.765] [M: 23044.09] [ET: 0.972/27548.789] [MU: 20.77/23043.98] 
	models.RouteRates.calculateDriverAllowance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27582.799] [M: 23045.77] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27584.003] [M: 23059.23] [ET: 1.07/27550.008] [MU: 3/23056.73] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+10013),(IF((cpm_value_type=2),(10013+(10013*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30937 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30937) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-24 04:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=45 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27585.563] [M: 23101.46] [ET: 3.831/27551.584] [MU: 78.6/23101.3] 
	RouteRates::calculate for CAB 45 2024-10-24 04:00:00 - Trip Type: 1 414316559
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27585.712] [M: 23079.15] [ET: 41.356/27551.735] [MU: 304.59/23078.99] 
	Quote::calculateRules for CAB 45, From City Id: 30804, To city Id: 30711
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27586.012] [M: 23051.53] [ET: 0.216/27552.033] [MU: 0.89/23051.28] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"45"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27586.086] [M: 23052.78] [ET: 76.521/27552.11] [MU: 485.95/23052.69] 
	Quote For CabType: 45
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27587.294] [M: 23063.13] [ET: 0.404/27553.314] [MU: 3.34/23062.69] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27587.752] [M: 23068.94] [ET: 0.392/27553.773] [MU: 3.33/23068.5] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27588.446] [M: 23071.88] [ET: 0.605/27554.446] [MU: 0.9/23071.63] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27589.288] [M: 23104.23] [ET: 0.699/27555.294] [MU: 24.22/23102.73] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (100) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30711) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp91)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp94,:gp95)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp92,:gp93)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp96,:gp97))
			OR (scr_area_type = 5 AND scr_area_id IN (3699))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (54)
		ORDER BY rank DESC
		 
	 [params: {":gp91":"31",":gp92":"30804",":gp93":"30711",":gp94":"105",":gp95":"100",":gp96":"1",":gp97":"1","tripType":"1"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27590.086] [M: 23084.42] [ET: 0.25/27556.105] [MU: 0.84/23084.23] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27590.487] [M: 23087.3] [ET: 0.325/27556.508] [MU: 0.96/23086.98] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"4"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27595.227] [M: 23100.27] [ET: 3.394/27561.221] [MU: 2.05/23099.77] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"54"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27599.894] [M: 23109.6] [ET: 4.35/27565.903] [MU: 3.49/23108.73] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"54","fromCity":"30804","toCity":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27601.678] [M: 23112.85] [ET: 0.56/27567.694] [MU: 0.87/23112.63] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":0}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27602.442] [M: 23120.18] [ET: 0.602/27568.462] [MU: 3.01/23119.74] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27603.079] [M: 23148.35] [ET: 0.534/27569.099] [MU: 22.05/23147.73] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp99)) OR (apr_area_type = 2 AND apr_area_id IN (:gp100)) OR (apr_area_type = 4 AND apr_area_id IN (:gp101)) OR (apr_area_type = 1 AND apr_area_id IN (:gp98))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp98":"31",":gp99":"30804",":gp100":"105",":gp101":"1","cab":"54"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27604.01] [M: 23135.08] [ET: 0.407/27570.029] [MU: 3.33/23134.64] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27607.188] [M: 23145.31] [ET: 3.007/27573.181] [MU: 3.36/23144.44] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp103)) OR (scr_area_type = 2 AND scr_area_id IN (:gp104)) OR (scr_area_type = 4 AND scr_area_id IN (:gp105)) OR (scr_area_type = 1 AND scr_area_id IN (:gp102)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp102":"31",":gp103":"30804",":gp104":"105",":gp105":"1","scv_id":"54"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27610.655] [M: 23173.09] [ET: 2.499/27576.643] [MU: 0.74/23165.09] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"nearest_route_30804_30711","sql":"(INDEX indx_nearest_rt_rutid (rut_id)) \r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, routeFrom.rut_name as fromAlias, \r\n\t\t\t\tNULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, \r\n\t\t\t\t0 as rank, routeFrom.rut_estm_time as startTime, 0 as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 \r\n\t\t\t\tAND routeFrom.rut_from_city_id<>routeFrom.rut_to_city_id AND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\t\tAND (routeAlias.rut_to_city_id=route.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, NULL, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) \r\n\t\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\t0 AS extraStartDistance, 0, 0 as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND route.rut_from_city_id = 30804 AND route.rut_to_city_id=30711 \r\n\t\t\t\tAND routeTo.rut_from_city_id=30711\r\n\t\t\t\tAND route.rut_active = 1 AND routeTo.rut_active = 1 AND routeTo.rut_estm_distance < 50 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = route.rut_from_city_id) \r\n\t\t\t   AND (routeAlias.rut_to_city_id = routeTo.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, \r\n\t\t\t\trouteFrom.rut_name, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t+ IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) \r\n\t\t\t\tAS extraDistance, IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, 0, \r\n\t\t\t\trouteFrom.rut_estm_time as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 AND routeFrom.rut_from_city_id <> routeFrom.rut_to_city_id\r\n\t\t\t\t\tAND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND routeTo.rut_estm_distance < 50 \r\n\t\t\t\t\tAND routeTo.rut_from_city_id=30711 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\tAND (routeAlias.rut_to_city_id=routeTo.rut_to_city_id) AND routeAlias.rut_active = 1 AND routeAlias.rut_from_city_id=30804  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27613.934] [M: 23177.12] [ET: 3.168/27579.926] [MU: 2.11/23176.68] 
	SQL: SELECT *, (rte_vendor_amount + extraDistance * 10.55) as totalCost FROM (SELECT * FROM nearest_route_30804_30711) a
					INNER JOIN rate ON a.rut_id = rate.rte_route_id AND rte_status=1 AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <>0
					WHERE 1 ORDER BY rank DESC, totalCost ASC LIMIT 0,1 
	 [params: {"cabType":"54"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27614.877] [M: 23185.14] [ET: 0.786/27580.862] [MU: 0.74/23183.14] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"getNearestRoute_30804_30711_70","sql":"(INDEX getNearestRoute_30804_30711_70_index_rut_id (rut_id))\r\n\t\t\t\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id AS start, routeAlias.rut_to_city_id AS end,\r\n\t\t\t\t\t\t\t\trouteFrom.rut_name AS fromAlias, NULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance AS quotedDistance,\r\n\t\t\t\t\t\t\t\trouteAlias.rut_estm_distance AS rateDistance, \r\n\t\t\t\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance)\r\n\t\t\t\t\t\t\t\t\t - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance,\r\n\t\t\t\t\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance,\r\n\t\t\t\t\t\t\t\t0 AS rank, routeFrom.rut_estm_time AS startTime, 0 AS endTime, route.rut_estm_time, \r\n\t\t\t\t\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraTravelDistance\r\n\t\t\t\t\t\tFROM   route\r\n\t\t\t\t\t\tINNER JOIN route routeTo ON routeTo.rut_to_city_id=route.rut_from_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_from_city_id=30804 AND routeTo.rut_active=1\r\n\t\t\t\t\t\t\t\tAND routeTo.rut_estm_distance<70 AND route.rut_active=1\r\n\t\t\t\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_from_city_id=route.rut_to_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_active = 1\r\n\t\t\t\t\t\t\t\tAND routeFrom.rut_estm_distance<70 AND route.rut_active = 1\r\n\t\t\t\t\t\tINNER JOIN route routeAlias ON routeAlias.rut_to_city_id=routeFrom.rut_to_city_id\r\n\t\t\t\t\t\t\tAND routeAlias.rut_from_city_id=routeTo.rut_from_city_id AND routeAlias.rut_active = 1"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27617.84] [M: 23190.41] [ET: 2.833/27583.833] [MU: 2.41/23189.78] 
	SQL: SELECT *, (rte_vendor_amount + extradistance * 10.55 ) AS totalCost, 
						ABS(quotedDistance-rateDistance) AS extraChargeableDistance
					FROM getNearestRoute_30804_30711_70 a
					INNER JOIN rate ON a.rut_id=rate.rte_route_id AND rte_status=1 
						AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <> 0
					WHERE  1
					ORDER  BY rank DESC, extraStartDistance, extraChargeableDistance ASC, totalcost ASC
					LIMIT  0, 1 
	 [params: {"cabType":"54"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27621.374] [M: 23205.55] [ET: 0.694/27587.38] [MU: 3.46/23204.67] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"45","fromCity":"30804","toCity":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27623.459] [M: 23222.16] [ET: 0.602/27589.476] [MU: 3.78/23221.29] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"16","fromCity":"30804","toCity":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27625.199] [M: 23238.78] [ET: 0.673/27591.214] [MU: 3.78/23237.91] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27626.575] [M: 23250.73] [ET: 31.25/27592.599] [MU: 149.05/23250.58] 
	Quote::calculateOneWay  for CAB 54 Date: 2024-10-24 04:00:00
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27627.082] [M: 23254.23] [ET: 0.414/27593.104] [MU: 0.9/23253.98] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27628.391] [M: 23266.95] [ET: 0.767/27594.407] [MU: 3.34/23266.51] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27629.174] [M: 23296.12] [ET: 0.628/27595.18] [MU: 22.53/23295.37] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp108)) OR (apr_area_type = 5 AND apr_area_id IN (:gp106)) OR (apr_area_type = 2 AND apr_area_id IN (:gp109)) OR (apr_area_type = 4 AND apr_area_id IN (:gp110)) OR (apr_area_type = 1 AND apr_area_id IN (:gp107))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp106":"3699",":gp107":"31",":gp108":"30804",":gp109":"105",":gp110":"1","cab":"54"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27630.88] [M: 23283.14] [ET: 0.585/27596.879] [MU: 3.34/23282.7] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27633.993] [M: 23293.64] [ET: 2.934/27599.985] [MU: 3.49/23292.77] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp113)) OR (scr_area_type = 5 AND scr_area_id IN (:gp111)) OR (scr_area_type = 2 AND scr_area_id IN (:gp114)) OR (scr_area_type = 4 AND scr_area_id IN (:gp115)) OR (scr_area_type = 1 AND scr_area_id IN (:gp112)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp111":"3699",":gp112":"31",":gp113":"3699",":gp114":"105",":gp115":"1","scv_id":"54"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27634.748] [M: 23294.8] [ET: 0.367/27600.755] [MU: 2.98/23294.7] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27637.273] [M: 23304.96] [ET: 1.023/27603.278] [MU: 2.84/23304.34] 
	SQL: SELECT 
						fc.cty_id as c2id, 
						fc.cty_name as c2name, 
						fc.cty_garage_address as c2address,
						tc.cty_id as c4id,
						tc.cty_name as c4name, tc.cty_garage_address as c4address,
						0 as totalExtraDistance FROM route
						INNER JOIN cities fc ON rut_from_city_id=fc.cty_id
						INNER JOIN cities tc ON rut_to_city_id=tc.cty_id
						INNER JOIN rate on  rate.rte_route_id=route.rut_id  AND rate.rte_vehicletype_id IN (3)
						WHERE route.rut_from_city_id=30804 AND route.rut_to_city_id=30711 AND route.rut_active=1 
	 [params: []]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27637.98] [M: 23318.84] [ET: 0.605/27603.968] [MU: 6.53/23316.84] 
	SQL: 
				SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address, tc.cty_id as c4id, 
				tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
					FROM
					 (
						(
							SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id,  
								r3.rut_to_city_id, route.rut_name , route.rut_id,
								(route.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, 
								r3.rut_estm_distance
							FROM route
							INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_from_city_id=30804  
									AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=route.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) 
									AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
						UNION
						(
							SELECT r3.rut_id, r3.rut_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,(route.rut_estm_distance + r1.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
							FROM route
							INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND  route.rut_to_city_id=30711 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND route.rut_to_city_id=r3.rut_to_city_id))	AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
                     ) a
					INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
					INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1 
	 [params: []]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27638.729] [M: 23329.35] [ET: 0.636/27604.722] [MU: 5.03/23327.85] 
	SQL: SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
                              tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
                        FROM (SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,
                                    (route.rut_estm_distance + r1.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
                                FROM route
								INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
								INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
								INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) AND r3.rut_active=1 
								INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3) LIMIT 1
							)a
                        INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
                        INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1
                         
	 [params: []]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27639.556] [M: 23335.73] [ET: 0.706/27605.566] [MU: 0.74/23334.85] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"GarageRoute_30804_30711","sql":" (INDEX GarageRoute_30804_30711_index_rut_id (rut_id), INDEX GarageRoute_30804_30711_index_rut_from_city_id (rut_from_city_id), INDEX GarageRoute_30804_30711_index_rut_to_city_id (rut_to_city_id))\r\n\t\t\t\t\t\t\tSELECT route.rut_id, route.rut_from_city_id, route.rut_to_city_id, route.rut_name, rut_estm_distance FROM route \r\n\t\t\t\t\t\t\tINNER JOIN cities_stats   ON cities_stats.cts_cty_id = route.rut_from_city_id\r\n\t\t\t\t\t\t\tAND rut_estm_distance < 300\r\n\t\t\t\t\t\t\tAND rut_active = 1\r\n\t\t\t\t\t\t\tAND route.rut_to_city_id=30804\r\n\t\t\t\t\t\t\tAND cities_stats.cts_vnd_cnt >= 3\r\n\t\t\t\t\t\t\tORDER BY rut_estm_distance LIMIT 10"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27640.38] [M: 23347.65] [ET: 0.714/27606.367] [MU: 6.69/23345.9] 
	SQL: SELECT a.*, fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
								tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address 
						FROM ((SELECT xyz.rut_from_city_id as startCity, r1.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r3.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_from_city_id
							INNER JOIN rate ON rate.rte_route_id=r1.rut_id  AND rate.rte_vehicletype_id IN (3)
							INNER JOIN route r2 ON r2.rut_to_city_id=r1.rut_to_city_id AND r2.rut_from_city_id=:dropCity AND r2.rut_active=1
							INNER JOIN route r3 ON r3.rut_from_city_id=xyz.rut_to_city_id AND r3.rut_to_city_id=r2.rut_from_city_id AND r3.rut_active=1
							ORDER BY ExtraDistance LIMIT 1
							)
							UNION
							(
							SELECT xyz.rut_from_city_id as startCity, r2.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r2.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_to_city_id AND r1.rut_to_city_id=:dropCity
							INNER JOIN route r2 ON r2.rut_to_city_id=xyz.rut_from_city_id AND r2.rut_from_city_id=r1.rut_to_city_id
							ORDER BY ExtraDistance ASC LIMIT 1
							)) a
						INNER JOIN cities fc ON startCity=fc.cty_id
						INNER JOIN cities tc ON endCity=tc.cty_id 
						ORDER BY ExtraDistance 
	 [params: {"pickupCity":"30804","dropCity":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27643.425] [M: 23358.99] [ET: 1.281/27609.442] [MU: 7.89/23358.88] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27644.595] [M: 23364.56] [ET: 1.063/27610.596] [MU: 8.27/23364.45] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27645.499] [M: 23372.19] [ET: 0.361/27611.499] [MU: 1/23371.81] 
	SQL: SELECT cts_airport_pickup_entry_fee
               FROM   cities
               INNER JOIN cities_stats
               ON cities.cty_id = cities_stats.cts_cty_id
               WHERE  cty_id = :cityId
               AND cty_is_airport = 1 AND cty_active = 1 
	 [params: {"cityId":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27647.339] [M: 23386.1] [ET: 1.067/27613.36] [MU: 8.13/23385.99] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27648.579] [M: 23393.84] [ET: 1.14/27614.598] [MU: 8.08/23393.73] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27649.124] [M: 23393.18] [ET: 0.451/27615.132] [MU: 0.9/23392.93] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27650.7] [M: 23405.89] [ET: 0.882/27616.714] [MU: 3.34/23405.45] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27651.471] [M: 23435.06] [ET: 0.656/27617.484] [MU: 22.54/23434.31] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp118)) OR (apr_area_type = 5 AND apr_area_id IN (:gp116)) OR (apr_area_type = 2 AND apr_area_id IN (:gp119)) OR (apr_area_type = 4 AND apr_area_id IN (:gp120)) OR (apr_area_type = 1 AND apr_area_id IN (:gp117))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp116":"3699",":gp117":"31",":gp118":"30804",":gp119":"105",":gp120":"1","cab":"54"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27653.307] [M: 23422.09] [ET: 0.511/27619.317] [MU: 3.33/23421.65] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27656.177] [M: 23432.59] [ET: 2.745/27622.17] [MU: 3.48/23431.71] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp123)) OR (scr_area_type = 5 AND scr_area_id IN (:gp121)) OR (scr_area_type = 2 AND scr_area_id IN (:gp124)) OR (scr_area_type = 4 AND scr_area_id IN (:gp125)) OR (scr_area_type = 1 AND scr_area_id IN (:gp122)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp121":"3699",":gp122":"31",":gp123":"3699",":gp124":"105",":gp125":"1","scv_id":"54"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27657.041] [M: 23435.79] [ET: 0.366/27623.048] [MU: 2.97/23435.68] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27659.055] [M: 23448.9] [ET: 0.375/27625.06] [MU: 2.97/23448.79] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27659.385] [M: 23452.98] [ET: 0.234/27625.409] [MU: 2.98/23452.87] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27664.537] [M: 23487.08] [ET: 0.871/27630.53] [MU: 6.33/23485.08] 
	SQL: 
                SELECT cities.cty_id as c2id, cities.cty_name as c2name, cities.cty_garage_address as c2address,
                    cities.cty_id as c4id, cities.cty_name as c4name, cities.cty_garage_address as c4address,
                        (distance * 2) as totalExtraDistance
                 FROM (SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<40
                     INNER JOIN route r1 ON route.rut_to_city_id=r1.rut_from_city_id AND r1.rut_active=1
                     INNER JOIN rate ON r1.rut_id=rate.rte_route_id AND rate.rte_status=1  AND rate.rte_vehicletype_id IN (3) GROUP BY route.rut_id HAVING count(*) >30
                   UNION
                     SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<600
                     INNER JOIN cities tc ON tc.cty_id=route.rut_to_city_id AND tc.cty_service_active=1 AND CalcDistance(cities.cty_lat, cities.cty_long, tc.cty_lat, tc.cty_long)<=route.rut_estm_distance						 
                     INNER JOIN cities_stats ON cities_stats.cts_cty_id = route.rut_to_city_id AND cities_stats.cts_vnd_cnt >= 2
                   UNION
                    SELECT cts_cty_id AS city, 0 AS distance
					FROM cities_stats WHERE 1 AND cities_stats.cts_cty_id= 30817 and cities_stats.cts_vnd_cnt>1) a
                    INNER JOIN cities ON cities.cty_id=a.city
                    ORDER BY totalExtraDistance LIMIT 1 
	 [params: []]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27667.34] [M: 23501.89] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.255.12
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"3","tripDistance":"","tripDuration":"","multiCityData":"","bookingType":"1","pickupAddress":"","pickupDate":"24\/10\/2024","pickupTime":"04:00 AM","isGozonow":"0","minTripDistance":"0","sccId":"0","tripUser":"1","YII_CSRF_TOKEN":"N3VxRE1WeG9UeHk5UWFBUFpPT216eWVyY0xWTVpoTkcUoJ2aBoup1fU2M5E4ePVZVcUNlKiYZZysUqEklNiKWw==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=3&tripDistance=&tripDuration=&multiCityData=&bookingType=1&pickupAddress=&pickupDate=24%2F10%2F2024&pickupTime=04%3A00+AM&isGozonow=0&minTripDistance=0&sccId=0&tripUser=1&YII_CSRF_TOKEN=N3VxRE1WeG9UeHk5UWFBUFpPT216eWVyY0xWTVpoTkcUoJ2aBoup1fU2M5E4ePVZVcUNlKiYZZysUqEklNiKWw%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27667.932] [M: 23521.45] [ET: 1.037/27633.955] [MU: 20.77/23521.34] 
	models.RouteRates.calculateDriverAllowance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27667.965] [M: 23523.13] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27669.2] [M: 23536.59] [ET: 1.087/27635.197] [MU: 3/23534.09] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+10013),(IF((cpm_value_type=2),(10013+(10013*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30937 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30937) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-24 04:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=54 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27670.977] [M: 23578.82] [ET: 4.126/27636.979] [MU: 78.6/23578.66] 
	RouteRates::calculate for CAB 54 2024-10-24 04:00:00 - Trip Type: 1 156522435
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27671.162] [M: 23556.51] [ET: 44.527/27637.186] [MU: 304.31/23556.35] 
	Quote::calculateRules for CAB 54, From City Id: 30804, To city Id: 30711
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27671.544] [M: 23528.01] [ET: 0.301/27637.564] [MU: 0.9/23527.76] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"54"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27671.621] [M: 23529.26] [ET: 85.484/27637.647] [MU: 475.18/23529.16] 
	Quote For CabType: 54
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27672.977] [M: 23539.6] [ET: 0.452/27638.997] [MU: 3.34/23539.16] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27673.606] [M: 23545.41] [ET: 0.538/27639.62] [MU: 3.34/23544.98] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27674.405] [M: 23548.35] [ET: 0.697/27640.396] [MU: 0.89/23548.1] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27675.146] [M: 23580.71] [ET: 0.579/27641.159] [MU: 24.22/23579.21] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (100) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30711) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp126)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp129,:gp130)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp127,:gp128)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp131,:gp132))
			OR (scr_area_type = 5 AND scr_area_id IN (3699))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (55)
		ORDER BY rank DESC
		 
	 [params: {":gp126":"31",":gp127":"30804",":gp128":"30711",":gp129":"105",":gp130":"100",":gp131":"1",":gp132":"1","tripType":"1"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27675.812] [M: 23560.89] [ET: 0.17/27641.834] [MU: 0.84/23560.7] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27676.188] [M: 23563.77] [ET: 0.293/27642.192] [MU: 0.97/23563.45] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"4"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27677.538] [M: 23576.73] [ET: 0.336/27643.557] [MU: 2.05/23576.23] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"55"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27680.793] [M: 23586.07] [ET: 3.051/27646.8] [MU: 3.49/23585.2] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"55","fromCity":"30804","toCity":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27682.633] [M: 23589.32] [ET: 0.562/27648.646] [MU: 0.86/23589.1] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":0}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27683.435] [M: 23596.65] [ET: 0.628/27649.447] [MU: 3.01/23596.21] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27684.081] [M: 23624.82] [ET: 0.543/27650.1] [MU: 22.05/23624.2] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp134)) OR (apr_area_type = 2 AND apr_area_id IN (:gp135)) OR (apr_area_type = 4 AND apr_area_id IN (:gp136)) OR (apr_area_type = 1 AND apr_area_id IN (:gp133))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp133":"31",":gp134":"30804",":gp135":"105",":gp136":"1","cab":"55"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27685.3] [M: 23611.54] [ET: 0.484/27651.319] [MU: 3.33/23611.1] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27688.094] [M: 23621.77] [ET: 2.67/27654.086] [MU: 3.36/23620.9] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp138)) OR (scr_area_type = 2 AND scr_area_id IN (:gp139)) OR (scr_area_type = 4 AND scr_area_id IN (:gp140)) OR (scr_area_type = 1 AND scr_area_id IN (:gp137)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp137":"31",":gp138":"30804",":gp139":"105",":gp140":"1","scv_id":"55"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27691.582] [M: 23655.05] [ET: 2.52/27657.574] [MU: 0.74/23647.05] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"nearest_route_30804_30711","sql":"(INDEX indx_nearest_rt_rutid (rut_id)) \r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, routeFrom.rut_name as fromAlias, \r\n\t\t\t\tNULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, \r\n\t\t\t\t0 as rank, routeFrom.rut_estm_time as startTime, 0 as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 \r\n\t\t\t\tAND routeFrom.rut_from_city_id<>routeFrom.rut_to_city_id AND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\t\tAND (routeAlias.rut_to_city_id=route.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, NULL, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) \r\n\t\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\t0 AS extraStartDistance, 0, 0 as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND route.rut_from_city_id = 30804 AND route.rut_to_city_id=30711 \r\n\t\t\t\tAND routeTo.rut_from_city_id=30711\r\n\t\t\t\tAND route.rut_active = 1 AND routeTo.rut_active = 1 AND routeTo.rut_estm_distance < 50 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = route.rut_from_city_id) \r\n\t\t\t   AND (routeAlias.rut_to_city_id = routeTo.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, \r\n\t\t\t\trouteFrom.rut_name, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t+ IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) \r\n\t\t\t\tAS extraDistance, IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, 0, \r\n\t\t\t\trouteFrom.rut_estm_time as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 AND routeFrom.rut_from_city_id <> routeFrom.rut_to_city_id\r\n\t\t\t\t\tAND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND routeTo.rut_estm_distance < 50 \r\n\t\t\t\t\tAND routeTo.rut_from_city_id=30711 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\tAND (routeAlias.rut_to_city_id=routeTo.rut_to_city_id) AND routeAlias.rut_active = 1 AND routeAlias.rut_from_city_id=30804  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27694.755] [M: 23659.09] [ET: 3.073/27660.768] [MU: 2.12/23658.65] 
	SQL: SELECT *, (rte_vendor_amount + extraDistance * 10.55) as totalCost FROM (SELECT * FROM nearest_route_30804_30711) a
					INNER JOIN rate ON a.rut_id = rate.rte_route_id AND rte_status=1 AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <>0
					WHERE 1 ORDER BY rank DESC, totalCost ASC LIMIT 0,1 
	 [params: {"cabType":"55"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27695.467] [M: 23667.11] [ET: 0.604/27661.474] [MU: 0.74/23665.11] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"getNearestRoute_30804_30711_70","sql":"(INDEX getNearestRoute_30804_30711_70_index_rut_id (rut_id))\r\n\t\t\t\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id AS start, routeAlias.rut_to_city_id AS end,\r\n\t\t\t\t\t\t\t\trouteFrom.rut_name AS fromAlias, NULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance AS quotedDistance,\r\n\t\t\t\t\t\t\t\trouteAlias.rut_estm_distance AS rateDistance, \r\n\t\t\t\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance)\r\n\t\t\t\t\t\t\t\t\t - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance,\r\n\t\t\t\t\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance,\r\n\t\t\t\t\t\t\t\t0 AS rank, routeFrom.rut_estm_time AS startTime, 0 AS endTime, route.rut_estm_time, \r\n\t\t\t\t\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraTravelDistance\r\n\t\t\t\t\t\tFROM   route\r\n\t\t\t\t\t\tINNER JOIN route routeTo ON routeTo.rut_to_city_id=route.rut_from_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_from_city_id=30804 AND routeTo.rut_active=1\r\n\t\t\t\t\t\t\t\tAND routeTo.rut_estm_distance<70 AND route.rut_active=1\r\n\t\t\t\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_from_city_id=route.rut_to_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_active = 1\r\n\t\t\t\t\t\t\t\tAND routeFrom.rut_estm_distance<70 AND route.rut_active = 1\r\n\t\t\t\t\t\tINNER JOIN route routeAlias ON routeAlias.rut_to_city_id=routeFrom.rut_to_city_id\r\n\t\t\t\t\t\t\tAND routeAlias.rut_from_city_id=routeTo.rut_from_city_id AND routeAlias.rut_active = 1"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27698.558] [M: 23672.38] [ET: 2.991/27664.554] [MU: 2.41/23671.75] 
	SQL: SELECT *, (rte_vendor_amount + extradistance * 10.55 ) AS totalCost, 
						ABS(quotedDistance-rateDistance) AS extraChargeableDistance
					FROM getNearestRoute_30804_30711_70 a
					INNER JOIN rate ON a.rut_id=rate.rte_route_id AND rte_status=1 
						AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <> 0
					WHERE  1
					ORDER  BY rank DESC, extraStartDistance, extraChargeableDistance ASC, totalcost ASC
					LIMIT  0, 1 
	 [params: {"cabType":"55"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27702.182] [M: 23687.51] [ET: 0.693/27668.183] [MU: 3.47/23686.63] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"45","fromCity":"30804","toCity":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27704.088] [M: 23704.13] [ET: 0.593/27670.104] [MU: 3.78/23703.25] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"16","fromCity":"30804","toCity":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27706.052] [M: 23720.74] [ET: 0.644/27672.053] [MU: 3.78/23719.87] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27707.54] [M: 23732.7] [ET: 29.935/27673.565] [MU: 154.55/23732.55] 
	Quote::calculateOneWay  for CAB 55 Date: 2024-10-24 04:00:00
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27708.254] [M: 23736.2] [ET: 0.601/27674.249] [MU: 0.9/23735.95] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27710.789] [M: 23748.91] [ET: 0.904/27676.792] [MU: 3.34/23748.48] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27711.772] [M: 23778.09] [ET: 0.77/27677.753] [MU: 22.53/23777.34] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp143)) OR (apr_area_type = 5 AND apr_area_id IN (:gp141)) OR (apr_area_type = 2 AND apr_area_id IN (:gp144)) OR (apr_area_type = 4 AND apr_area_id IN (:gp145)) OR (apr_area_type = 1 AND apr_area_id IN (:gp142))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp141":"3699",":gp142":"31",":gp143":"30804",":gp144":"105",":gp145":"1","cab":"55"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27713.743] [M: 23765.1] [ET: 0.56/27679.761] [MU: 3.34/23764.66] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27717.233] [M: 23775.6] [ET: 3.361/27683.226] [MU: 3.49/23774.73] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp148)) OR (scr_area_type = 5 AND scr_area_id IN (:gp146)) OR (scr_area_type = 2 AND scr_area_id IN (:gp149)) OR (scr_area_type = 4 AND scr_area_id IN (:gp150)) OR (scr_area_type = 1 AND scr_area_id IN (:gp147)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp146":"3699",":gp147":"31",":gp148":"3699",":gp149":"105",":gp150":"1","scv_id":"55"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27717.833] [M: 23776.77] [ET: 0.237/27683.857] [MU: 2.98/23776.66] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27720.461] [M: 23851.02] [ET: 0.866/27686.434] [MU: 2.83/23850.4] 
	SQL: SELECT 
						fc.cty_id as c2id, 
						fc.cty_name as c2name, 
						fc.cty_garage_address as c2address,
						tc.cty_id as c4id,
						tc.cty_name as c4name, tc.cty_garage_address as c4address,
						0 as totalExtraDistance FROM route
						INNER JOIN cities fc ON rut_from_city_id=fc.cty_id
						INNER JOIN cities tc ON rut_to_city_id=tc.cty_id
						INNER JOIN rate on  rate.rte_route_id=route.rut_id  AND rate.rte_vehicletype_id IN (3)
						WHERE route.rut_from_city_id=30804 AND route.rut_to_city_id=30711 AND route.rut_active=1 
	 [params: []]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27721.44] [M: 23864.91] [ET: 0.83/27687.433] [MU: 6.53/23862.91] 
	SQL: 
				SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address, tc.cty_id as c4id, 
				tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
					FROM
					 (
						(
							SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id,  
								r3.rut_to_city_id, route.rut_name , route.rut_id,
								(route.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, 
								r3.rut_estm_distance
							FROM route
							INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_from_city_id=30804  
									AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=route.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) 
									AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
						UNION
						(
							SELECT r3.rut_id, r3.rut_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,(route.rut_estm_distance + r1.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
							FROM route
							INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND  route.rut_to_city_id=30711 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND route.rut_to_city_id=r3.rut_to_city_id))	AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
                     ) a
					INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
					INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1 
	 [params: []]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27722.081] [M: 23875.41] [ET: 0.538/27688.094] [MU: 5.03/23873.91] 
	SQL: SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
                              tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
                        FROM (SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,
                                    (route.rut_estm_distance + r1.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
                                FROM route
								INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
								INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
								INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) AND r3.rut_active=1 
								INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3) LIMIT 1
							)a
                        INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
                        INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1
                         
	 [params: []]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27722.663] [M: 23881.79] [ET: 0.506/27688.68] [MU: 0.75/23880.91] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"GarageRoute_30804_30711","sql":" (INDEX GarageRoute_30804_30711_index_rut_id (rut_id), INDEX GarageRoute_30804_30711_index_rut_from_city_id (rut_from_city_id), INDEX GarageRoute_30804_30711_index_rut_to_city_id (rut_to_city_id))\r\n\t\t\t\t\t\t\tSELECT route.rut_id, route.rut_from_city_id, route.rut_to_city_id, route.rut_name, rut_estm_distance FROM route \r\n\t\t\t\t\t\t\tINNER JOIN cities_stats   ON cities_stats.cts_cty_id = route.rut_from_city_id\r\n\t\t\t\t\t\t\tAND rut_estm_distance < 300\r\n\t\t\t\t\t\t\tAND rut_active = 1\r\n\t\t\t\t\t\t\tAND route.rut_to_city_id=30804\r\n\t\t\t\t\t\t\tAND cities_stats.cts_vnd_cnt >= 3\r\n\t\t\t\t\t\t\tORDER BY rut_estm_distance LIMIT 10"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27723.233] [M: 23893.71] [ET: 0.495/27689.248] [MU: 6.68/23891.96] 
	SQL: SELECT a.*, fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
								tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address 
						FROM ((SELECT xyz.rut_from_city_id as startCity, r1.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r3.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_from_city_id
							INNER JOIN rate ON rate.rte_route_id=r1.rut_id  AND rate.rte_vehicletype_id IN (3)
							INNER JOIN route r2 ON r2.rut_to_city_id=r1.rut_to_city_id AND r2.rut_from_city_id=:dropCity AND r2.rut_active=1
							INNER JOIN route r3 ON r3.rut_from_city_id=xyz.rut_to_city_id AND r3.rut_to_city_id=r2.rut_from_city_id AND r3.rut_active=1
							ORDER BY ExtraDistance LIMIT 1
							)
							UNION
							(
							SELECT xyz.rut_from_city_id as startCity, r2.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r2.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_to_city_id AND r1.rut_to_city_id=:dropCity
							INNER JOIN route r2 ON r2.rut_to_city_id=xyz.rut_from_city_id AND r2.rut_from_city_id=r1.rut_to_city_id
							ORDER BY ExtraDistance ASC LIMIT 1
							)) a
						INNER JOIN cities fc ON startCity=fc.cty_id
						INNER JOIN cities tc ON endCity=tc.cty_id 
						ORDER BY ExtraDistance 
	 [params: {"pickupCity":"30804","dropCity":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27726.036] [M: 23905.05] [ET: 1.174/27692.053] [MU: 7.88/23904.95] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27727.015] [M: 23910.63] [ET: 0.877/27693.018] [MU: 8.27/23910.52] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27728.059] [M: 23918.25] [ET: 0.304/27694.07] [MU: 0.99/23917.88] 
	SQL: SELECT cts_airport_pickup_entry_fee
               FROM   cities
               INNER JOIN cities_stats
               ON cities.cty_id = cities_stats.cts_cty_id
               WHERE  cty_id = :cityId
               AND cty_is_airport = 1 AND cty_active = 1 
	 [params: {"cityId":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27729.734] [M: 23932.16] [ET: 1.036/27695.753] [MU: 8.14/23932.05] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27730.834] [M: 23940] [ET: 0.997/27696.851] [MU: 8.07/23939.89] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27731.71] [M: 23939.34] [ET: 0.678/27697.724] [MU: 0.9/23939.09] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27732.961] [M: 23952.05] [ET: 0.601/27698.979] [MU: 3.33/23951.61] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27733.682] [M: 23981.22] [ET: 0.611/27699.701] [MU: 22.53/23980.47] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp153)) OR (apr_area_type = 5 AND apr_area_id IN (:gp151)) OR (apr_area_type = 2 AND apr_area_id IN (:gp154)) OR (apr_area_type = 4 AND apr_area_id IN (:gp155)) OR (apr_area_type = 1 AND apr_area_id IN (:gp152))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp151":"3699",":gp152":"31",":gp153":"30804",":gp154":"105",":gp155":"1","cab":"55"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27735.053] [M: 23968.23] [ET: 0.451/27701.073] [MU: 3.34/23967.8] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27742.411] [M: 23978.73] [ET: 7.249/27708.421] [MU: 3.48/23977.86] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp158)) OR (scr_area_type = 5 AND scr_area_id IN (:gp156)) OR (scr_area_type = 2 AND scr_area_id IN (:gp159)) OR (scr_area_type = 4 AND scr_area_id IN (:gp160)) OR (scr_area_type = 1 AND scr_area_id IN (:gp157)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp156":"3699",":gp157":"31",":gp158":"3699",":gp159":"105",":gp160":"1","scv_id":"55"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27743.252] [M: 23981.95] [ET: 0.42/27709.255] [MU: 2.98/23981.84] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27744.954] [M: 23994.96] [ET: 0.236/27710.978] [MU: 2.97/23994.85] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27745.221] [M: 23999.13] [ET: 0.199/27711.246] [MU: 2.98/23999.02] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27749.716] [M: 24033.23] [ET: 0.837/27715.71] [MU: 6.33/24031.23] 
	SQL: 
                SELECT cities.cty_id as c2id, cities.cty_name as c2name, cities.cty_garage_address as c2address,
                    cities.cty_id as c4id, cities.cty_name as c4name, cities.cty_garage_address as c4address,
                        (distance * 2) as totalExtraDistance
                 FROM (SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<40
                     INNER JOIN route r1 ON route.rut_to_city_id=r1.rut_from_city_id AND r1.rut_active=1
                     INNER JOIN rate ON r1.rut_id=rate.rte_route_id AND rate.rte_status=1  AND rate.rte_vehicletype_id IN (3) GROUP BY route.rut_id HAVING count(*) >30
                   UNION
                     SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<600
                     INNER JOIN cities tc ON tc.cty_id=route.rut_to_city_id AND tc.cty_service_active=1 AND CalcDistance(cities.cty_lat, cities.cty_long, tc.cty_lat, tc.cty_long)<=route.rut_estm_distance						 
                     INNER JOIN cities_stats ON cities_stats.cts_cty_id = route.rut_to_city_id AND cities_stats.cts_vnd_cnt >= 2
                   UNION
                    SELECT cts_cty_id AS city, 0 AS distance
					FROM cities_stats WHERE 1 AND cities_stats.cts_cty_id= 30817 and cities_stats.cts_vnd_cnt>1) a
                    INNER JOIN cities ON cities.cty_id=a.city
                    ORDER BY totalExtraDistance LIMIT 1 
	 [params: []]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27753.024] [M: 24048.05] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.255.12
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"3","tripDistance":"","tripDuration":"","multiCityData":"","bookingType":"1","pickupAddress":"","pickupDate":"24\/10\/2024","pickupTime":"04:00 AM","isGozonow":"0","minTripDistance":"0","sccId":"0","tripUser":"1","YII_CSRF_TOKEN":"N3VxRE1WeG9UeHk5UWFBUFpPT216eWVyY0xWTVpoTkcUoJ2aBoup1fU2M5E4ePVZVcUNlKiYZZysUqEklNiKWw==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=3&tripDistance=&tripDuration=&multiCityData=&bookingType=1&pickupAddress=&pickupDate=24%2F10%2F2024&pickupTime=04%3A00+AM&isGozonow=0&minTripDistance=0&sccId=0&tripUser=1&YII_CSRF_TOKEN=N3VxRE1WeG9UeHk5UWFBUFpPT216eWVyY0xWTVpoTkcUoJ2aBoup1fU2M5E4ePVZVcUNlKiYZZysUqEklNiKWw%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27753.904] [M: 24067.61] [ET: 1.455/27719.911] [MU: 20.76/24067.5] 
	models.RouteRates.calculateDriverAllowance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27753.958] [M: 24069.29] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27755.311] [M: 24082.75] [ET: 1.173/27721.312] [MU: 2.99/24080.25] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+10013),(IF((cpm_value_type=2),(10013+(10013*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30937 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30937) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-24 04:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=55 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27757.134] [M: 24124.98] [ET: 4.779/27723.153] [MU: 78.59/24124.82] 
	RouteRates::calculate for CAB 55 2024-10-24 04:00:00 - Trip Type: 1 503969573
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27757.28] [M: 24102.66] [ET: 49.682/27723.305] [MU: 368.5/24102.51] 
	Quote::calculateRules for CAB 55, From City Id: 30804, To city Id: 30711
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27757.549] [M: 24074.17] [ET: 0.192/27723.571] [MU: 0.89/24073.92] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"55"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27757.622] [M: 24075.42] [ET: 85.949/27723.647] [MU: 544.86/24075.33] 
	Quote For CabType: 55
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27758.834] [M: 24085.77] [ET: 0.419/27724.853] [MU: 3.34/24085.33] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27759.371] [M: 24091.58] [ET: 0.467/27725.39] [MU: 3.33/24091.14] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27759.889] [M: 24094.52] [ET: 0.446/27725.906] [MU: 0.9/24094.27] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27760.817] [M: 24126.88] [ET: 0.793/27726.807] [MU: 24.22/24125.38] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (100) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30711) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp161)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp164,:gp165)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp162,:gp163)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp166,:gp167))
			OR (scr_area_type = 5 AND scr_area_id IN (3699))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (57)
		ORDER BY rank DESC
		 
	 [params: {":gp161":"31",":gp162":"30804",":gp163":"30711",":gp164":"105",":gp165":"100",":gp166":"1",":gp167":"1","tripType":"1"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27761.64] [M: 24107.05] [ET: 0.23/27727.659] [MU: 0.84/24106.87] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27762.036] [M: 24109.93] [ET: 0.317/27728.056] [MU: 0.96/24109.62] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"4"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27763.294] [M: 24122.9] [ET: 0.392/27729.293] [MU: 2.05/24122.4] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"57"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27766.921] [M: 24132.23] [ET: 3.323/27732.919] [MU: 3.48/24131.36] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"57","fromCity":"30804","toCity":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27768.413] [M: 24135.48] [ET: 0.652/27734.427] [MU: 0.87/24135.27] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":0}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27769.321] [M: 24142.81] [ET: 0.722/27735.321] [MU: 3.02/24142.38] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27770.159] [M: 24170.98] [ET: 0.667/27736.136] [MU: 22.04/24170.36] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp169)) OR (apr_area_type = 2 AND apr_area_id IN (:gp170)) OR (apr_area_type = 4 AND apr_area_id IN (:gp171)) OR (apr_area_type = 1 AND apr_area_id IN (:gp168))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp168":"31",":gp169":"30804",":gp170":"105",":gp171":"1","cab":"57"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27771.503] [M: 24157.7] [ET: 0.513/27737.521] [MU: 3.34/24157.27] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27774.362] [M: 24167.94] [ET: 2.73/27740.35] [MU: 3.36/24167.06] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp173)) OR (scr_area_type = 2 AND scr_area_id IN (:gp174)) OR (scr_area_type = 4 AND scr_area_id IN (:gp175)) OR (scr_area_type = 1 AND scr_area_id IN (:gp172)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp172":"31",":gp173":"30804",":gp174":"105",":gp175":"1","scv_id":"57"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27777.462] [M: 24195.72] [ET: 2.083/27743.433] [MU: 0.74/24187.72] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"nearest_route_30804_30711","sql":"(INDEX indx_nearest_rt_rutid (rut_id)) \r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, routeFrom.rut_name as fromAlias, \r\n\t\t\t\tNULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, \r\n\t\t\t\t0 as rank, routeFrom.rut_estm_time as startTime, 0 as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 \r\n\t\t\t\tAND routeFrom.rut_from_city_id<>routeFrom.rut_to_city_id AND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\t\tAND (routeAlias.rut_to_city_id=route.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, NULL, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) \r\n\t\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\t0 AS extraStartDistance, 0, 0 as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND route.rut_from_city_id = 30804 AND route.rut_to_city_id=30711 \r\n\t\t\t\tAND routeTo.rut_from_city_id=30711\r\n\t\t\t\tAND route.rut_active = 1 AND routeTo.rut_active = 1 AND routeTo.rut_estm_distance < 50 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = route.rut_from_city_id) \r\n\t\t\t   AND (routeAlias.rut_to_city_id = routeTo.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, \r\n\t\t\t\trouteFrom.rut_name, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t+ IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) \r\n\t\t\t\tAS extraDistance, IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, 0, \r\n\t\t\t\trouteFrom.rut_estm_time as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 AND routeFrom.rut_from_city_id <> routeFrom.rut_to_city_id\r\n\t\t\t\t\tAND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND routeTo.rut_estm_distance < 50 \r\n\t\t\t\t\tAND routeTo.rut_from_city_id=30711 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\tAND (routeAlias.rut_to_city_id=routeTo.rut_to_city_id) AND routeAlias.rut_active = 1 AND routeAlias.rut_from_city_id=30804  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27780.725] [M: 24199.75] [ET: 3.13/27746.714] [MU: 2.12/24199.31] 
	SQL: SELECT *, (rte_vendor_amount + extraDistance * 10.55) as totalCost FROM (SELECT * FROM nearest_route_30804_30711) a
					INNER JOIN rate ON a.rut_id = rate.rte_route_id AND rte_status=1 AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <>0
					WHERE 1 ORDER BY rank DESC, totalCost ASC LIMIT 0,1 
	 [params: {"cabType":"57"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27781.944] [M: 24207.77] [ET: 0.839/27747.946] [MU: 0.75/24205.77] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"getNearestRoute_30804_30711_70","sql":"(INDEX getNearestRoute_30804_30711_70_index_rut_id (rut_id))\r\n\t\t\t\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id AS start, routeAlias.rut_to_city_id AS end,\r\n\t\t\t\t\t\t\t\trouteFrom.rut_name AS fromAlias, NULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance AS quotedDistance,\r\n\t\t\t\t\t\t\t\trouteAlias.rut_estm_distance AS rateDistance, \r\n\t\t\t\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance)\r\n\t\t\t\t\t\t\t\t\t - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance,\r\n\t\t\t\t\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance,\r\n\t\t\t\t\t\t\t\t0 AS rank, routeFrom.rut_estm_time AS startTime, 0 AS endTime, route.rut_estm_time, \r\n\t\t\t\t\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraTravelDistance\r\n\t\t\t\t\t\tFROM   route\r\n\t\t\t\t\t\tINNER JOIN route routeTo ON routeTo.rut_to_city_id=route.rut_from_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_from_city_id=30804 AND routeTo.rut_active=1\r\n\t\t\t\t\t\t\t\tAND routeTo.rut_estm_distance<70 AND route.rut_active=1\r\n\t\t\t\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_from_city_id=route.rut_to_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_active = 1\r\n\t\t\t\t\t\t\t\tAND routeFrom.rut_estm_distance<70 AND route.rut_active = 1\r\n\t\t\t\t\t\tINNER JOIN route routeAlias ON routeAlias.rut_to_city_id=routeFrom.rut_to_city_id\r\n\t\t\t\t\t\t\tAND routeAlias.rut_from_city_id=routeTo.rut_from_city_id AND routeAlias.rut_active = 1"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27784.529] [M: 24213.04] [ET: 2.492/27750.539] [MU: 2.42/24212.41] 
	SQL: SELECT *, (rte_vendor_amount + extradistance * 10.55 ) AS totalCost, 
						ABS(quotedDistance-rateDistance) AS extraChargeableDistance
					FROM getNearestRoute_30804_30711_70 a
					INNER JOIN rate ON a.rut_id=rate.rte_route_id AND rte_status=1 
						AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <> 0
					WHERE  1
					ORDER  BY rank DESC, extraStartDistance, extraChargeableDistance ASC, totalcost ASC
					LIMIT  0, 1 
	 [params: {"cabType":"57"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27787.477] [M: 24228.17] [ET: 0.563/27753.493] [MU: 3.46/24227.3] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"45","fromCity":"30804","toCity":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27789.09] [M: 24244.79] [ET: 0.53/27755.101] [MU: 3.78/24243.91] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"16","fromCity":"30804","toCity":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27791.274] [M: 24261.41] [ET: 0.791/27757.271] [MU: 3.78/24260.53] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27792.924] [M: 24273.37] [ET: 29.539/27758.948] [MU: 149.04/24273.21] 
	Quote::calculateOneWay  for CAB 57 Date: 2024-10-24 04:00:00
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27793.438] [M: 24276.96] [ET: 0.403/27759.439] [MU: 0.89/24276.71] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27794.951] [M: 24289.67] [ET: 0.741/27760.952] [MU: 3.34/24289.23] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27795.641] [M: 24318.84] [ET: 0.543/27761.658] [MU: 22.53/24318.09] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp178)) OR (apr_area_type = 5 AND apr_area_id IN (:gp176)) OR (apr_area_type = 2 AND apr_area_id IN (:gp179)) OR (apr_area_type = 4 AND apr_area_id IN (:gp180)) OR (apr_area_type = 1 AND apr_area_id IN (:gp177))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp176":"3699",":gp177":"31",":gp178":"30804",":gp179":"105",":gp180":"1","cab":"57"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27797.359] [M: 24305.86] [ET: 0.596/27763.361] [MU: 3.33/24305.42] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27800.859] [M: 24316.36] [ET: 3.334/27766.861] [MU: 3.49/24315.48] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp183)) OR (scr_area_type = 5 AND scr_area_id IN (:gp181)) OR (scr_area_type = 2 AND scr_area_id IN (:gp184)) OR (scr_area_type = 4 AND scr_area_id IN (:gp185)) OR (scr_area_type = 1 AND scr_area_id IN (:gp182)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp181":"3699",":gp182":"31",":gp183":"3699",":gp184":"105",":gp185":"1","scv_id":"57"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27801.536] [M: 24317.53] [ET: 0.39/27767.539] [MU: 2.97/24317.42] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27803.702] [M: 24327.69] [ET: 0.624/27769.719] [MU: 2.84/24327.06] 
	SQL: SELECT 
						fc.cty_id as c2id, 
						fc.cty_name as c2name, 
						fc.cty_garage_address as c2address,
						tc.cty_id as c4id,
						tc.cty_name as c4name, tc.cty_garage_address as c4address,
						0 as totalExtraDistance FROM route
						INNER JOIN cities fc ON rut_from_city_id=fc.cty_id
						INNER JOIN cities tc ON rut_to_city_id=tc.cty_id
						INNER JOIN rate on  rate.rte_route_id=route.rut_id  AND rate.rte_vehicletype_id IN (3)
						WHERE route.rut_from_city_id=30804 AND route.rut_to_city_id=30711 AND route.rut_active=1 
	 [params: []]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27804.237] [M: 24341.57] [ET: 0.458/27770.252] [MU: 6.53/24339.57] 
	SQL: 
				SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address, tc.cty_id as c4id, 
				tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
					FROM
					 (
						(
							SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id,  
								r3.rut_to_city_id, route.rut_name , route.rut_id,
								(route.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, 
								r3.rut_estm_distance
							FROM route
							INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_from_city_id=30804  
									AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=route.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) 
									AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
						UNION
						(
							SELECT r3.rut_id, r3.rut_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,(route.rut_estm_distance + r1.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
							FROM route
							INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND  route.rut_to_city_id=30711 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND route.rut_to_city_id=r3.rut_to_city_id))	AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
                     ) a
					INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
					INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1 
	 [params: []]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27804.702] [M: 24352.08] [ET: 0.389/27770.714] [MU: 5.03/24350.58] 
	SQL: SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
                              tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
                        FROM (SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,
                                    (route.rut_estm_distance + r1.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
                                FROM route
								INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
								INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
								INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) AND r3.rut_active=1 
								INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3) LIMIT 1
							)a
                        INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
                        INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1
                         
	 [params: []]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27805.211] [M: 24358.45] [ET: 0.418/27771.207] [MU: 0.74/24357.58] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"GarageRoute_30804_30711","sql":" (INDEX GarageRoute_30804_30711_index_rut_id (rut_id), INDEX GarageRoute_30804_30711_index_rut_from_city_id (rut_from_city_id), INDEX GarageRoute_30804_30711_index_rut_to_city_id (rut_to_city_id))\r\n\t\t\t\t\t\t\tSELECT route.rut_id, route.rut_from_city_id, route.rut_to_city_id, route.rut_name, rut_estm_distance FROM route \r\n\t\t\t\t\t\t\tINNER JOIN cities_stats   ON cities_stats.cts_cty_id = route.rut_from_city_id\r\n\t\t\t\t\t\t\tAND rut_estm_distance < 300\r\n\t\t\t\t\t\t\tAND rut_active = 1\r\n\t\t\t\t\t\t\tAND route.rut_to_city_id=30804\r\n\t\t\t\t\t\t\tAND cities_stats.cts_vnd_cnt >= 3\r\n\t\t\t\t\t\t\tORDER BY rut_estm_distance LIMIT 10"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27806.037] [M: 24370.38] [ET: 0.707/27772.033] [MU: 6.69/24368.63] 
	SQL: SELECT a.*, fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
								tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address 
						FROM ((SELECT xyz.rut_from_city_id as startCity, r1.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r3.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_from_city_id
							INNER JOIN rate ON rate.rte_route_id=r1.rut_id  AND rate.rte_vehicletype_id IN (3)
							INNER JOIN route r2 ON r2.rut_to_city_id=r1.rut_to_city_id AND r2.rut_from_city_id=:dropCity AND r2.rut_active=1
							INNER JOIN route r3 ON r3.rut_from_city_id=xyz.rut_to_city_id AND r3.rut_to_city_id=r2.rut_from_city_id AND r3.rut_active=1
							ORDER BY ExtraDistance LIMIT 1
							)
							UNION
							(
							SELECT xyz.rut_from_city_id as startCity, r2.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r2.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_to_city_id AND r1.rut_to_city_id=:dropCity
							INNER JOIN route r2 ON r2.rut_to_city_id=xyz.rut_from_city_id AND r2.rut_from_city_id=r1.rut_to_city_id
							ORDER BY ExtraDistance ASC LIMIT 1
							)) a
						INNER JOIN cities fc ON startCity=fc.cty_id
						INNER JOIN cities tc ON endCity=tc.cty_id 
						ORDER BY ExtraDistance 
	 [params: {"pickupCity":"30804","dropCity":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27809.015] [M: 24381.72] [ET: 1.29/27775.012] [MU: 7.88/24381.61] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27810.191] [M: 24387.2] [ET: 1.043/27776.208] [MU: 8.27/24387.09] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27811.169] [M: 24394.73] [ET: 0.439/27777.168] [MU: 0.99/24394.35] 
	SQL: SELECT cts_airport_pickup_entry_fee
               FROM   cities
               INNER JOIN cities_stats
               ON cities.cty_id = cities_stats.cts_cty_id
               WHERE  cty_id = :cityId
               AND cty_is_airport = 1 AND cty_active = 1 
	 [params: {"cityId":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27813.19] [M: 24408.64] [ET: 1.169/27779.188] [MU: 8.13/24408.53] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27814.79] [M: 24416.38] [ET: 1.412/27780.789] [MU: 8.08/24416.27] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27815.462] [M: 24415.72] [ET: 0.538/27781.464] [MU: 0.9/24415.47] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27816.957] [M: 24428.43] [ET: 0.735/27782.958] [MU: 3.33/24427.99] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27817.608] [M: 24457.6] [ET: 0.506/27783.623] [MU: 22.53/24456.85] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp188)) OR (apr_area_type = 5 AND apr_area_id IN (:gp186)) OR (apr_area_type = 2 AND apr_area_id IN (:gp189)) OR (apr_area_type = 4 AND apr_area_id IN (:gp190)) OR (apr_area_type = 1 AND apr_area_id IN (:gp187))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp186":"3699",":gp187":"31",":gp188":"30804",":gp189":"105",":gp190":"1","cab":"57"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27819.039] [M: 24444.62] [ET: 0.473/27785.054] [MU: 3.33/24444.18] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27822.403] [M: 24455.12] [ET: 3.215/27788.383] [MU: 3.48/24454.24] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp193)) OR (scr_area_type = 5 AND scr_area_id IN (:gp191)) OR (scr_area_type = 2 AND scr_area_id IN (:gp194)) OR (scr_area_type = 4 AND scr_area_id IN (:gp195)) OR (scr_area_type = 1 AND scr_area_id IN (:gp192)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp191":"3699",":gp192":"31",":gp193":"3699",":gp194":"105",":gp195":"1","scv_id":"57"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27823.257] [M: 24458.33] [ET: 0.348/27789.265] [MU: 2.98/24458.22] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27825.282] [M: 24471.44] [ET: 0.386/27791.288] [MU: 2.98/24471.33] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27825.734] [M: 24475.61] [ET: 0.343/27791.744] [MU: 2.97/24475.5] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27830.231] [M: 24509.62] [ET: 0.697/27796.227] [MU: 6.33/24507.62] 
	SQL: 
                SELECT cities.cty_id as c2id, cities.cty_name as c2name, cities.cty_garage_address as c2address,
                    cities.cty_id as c4id, cities.cty_name as c4name, cities.cty_garage_address as c4address,
                        (distance * 2) as totalExtraDistance
                 FROM (SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<40
                     INNER JOIN route r1 ON route.rut_to_city_id=r1.rut_from_city_id AND r1.rut_active=1
                     INNER JOIN rate ON r1.rut_id=rate.rte_route_id AND rate.rte_status=1  AND rate.rte_vehicletype_id IN (3) GROUP BY route.rut_id HAVING count(*) >30
                   UNION
                     SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<600
                     INNER JOIN cities tc ON tc.cty_id=route.rut_to_city_id AND tc.cty_service_active=1 AND CalcDistance(cities.cty_lat, cities.cty_long, tc.cty_lat, tc.cty_long)<=route.rut_estm_distance						 
                     INNER JOIN cities_stats ON cities_stats.cts_cty_id = route.rut_to_city_id AND cities_stats.cts_vnd_cnt >= 2
                   UNION
                    SELECT cts_cty_id AS city, 0 AS distance
					FROM cities_stats WHERE 1 AND cities_stats.cts_cty_id= 30817 and cities_stats.cts_vnd_cnt>1) a
                    INNER JOIN cities ON cities.cty_id=a.city
                    ORDER BY totalExtraDistance LIMIT 1 
	 [params: []]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27833.108] [M: 24524.43] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.255.12
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"3","tripDistance":"","tripDuration":"","multiCityData":"","bookingType":"1","pickupAddress":"","pickupDate":"24\/10\/2024","pickupTime":"04:00 AM","isGozonow":"0","minTripDistance":"0","sccId":"0","tripUser":"1","YII_CSRF_TOKEN":"N3VxRE1WeG9UeHk5UWFBUFpPT216eWVyY0xWTVpoTkcUoJ2aBoup1fU2M5E4ePVZVcUNlKiYZZysUqEklNiKWw==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=3&tripDistance=&tripDuration=&multiCityData=&bookingType=1&pickupAddress=&pickupDate=24%2F10%2F2024&pickupTime=04%3A00+AM&isGozonow=0&minTripDistance=0&sccId=0&tripUser=1&YII_CSRF_TOKEN=N3VxRE1WeG9UeHk5UWFBUFpPT216eWVyY0xWTVpoTkcUoJ2aBoup1fU2M5E4ePVZVcUNlKiYZZysUqEklNiKWw%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27833.594] [M: 24543.99] [ET: 0.919/27799.619] [MU: 20.77/24543.88] 
	models.RouteRates.calculateDriverAllowance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27833.626] [M: 24545.67] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27834.601] [M: 24559.13] [ET: 0.837/27800.592] [MU: 3/24556.63] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+10013),(IF((cpm_value_type=2),(10013+(10013*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30937 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30937) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-24 04:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=57 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27836.16] [M: 24601.36] [ET: 3.524/27802.164] [MU: 78.6/24601.2] 
	RouteRates::calculate for CAB 57 2024-10-24 04:00:00 - Trip Type: 1 110458904
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27836.389] [M: 24579.05] [ET: 43.389/27802.393] [MU: 304.12/24578.89] 
	Quote::calculateRules for CAB 57, From City Id: 30804, To city Id: 30711
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27836.772] [M: 24550.55] [ET: 0.265/27802.776] [MU: 0.9/24550.3] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"57"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27836.881] [M: 24551.8] [ET: 79.196/27802.891] [MU: 475.07/24551.71] 
	Quote For CabType: 57
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27838.395] [M: 24562.15] [ET: 0.522/27804.398] [MU: 3.33/24561.71] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27838.98] [M: 24567.96] [ET: 0.481/27804.987] [MU: 3.34/24567.52] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27839.644] [M: 24570.9] [ET: 0.571/27805.659] [MU: 0.9/24570.65] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27840.398] [M: 24603.26] [ET: 0.611/27806.382] [MU: 24.22/24601.76] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (100) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30711) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp196)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp199,:gp200)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp197,:gp198)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp201,:gp202))
			OR (scr_area_type = 5 AND scr_area_id IN (3699))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (69)
		ORDER BY rank DESC
		 
	 [params: {":gp196":"31",":gp197":"30804",":gp198":"30711",":gp199":"105",":gp200":"100",":gp201":"1",":gp202":"1","tripType":"1"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27841.245] [M: 24583.44] [ET: 0.237/27807.237] [MU: 0.83/24583.25] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27841.776] [M: 24586.31] [ET: 0.416/27807.778] [MU: 0.96/24586] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"4"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27843.295] [M: 24599.28] [ET: 0.393/27809.296] [MU: 2.04/24598.78] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"69"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27848.997] [M: 24608.62] [ET: 5.381/27814.973] [MU: 3.48/24607.74] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"69","fromCity":"30804","toCity":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27850.5] [M: 24611.87] [ET: 0.603/27816.497] [MU: 0.87/24611.65] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":0}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27851.512] [M: 24619.2] [ET: 0.77/27817.529] [MU: 3.02/24618.76] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27852.198] [M: 24647.37] [ET: 0.577/27818.216] [MU: 22.04/24646.74] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp204)) OR (apr_area_type = 2 AND apr_area_id IN (:gp205)) OR (apr_area_type = 4 AND apr_area_id IN (:gp206)) OR (apr_area_type = 1 AND apr_area_id IN (:gp203))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp203":"31",":gp204":"30804",":gp205":"105",":gp206":"1","cab":"69"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27853.414] [M: 24634.09] [ET: 0.58/27819.417] [MU: 3.33/24633.65] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27855.976] [M: 24644.32] [ET: 2.41/27821.988] [MU: 3.36/24643.45] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp208)) OR (scr_area_type = 2 AND scr_area_id IN (:gp209)) OR (scr_area_type = 4 AND scr_area_id IN (:gp210)) OR (scr_area_type = 1 AND scr_area_id IN (:gp207)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp207":"31",":gp208":"30804",":gp209":"105",":gp210":"1","scv_id":"69"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27859.554] [M: 24672.1] [ET: 2.751/27825.518] [MU: 0.74/24664.1] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"nearest_route_30804_30711","sql":"(INDEX indx_nearest_rt_rutid (rut_id)) \r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, routeFrom.rut_name as fromAlias, \r\n\t\t\t\tNULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, \r\n\t\t\t\t0 as rank, routeFrom.rut_estm_time as startTime, 0 as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 \r\n\t\t\t\tAND routeFrom.rut_from_city_id<>routeFrom.rut_to_city_id AND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\t\tAND (routeAlias.rut_to_city_id=route.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, NULL, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) \r\n\t\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\t0 AS extraStartDistance, 0, 0 as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND route.rut_from_city_id = 30804 AND route.rut_to_city_id=30711 \r\n\t\t\t\tAND routeTo.rut_from_city_id=30711\r\n\t\t\t\tAND route.rut_active = 1 AND routeTo.rut_active = 1 AND routeTo.rut_estm_distance < 50 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = route.rut_from_city_id) \r\n\t\t\t   AND (routeAlias.rut_to_city_id = routeTo.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, \r\n\t\t\t\trouteFrom.rut_name, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t+ IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) \r\n\t\t\t\tAS extraDistance, IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, 0, \r\n\t\t\t\trouteFrom.rut_estm_time as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 AND routeFrom.rut_from_city_id <> routeFrom.rut_to_city_id\r\n\t\t\t\t\tAND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND routeTo.rut_estm_distance < 50 \r\n\t\t\t\t\tAND routeTo.rut_from_city_id=30711 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\tAND (routeAlias.rut_to_city_id=routeTo.rut_to_city_id) AND routeAlias.rut_active = 1 AND routeAlias.rut_from_city_id=30804  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27863.539] [M: 24676.13] [ET: 3.854/27829.541] [MU: 2.12/24675.7] 
	SQL: SELECT *, (rte_vendor_amount + extraDistance * 10.55) as totalCost FROM (SELECT * FROM nearest_route_30804_30711) a
					INNER JOIN rate ON a.rut_id = rate.rte_route_id AND rte_status=1 AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <>0
					WHERE 1 ORDER BY rank DESC, totalCost ASC LIMIT 0,1 
	 [params: {"cabType":"69"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27864.577] [M: 24684.16] [ET: 0.908/27830.559] [MU: 0.74/24682.16] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"getNearestRoute_30804_30711_70","sql":"(INDEX getNearestRoute_30804_30711_70_index_rut_id (rut_id))\r\n\t\t\t\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id AS start, routeAlias.rut_to_city_id AS end,\r\n\t\t\t\t\t\t\t\trouteFrom.rut_name AS fromAlias, NULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance AS quotedDistance,\r\n\t\t\t\t\t\t\t\trouteAlias.rut_estm_distance AS rateDistance, \r\n\t\t\t\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance)\r\n\t\t\t\t\t\t\t\t\t - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance,\r\n\t\t\t\t\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance,\r\n\t\t\t\t\t\t\t\t0 AS rank, routeFrom.rut_estm_time AS startTime, 0 AS endTime, route.rut_estm_time, \r\n\t\t\t\t\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraTravelDistance\r\n\t\t\t\t\t\tFROM   route\r\n\t\t\t\t\t\tINNER JOIN route routeTo ON routeTo.rut_to_city_id=route.rut_from_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_from_city_id=30804 AND routeTo.rut_active=1\r\n\t\t\t\t\t\t\t\tAND routeTo.rut_estm_distance<70 AND route.rut_active=1\r\n\t\t\t\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_from_city_id=route.rut_to_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_active = 1\r\n\t\t\t\t\t\t\t\tAND routeFrom.rut_estm_distance<70 AND route.rut_active = 1\r\n\t\t\t\t\t\tINNER JOIN route routeAlias ON routeAlias.rut_to_city_id=routeFrom.rut_to_city_id\r\n\t\t\t\t\t\t\tAND routeAlias.rut_from_city_id=routeTo.rut_from_city_id AND routeAlias.rut_active = 1"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27867.704] [M: 24689.42] [ET: 2.989/27833.699] [MU: 2.41/24688.8] 
	SQL: SELECT *, (rte_vendor_amount + extradistance * 10.55 ) AS totalCost, 
						ABS(quotedDistance-rateDistance) AS extraChargeableDistance
					FROM getNearestRoute_30804_30711_70 a
					INNER JOIN rate ON a.rut_id=rate.rte_route_id AND rte_status=1 
						AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <> 0
					WHERE  1
					ORDER  BY rank DESC, extraStartDistance, extraChargeableDistance ASC, totalcost ASC
					LIMIT  0, 1 
	 [params: {"cabType":"69"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27871.358] [M: 24704.55] [ET: 0.753/27837.36] [MU: 3.46/24703.68] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"45","fromCity":"30804","toCity":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27872.965] [M: 24721.17] [ET: 0.481/27838.983] [MU: 3.78/24720.3] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"16","fromCity":"30804","toCity":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27874.605] [M: 24737.79] [ET: 0.522/27840.622] [MU: 3.78/24736.91] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27876.241] [M: 24749.75] [ET: 32.853/27842.263] [MU: 149.05/24749.59] 
	Quote::calculateOneWay  for CAB 69 Date: 2024-10-24 04:00:00
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27876.886] [M: 24753.34] [ET: 0.543/27842.902] [MU: 0.9/24753.09] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27878.168] [M: 24766.05] [ET: 0.67/27844.183] [MU: 3.34/24765.62] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27878.842] [M: 24795.23] [ET: 0.563/27844.858] [MU: 22.53/24794.48] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp213)) OR (apr_area_type = 5 AND apr_area_id IN (:gp211)) OR (apr_area_type = 2 AND apr_area_id IN (:gp214)) OR (apr_area_type = 4 AND apr_area_id IN (:gp215)) OR (apr_area_type = 1 AND apr_area_id IN (:gp212))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp211":"3699",":gp212":"31",":gp213":"30804",":gp214":"105",":gp215":"1","cab":"69"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27880.634] [M: 24782.24] [ET: 0.711/27846.625] [MU: 3.34/24781.8] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27886.469] [M: 24792.74] [ET: 5.637/27852.45] [MU: 3.48/24791.87] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp218)) OR (scr_area_type = 5 AND scr_area_id IN (:gp216)) OR (scr_area_type = 2 AND scr_area_id IN (:gp219)) OR (scr_area_type = 4 AND scr_area_id IN (:gp220)) OR (scr_area_type = 1 AND scr_area_id IN (:gp217)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp216":"3699",":gp217":"31",":gp218":"3699",":gp219":"105",":gp220":"1","scv_id":"69"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27887.356] [M: 24793.91] [ET: 0.438/27853.353] [MU: 2.98/24793.8] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27890.464] [M: 24804.07] [ET: 1.122/27856.45] [MU: 2.84/24803.45] 
	SQL: SELECT 
						fc.cty_id as c2id, 
						fc.cty_name as c2name, 
						fc.cty_garage_address as c2address,
						tc.cty_id as c4id,
						tc.cty_name as c4name, tc.cty_garage_address as c4address,
						0 as totalExtraDistance FROM route
						INNER JOIN cities fc ON rut_from_city_id=fc.cty_id
						INNER JOIN cities tc ON rut_to_city_id=tc.cty_id
						INNER JOIN rate on  rate.rte_route_id=route.rut_id  AND rate.rte_vehicletype_id IN (3)
						WHERE route.rut_from_city_id=30804 AND route.rut_to_city_id=30711 AND route.rut_active=1 
	 [params: []]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27891.409] [M: 24817.95] [ET: 0.806/27857.392] [MU: 6.54/24815.95] 
	SQL: 
				SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address, tc.cty_id as c4id, 
				tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
					FROM
					 (
						(
							SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id,  
								r3.rut_to_city_id, route.rut_name , route.rut_id,
								(route.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, 
								r3.rut_estm_distance
							FROM route
							INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_from_city_id=30804  
									AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=route.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) 
									AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
						UNION
						(
							SELECT r3.rut_id, r3.rut_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,(route.rut_estm_distance + r1.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
							FROM route
							INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND  route.rut_to_city_id=30711 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND route.rut_to_city_id=r3.rut_to_city_id))	AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
                     ) a
					INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
					INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1 
	 [params: []]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27892.206] [M: 24828.46] [ET: 0.668/27858.196] [MU: 5.03/24826.96] 
	SQL: SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
                              tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
                        FROM (SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,
                                    (route.rut_estm_distance + r1.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
                                FROM route
								INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
								INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
								INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) AND r3.rut_active=1 
								INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3) LIMIT 1
							)a
                        INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
                        INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1
                         
	 [params: []]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27892.874] [M: 24834.84] [ET: 0.538/27858.865] [MU: 0.74/24833.96] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"GarageRoute_30804_30711","sql":" (INDEX GarageRoute_30804_30711_index_rut_id (rut_id), INDEX GarageRoute_30804_30711_index_rut_from_city_id (rut_from_city_id), INDEX GarageRoute_30804_30711_index_rut_to_city_id (rut_to_city_id))\r\n\t\t\t\t\t\t\tSELECT route.rut_id, route.rut_from_city_id, route.rut_to_city_id, route.rut_name, rut_estm_distance FROM route \r\n\t\t\t\t\t\t\tINNER JOIN cities_stats   ON cities_stats.cts_cty_id = route.rut_from_city_id\r\n\t\t\t\t\t\t\tAND rut_estm_distance < 300\r\n\t\t\t\t\t\t\tAND rut_active = 1\r\n\t\t\t\t\t\t\tAND route.rut_to_city_id=30804\r\n\t\t\t\t\t\t\tAND cities_stats.cts_vnd_cnt >= 3\r\n\t\t\t\t\t\t\tORDER BY rut_estm_distance LIMIT 10"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27893.694] [M: 24846.76] [ET: 0.704/27859.698] [MU: 6.69/24845.01] 
	SQL: SELECT a.*, fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
								tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address 
						FROM ((SELECT xyz.rut_from_city_id as startCity, r1.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r3.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_from_city_id
							INNER JOIN rate ON rate.rte_route_id=r1.rut_id  AND rate.rte_vehicletype_id IN (3)
							INNER JOIN route r2 ON r2.rut_to_city_id=r1.rut_to_city_id AND r2.rut_from_city_id=:dropCity AND r2.rut_active=1
							INNER JOIN route r3 ON r3.rut_from_city_id=xyz.rut_to_city_id AND r3.rut_to_city_id=r2.rut_from_city_id AND r3.rut_active=1
							ORDER BY ExtraDistance LIMIT 1
							)
							UNION
							(
							SELECT xyz.rut_from_city_id as startCity, r2.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r2.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_to_city_id AND r1.rut_to_city_id=:dropCity
							INNER JOIN route r2 ON r2.rut_to_city_id=xyz.rut_from_city_id AND r2.rut_from_city_id=r1.rut_to_city_id
							ORDER BY ExtraDistance ASC LIMIT 1
							)) a
						INNER JOIN cities fc ON startCity=fc.cty_id
						INNER JOIN cities tc ON endCity=tc.cty_id 
						ORDER BY ExtraDistance 
	 [params: {"pickupCity":"30804","dropCity":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27896.53] [M: 24858.1] [ET: 1.332/27862.545] [MU: 7.88/24857.99] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27897.709] [M: 24863.58] [ET: 1.079/27863.724] [MU: 8.26/24863.47] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27898.749] [M: 24871.2] [ET: 0.407/27864.745] [MU: 0.99/24870.83] 
	SQL: SELECT cts_airport_pickup_entry_fee
               FROM   cities
               INNER JOIN cities_stats
               ON cities.cty_id = cities_stats.cts_cty_id
               WHERE  cty_id = :cityId
               AND cty_is_airport = 1 AND cty_active = 1 
	 [params: {"cityId":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27901.079] [M: 24885.12] [ET: 1.432/27867.094] [MU: 8.13/24885.01] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27902.136] [M: 24892.95] [ET: 0.937/27868.137] [MU: 8.08/24892.84] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27902.65] [M: 24892.38] [ET: 0.403/27868.668] [MU: 0.9/24892.13] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27903.821] [M: 24905.09] [ET: 0.606/27869.838] [MU: 3.34/24904.66] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27904.422] [M: 24934.27] [ET: 0.489/27870.437] [MU: 22.53/24933.52] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp223)) OR (apr_area_type = 5 AND apr_area_id IN (:gp221)) OR (apr_area_type = 2 AND apr_area_id IN (:gp224)) OR (apr_area_type = 4 AND apr_area_id IN (:gp225)) OR (apr_area_type = 1 AND apr_area_id IN (:gp222))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp221":"3699",":gp222":"31",":gp223":"30804",":gp224":"105",":gp225":"1","cab":"69"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27906.155] [M: 24921.28] [ET: 0.52/27872.172] [MU: 3.34/24920.84] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27909.472] [M: 24931.78] [ET: 3.184/27875.462] [MU: 3.49/24930.91] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp228)) OR (scr_area_type = 5 AND scr_area_id IN (:gp226)) OR (scr_area_type = 2 AND scr_area_id IN (:gp229)) OR (scr_area_type = 4 AND scr_area_id IN (:gp230)) OR (scr_area_type = 1 AND scr_area_id IN (:gp227)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp226":"3699",":gp227":"31",":gp228":"3699",":gp229":"105",":gp230":"1","scv_id":"69"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27910.406] [M: 24934.99] [ET: 0.438/27876.42] [MU: 2.98/24934.88] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27912.12] [M: 24948.01] [ET: 0.253/27878.143] [MU: 2.98/24947.9] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27912.403] [M: 24952.09] [ET: 0.212/27878.423] [MU: 2.98/24951.98] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27917.346] [M: 24986.19] [ET: 0.805/27883.341] [MU: 6.33/24984.19] 
	SQL: 
                SELECT cities.cty_id as c2id, cities.cty_name as c2name, cities.cty_garage_address as c2address,
                    cities.cty_id as c4id, cities.cty_name as c4name, cities.cty_garage_address as c4address,
                        (distance * 2) as totalExtraDistance
                 FROM (SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<40
                     INNER JOIN route r1 ON route.rut_to_city_id=r1.rut_from_city_id AND r1.rut_active=1
                     INNER JOIN rate ON r1.rut_id=rate.rte_route_id AND rate.rte_status=1  AND rate.rte_vehicletype_id IN (3) GROUP BY route.rut_id HAVING count(*) >30
                   UNION
                     SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<600
                     INNER JOIN cities tc ON tc.cty_id=route.rut_to_city_id AND tc.cty_service_active=1 AND CalcDistance(cities.cty_lat, cities.cty_long, tc.cty_lat, tc.cty_long)<=route.rut_estm_distance						 
                     INNER JOIN cities_stats ON cities_stats.cts_cty_id = route.rut_to_city_id AND cities_stats.cts_vnd_cnt >= 2
                   UNION
                    SELECT cts_cty_id AS city, 0 AS distance
					FROM cities_stats WHERE 1 AND cities_stats.cts_cty_id= 30817 and cities_stats.cts_vnd_cnt>1) a
                    INNER JOIN cities ON cities.cty_id=a.city
                    ORDER BY totalExtraDistance LIMIT 1 
	 [params: []]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27920.13] [M: 25001] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.255.12
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"3","tripDistance":"","tripDuration":"","multiCityData":"","bookingType":"1","pickupAddress":"","pickupDate":"24\/10\/2024","pickupTime":"04:00 AM","isGozonow":"0","minTripDistance":"0","sccId":"0","tripUser":"1","YII_CSRF_TOKEN":"N3VxRE1WeG9UeHk5UWFBUFpPT216eWVyY0xWTVpoTkcUoJ2aBoup1fU2M5E4ePVZVcUNlKiYZZysUqEklNiKWw==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=3&tripDistance=&tripDuration=&multiCityData=&bookingType=1&pickupAddress=&pickupDate=24%2F10%2F2024&pickupTime=04%3A00+AM&isGozonow=0&minTripDistance=0&sccId=0&tripUser=1&YII_CSRF_TOKEN=N3VxRE1WeG9UeHk5UWFBUFpPT216eWVyY0xWTVpoTkcUoJ2aBoup1fU2M5E4ePVZVcUNlKiYZZysUqEklNiKWw%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27920.707] [M: 25020.56] [ET: 1.093/27886.732] [MU: 20.77/25020.45] 
	models.RouteRates.calculateDriverAllowance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27920.74] [M: 25022.24] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27922.076] [M: 25035.7] [ET: 1.19/27888.061] [MU: 3/25033.2] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+10013),(IF((cpm_value_type=2),(10013+(10013*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30937 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30937) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-24 04:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=69 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27924.039] [M: 25077.93] [ET: 4.48/27890.059] [MU: 78.6/25077.77] 
	RouteRates::calculate for CAB 69 2024-10-24 04:00:00 - Trip Type: 1 171489817
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27924.186] [M: 25055.62] [ET: 47.883/27890.21] [MU: 304.31/25055.46] 
	Quote::calculateRules for CAB 69, From City Id: 30804, To city Id: 30711
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27924.51] [M: 25027.13] [ET: 0.232/27890.511] [MU: 0.9/25026.88] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"69"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27924.626] [M: 25028.38] [ET: 87.666/27890.634] [MU: 475.26/25028.28] 
	Quote For CabType: 69
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27926.174] [M: 25038.72] [ET: 0.517/27892.177] [MU: 3.33/25038.28] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27926.786] [M: 25044.53] [ET: 0.509/27892.79] [MU: 3.34/25044.09] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27927.376] [M: 25047.47] [ET: 0.499/27893.396] [MU: 0.9/25047.22] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27928.095] [M: 25079.83] [ET: 0.587/27894.081] [MU: 24.22/25078.33] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (100) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30711) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp231)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp234,:gp235)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp232,:gp233)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp236,:gp237))
			OR (scr_area_type = 5 AND scr_area_id IN (3699))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (70)
		ORDER BY rank DESC
		 
	 [params: {":gp231":"31",":gp232":"30804",":gp233":"30711",":gp234":"105",":gp235":"100",":gp236":"1",":gp237":"1","tripType":"1"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27928.983] [M: 25060.01] [ET: 0.239/27894.988] [MU: 0.83/25059.82] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27929.535] [M: 25062.88] [ET: 0.439/27895.535] [MU: 0.96/25062.57] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"4"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27931.739] [M: 25075.85] [ET: 0.713/27897.733] [MU: 2.04/25075.35] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"70"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27934.794] [M: 25085.19] [ET: 2.734/27900.801] [MU: 3.49/25084.31] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"70","fromCity":"30804","toCity":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27936.216] [M: 25088.44] [ET: 0.657/27902.214] [MU: 0.87/25088.22] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":0}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27937.113] [M: 25095.77] [ET: 0.659/27903.13] [MU: 3.01/25095.33] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27937.841] [M: 25123.94] [ET: 0.572/27903.854] [MU: 22.05/25123.31] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp239)) OR (apr_area_type = 2 AND apr_area_id IN (:gp240)) OR (apr_area_type = 4 AND apr_area_id IN (:gp241)) OR (apr_area_type = 1 AND apr_area_id IN (:gp238))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp238":"31",":gp239":"30804",":gp240":"105",":gp241":"1","cab":"70"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27939.006] [M: 25110.66] [ET: 0.522/27905.012] [MU: 3.33/25110.22] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27942.283] [M: 25120.89] [ET: 3.116/27908.274] [MU: 3.36/25120.02] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp243)) OR (scr_area_type = 2 AND scr_area_id IN (:gp244)) OR (scr_area_type = 4 AND scr_area_id IN (:gp245)) OR (scr_area_type = 1 AND scr_area_id IN (:gp242)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp242":"31",":gp243":"30804",":gp244":"105",":gp245":"1","scv_id":"70"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27945.299] [M: 25148.67] [ET: 2.003/27911.273] [MU: 0.74/25140.67] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"nearest_route_30804_30711","sql":"(INDEX indx_nearest_rt_rutid (rut_id)) \r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, routeFrom.rut_name as fromAlias, \r\n\t\t\t\tNULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, \r\n\t\t\t\t0 as rank, routeFrom.rut_estm_time as startTime, 0 as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 \r\n\t\t\t\tAND routeFrom.rut_from_city_id<>routeFrom.rut_to_city_id AND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\t\tAND (routeAlias.rut_to_city_id=route.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, NULL, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) \r\n\t\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\t0 AS extraStartDistance, 0, 0 as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND route.rut_from_city_id = 30804 AND route.rut_to_city_id=30711 \r\n\t\t\t\tAND routeTo.rut_from_city_id=30711\r\n\t\t\t\tAND route.rut_active = 1 AND routeTo.rut_active = 1 AND routeTo.rut_estm_distance < 50 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = route.rut_from_city_id) \r\n\t\t\t   AND (routeAlias.rut_to_city_id = routeTo.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, \r\n\t\t\t\trouteFrom.rut_name, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t+ IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) \r\n\t\t\t\tAS extraDistance, IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, 0, \r\n\t\t\t\trouteFrom.rut_estm_time as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 AND routeFrom.rut_from_city_id <> routeFrom.rut_to_city_id\r\n\t\t\t\t\tAND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND routeTo.rut_estm_distance < 50 \r\n\t\t\t\t\tAND routeTo.rut_from_city_id=30711 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\tAND (routeAlias.rut_to_city_id=routeTo.rut_to_city_id) AND routeAlias.rut_active = 1 AND routeAlias.rut_from_city_id=30804  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27948.858] [M: 25152.7] [ET: 3.425/27914.852] [MU: 2.12/25152.27] 
	SQL: SELECT *, (rte_vendor_amount + extraDistance * 10.55) as totalCost FROM (SELECT * FROM nearest_route_30804_30711) a
					INNER JOIN rate ON a.rut_id = rate.rte_route_id AND rte_status=1 AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <>0
					WHERE 1 ORDER BY rank DESC, totalCost ASC LIMIT 0,1 
	 [params: {"cabType":"70"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27949.813] [M: 25160.73] [ET: 0.764/27915.802] [MU: 0.74/25158.73] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"getNearestRoute_30804_30711_70","sql":"(INDEX getNearestRoute_30804_30711_70_index_rut_id (rut_id))\r\n\t\t\t\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id AS start, routeAlias.rut_to_city_id AS end,\r\n\t\t\t\t\t\t\t\trouteFrom.rut_name AS fromAlias, NULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance AS quotedDistance,\r\n\t\t\t\t\t\t\t\trouteAlias.rut_estm_distance AS rateDistance, \r\n\t\t\t\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance)\r\n\t\t\t\t\t\t\t\t\t - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance,\r\n\t\t\t\t\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance,\r\n\t\t\t\t\t\t\t\t0 AS rank, routeFrom.rut_estm_time AS startTime, 0 AS endTime, route.rut_estm_time, \r\n\t\t\t\t\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraTravelDistance\r\n\t\t\t\t\t\tFROM   route\r\n\t\t\t\t\t\tINNER JOIN route routeTo ON routeTo.rut_to_city_id=route.rut_from_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_from_city_id=30804 AND routeTo.rut_active=1\r\n\t\t\t\t\t\t\t\tAND routeTo.rut_estm_distance<70 AND route.rut_active=1\r\n\t\t\t\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_from_city_id=route.rut_to_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_active = 1\r\n\t\t\t\t\t\t\t\tAND routeFrom.rut_estm_distance<70 AND route.rut_active = 1\r\n\t\t\t\t\t\tINNER JOIN route routeAlias ON routeAlias.rut_to_city_id=routeFrom.rut_to_city_id\r\n\t\t\t\t\t\t\tAND routeAlias.rut_from_city_id=routeTo.rut_from_city_id AND routeAlias.rut_active = 1"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27952.834] [M: 25165.99] [ET: 2.898/27918.829] [MU: 2.41/25165.37] 
	SQL: SELECT *, (rte_vendor_amount + extradistance * 10.55 ) AS totalCost, 
						ABS(quotedDistance-rateDistance) AS extraChargeableDistance
					FROM getNearestRoute_30804_30711_70 a
					INNER JOIN rate ON a.rut_id=rate.rte_route_id AND rte_status=1 
						AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <> 0
					WHERE  1
					ORDER  BY rank DESC, extraStartDistance, extraChargeableDistance ASC, totalcost ASC
					LIMIT  0, 1 
	 [params: {"cabType":"70"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27956.54] [M: 25181.13] [ET: 0.854/27922.532] [MU: 3.46/25180.25] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"45","fromCity":"30804","toCity":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27958.863] [M: 25197.74] [ET: 0.631/27924.864] [MU: 3.78/25196.87] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"16","fromCity":"30804","toCity":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27961.087] [M: 25214.36] [ET: 0.665/27927.088] [MU: 3.78/25213.48] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27962.791] [M: 25226.32] [ET: 30.936/27928.781] [MU: 149.05/25226.16] 
	Quote::calculateOneWay  for CAB 70 Date: 2024-10-24 04:00:00
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27963.509] [M: 25229.91] [ET: 0.56/27929.502] [MU: 0.9/25229.66] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27965.101] [M: 25242.63] [ET: 0.77/27931.117] [MU: 3.34/25242.19] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27965.837] [M: 25271.8] [ET: 0.625/27931.855] [MU: 22.53/25271.05] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp248)) OR (apr_area_type = 5 AND apr_area_id IN (:gp246)) OR (apr_area_type = 2 AND apr_area_id IN (:gp249)) OR (apr_area_type = 4 AND apr_area_id IN (:gp250)) OR (apr_area_type = 1 AND apr_area_id IN (:gp247))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp246":"3699",":gp247":"31",":gp248":"30804",":gp249":"105",":gp250":"1","cab":"70"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27967.136] [M: 25258.81] [ET: 0.425/27933.157] [MU: 3.34/25258.38] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27969.962] [M: 25269.31] [ET: 2.69/27935.952] [MU: 3.48/25268.44] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp253)) OR (scr_area_type = 5 AND scr_area_id IN (:gp251)) OR (scr_area_type = 2 AND scr_area_id IN (:gp254)) OR (scr_area_type = 4 AND scr_area_id IN (:gp255)) OR (scr_area_type = 1 AND scr_area_id IN (:gp252)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp251":"3699",":gp252":"31",":gp253":"3699",":gp254":"105",":gp255":"1","scv_id":"70"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27970.8] [M: 25270.48] [ET: 0.367/27936.808] [MU: 2.98/25270.38] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27973.206] [M: 25280.64] [ET: 0.783/27939.207] [MU: 2.84/25280.02] 
	SQL: SELECT 
						fc.cty_id as c2id, 
						fc.cty_name as c2name, 
						fc.cty_garage_address as c2address,
						tc.cty_id as c4id,
						tc.cty_name as c4name, tc.cty_garage_address as c4address,
						0 as totalExtraDistance FROM route
						INNER JOIN cities fc ON rut_from_city_id=fc.cty_id
						INNER JOIN cities tc ON rut_to_city_id=tc.cty_id
						INNER JOIN rate on  rate.rte_route_id=route.rut_id  AND rate.rte_vehicletype_id IN (3)
						WHERE route.rut_from_city_id=30804 AND route.rut_to_city_id=30711 AND route.rut_active=1 
	 [params: []]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27973.818] [M: 25294.52] [ET: 0.503/27939.817] [MU: 6.54/25292.52] 
	SQL: 
				SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address, tc.cty_id as c4id, 
				tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
					FROM
					 (
						(
							SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id,  
								r3.rut_to_city_id, route.rut_name , route.rut_id,
								(route.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, 
								r3.rut_estm_distance
							FROM route
							INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_from_city_id=30804  
									AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=route.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) 
									AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
						UNION
						(
							SELECT r3.rut_id, r3.rut_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,(route.rut_estm_distance + r1.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
							FROM route
							INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND  route.rut_to_city_id=30711 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND route.rut_to_city_id=r3.rut_to_city_id))	AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
                     ) a
					INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
					INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1 
	 [params: []]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27974.4] [M: 25305.03] [ET: 0.481/27940.401] [MU: 5.03/25303.53] 
	SQL: SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
                              tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
                        FROM (SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,
                                    (route.rut_estm_distance + r1.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
                                FROM route
								INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
								INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
								INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) AND r3.rut_active=1 
								INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3) LIMIT 1
							)a
                        INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
                        INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1
                         
	 [params: []]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27974.929] [M: 25311.41] [ET: 0.409/27940.943] [MU: 0.74/25310.53] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"GarageRoute_30804_30711","sql":" (INDEX GarageRoute_30804_30711_index_rut_id (rut_id), INDEX GarageRoute_30804_30711_index_rut_from_city_id (rut_from_city_id), INDEX GarageRoute_30804_30711_index_rut_to_city_id (rut_to_city_id))\r\n\t\t\t\t\t\t\tSELECT route.rut_id, route.rut_from_city_id, route.rut_to_city_id, route.rut_name, rut_estm_distance FROM route \r\n\t\t\t\t\t\t\tINNER JOIN cities_stats   ON cities_stats.cts_cty_id = route.rut_from_city_id\r\n\t\t\t\t\t\t\tAND rut_estm_distance < 300\r\n\t\t\t\t\t\t\tAND rut_active = 1\r\n\t\t\t\t\t\t\tAND route.rut_to_city_id=30804\r\n\t\t\t\t\t\t\tAND cities_stats.cts_vnd_cnt >= 3\r\n\t\t\t\t\t\t\tORDER BY rut_estm_distance LIMIT 10"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27975.546] [M: 25323.33] [ET: 0.537/27941.56] [MU: 6.69/25321.58] 
	SQL: SELECT a.*, fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
								tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address 
						FROM ((SELECT xyz.rut_from_city_id as startCity, r1.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r3.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_from_city_id
							INNER JOIN rate ON rate.rte_route_id=r1.rut_id  AND rate.rte_vehicletype_id IN (3)
							INNER JOIN route r2 ON r2.rut_to_city_id=r1.rut_to_city_id AND r2.rut_from_city_id=:dropCity AND r2.rut_active=1
							INNER JOIN route r3 ON r3.rut_from_city_id=xyz.rut_to_city_id AND r3.rut_to_city_id=r2.rut_from_city_id AND r3.rut_active=1
							ORDER BY ExtraDistance LIMIT 1
							)
							UNION
							(
							SELECT xyz.rut_from_city_id as startCity, r2.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r2.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_to_city_id AND r1.rut_to_city_id=:dropCity
							INNER JOIN route r2 ON r2.rut_to_city_id=xyz.rut_from_city_id AND r2.rut_from_city_id=r1.rut_to_city_id
							ORDER BY ExtraDistance ASC LIMIT 1
							)) a
						INNER JOIN cities fc ON startCity=fc.cty_id
						INNER JOIN cities tc ON endCity=tc.cty_id 
						ORDER BY ExtraDistance 
	 [params: {"pickupCity":"30804","dropCity":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27978.461] [M: 25334.67] [ET: 1.299/27944.459] [MU: 7.89/25334.56] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27979.775] [M: 25340.24] [ET: 1.172/27945.772] [MU: 8.27/25340.13] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27981.152] [M: 25347.87] [ET: 0.545/27947.144] [MU: 0.99/25347.49] 
	SQL: SELECT cts_airport_pickup_entry_fee
               FROM   cities
               INNER JOIN cities_stats
               ON cities.cty_id = cities_stats.cts_cty_id
               WHERE  cty_id = :cityId
               AND cty_is_airport = 1 AND cty_active = 1 
	 [params: {"cityId":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27982.893] [M: 25361.78] [ET: 0.978/27948.896] [MU: 8.13/25361.67] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27984.026] [M: 25369.62] [ET: 0.997/27950.046] [MU: 8.08/25369.51] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27984.443] [M: 25369.05] [ET: 0.322/27950.446] [MU: 0.9/25368.8] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27986.104] [M: 25381.76] [ET: 0.735/27952.104] [MU: 3.33/25381.32] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27986.755] [M: 25410.93] [ET: 0.505/27952.771] [MU: 22.53/25410.18] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp258)) OR (apr_area_type = 5 AND apr_area_id IN (:gp256)) OR (apr_area_type = 2 AND apr_area_id IN (:gp259)) OR (apr_area_type = 4 AND apr_area_id IN (:gp260)) OR (apr_area_type = 1 AND apr_area_id IN (:gp257))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp256":"3699",":gp257":"31",":gp258":"30804",":gp259":"105",":gp260":"1","cab":"70"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27988.423] [M: 25397.95] [ET: 0.565/27954.425] [MU: 3.34/25397.51] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27991.756] [M: 25408.45] [ET: 3.164/27957.746] [MU: 3.48/25407.57] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp263)) OR (scr_area_type = 5 AND scr_area_id IN (:gp261)) OR (scr_area_type = 2 AND scr_area_id IN (:gp264)) OR (scr_area_type = 4 AND scr_area_id IN (:gp265)) OR (scr_area_type = 1 AND scr_area_id IN (:gp262)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp261":"3699",":gp262":"31",":gp263":"3699",":gp264":"105",":gp265":"1","scv_id":"70"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27992.637] [M: 25411.66] [ET: 0.378/27958.645] [MU: 2.98/25411.55] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27994.356] [M: 25424.77] [ET: 0.244/27960.379] [MU: 2.98/25424.66] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27994.625] [M: 25428.94] [ET: 0.201/27960.65] [MU: 2.98/25428.83] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 27999.007] [M: 25462.95] [ET: 0.819/27964.996] [MU: 6.33/25460.95] 
	SQL: 
                SELECT cities.cty_id as c2id, cities.cty_name as c2name, cities.cty_garage_address as c2address,
                    cities.cty_id as c4id, cities.cty_name as c4name, cities.cty_garage_address as c4address,
                        (distance * 2) as totalExtraDistance
                 FROM (SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<40
                     INNER JOIN route r1 ON route.rut_to_city_id=r1.rut_from_city_id AND r1.rut_active=1
                     INNER JOIN rate ON r1.rut_id=rate.rte_route_id AND rate.rte_status=1  AND rate.rte_vehicletype_id IN (3) GROUP BY route.rut_id HAVING count(*) >30
                   UNION
                     SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<600
                     INNER JOIN cities tc ON tc.cty_id=route.rut_to_city_id AND tc.cty_service_active=1 AND CalcDistance(cities.cty_lat, cities.cty_long, tc.cty_lat, tc.cty_long)<=route.rut_estm_distance						 
                     INNER JOIN cities_stats ON cities_stats.cts_cty_id = route.rut_to_city_id AND cities_stats.cts_vnd_cnt >= 2
                   UNION
                    SELECT cts_cty_id AS city, 0 AS distance
					FROM cities_stats WHERE 1 AND cities_stats.cts_cty_id= 30817 and cities_stats.cts_vnd_cnt>1) a
                    INNER JOIN cities ON cities.cty_id=a.city
                    ORDER BY totalExtraDistance LIMIT 1 
	 [params: []]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28001.864] [M: 25477.76] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.255.12
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"3","tripDistance":"","tripDuration":"","multiCityData":"","bookingType":"1","pickupAddress":"","pickupDate":"24\/10\/2024","pickupTime":"04:00 AM","isGozonow":"0","minTripDistance":"0","sccId":"0","tripUser":"1","YII_CSRF_TOKEN":"N3VxRE1WeG9UeHk5UWFBUFpPT216eWVyY0xWTVpoTkcUoJ2aBoup1fU2M5E4ePVZVcUNlKiYZZysUqEklNiKWw==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=3&tripDistance=&tripDuration=&multiCityData=&bookingType=1&pickupAddress=&pickupDate=24%2F10%2F2024&pickupTime=04%3A00+AM&isGozonow=0&minTripDistance=0&sccId=0&tripUser=1&YII_CSRF_TOKEN=N3VxRE1WeG9UeHk5UWFBUFpPT216eWVyY0xWTVpoTkcUoJ2aBoup1fU2M5E4ePVZVcUNlKiYZZysUqEklNiKWw%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28002.352] [M: 25497.32] [ET: 1.03/27968.378] [MU: 20.76/25497.21] 
	models.RouteRates.calculateDriverAllowance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28002.393] [M: 25499] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28003.365] [M: 25512.46] [ET: 0.832/27969.354] [MU: 2.99/25509.96] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+10013),(IF((cpm_value_type=2),(10013+(10013*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30937 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30937) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-24 04:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=70 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28005.022] [M: 25554.69] [ET: 3.765/27971.026] [MU: 78.59/25554.53] 
	RouteRates::calculate for CAB 70 2024-10-24 04:00:00 - Trip Type: 1 565063832
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28005.244] [M: 25532.38] [ET: 42.36/27971.252] [MU: 304.5/25532.22] 
	Quote::calculateRules for CAB 70, From City Id: 30804, To city Id: 30711
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28005.591] [M: 25503.88] [ET: 0.227/27971.597] [MU: 0.9/25503.63] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"70"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28005.7] [M: 25505.13] [ET: 80.993/27971.709] [MU: 475.45/25505.04] 
	Quote For CabType: 70
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28006.942] [M: 25515.48] [ET: 0.43/27972.962] [MU: 3.33/25515.04] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28007.395] [M: 25521.29] [ET: 0.385/27973.416] [MU: 3.33/25520.85] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28007.966] [M: 25524.23] [ET: 0.502/27973.983] [MU: 0.9/25523.98] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28008.581] [M: 25556.59] [ET: 0.481/27974.573] [MU: 24.22/25555.09] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (100) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30711) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp266)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp269,:gp270)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp267,:gp268)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp271,:gp272))
			OR (scr_area_type = 5 AND scr_area_id IN (3699))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (73)
		ORDER BY rank DESC
		 
	 [params: {":gp266":"31",":gp267":"30804",":gp268":"30711",":gp269":"105",":gp270":"100",":gp271":"1",":gp272":"1","tripType":"1"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28009.297] [M: 25536.76] [ET: 0.21/27975.319] [MU: 0.83/25536.57] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28009.63] [M: 25539.6] [ET: 0.261/27975.653] [MU: 0.93/25539.29] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"6"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28017.46] [M: 25557.25] [ET: 6.559/27983.45] [MU: 3.49/25556.38] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"73","fromCity":"30804","toCity":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28019.006] [M: 25560.5] [ET: 0.61/27985.022] [MU: 0.86/25560.28] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":0}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28020.045] [M: 25567.83] [ET: 0.806/27986.046] [MU: 3.01/25567.39] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28020.942] [M: 25596] [ET: 0.711/27986.959] [MU: 22.05/25595.38] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp274)) OR (apr_area_type = 2 AND apr_area_id IN (:gp275)) OR (apr_area_type = 4 AND apr_area_id IN (:gp276)) OR (apr_area_type = 1 AND apr_area_id IN (:gp273))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp273":"31",":gp274":"30804",":gp275":"105",":gp276":"1","cab":"73"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28022.431] [M: 25582.71] [ET: 0.643/27988.449] [MU: 3.34/25582.27] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28025.041] [M: 25592.95] [ET: 2.478/27991.03] [MU: 3.36/25592.07] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp278)) OR (scr_area_type = 2 AND scr_area_id IN (:gp279)) OR (scr_area_type = 4 AND scr_area_id IN (:gp280)) OR (scr_area_type = 1 AND scr_area_id IN (:gp277)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp277":"31",":gp278":"30804",":gp279":"105",":gp280":"1","scv_id":"73"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28028.1] [M: 25620.73] [ET: 2.128/27994.092] [MU: 0.75/25612.73] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"nearest_route_30804_30711","sql":"(INDEX indx_nearest_rt_rutid (rut_id)) \r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, routeFrom.rut_name as fromAlias, \r\n\t\t\t\tNULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, \r\n\t\t\t\t0 as rank, routeFrom.rut_estm_time as startTime, 0 as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 \r\n\t\t\t\tAND routeFrom.rut_from_city_id<>routeFrom.rut_to_city_id AND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\t\tAND (routeAlias.rut_to_city_id=route.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, NULL, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) \r\n\t\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\t0 AS extraStartDistance, 0, 0 as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND route.rut_from_city_id = 30804 AND route.rut_to_city_id=30711 \r\n\t\t\t\tAND routeTo.rut_from_city_id=30711\r\n\t\t\t\tAND route.rut_active = 1 AND routeTo.rut_active = 1 AND routeTo.rut_estm_distance < 50 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = route.rut_from_city_id) \r\n\t\t\t   AND (routeAlias.rut_to_city_id = routeTo.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, \r\n\t\t\t\trouteFrom.rut_name, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t+ IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) \r\n\t\t\t\tAS extraDistance, IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, 0, \r\n\t\t\t\trouteFrom.rut_estm_time as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 AND routeFrom.rut_from_city_id <> routeFrom.rut_to_city_id\r\n\t\t\t\t\tAND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND routeTo.rut_estm_distance < 50 \r\n\t\t\t\t\tAND routeTo.rut_from_city_id=30711 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\tAND (routeAlias.rut_to_city_id=routeTo.rut_to_city_id) AND routeAlias.rut_active = 1 AND routeAlias.rut_from_city_id=30804  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28032.555] [M: 25624.77] [ET: 4.358/27998.565] [MU: 2.12/25624.33] 
	SQL: SELECT *, (rte_vendor_amount + extraDistance * 10.55) as totalCost FROM (SELECT * FROM nearest_route_30804_30711) a
					INNER JOIN rate ON a.rut_id = rate.rte_route_id AND rte_status=1 AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <>0
					WHERE 1 ORDER BY rank DESC, totalCost ASC LIMIT 0,1 
	 [params: {"cabType":"73"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28033.3] [M: 25632.79] [ET: 0.637/27999.306] [MU: 0.74/25630.79] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"getNearestRoute_30804_30711_70","sql":"(INDEX getNearestRoute_30804_30711_70_index_rut_id (rut_id))\r\n\t\t\t\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id AS start, routeAlias.rut_to_city_id AS end,\r\n\t\t\t\t\t\t\t\trouteFrom.rut_name AS fromAlias, NULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance AS quotedDistance,\r\n\t\t\t\t\t\t\t\trouteAlias.rut_estm_distance AS rateDistance, \r\n\t\t\t\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance)\r\n\t\t\t\t\t\t\t\t\t - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance,\r\n\t\t\t\t\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance,\r\n\t\t\t\t\t\t\t\t0 AS rank, routeFrom.rut_estm_time AS startTime, 0 AS endTime, route.rut_estm_time, \r\n\t\t\t\t\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraTravelDistance\r\n\t\t\t\t\t\tFROM   route\r\n\t\t\t\t\t\tINNER JOIN route routeTo ON routeTo.rut_to_city_id=route.rut_from_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_from_city_id=30804 AND routeTo.rut_active=1\r\n\t\t\t\t\t\t\t\tAND routeTo.rut_estm_distance<70 AND route.rut_active=1\r\n\t\t\t\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_from_city_id=route.rut_to_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_active = 1\r\n\t\t\t\t\t\t\t\tAND routeFrom.rut_estm_distance<70 AND route.rut_active = 1\r\n\t\t\t\t\t\tINNER JOIN route routeAlias ON routeAlias.rut_to_city_id=routeFrom.rut_to_city_id\r\n\t\t\t\t\t\t\tAND routeAlias.rut_from_city_id=routeTo.rut_from_city_id AND routeAlias.rut_active = 1"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28037.32] [M: 25638.05] [ET: 3.906/28003.299] [MU: 2.41/25637.43] 
	SQL: SELECT *, (rte_vendor_amount + extradistance * 10.55 ) AS totalCost, 
						ABS(quotedDistance-rateDistance) AS extraChargeableDistance
					FROM getNearestRoute_30804_30711_70 a
					INNER JOIN rate ON a.rut_id=rate.rte_route_id AND rte_status=1 
						AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <> 0
					WHERE  1
					ORDER  BY rank DESC, extraStartDistance, extraChargeableDistance ASC, totalcost ASC
					LIMIT  0, 1 
	 [params: {"cabType":"73"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28041.094] [M: 25653.18] [ET: 0.829/28007.09] [MU: 3.46/25652.3] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28042.457] [M: 25663.43] [ET: 31.745/28008.48] [MU: 114.1/25663.27] 
	Quote::calculateOneWay  for CAB 73 Date: 2024-10-24 04:00:00
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28042.924] [M: 25666.93] [ET: 0.365/28008.942] [MU: 0.9/25666.68] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28044.171] [M: 25679.64] [ET: 0.635/28010.173] [MU: 3.34/25679.2] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28045.102] [M: 25708.81] [ET: 0.794/28011.108] [MU: 22.54/25708.06] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp283)) OR (apr_area_type = 5 AND apr_area_id IN (:gp281)) OR (apr_area_type = 2 AND apr_area_id IN (:gp284)) OR (apr_area_type = 4 AND apr_area_id IN (:gp285)) OR (apr_area_type = 1 AND apr_area_id IN (:gp282))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp281":"3699",":gp282":"31",":gp283":"30804",":gp284":"105",":gp285":"1","cab":"73"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28047.076] [M: 25695.82] [ET: 0.675/28013.091] [MU: 3.34/25695.38] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28050.831] [M: 25706.32] [ET: 3.616/28016.82] [MU: 3.49/25705.45] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp288)) OR (scr_area_type = 5 AND scr_area_id IN (:gp286)) OR (scr_area_type = 2 AND scr_area_id IN (:gp289)) OR (scr_area_type = 4 AND scr_area_id IN (:gp290)) OR (scr_area_type = 1 AND scr_area_id IN (:gp287)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp286":"3699",":gp287":"31",":gp288":"3699",":gp289":"105",":gp290":"1","scv_id":"73"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28051.637] [M: 25707.5] [ET: 0.391/28017.658] [MU: 2.97/25707.39] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28053.812] [M: 25717.66] [ET: 0.636/28019.814] [MU: 2.83/25717.03] 
	SQL: SELECT 
						fc.cty_id as c2id, 
						fc.cty_name as c2name, 
						fc.cty_garage_address as c2address,
						tc.cty_id as c4id,
						tc.cty_name as c4name, tc.cty_garage_address as c4address,
						0 as totalExtraDistance FROM route
						INNER JOIN cities fc ON rut_from_city_id=fc.cty_id
						INNER JOIN cities tc ON rut_to_city_id=tc.cty_id
						INNER JOIN rate on  rate.rte_route_id=route.rut_id  AND rate.rte_vehicletype_id IN (3)
						WHERE route.rut_from_city_id=30804 AND route.rut_to_city_id=30711 AND route.rut_active=1 
	 [params: []]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28054.583] [M: 25731.54] [ET: 0.665/28020.594] [MU: 6.53/25729.54] 
	SQL: 
				SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address, tc.cty_id as c4id, 
				tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
					FROM
					 (
						(
							SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id,  
								r3.rut_to_city_id, route.rut_name , route.rut_id,
								(route.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, 
								r3.rut_estm_distance
							FROM route
							INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_from_city_id=30804  
									AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=route.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) 
									AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
						UNION
						(
							SELECT r3.rut_id, r3.rut_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,(route.rut_estm_distance + r1.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
							FROM route
							INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND  route.rut_to_city_id=30711 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND route.rut_to_city_id=r3.rut_to_city_id))	AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
                     ) a
					INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
					INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1 
	 [params: []]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28055.089] [M: 25742.05] [ET: 0.429/28021.105] [MU: 5.03/25740.55] 
	SQL: SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
                              tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
                        FROM (SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,
                                    (route.rut_estm_distance + r1.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
                                FROM route
								INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
								INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
								INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) AND r3.rut_active=1 
								INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3) LIMIT 1
							)a
                        INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
                        INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1
                         
	 [params: []]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28055.628] [M: 25748.42] [ET: 0.462/28021.644] [MU: 0.74/25747.55] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"GarageRoute_30804_30711","sql":" (INDEX GarageRoute_30804_30711_index_rut_id (rut_id), INDEX GarageRoute_30804_30711_index_rut_from_city_id (rut_from_city_id), INDEX GarageRoute_30804_30711_index_rut_to_city_id (rut_to_city_id))\r\n\t\t\t\t\t\t\tSELECT route.rut_id, route.rut_from_city_id, route.rut_to_city_id, route.rut_name, rut_estm_distance FROM route \r\n\t\t\t\t\t\t\tINNER JOIN cities_stats   ON cities_stats.cts_cty_id = route.rut_from_city_id\r\n\t\t\t\t\t\t\tAND rut_estm_distance < 300\r\n\t\t\t\t\t\t\tAND rut_active = 1\r\n\t\t\t\t\t\t\tAND route.rut_to_city_id=30804\r\n\t\t\t\t\t\t\tAND cities_stats.cts_vnd_cnt >= 3\r\n\t\t\t\t\t\t\tORDER BY rut_estm_distance LIMIT 10"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28056.201] [M: 25760.34] [ET: 0.494/28022.214] [MU: 6.69/25758.59] 
	SQL: SELECT a.*, fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
								tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address 
						FROM ((SELECT xyz.rut_from_city_id as startCity, r1.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r3.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_from_city_id
							INNER JOIN rate ON rate.rte_route_id=r1.rut_id  AND rate.rte_vehicletype_id IN (3)
							INNER JOIN route r2 ON r2.rut_to_city_id=r1.rut_to_city_id AND r2.rut_from_city_id=:dropCity AND r2.rut_active=1
							INNER JOIN route r3 ON r3.rut_from_city_id=xyz.rut_to_city_id AND r3.rut_to_city_id=r2.rut_from_city_id AND r3.rut_active=1
							ORDER BY ExtraDistance LIMIT 1
							)
							UNION
							(
							SELECT xyz.rut_from_city_id as startCity, r2.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r2.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_to_city_id AND r1.rut_to_city_id=:dropCity
							INNER JOIN route r2 ON r2.rut_to_city_id=xyz.rut_from_city_id AND r2.rut_from_city_id=r1.rut_to_city_id
							ORDER BY ExtraDistance ASC LIMIT 1
							)) a
						INNER JOIN cities fc ON startCity=fc.cty_id
						INNER JOIN cities tc ON endCity=tc.cty_id 
						ORDER BY ExtraDistance 
	 [params: {"pickupCity":"30804","dropCity":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28058.935] [M: 25771.69] [ET: 1.127/28024.944] [MU: 7.88/25771.58] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28060.227] [M: 25777.26] [ET: 1.181/28026.223] [MU: 8.26/25777.15] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28061.377] [M: 25784.7] [ET: 0.39/28027.393] [MU: 0.99/25784.32] 
	SQL: SELECT cts_airport_pickup_entry_fee
               FROM   cities
               INNER JOIN cities_stats
               ON cities.cty_id = cities_stats.cts_cty_id
               WHERE  cty_id = :cityId
               AND cty_is_airport = 1 AND cty_active = 1 
	 [params: {"cityId":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28063.239] [M: 25798.61] [ET: 1.136/28029.243] [MU: 8.13/25798.5] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28064.61] [M: 25806.35] [ET: 1.245/28030.627] [MU: 8.07/25806.24] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28065.185] [M: 25805.69] [ET: 0.485/28031.202] [MU: 0.9/25805.44] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28066.658] [M: 25818.4] [ET: 0.78/28032.658] [MU: 3.33/25817.96] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28067.33] [M: 25847.57] [ET: 0.523/28033.346] [MU: 22.53/25846.82] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp293)) OR (apr_area_type = 5 AND apr_area_id IN (:gp291)) OR (apr_area_type = 2 AND apr_area_id IN (:gp294)) OR (apr_area_type = 4 AND apr_area_id IN (:gp295)) OR (apr_area_type = 1 AND apr_area_id IN (:gp292))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp291":"3699",":gp292":"31",":gp293":"30804",":gp294":"105",":gp295":"1","cab":"73"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28068.733] [M: 25834.58] [ET: 0.463/28034.751] [MU: 3.33/25834.14] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28071.722] [M: 25845.08] [ET: 2.863/28037.711] [MU: 3.49/25844.2] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp298)) OR (scr_area_type = 5 AND scr_area_id IN (:gp296)) OR (scr_area_type = 2 AND scr_area_id IN (:gp299)) OR (scr_area_type = 4 AND scr_area_id IN (:gp300)) OR (scr_area_type = 1 AND scr_area_id IN (:gp297)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp296":"3699",":gp297":"31",":gp298":"3699",":gp299":"105",":gp300":"1","scv_id":"73"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28072.605] [M: 25848.3] [ET: 0.372/28038.624] [MU: 2.98/25848.19] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28074.031] [M: 25861.31] [ET: 0.237/28040.054] [MU: 2.98/25861.2] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28074.303] [M: 25865.39] [ET: 0.199/28040.328] [MU: 2.97/25865.28] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28078.901] [M: 25899.49] [ET: 0.739/28044.91] [MU: 6.32/25897.49] 
	SQL: 
                SELECT cities.cty_id as c2id, cities.cty_name as c2name, cities.cty_garage_address as c2address,
                    cities.cty_id as c4id, cities.cty_name as c4name, cities.cty_garage_address as c4address,
                        (distance * 2) as totalExtraDistance
                 FROM (SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<40
                     INNER JOIN route r1 ON route.rut_to_city_id=r1.rut_from_city_id AND r1.rut_active=1
                     INNER JOIN rate ON r1.rut_id=rate.rte_route_id AND rate.rte_status=1  AND rate.rte_vehicletype_id IN (3) GROUP BY route.rut_id HAVING count(*) >30
                   UNION
                     SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<600
                     INNER JOIN cities tc ON tc.cty_id=route.rut_to_city_id AND tc.cty_service_active=1 AND CalcDistance(cities.cty_lat, cities.cty_long, tc.cty_lat, tc.cty_long)<=route.rut_estm_distance						 
                     INNER JOIN cities_stats ON cities_stats.cts_cty_id = route.rut_to_city_id AND cities_stats.cts_vnd_cnt >= 2
                   UNION
                    SELECT cts_cty_id AS city, 0 AS distance
					FROM cities_stats WHERE 1 AND cities_stats.cts_cty_id= 30817 and cities_stats.cts_vnd_cnt>1) a
                    INNER JOIN cities ON cities.cty_id=a.city
                    ORDER BY totalExtraDistance LIMIT 1 
	 [params: []]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28082.089] [M: 25914.3] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.255.12
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"3","tripDistance":"","tripDuration":"","multiCityData":"","bookingType":"1","pickupAddress":"","pickupDate":"24\/10\/2024","pickupTime":"04:00 AM","isGozonow":"0","minTripDistance":"0","sccId":"0","tripUser":"1","YII_CSRF_TOKEN":"N3VxRE1WeG9UeHk5UWFBUFpPT216eWVyY0xWTVpoTkcUoJ2aBoup1fU2M5E4ePVZVcUNlKiYZZysUqEklNiKWw==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=3&tripDistance=&tripDuration=&multiCityData=&bookingType=1&pickupAddress=&pickupDate=24%2F10%2F2024&pickupTime=04%3A00+AM&isGozonow=0&minTripDistance=0&sccId=0&tripUser=1&YII_CSRF_TOKEN=N3VxRE1WeG9UeHk5UWFBUFpPT216eWVyY0xWTVpoTkcUoJ2aBoup1fU2M5E4ePVZVcUNlKiYZZysUqEklNiKWw%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28082.617] [M: 26061.88] [ET: 1.014/28048.642] [MU: 148.77/26061.76] 
	models.RouteRates.calculateDriverAllowance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28082.649] [M: 26063.55] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28083.638] [M: 26077.01] [ET: 0.847/28049.628] [MU: 2.99/26074.51] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+10013),(IF((cpm_value_type=2),(10013+(10013*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30937 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30937) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-24 04:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=73 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28085.532] [M: 26119.23] [ET: 4.024/28051.537] [MU: 206.59/26119.08] 
	RouteRates::calculate for CAB 73 2024-10-24 04:00:00 - Trip Type: 1 456657885
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28085.773] [M: 26096.92] [ET: 43.239/28051.776] [MU: 432.03/26096.77] 
	Quote::calculateRules for CAB 73, From City Id: 30804, To city Id: 30711
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28086.11] [M: 26069.44] [ET: 0.224/28052.116] [MU: 0.9/26069.19] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"73"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28086.223] [M: 26071] [ET: 80.437/28052.227] [MU: 564.56/26070.91] 
	Quote For CabType: 73
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28087.799] [M: 26081.34] [ET: 0.536/28053.802] [MU: 3.34/26080.91] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28088.386] [M: 26087.16] [ET: 0.491/28054.399] [MU: 3.33/26086.72] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28089.063] [M: 26090.09] [ET: 0.595/28055.073] [MU: 0.9/26089.84] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28089.768] [M: 26122.45] [ET: 0.567/28055.78] [MU: 24.22/26120.95] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (100) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30711) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp301)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp304,:gp305)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp302,:gp303)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp306,:gp307))
			OR (scr_area_type = 5 AND scr_area_id IN (3699))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (78)
		ORDER BY rank DESC
		 
	 [params: {":gp301":"31",":gp302":"30804",":gp303":"30711",":gp304":"105",":gp305":"100",":gp306":"1",":gp307":"1","tripType":"1"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28090.687] [M: 26102.64] [ET: 0.301/28056.7] [MU: 0.84/26102.45] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28091.114] [M: 26105.52] [ET: 0.332/28057.112] [MU: 0.97/26105.2] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"1"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28092.435] [M: 26118.28] [ET: 0.394/28058.452] [MU: 2.04/26117.78] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"78"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28096.131] [M: 26127.62] [ET: 3.493/28062.141] [MU: 3.48/26126.74] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"78","fromCity":"30804","toCity":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28097.793] [M: 26130.87] [ET: 0.741/28063.806] [MU: 0.87/26130.65] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":0}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28098.639] [M: 26138.2] [ET: 0.675/28064.659] [MU: 3.02/26137.76] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28099.429] [M: 26166.37] [ET: 0.667/28065.424] [MU: 22.04/26165.74] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp309)) OR (apr_area_type = 2 AND apr_area_id IN (:gp310)) OR (apr_area_type = 4 AND apr_area_id IN (:gp311)) OR (apr_area_type = 1 AND apr_area_id IN (:gp308))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp308":"31",":gp309":"30804",":gp310":"105",":gp311":"1","cab":"78"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28100.915] [M: 26153.09] [ET: 0.651/28066.916] [MU: 3.34/26152.66] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28103.925] [M: 26163.33] [ET: 2.859/28069.935] [MU: 3.36/26162.45] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp313)) OR (scr_area_type = 2 AND scr_area_id IN (:gp314)) OR (scr_area_type = 4 AND scr_area_id IN (:gp315)) OR (scr_area_type = 1 AND scr_area_id IN (:gp312)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp312":"31",":gp313":"30804",":gp314":"105",":gp315":"1","scv_id":"78"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28106.711] [M: 26191.1] [ET: 1.977/28072.702] [MU: 0.74/26183.1] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"nearest_route_30804_30711","sql":"(INDEX indx_nearest_rt_rutid (rut_id)) \r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, routeFrom.rut_name as fromAlias, \r\n\t\t\t\tNULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, \r\n\t\t\t\t0 as rank, routeFrom.rut_estm_time as startTime, 0 as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 \r\n\t\t\t\tAND routeFrom.rut_from_city_id<>routeFrom.rut_to_city_id AND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\t\tAND (routeAlias.rut_to_city_id=route.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, NULL, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) \r\n\t\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\t0 AS extraStartDistance, 0, 0 as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND route.rut_from_city_id = 30804 AND route.rut_to_city_id=30711 \r\n\t\t\t\tAND routeTo.rut_from_city_id=30711\r\n\t\t\t\tAND route.rut_active = 1 AND routeTo.rut_active = 1 AND routeTo.rut_estm_distance < 50 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = route.rut_from_city_id) \r\n\t\t\t   AND (routeAlias.rut_to_city_id = routeTo.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, \r\n\t\t\t\trouteFrom.rut_name, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t+ IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) \r\n\t\t\t\tAS extraDistance, IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, 0, \r\n\t\t\t\trouteFrom.rut_estm_time as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 AND routeFrom.rut_from_city_id <> routeFrom.rut_to_city_id\r\n\t\t\t\t\tAND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND routeTo.rut_estm_distance < 50 \r\n\t\t\t\t\tAND routeTo.rut_from_city_id=30711 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\tAND (routeAlias.rut_to_city_id=routeTo.rut_to_city_id) AND routeAlias.rut_active = 1 AND routeAlias.rut_from_city_id=30804  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28109.912] [M: 26195.13] [ET: 3.077/28075.899] [MU: 2.12/26194.7] 
	SQL: SELECT *, (rte_vendor_amount + extraDistance * 10.55) as totalCost FROM (SELECT * FROM nearest_route_30804_30711) a
					INNER JOIN rate ON a.rut_id = rate.rte_route_id AND rte_status=1 AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <>0
					WHERE 1 ORDER BY rank DESC, totalCost ASC LIMIT 0,1 
	 [params: {"cabType":"78"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28110.856] [M: 26203.16] [ET: 0.782/28076.84] [MU: 0.74/26201.16] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"getNearestRoute_30804_30711_70","sql":"(INDEX getNearestRoute_30804_30711_70_index_rut_id (rut_id))\r\n\t\t\t\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id AS start, routeAlias.rut_to_city_id AS end,\r\n\t\t\t\t\t\t\t\trouteFrom.rut_name AS fromAlias, NULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance AS quotedDistance,\r\n\t\t\t\t\t\t\t\trouteAlias.rut_estm_distance AS rateDistance, \r\n\t\t\t\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance)\r\n\t\t\t\t\t\t\t\t\t - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance,\r\n\t\t\t\t\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance,\r\n\t\t\t\t\t\t\t\t0 AS rank, routeFrom.rut_estm_time AS startTime, 0 AS endTime, route.rut_estm_time, \r\n\t\t\t\t\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraTravelDistance\r\n\t\t\t\t\t\tFROM   route\r\n\t\t\t\t\t\tINNER JOIN route routeTo ON routeTo.rut_to_city_id=route.rut_from_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_from_city_id=30804 AND routeTo.rut_active=1\r\n\t\t\t\t\t\t\t\tAND routeTo.rut_estm_distance<70 AND route.rut_active=1\r\n\t\t\t\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_from_city_id=route.rut_to_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_active = 1\r\n\t\t\t\t\t\t\t\tAND routeFrom.rut_estm_distance<70 AND route.rut_active = 1\r\n\t\t\t\t\t\tINNER JOIN route routeAlias ON routeAlias.rut_to_city_id=routeFrom.rut_to_city_id\r\n\t\t\t\t\t\t\tAND routeAlias.rut_from_city_id=routeTo.rut_from_city_id AND routeAlias.rut_active = 1"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28113.645] [M: 26208.42] [ET: 2.677/28079.657] [MU: 2.41/26207.8] 
	SQL: SELECT *, (rte_vendor_amount + extradistance * 10.55 ) AS totalCost, 
						ABS(quotedDistance-rateDistance) AS extraChargeableDistance
					FROM getNearestRoute_30804_30711_70 a
					INNER JOIN rate ON a.rut_id=rate.rte_route_id AND rte_status=1 
						AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <> 0
					WHERE  1
					ORDER  BY rank DESC, extraStartDistance, extraChargeableDistance ASC, totalcost ASC
					LIMIT  0, 1 
	 [params: {"cabType":"78"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28116.829] [M: 26223.56] [ET: 0.541/28082.847] [MU: 3.46/26222.69] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28118.077] [M: 26233.8] [ET: 25.576/28084.101] [MU: 114.09/26233.64] 
	Quote::calculateOneWay  for CAB 78 Date: 2024-10-24 04:00:00
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28118.619] [M: 26237.3] [ET: 0.436/28084.637] [MU: 0.9/26237.05] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28119.805] [M: 26250.01] [ET: 0.576/28085.825] [MU: 3.33/26249.57] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28120.628] [M: 26279.18] [ET: 0.703/28086.625] [MU: 22.53/26278.43] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp318)) OR (apr_area_type = 5 AND apr_area_id IN (:gp316)) OR (apr_area_type = 2 AND apr_area_id IN (:gp319)) OR (apr_area_type = 4 AND apr_area_id IN (:gp320)) OR (apr_area_type = 1 AND apr_area_id IN (:gp317))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp316":"3699",":gp317":"31",":gp318":"30804",":gp319":"105",":gp320":"1","cab":"78"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28122.763] [M: 26266.2] [ET: 0.604/28088.781] [MU: 3.34/26265.77] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28125.555] [M: 26276.7] [ET: 2.666/28091.548] [MU: 3.48/26275.83] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp323)) OR (scr_area_type = 5 AND scr_area_id IN (:gp321)) OR (scr_area_type = 2 AND scr_area_id IN (:gp324)) OR (scr_area_type = 4 AND scr_area_id IN (:gp325)) OR (scr_area_type = 1 AND scr_area_id IN (:gp322)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp321":"3699",":gp322":"31",":gp323":"3699",":gp324":"105",":gp325":"1","scv_id":"78"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28126.307] [M: 26277.87] [ET: 0.36/28092.315] [MU: 2.98/26277.76] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28128.438] [M: 26288.02] [ET: 0.622/28094.455] [MU: 2.83/26287.4] 
	SQL: SELECT 
						fc.cty_id as c2id, 
						fc.cty_name as c2name, 
						fc.cty_garage_address as c2address,
						tc.cty_id as c4id,
						tc.cty_name as c4name, tc.cty_garage_address as c4address,
						0 as totalExtraDistance FROM route
						INNER JOIN cities fc ON rut_from_city_id=fc.cty_id
						INNER JOIN cities tc ON rut_to_city_id=tc.cty_id
						INNER JOIN rate on  rate.rte_route_id=route.rut_id  AND rate.rte_vehicletype_id IN (3)
						WHERE route.rut_from_city_id=30804 AND route.rut_to_city_id=30711 AND route.rut_active=1 
	 [params: []]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28128.913] [M: 26301.91] [ET: 0.4/28094.928] [MU: 6.53/26299.91] 
	SQL: 
				SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address, tc.cty_id as c4id, 
				tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
					FROM
					 (
						(
							SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id,  
								r3.rut_to_city_id, route.rut_name , route.rut_id,
								(route.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, 
								r3.rut_estm_distance
							FROM route
							INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_from_city_id=30804  
									AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=route.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) 
									AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
						UNION
						(
							SELECT r3.rut_id, r3.rut_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,(route.rut_estm_distance + r1.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
							FROM route
							INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND  route.rut_to_city_id=30711 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND route.rut_to_city_id=r3.rut_to_city_id))	AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
                     ) a
					INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
					INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1 
	 [params: []]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28129.382] [M: 26312.41] [ET: 0.4/28095.399] [MU: 5.03/26310.91] 
	SQL: SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
                              tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
                        FROM (SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,
                                    (route.rut_estm_distance + r1.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
                                FROM route
								INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
								INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
								INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) AND r3.rut_active=1 
								INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3) LIMIT 1
							)a
                        INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
                        INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1
                         
	 [params: []]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28129.843] [M: 26318.79] [ET: 0.389/28095.86] [MU: 0.75/26317.91] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"GarageRoute_30804_30711","sql":" (INDEX GarageRoute_30804_30711_index_rut_id (rut_id), INDEX GarageRoute_30804_30711_index_rut_from_city_id (rut_from_city_id), INDEX GarageRoute_30804_30711_index_rut_to_city_id (rut_to_city_id))\r\n\t\t\t\t\t\t\tSELECT route.rut_id, route.rut_from_city_id, route.rut_to_city_id, route.rut_name, rut_estm_distance FROM route \r\n\t\t\t\t\t\t\tINNER JOIN cities_stats   ON cities_stats.cts_cty_id = route.rut_from_city_id\r\n\t\t\t\t\t\t\tAND rut_estm_distance < 300\r\n\t\t\t\t\t\t\tAND rut_active = 1\r\n\t\t\t\t\t\t\tAND route.rut_to_city_id=30804\r\n\t\t\t\t\t\t\tAND cities_stats.cts_vnd_cnt >= 3\r\n\t\t\t\t\t\t\tORDER BY rut_estm_distance LIMIT 10"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28130.82] [M: 26330.71] [ET: 0.884/28096.815] [MU: 6.68/26328.96] 
	SQL: SELECT a.*, fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
								tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address 
						FROM ((SELECT xyz.rut_from_city_id as startCity, r1.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r3.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_from_city_id
							INNER JOIN rate ON rate.rte_route_id=r1.rut_id  AND rate.rte_vehicletype_id IN (3)
							INNER JOIN route r2 ON r2.rut_to_city_id=r1.rut_to_city_id AND r2.rut_from_city_id=:dropCity AND r2.rut_active=1
							INNER JOIN route r3 ON r3.rut_from_city_id=xyz.rut_to_city_id AND r3.rut_to_city_id=r2.rut_from_city_id AND r3.rut_active=1
							ORDER BY ExtraDistance LIMIT 1
							)
							UNION
							(
							SELECT xyz.rut_from_city_id as startCity, r2.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r2.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_to_city_id AND r1.rut_to_city_id=:dropCity
							INNER JOIN route r2 ON r2.rut_to_city_id=xyz.rut_from_city_id AND r2.rut_from_city_id=r1.rut_to_city_id
							ORDER BY ExtraDistance ASC LIMIT 1
							)) a
						INNER JOIN cities fc ON startCity=fc.cty_id
						INNER JOIN cities tc ON endCity=tc.cty_id 
						ORDER BY ExtraDistance 
	 [params: {"pickupCity":"30804","dropCity":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28133.781] [M: 26342.05] [ET: 1.128/28099.779] [MU: 7.88/26341.95] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28134.959] [M: 26347.63] [ET: 1.054/28100.979] [MU: 8.27/26347.52] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28135.728] [M: 26355.25] [ET: 0.287/28101.748] [MU: 0.99/26354.88] 
	SQL: SELECT cts_airport_pickup_entry_fee
               FROM   cities
               INNER JOIN cities_stats
               ON cities.cty_id = cities_stats.cts_cty_id
               WHERE  cty_id = :cityId
               AND cty_is_airport = 1 AND cty_active = 1 
	 [params: {"cityId":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28137.409] [M: 26369.16] [ET: 1.044/28103.41] [MU: 8.14/26369.05] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28138.879] [M: 26376.91] [ET: 1.314/28104.876] [MU: 8.08/26376.8] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28139.706] [M: 26376.24] [ET: 0.702/28105.702] [MU: 0.89/26375.99] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28141.748] [M: 26388.95] [ET: 0.827/28107.744] [MU: 3.34/26388.52] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28142.739] [M: 26418.13] [ET: 0.816/28108.747] [MU: 22.53/26417.38] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp328)) OR (apr_area_type = 5 AND apr_area_id IN (:gp326)) OR (apr_area_type = 2 AND apr_area_id IN (:gp329)) OR (apr_area_type = 4 AND apr_area_id IN (:gp330)) OR (apr_area_type = 1 AND apr_area_id IN (:gp327))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp326":"3699",":gp327":"31",":gp328":"30804",":gp329":"105",":gp330":"1","cab":"78"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28144.855] [M: 26405.15] [ET: 0.57/28110.871] [MU: 3.33/26404.71] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28148.33] [M: 26415.65] [ET: 3.329/28114.311] [MU: 3.49/26414.77] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp333)) OR (scr_area_type = 5 AND scr_area_id IN (:gp331)) OR (scr_area_type = 2 AND scr_area_id IN (:gp334)) OR (scr_area_type = 4 AND scr_area_id IN (:gp335)) OR (scr_area_type = 1 AND scr_area_id IN (:gp332)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp331":"3699",":gp332":"31",":gp333":"3699",":gp334":"105",":gp335":"1","scv_id":"78"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28148.945] [M: 26418.85] [ET: 0.237/28114.969] [MU: 2.97/26418.74] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28150.67] [M: 26431.96] [ET: 0.384/28116.677] [MU: 2.97/26431.85] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28151.096] [M: 26436.04] [ET: 0.322/28117.119] [MU: 2.97/26435.93] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28155.904] [M: 26470.14] [ET: 0.759/28121.915] [MU: 6.32/26468.14] 
	SQL: 
                SELECT cities.cty_id as c2id, cities.cty_name as c2name, cities.cty_garage_address as c2address,
                    cities.cty_id as c4id, cities.cty_name as c4name, cities.cty_garage_address as c4address,
                        (distance * 2) as totalExtraDistance
                 FROM (SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<40
                     INNER JOIN route r1 ON route.rut_to_city_id=r1.rut_from_city_id AND r1.rut_active=1
                     INNER JOIN rate ON r1.rut_id=rate.rte_route_id AND rate.rte_status=1  AND rate.rte_vehicletype_id IN (3) GROUP BY route.rut_id HAVING count(*) >30
                   UNION
                     SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<600
                     INNER JOIN cities tc ON tc.cty_id=route.rut_to_city_id AND tc.cty_service_active=1 AND CalcDistance(cities.cty_lat, cities.cty_long, tc.cty_lat, tc.cty_long)<=route.rut_estm_distance						 
                     INNER JOIN cities_stats ON cities_stats.cts_cty_id = route.rut_to_city_id AND cities_stats.cts_vnd_cnt >= 2
                   UNION
                    SELECT cts_cty_id AS city, 0 AS distance
					FROM cities_stats WHERE 1 AND cities_stats.cts_cty_id= 30817 and cities_stats.cts_vnd_cnt>1) a
                    INNER JOIN cities ON cities.cty_id=a.city
                    ORDER BY totalExtraDistance LIMIT 1 
	 [params: []]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28158.781] [M: 26484.95] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.255.12
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"3","tripDistance":"","tripDuration":"","multiCityData":"","bookingType":"1","pickupAddress":"","pickupDate":"24\/10\/2024","pickupTime":"04:00 AM","isGozonow":"0","minTripDistance":"0","sccId":"0","tripUser":"1","YII_CSRF_TOKEN":"N3VxRE1WeG9UeHk5UWFBUFpPT216eWVyY0xWTVpoTkcUoJ2aBoup1fU2M5E4ePVZVcUNlKiYZZysUqEklNiKWw==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=3&tripDistance=&tripDuration=&multiCityData=&bookingType=1&pickupAddress=&pickupDate=24%2F10%2F2024&pickupTime=04%3A00+AM&isGozonow=0&minTripDistance=0&sccId=0&tripUser=1&YII_CSRF_TOKEN=N3VxRE1WeG9UeHk5UWFBUFpPT216eWVyY0xWTVpoTkcUoJ2aBoup1fU2M5E4ePVZVcUNlKiYZZysUqEklNiKWw%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28159.47] [M: 26504.52] [ET: 1.108/28125.477] [MU: 20.77/26504.41] 
	models.RouteRates.calculateDriverAllowance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28159.521] [M: 26506.2] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28160.982] [M: 26519.66] [ET: 1.265/28126.967] [MU: 2.99/26517.16] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+10013),(IF((cpm_value_type=2),(10013+(10013*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30937 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30937) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-24 04:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=78 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28162.78] [M: 26561.88] [ET: 4.521/28128.799] [MU: 78.59/26561.73] 
	RouteRates::calculate for CAB 78 2024-10-24 04:00:00 - Trip Type: 1 826601544
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28162.927] [M: 26539.57] [ET: 44.78/28128.952] [MU: 304.32/26539.41] 
	Quote::calculateRules for CAB 78, From City Id: 30804, To city Id: 30711
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28163.214] [M: 26511.27] [ET: 0.197/28129.217] [MU: 0.9/26511.02] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"78"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28163.326] [M: 26512.84] [ET: 77.022/28129.335] [MU: 440.53/26512.74] 
	Quote For CabType: 78
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28164.944] [M: 26523.18] [ET: 0.48/28130.962] [MU: 3.33/26522.74] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28165.404] [M: 26528.99] [ET: 0.39/28131.422] [MU: 3.34/26528.55] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28165.979] [M: 26531.9] [ET: 0.509/28132] [MU: 0.9/26531.68] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28166.583] [M: 26564.29] [ET: 0.499/28132.596] [MU: 24.22/26562.79] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (100) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30711) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp336)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp339,:gp340)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp337,:gp338)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp341,:gp342))
			OR (scr_area_type = 5 AND scr_area_id IN (3699))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (81)
		ORDER BY rank DESC
		 
	 [params: {":gp336":"31",":gp337":"30804",":gp338":"30711",":gp339":"105",":gp340":"100",":gp341":"1",":gp342":"1","tripType":"1"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28167.157] [M: 26544.47] [ET: 0.161/28133.18] [MU: 0.83/26544.28] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28167.488] [M: 26547.34] [ET: 0.259/28133.51] [MU: 0.96/26547.03] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"1"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28168.549] [M: 26560.11] [ET: 0.337/28134.57] [MU: 2.04/26559.61] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"81"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28172.086] [M: 26569.45] [ET: 3.324/28138.077] [MU: 3.48/26568.57] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"81","fromCity":"30804","toCity":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28173.688] [M: 26572.7] [ET: 0.626/28139.703] [MU: 0.87/26572.48] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":0}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28174.507] [M: 26580.02] [ET: 0.646/28140.524] [MU: 3.02/26579.59] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28175.115] [M: 26608.2] [ET: 0.47/28141.131] [MU: 22.04/26607.57] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp344)) OR (apr_area_type = 2 AND apr_area_id IN (:gp345)) OR (apr_area_type = 4 AND apr_area_id IN (:gp346)) OR (apr_area_type = 1 AND apr_area_id IN (:gp343))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp343":"31",":gp344":"30804",":gp345":"105",":gp346":"1","cab":"81"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28176.102] [M: 26594.91] [ET: 0.435/28142.121] [MU: 3.34/26594.48] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28178.949] [M: 26605.15] [ET: 2.719/28144.938] [MU: 3.36/26604.27] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp348)) OR (scr_area_type = 2 AND scr_area_id IN (:gp349)) OR (scr_area_type = 4 AND scr_area_id IN (:gp350)) OR (scr_area_type = 1 AND scr_area_id IN (:gp347)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp347":"31",":gp348":"30804",":gp349":"105",":gp350":"1","scv_id":"81"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28182.797] [M: 26632.93] [ET: 2.891/28148.776] [MU: 0.74/26624.93] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"nearest_route_30804_30711","sql":"(INDEX indx_nearest_rt_rutid (rut_id)) \r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, routeFrom.rut_name as fromAlias, \r\n\t\t\t\tNULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, \r\n\t\t\t\t0 as rank, routeFrom.rut_estm_time as startTime, 0 as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 \r\n\t\t\t\tAND routeFrom.rut_from_city_id<>routeFrom.rut_to_city_id AND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\t\tAND (routeAlias.rut_to_city_id=route.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, NULL, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) \r\n\t\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\t0 AS extraStartDistance, 0, 0 as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND route.rut_from_city_id = 30804 AND route.rut_to_city_id=30711 \r\n\t\t\t\tAND routeTo.rut_from_city_id=30711\r\n\t\t\t\tAND route.rut_active = 1 AND routeTo.rut_active = 1 AND routeTo.rut_estm_distance < 50 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = route.rut_from_city_id) \r\n\t\t\t   AND (routeAlias.rut_to_city_id = routeTo.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, \r\n\t\t\t\trouteFrom.rut_name, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t+ IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) \r\n\t\t\t\tAS extraDistance, IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, 0, \r\n\t\t\t\trouteFrom.rut_estm_time as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 AND routeFrom.rut_from_city_id <> routeFrom.rut_to_city_id\r\n\t\t\t\t\tAND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND routeTo.rut_estm_distance < 50 \r\n\t\t\t\t\tAND routeTo.rut_from_city_id=30711 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\tAND (routeAlias.rut_to_city_id=routeTo.rut_to_city_id) AND routeAlias.rut_active = 1 AND routeAlias.rut_from_city_id=30804  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28185.723] [M: 26636.96] [ET: 2.828/28151.733] [MU: 2.12/26636.52] 
	SQL: SELECT *, (rte_vendor_amount + extraDistance * 10.55) as totalCost FROM (SELECT * FROM nearest_route_30804_30711) a
					INNER JOIN rate ON a.rut_id = rate.rte_route_id AND rte_status=1 AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <>0
					WHERE 1 ORDER BY rank DESC, totalCost ASC LIMIT 0,1 
	 [params: {"cabType":"81"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28186.732] [M: 26644.98] [ET: 0.897/28152.737] [MU: 0.75/26642.98] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"getNearestRoute_30804_30711_70","sql":"(INDEX getNearestRoute_30804_30711_70_index_rut_id (rut_id))\r\n\t\t\t\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id AS start, routeAlias.rut_to_city_id AS end,\r\n\t\t\t\t\t\t\t\trouteFrom.rut_name AS fromAlias, NULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance AS quotedDistance,\r\n\t\t\t\t\t\t\t\trouteAlias.rut_estm_distance AS rateDistance, \r\n\t\t\t\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance)\r\n\t\t\t\t\t\t\t\t\t - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance,\r\n\t\t\t\t\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance,\r\n\t\t\t\t\t\t\t\t0 AS rank, routeFrom.rut_estm_time AS startTime, 0 AS endTime, route.rut_estm_time, \r\n\t\t\t\t\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraTravelDistance\r\n\t\t\t\t\t\tFROM   route\r\n\t\t\t\t\t\tINNER JOIN route routeTo ON routeTo.rut_to_city_id=route.rut_from_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_from_city_id=30804 AND routeTo.rut_active=1\r\n\t\t\t\t\t\t\t\tAND routeTo.rut_estm_distance<70 AND route.rut_active=1\r\n\t\t\t\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_from_city_id=route.rut_to_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_active = 1\r\n\t\t\t\t\t\t\t\tAND routeFrom.rut_estm_distance<70 AND route.rut_active = 1\r\n\t\t\t\t\t\tINNER JOIN route routeAlias ON routeAlias.rut_to_city_id=routeFrom.rut_to_city_id\r\n\t\t\t\t\t\t\tAND routeAlias.rut_from_city_id=routeTo.rut_from_city_id AND routeAlias.rut_active = 1"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28189.784] [M: 26650.25] [ET: 2.96/28155.788] [MU: 2.42/26649.63] 
	SQL: SELECT *, (rte_vendor_amount + extradistance * 10.55 ) AS totalCost, 
						ABS(quotedDistance-rateDistance) AS extraChargeableDistance
					FROM getNearestRoute_30804_30711_70 a
					INNER JOIN rate ON a.rut_id=rate.rte_route_id AND rte_status=1 
						AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <> 0
					WHERE  1
					ORDER  BY rank DESC, extraStartDistance, extraChargeableDistance ASC, totalcost ASC
					LIMIT  0, 1 
	 [params: {"cabType":"81"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28194.924] [M: 26665.38] [ET: 0.567/28160.941] [MU: 3.46/26664.51] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28196.086] [M: 26675.63] [ET: 27.473/28162.11] [MU: 114.09/26675.47] 
	Quote::calculateOneWay  for CAB 81 Date: 2024-10-24 04:00:00
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28196.568] [M: 26679.13] [ET: 0.385/28162.583] [MU: 0.9/26678.88] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28197.801] [M: 26691.84] [ET: 0.652/28163.818] [MU: 3.33/26691.4] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28198.438] [M: 26721.01] [ET: 0.529/28164.455] [MU: 22.53/26720.26] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp353)) OR (apr_area_type = 5 AND apr_area_id IN (:gp351)) OR (apr_area_type = 2 AND apr_area_id IN (:gp354)) OR (apr_area_type = 4 AND apr_area_id IN (:gp355)) OR (apr_area_type = 1 AND apr_area_id IN (:gp352))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp351":"3699",":gp352":"31",":gp353":"30804",":gp354":"105",":gp355":"1","cab":"81"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28200.052] [M: 26708.02] [ET: 0.517/28166.032] [MU: 3.34/26707.59] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28202.631] [M: 26718.52] [ET: 2.41/28168.64] [MU: 3.48/26717.65] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp358)) OR (scr_area_type = 5 AND scr_area_id IN (:gp356)) OR (scr_area_type = 2 AND scr_area_id IN (:gp359)) OR (scr_area_type = 4 AND scr_area_id IN (:gp360)) OR (scr_area_type = 1 AND scr_area_id IN (:gp357)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp356":"3699",":gp357":"31",":gp358":"3699",":gp359":"105",":gp360":"1","scv_id":"81"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28203.147] [M: 26719.7] [ET: 0.248/28169.168] [MU: 2.98/26719.59] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28205.344] [M: 26729.85] [ET: 0.807/28171.344] [MU: 2.84/26729.23] 
	SQL: SELECT 
						fc.cty_id as c2id, 
						fc.cty_name as c2name, 
						fc.cty_garage_address as c2address,
						tc.cty_id as c4id,
						tc.cty_name as c4name, tc.cty_garage_address as c4address,
						0 as totalExtraDistance FROM route
						INNER JOIN cities fc ON rut_from_city_id=fc.cty_id
						INNER JOIN cities tc ON rut_to_city_id=tc.cty_id
						INNER JOIN rate on  rate.rte_route_id=route.rut_id  AND rate.rte_vehicletype_id IN (3)
						WHERE route.rut_from_city_id=30804 AND route.rut_to_city_id=30711 AND route.rut_active=1 
	 [params: []]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28205.975] [M: 26743.73] [ET: 0.513/28171.975] [MU: 6.53/26741.73] 
	SQL: 
				SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address, tc.cty_id as c4id, 
				tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
					FROM
					 (
						(
							SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id,  
								r3.rut_to_city_id, route.rut_name , route.rut_id,
								(route.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, 
								r3.rut_estm_distance
							FROM route
							INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_from_city_id=30804  
									AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=route.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) 
									AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
						UNION
						(
							SELECT r3.rut_id, r3.rut_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,(route.rut_estm_distance + r1.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
							FROM route
							INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND  route.rut_to_city_id=30711 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND route.rut_to_city_id=r3.rut_to_city_id))	AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
                     ) a
					INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
					INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1 
	 [params: []]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28206.561] [M: 26754.24] [ET: 0.479/28172.563] [MU: 5.03/26752.74] 
	SQL: SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
                              tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
                        FROM (SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,
                                    (route.rut_estm_distance + r1.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
                                FROM route
								INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
								INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
								INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) AND r3.rut_active=1 
								INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3) LIMIT 1
							)a
                        INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
                        INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1
                         
	 [params: []]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28207.09] [M: 26760.62] [ET: 0.427/28173.1] [MU: 0.74/26759.74] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"GarageRoute_30804_30711","sql":" (INDEX GarageRoute_30804_30711_index_rut_id (rut_id), INDEX GarageRoute_30804_30711_index_rut_from_city_id (rut_from_city_id), INDEX GarageRoute_30804_30711_index_rut_to_city_id (rut_to_city_id))\r\n\t\t\t\t\t\t\tSELECT route.rut_id, route.rut_from_city_id, route.rut_to_city_id, route.rut_name, rut_estm_distance FROM route \r\n\t\t\t\t\t\t\tINNER JOIN cities_stats   ON cities_stats.cts_cty_id = route.rut_from_city_id\r\n\t\t\t\t\t\t\tAND rut_estm_distance < 300\r\n\t\t\t\t\t\t\tAND rut_active = 1\r\n\t\t\t\t\t\t\tAND route.rut_to_city_id=30804\r\n\t\t\t\t\t\t\tAND cities_stats.cts_vnd_cnt >= 3\r\n\t\t\t\t\t\t\tORDER BY rut_estm_distance LIMIT 10"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28207.713] [M: 26772.54] [ET: 0.545/28173.728] [MU: 6.69/26770.79] 
	SQL: SELECT a.*, fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
								tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address 
						FROM ((SELECT xyz.rut_from_city_id as startCity, r1.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r3.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_from_city_id
							INNER JOIN rate ON rate.rte_route_id=r1.rut_id  AND rate.rte_vehicletype_id IN (3)
							INNER JOIN route r2 ON r2.rut_to_city_id=r1.rut_to_city_id AND r2.rut_from_city_id=:dropCity AND r2.rut_active=1
							INNER JOIN route r3 ON r3.rut_from_city_id=xyz.rut_to_city_id AND r3.rut_to_city_id=r2.rut_from_city_id AND r3.rut_active=1
							ORDER BY ExtraDistance LIMIT 1
							)
							UNION
							(
							SELECT xyz.rut_from_city_id as startCity, r2.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r2.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_to_city_id AND r1.rut_to_city_id=:dropCity
							INNER JOIN route r2 ON r2.rut_to_city_id=xyz.rut_from_city_id AND r2.rut_from_city_id=r1.rut_to_city_id
							ORDER BY ExtraDistance ASC LIMIT 1
							)) a
						INNER JOIN cities fc ON startCity=fc.cty_id
						INNER JOIN cities tc ON endCity=tc.cty_id 
						ORDER BY ExtraDistance 
	 [params: {"pickupCity":"30804","dropCity":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28210.622] [M: 26783.88] [ET: 1.391/28176.597] [MU: 7.89/26783.77] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28211.884] [M: 26789.45] [ET: 1.113/28177.903] [MU: 8.27/26789.34] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28212.662] [M: 26797.08] [ET: 0.297/28178.683] [MU: 1/26796.7] 
	SQL: SELECT cts_airport_pickup_entry_fee
               FROM   cities
               INNER JOIN cities_stats
               ON cities.cty_id = cities_stats.cts_cty_id
               WHERE  cty_id = :cityId
               AND cty_is_airport = 1 AND cty_active = 1 
	 [params: {"cityId":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28214.497] [M: 26810.99] [ET: 1.181/28180.498] [MU: 8.14/26810.88] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28215.738] [M: 26818.83] [ET: 1.088/28181.743] [MU: 8.08/26818.72] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28216.216] [M: 26818.26] [ET: 0.36/28182.221] [MU: 0.9/26818.01] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28217.632] [M: 26830.97] [ET: 0.73/28183.631] [MU: 3.33/26830.53] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28218.331] [M: 26860.14] [ET: 0.544/28184.348] [MU: 22.53/26859.39] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp363)) OR (apr_area_type = 5 AND apr_area_id IN (:gp361)) OR (apr_area_type = 2 AND apr_area_id IN (:gp364)) OR (apr_area_type = 4 AND apr_area_id IN (:gp365)) OR (apr_area_type = 1 AND apr_area_id IN (:gp362))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp361":"3699",":gp362":"31",":gp363":"30804",":gp364":"105",":gp365":"1","cab":"81"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28219.859] [M: 26847.16] [ET: 0.52/28185.877] [MU: 3.33/26846.72] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28223.263] [M: 26857.66] [ET: 3.272/28189.251] [MU: 3.48/26856.78] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp368)) OR (scr_area_type = 5 AND scr_area_id IN (:gp366)) OR (scr_area_type = 2 AND scr_area_id IN (:gp369)) OR (scr_area_type = 4 AND scr_area_id IN (:gp370)) OR (scr_area_type = 1 AND scr_area_id IN (:gp367)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp366":"3699",":gp367":"31",":gp368":"3699",":gp369":"105",":gp370":"1","scv_id":"81"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28224.114] [M: 26860.87] [ET: 0.374/28190.122] [MU: 2.98/26860.76] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28225.736] [M: 26873.98] [ET: 0.375/28191.742] [MU: 2.98/26873.87] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28226.188] [M: 26878.15] [ET: 0.343/28192.194] [MU: 2.97/26878.04] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28231.305] [M: 26912.25] [ET: 1.101/28197.311] [MU: 6.33/26910.25] 
	SQL: 
                SELECT cities.cty_id as c2id, cities.cty_name as c2name, cities.cty_garage_address as c2address,
                    cities.cty_id as c4id, cities.cty_name as c4name, cities.cty_garage_address as c4address,
                        (distance * 2) as totalExtraDistance
                 FROM (SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<40
                     INNER JOIN route r1 ON route.rut_to_city_id=r1.rut_from_city_id AND r1.rut_active=1
                     INNER JOIN rate ON r1.rut_id=rate.rte_route_id AND rate.rte_status=1  AND rate.rte_vehicletype_id IN (3) GROUP BY route.rut_id HAVING count(*) >30
                   UNION
                     SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<600
                     INNER JOIN cities tc ON tc.cty_id=route.rut_to_city_id AND tc.cty_service_active=1 AND CalcDistance(cities.cty_lat, cities.cty_long, tc.cty_lat, tc.cty_long)<=route.rut_estm_distance						 
                     INNER JOIN cities_stats ON cities_stats.cts_cty_id = route.rut_to_city_id AND cities_stats.cts_vnd_cnt >= 2
                   UNION
                    SELECT cts_cty_id AS city, 0 AS distance
					FROM cities_stats WHERE 1 AND cities_stats.cts_cty_id= 30817 and cities_stats.cts_vnd_cnt>1) a
                    INNER JOIN cities ON cities.cty_id=a.city
                    ORDER BY totalExtraDistance LIMIT 1 
	 [params: []]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28234.278] [M: 26927.06] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.255.12
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"3","tripDistance":"","tripDuration":"","multiCityData":"","bookingType":"1","pickupAddress":"","pickupDate":"24\/10\/2024","pickupTime":"04:00 AM","isGozonow":"0","minTripDistance":"0","sccId":"0","tripUser":"1","YII_CSRF_TOKEN":"N3VxRE1WeG9UeHk5UWFBUFpPT216eWVyY0xWTVpoTkcUoJ2aBoup1fU2M5E4ePVZVcUNlKiYZZysUqEklNiKWw==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=3&tripDistance=&tripDuration=&multiCityData=&bookingType=1&pickupAddress=&pickupDate=24%2F10%2F2024&pickupTime=04%3A00+AM&isGozonow=0&minTripDistance=0&sccId=0&tripUser=1&YII_CSRF_TOKEN=N3VxRE1WeG9UeHk5UWFBUFpPT216eWVyY0xWTVpoTkcUoJ2aBoup1fU2M5E4ePVZVcUNlKiYZZysUqEklNiKWw%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28235.034] [M: 26946.63] [ET: 1.306/28201.042] [MU: 20.77/26946.52] 
	models.RouteRates.calculateDriverAllowance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28235.086] [M: 26948.3] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28236.335] [M: 26961.77] [ET: 1.077/28202.337] [MU: 2.99/26959.27] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+10013),(IF((cpm_value_type=2),(10013+(10013*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30937 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30937) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-24 04:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=81 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28238.037] [M: 27003.99] [ET: 4.385/28204.038] [MU: 78.6/27003.84] 
	RouteRates::calculate for CAB 81 2024-10-24 04:00:00 - Trip Type: 1 600252289
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28238.269] [M: 26981.68] [ET: 42.106/28204.274] [MU: 304.6/26981.52] 
	Quote::calculateRules for CAB 81, From City Id: 30804, To city Id: 30711
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28238.674] [M: 26953.39] [ET: 0.278/28204.676] [MU: 0.9/26953.14] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"81"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28238.789] [M: 26954.95] [ET: 75.381/28204.797] [MU: 440.81/26954.86] 
	Quote For CabType: 81
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28240.182] [M: 26965.3] [ET: 0.475/28206.194] [MU: 3.33/26964.86] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28240.787] [M: 26971.11] [ET: 0.53/28206.799] [MU: 3.33/26970.67] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28241.32] [M: 26974.05] [ET: 0.458/28207.336] [MU: 0.9/26973.8] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28241.967] [M: 27006.41] [ET: 0.534/28207.979] [MU: 24.22/27004.91] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (100) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30711) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp371)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp374,:gp375)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp372,:gp373)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp376,:gp377))
			OR (scr_area_type = 5 AND scr_area_id IN (3699))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (82)
		ORDER BY rank DESC
		 
	 [params: {":gp371":"31",":gp372":"30804",":gp373":"30711",":gp374":"105",":gp375":"100",":gp376":"1",":gp377":"1","tripType":"1"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28242.657] [M: 26986.59] [ET: 0.208/28208.677] [MU: 0.83/26986.4] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28243.029] [M: 26989.46] [ET: 0.294/28209.048] [MU: 0.96/26989.15] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"1"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28244.125] [M: 27002.23] [ET: 0.32/28210.143] [MU: 2.05/27001.73] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"82"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28247.627] [M: 27011.56] [ET: 3.301/28213.633] [MU: 3.48/27010.69] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"82","fromCity":"30804","toCity":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28248.868] [M: 27014.81] [ET: 0.558/28214.881] [MU: 0.87/27014.59] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":0}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28249.697] [M: 27022.14] [ET: 0.631/28215.715] [MU: 3.02/27021.7] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28250.534] [M: 27050.31] [ET: 0.722/28216.543] [MU: 22.05/27049.69] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp379)) OR (apr_area_type = 2 AND apr_area_id IN (:gp380)) OR (apr_area_type = 4 AND apr_area_id IN (:gp381)) OR (apr_area_type = 1 AND apr_area_id IN (:gp378))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp378":"31",":gp379":"30804",":gp380":"105",":gp381":"1","cab":"82"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28251.696] [M: 27037.03] [ET: 0.485/28217.715] [MU: 3.34/27036.59] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28254.21] [M: 27047.27] [ET: 2.383/28220.206] [MU: 3.36/27046.39] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp383)) OR (scr_area_type = 2 AND scr_area_id IN (:gp384)) OR (scr_area_type = 4 AND scr_area_id IN (:gp385)) OR (scr_area_type = 1 AND scr_area_id IN (:gp382)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp382":"31",":gp383":"30804",":gp384":"105",":gp385":"1","scv_id":"82"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28257.063] [M: 27075.05] [ET: 1.983/28223.055] [MU: 0.74/27067.05] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"nearest_route_30804_30711","sql":"(INDEX indx_nearest_rt_rutid (rut_id)) \r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, routeFrom.rut_name as fromAlias, \r\n\t\t\t\tNULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, \r\n\t\t\t\t0 as rank, routeFrom.rut_estm_time as startTime, 0 as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 \r\n\t\t\t\tAND routeFrom.rut_from_city_id<>routeFrom.rut_to_city_id AND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\t\tAND (routeAlias.rut_to_city_id=route.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, NULL, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) \r\n\t\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\t0 AS extraStartDistance, 0, 0 as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND route.rut_from_city_id = 30804 AND route.rut_to_city_id=30711 \r\n\t\t\t\tAND routeTo.rut_from_city_id=30711\r\n\t\t\t\tAND route.rut_active = 1 AND routeTo.rut_active = 1 AND routeTo.rut_estm_distance < 50 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = route.rut_from_city_id) \r\n\t\t\t   AND (routeAlias.rut_to_city_id = routeTo.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, \r\n\t\t\t\trouteFrom.rut_name, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t+ IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) \r\n\t\t\t\tAS extraDistance, IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, 0, \r\n\t\t\t\trouteFrom.rut_estm_time as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 AND routeFrom.rut_from_city_id <> routeFrom.rut_to_city_id\r\n\t\t\t\t\tAND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND routeTo.rut_estm_distance < 50 \r\n\t\t\t\t\tAND routeTo.rut_from_city_id=30711 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\tAND (routeAlias.rut_to_city_id=routeTo.rut_to_city_id) AND routeAlias.rut_active = 1 AND routeAlias.rut_from_city_id=30804  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28259.768] [M: 27079.08] [ET: 2.604/28225.766] [MU: 2.11/27078.64] 
	SQL: SELECT *, (rte_vendor_amount + extraDistance * 10.55) as totalCost FROM (SELECT * FROM nearest_route_30804_30711) a
					INNER JOIN rate ON a.rut_id = rate.rte_route_id AND rte_status=1 AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <>0
					WHERE 1 ORDER BY rank DESC, totalCost ASC LIMIT 0,1 
	 [params: {"cabType":"82"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28260.856] [M: 27087.1] [ET: 0.968/28226.858] [MU: 0.74/27085.1] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"getNearestRoute_30804_30711_70","sql":"(INDEX getNearestRoute_30804_30711_70_index_rut_id (rut_id))\r\n\t\t\t\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id AS start, routeAlias.rut_to_city_id AS end,\r\n\t\t\t\t\t\t\t\trouteFrom.rut_name AS fromAlias, NULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance AS quotedDistance,\r\n\t\t\t\t\t\t\t\trouteAlias.rut_estm_distance AS rateDistance, \r\n\t\t\t\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance)\r\n\t\t\t\t\t\t\t\t\t - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance,\r\n\t\t\t\t\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance,\r\n\t\t\t\t\t\t\t\t0 AS rank, routeFrom.rut_estm_time AS startTime, 0 AS endTime, route.rut_estm_time, \r\n\t\t\t\t\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraTravelDistance\r\n\t\t\t\t\t\tFROM   route\r\n\t\t\t\t\t\tINNER JOIN route routeTo ON routeTo.rut_to_city_id=route.rut_from_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_from_city_id=30804 AND routeTo.rut_active=1\r\n\t\t\t\t\t\t\t\tAND routeTo.rut_estm_distance<70 AND route.rut_active=1\r\n\t\t\t\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_from_city_id=route.rut_to_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_active = 1\r\n\t\t\t\t\t\t\t\tAND routeFrom.rut_estm_distance<70 AND route.rut_active = 1\r\n\t\t\t\t\t\tINNER JOIN route routeAlias ON routeAlias.rut_to_city_id=routeFrom.rut_to_city_id\r\n\t\t\t\t\t\t\tAND routeAlias.rut_from_city_id=routeTo.rut_from_city_id AND routeAlias.rut_active = 1"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28264.86] [M: 27092.37] [ET: 3.915/28230.871] [MU: 2.41/27091.74] 
	SQL: SELECT *, (rte_vendor_amount + extradistance * 10.55 ) AS totalCost, 
						ABS(quotedDistance-rateDistance) AS extraChargeableDistance
					FROM getNearestRoute_30804_30711_70 a
					INNER JOIN rate ON a.rut_id=rate.rte_route_id AND rte_status=1 
						AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <> 0
					WHERE  1
					ORDER  BY rank DESC, extraStartDistance, extraChargeableDistance ASC, totalcost ASC
					LIMIT  0, 1 
	 [params: {"cabType":"82"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28267.827] [M: 27107.5] [ET: 0.561/28233.844] [MU: 3.46/27106.63] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28269.031] [M: 27117.74] [ET: 24.827/28235.03] [MU: 114.1/27117.59] 
	Quote::calculateOneWay  for CAB 82 Date: 2024-10-24 04:00:00
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28269.63] [M: 27121.24] [ET: 0.458/28235.647] [MU: 0.89/27120.99] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28271.024] [M: 27133.95] [ET: 0.719/28237.04] [MU: 3.34/27133.52] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28271.774] [M: 27163.13] [ET: 0.63/28237.791] [MU: 22.53/27162.38] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp388)) OR (apr_area_type = 5 AND apr_area_id IN (:gp386)) OR (apr_area_type = 2 AND apr_area_id IN (:gp389)) OR (apr_area_type = 4 AND apr_area_id IN (:gp390)) OR (apr_area_type = 1 AND apr_area_id IN (:gp387))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp386":"3699",":gp387":"31",":gp388":"30804",":gp389":"105",":gp390":"1","cab":"82"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28273.211] [M: 27150.14] [ET: 0.508/28239.231] [MU: 3.34/27149.7] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28276.123] [M: 27160.64] [ET: 2.789/28242.116] [MU: 3.49/27159.77] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp393)) OR (scr_area_type = 5 AND scr_area_id IN (:gp391)) OR (scr_area_type = 2 AND scr_area_id IN (:gp394)) OR (scr_area_type = 4 AND scr_area_id IN (:gp395)) OR (scr_area_type = 1 AND scr_area_id IN (:gp392)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp391":"3699",":gp392":"31",":gp393":"3699",":gp394":"105",":gp395":"1","scv_id":"82"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28276.853] [M: 27161.81] [ET: 0.349/28242.861] [MU: 2.98/27161.7] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28279.114] [M: 27171.97] [ET: 0.872/28245.116] [MU: 2.84/27171.34] 
	SQL: SELECT 
						fc.cty_id as c2id, 
						fc.cty_name as c2name, 
						fc.cty_garage_address as c2address,
						tc.cty_id as c4id,
						tc.cty_name as c4name, tc.cty_garage_address as c4address,
						0 as totalExtraDistance FROM route
						INNER JOIN cities fc ON rut_from_city_id=fc.cty_id
						INNER JOIN cities tc ON rut_to_city_id=tc.cty_id
						INNER JOIN rate on  rate.rte_route_id=route.rut_id  AND rate.rte_vehicletype_id IN (3)
						WHERE route.rut_from_city_id=30804 AND route.rut_to_city_id=30711 AND route.rut_active=1 
	 [params: []]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28279.675] [M: 27185.85] [ET: 0.466/28245.688] [MU: 6.53/27183.85] 
	SQL: 
				SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address, tc.cty_id as c4id, 
				tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
					FROM
					 (
						(
							SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id,  
								r3.rut_to_city_id, route.rut_name , route.rut_id,
								(route.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, 
								r3.rut_estm_distance
							FROM route
							INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_from_city_id=30804  
									AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=route.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) 
									AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
						UNION
						(
							SELECT r3.rut_id, r3.rut_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,(route.rut_estm_distance + r1.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
							FROM route
							INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND  route.rut_to_city_id=30711 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND route.rut_to_city_id=r3.rut_to_city_id))	AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
                     ) a
					INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
					INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1 
	 [params: []]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28280.51] [M: 27196.36] [ET: 0.664/28246.419] [MU: 5.03/27194.86] 
	SQL: SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
                              tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
                        FROM (SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,
                                    (route.rut_estm_distance + r1.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
                                FROM route
								INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
								INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
								INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) AND r3.rut_active=1 
								INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3) LIMIT 1
							)a
                        INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
                        INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1
                         
	 [params: []]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28281.226] [M: 27202.73] [ET: 0.577/28247.238] [MU: 0.74/27201.86] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"GarageRoute_30804_30711","sql":" (INDEX GarageRoute_30804_30711_index_rut_id (rut_id), INDEX GarageRoute_30804_30711_index_rut_from_city_id (rut_from_city_id), INDEX GarageRoute_30804_30711_index_rut_to_city_id (rut_to_city_id))\r\n\t\t\t\t\t\t\tSELECT route.rut_id, route.rut_from_city_id, route.rut_to_city_id, route.rut_name, rut_estm_distance FROM route \r\n\t\t\t\t\t\t\tINNER JOIN cities_stats   ON cities_stats.cts_cty_id = route.rut_from_city_id\r\n\t\t\t\t\t\t\tAND rut_estm_distance < 300\r\n\t\t\t\t\t\t\tAND rut_active = 1\r\n\t\t\t\t\t\t\tAND route.rut_to_city_id=30804\r\n\t\t\t\t\t\t\tAND cities_stats.cts_vnd_cnt >= 3\r\n\t\t\t\t\t\t\tORDER BY rut_estm_distance LIMIT 10"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28281.888] [M: 27214.66] [ET: 0.579/28247.902] [MU: 6.69/27212.91] 
	SQL: SELECT a.*, fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
								tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address 
						FROM ((SELECT xyz.rut_from_city_id as startCity, r1.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r3.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_from_city_id
							INNER JOIN rate ON rate.rte_route_id=r1.rut_id  AND rate.rte_vehicletype_id IN (3)
							INNER JOIN route r2 ON r2.rut_to_city_id=r1.rut_to_city_id AND r2.rut_from_city_id=:dropCity AND r2.rut_active=1
							INNER JOIN route r3 ON r3.rut_from_city_id=xyz.rut_to_city_id AND r3.rut_to_city_id=r2.rut_from_city_id AND r3.rut_active=1
							ORDER BY ExtraDistance LIMIT 1
							)
							UNION
							(
							SELECT xyz.rut_from_city_id as startCity, r2.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r2.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_to_city_id AND r1.rut_to_city_id=:dropCity
							INNER JOIN route r2 ON r2.rut_to_city_id=xyz.rut_from_city_id AND r2.rut_from_city_id=r1.rut_to_city_id
							ORDER BY ExtraDistance ASC LIMIT 1
							)) a
						INNER JOIN cities fc ON startCity=fc.cty_id
						INNER JOIN cities tc ON endCity=tc.cty_id 
						ORDER BY ExtraDistance 
	 [params: {"pickupCity":"30804","dropCity":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28284.619] [M: 27226] [ET: 1.072/28250.637] [MU: 7.88/27225.89] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28285.515] [M: 27231.48] [ET: 0.809/28251.536] [MU: 8.27/27231.37] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28286.258] [M: 27239.1] [ET: 0.277/28252.28] [MU: 0.99/27238.73] 
	SQL: SELECT cts_airport_pickup_entry_fee
               FROM   cities
               INNER JOIN cities_stats
               ON cities.cty_id = cities_stats.cts_cty_id
               WHERE  cty_id = :cityId
               AND cty_is_airport = 1 AND cty_active = 1 
	 [params: {"cityId":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28287.775] [M: 27253.02] [ET: 0.906/28253.797] [MU: 8.13/27252.91] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28288.604] [M: 27260.85] [ET: 0.736/28254.626] [MU: 8.07/27260.74] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28289.014] [M: 27260.28] [ET: 0.329/28255.036] [MU: 0.89/27260.03] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28290.451] [M: 27272.99] [ET: 0.681/28256.469] [MU: 3.34/27272.55] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28291.153] [M: 27302.16] [ET: 0.587/28257.163] [MU: 22.53/27301.41] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp398)) OR (apr_area_type = 5 AND apr_area_id IN (:gp396)) OR (apr_area_type = 2 AND apr_area_id IN (:gp399)) OR (apr_area_type = 4 AND apr_area_id IN (:gp400)) OR (apr_area_type = 1 AND apr_area_id IN (:gp397))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp396":"3699",":gp397":"31",":gp398":"30804",":gp399":"105",":gp400":"1","cab":"82"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28292.724] [M: 27289.18] [ET: 0.486/28258.742] [MU: 3.33/27288.74] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28295.665] [M: 27299.68] [ET: 2.808/28261.647] [MU: 3.49/27298.8] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp403)) OR (scr_area_type = 5 AND scr_area_id IN (:gp401)) OR (scr_area_type = 2 AND scr_area_id IN (:gp404)) OR (scr_area_type = 4 AND scr_area_id IN (:gp405)) OR (scr_area_type = 1 AND scr_area_id IN (:gp402)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp401":"3699",":gp402":"31",":gp403":"3699",":gp404":"105",":gp405":"1","scv_id":"82"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28296.543] [M: 27302.89] [ET: 0.374/28262.548] [MU: 2.97/27302.78] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28298.392] [M: 27316] [ET: 0.244/28264.41] [MU: 2.97/27315.89] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28298.659] [M: 27320.08] [ET: 0.2/28264.685] [MU: 2.98/27319.97] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28303.289] [M: 27354.09] [ET: 0.808/28269.285] [MU: 6.33/27352.09] 
	SQL: 
                SELECT cities.cty_id as c2id, cities.cty_name as c2name, cities.cty_garage_address as c2address,
                    cities.cty_id as c4id, cities.cty_name as c4name, cities.cty_garage_address as c4address,
                        (distance * 2) as totalExtraDistance
                 FROM (SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<40
                     INNER JOIN route r1 ON route.rut_to_city_id=r1.rut_from_city_id AND r1.rut_active=1
                     INNER JOIN rate ON r1.rut_id=rate.rte_route_id AND rate.rte_status=1  AND rate.rte_vehicletype_id IN (3) GROUP BY route.rut_id HAVING count(*) >30
                   UNION
                     SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<600
                     INNER JOIN cities tc ON tc.cty_id=route.rut_to_city_id AND tc.cty_service_active=1 AND CalcDistance(cities.cty_lat, cities.cty_long, tc.cty_lat, tc.cty_long)<=route.rut_estm_distance						 
                     INNER JOIN cities_stats ON cities_stats.cts_cty_id = route.rut_to_city_id AND cities_stats.cts_vnd_cnt >= 2
                   UNION
                    SELECT cts_cty_id AS city, 0 AS distance
					FROM cities_stats WHERE 1 AND cities_stats.cts_cty_id= 30817 and cities_stats.cts_vnd_cnt>1) a
                    INNER JOIN cities ON cities.cty_id=a.city
                    ORDER BY totalExtraDistance LIMIT 1 
	 [params: []]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28305.942] [M: 27368.9] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.255.12
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"3","tripDistance":"","tripDuration":"","multiCityData":"","bookingType":"1","pickupAddress":"","pickupDate":"24\/10\/2024","pickupTime":"04:00 AM","isGozonow":"0","minTripDistance":"0","sccId":"0","tripUser":"1","YII_CSRF_TOKEN":"N3VxRE1WeG9UeHk5UWFBUFpPT216eWVyY0xWTVpoTkcUoJ2aBoup1fU2M5E4ePVZVcUNlKiYZZysUqEklNiKWw==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=3&tripDistance=&tripDuration=&multiCityData=&bookingType=1&pickupAddress=&pickupDate=24%2F10%2F2024&pickupTime=04%3A00+AM&isGozonow=0&minTripDistance=0&sccId=0&tripUser=1&YII_CSRF_TOKEN=N3VxRE1WeG9UeHk5UWFBUFpPT216eWVyY0xWTVpoTkcUoJ2aBoup1fU2M5E4ePVZVcUNlKiYZZysUqEklNiKWw%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28306.429] [M: 27388.46] [ET: 0.937/28272.454] [MU: 20.76/27388.35] 
	models.RouteRates.calculateDriverAllowance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28306.46] [M: 27390.14] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28307.627] [M: 27403.6] [ET: 1.022/28273.637] [MU: 2.99/27401.1] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+10013),(IF((cpm_value_type=2),(10013+(10013*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30937 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30937) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-24 04:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=82 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28309.41] [M: 27445.83] [ET: 3.986/28275.407] [MU: 78.59/27445.67] 
	RouteRates::calculate for CAB 82 2024-10-24 04:00:00 - Trip Type: 1 832357349
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28309.64] [M: 27423.52] [ET: 40.509/28275.649] [MU: 304.31/27423.36] 
	Quote::calculateRules for CAB 82, From City Id: 30804, To city Id: 30711
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28310.038] [M: 27395.23] [ET: 0.284/28276.043] [MU: 0.9/27394.98] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"82"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28310.118] [M: 27396.79] [ET: 71.257/28276.143] [MU: 440.53/27396.7] 
	Quote For CabType: 82
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28311.728] [M: 27407.13] [ET: 0.679/28277.726] [MU: 3.34/27406.7] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28312.553] [M: 27412.95] [ET: 0.704/28278.552] [MU: 3.34/27412.51] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28313.309] [M: 27415.88] [ET: 0.653/28279.323] [MU: 0.9/27415.63] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28314.158] [M: 27448.24] [ET: 0.712/28280.148] [MU: 24.21/27446.74] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (100) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30711) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp406)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp409,:gp410)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp407,:gp408)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp411,:gp412))
			OR (scr_area_type = 5 AND scr_area_id IN (3699))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (83)
		ORDER BY rank DESC
		 
	 [params: {":gp406":"31",":gp407":"30804",":gp408":"30711",":gp409":"105",":gp410":"100",":gp411":"1",":gp412":"1","tripType":"1"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28315.031] [M: 27428.42] [ET: 0.23/28281.037] [MU: 0.84/27428.23] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28315.511] [M: 27431.3] [ET: 0.376/28281.52] [MU: 0.96/27430.98] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"1"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28316.761] [M: 27444.06] [ET: 0.373/28282.781] [MU: 2.05/27443.56] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"83"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28319.923] [M: 27453.4] [ET: 2.935/28285.903] [MU: 3.49/27452.52] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"83","fromCity":"30804","toCity":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28321.511] [M: 27456.65] [ET: 0.646/28287.509] [MU: 0.86/27456.43] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":0}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28322.468] [M: 27463.98] [ET: 0.685/28288.484] [MU: 3.01/27463.54] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28323.099] [M: 27492.15] [ET: 0.501/28289.099] [MU: 22.05/27491.52] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp414)) OR (apr_area_type = 2 AND apr_area_id IN (:gp415)) OR (apr_area_type = 4 AND apr_area_id IN (:gp416)) OR (apr_area_type = 1 AND apr_area_id IN (:gp413))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp413":"31",":gp414":"30804",":gp415":"105",":gp416":"1","cab":"83"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28324.414] [M: 27478.87] [ET: 0.592/28290.419] [MU: 3.33/27478.43] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28327.22] [M: 27489.1] [ET: 2.652/28293.228] [MU: 3.36/27488.23] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp418)) OR (scr_area_type = 2 AND scr_area_id IN (:gp419)) OR (scr_area_type = 4 AND scr_area_id IN (:gp420)) OR (scr_area_type = 1 AND scr_area_id IN (:gp417)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp417":"31",":gp418":"30804",":gp419":"105",":gp420":"1","scv_id":"83"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28331.295] [M: 27516.88] [ET: 3.108/28297.285] [MU: 0.75/27508.88] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"nearest_route_30804_30711","sql":"(INDEX indx_nearest_rt_rutid (rut_id)) \r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, routeFrom.rut_name as fromAlias, \r\n\t\t\t\tNULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, \r\n\t\t\t\t0 as rank, routeFrom.rut_estm_time as startTime, 0 as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 \r\n\t\t\t\tAND routeFrom.rut_from_city_id<>routeFrom.rut_to_city_id AND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\t\tAND (routeAlias.rut_to_city_id=route.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, NULL, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) \r\n\t\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\t0 AS extraStartDistance, 0, 0 as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND route.rut_from_city_id = 30804 AND route.rut_to_city_id=30711 \r\n\t\t\t\tAND routeTo.rut_from_city_id=30711\r\n\t\t\t\tAND route.rut_active = 1 AND routeTo.rut_active = 1 AND routeTo.rut_estm_distance < 50 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = route.rut_from_city_id) \r\n\t\t\t   AND (routeAlias.rut_to_city_id = routeTo.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, \r\n\t\t\t\trouteFrom.rut_name, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t+ IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) \r\n\t\t\t\tAS extraDistance, IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, 0, \r\n\t\t\t\trouteFrom.rut_estm_time as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 AND routeFrom.rut_from_city_id <> routeFrom.rut_to_city_id\r\n\t\t\t\t\tAND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND routeTo.rut_estm_distance < 50 \r\n\t\t\t\t\tAND routeTo.rut_from_city_id=30711 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\tAND (routeAlias.rut_to_city_id=routeTo.rut_to_city_id) AND routeAlias.rut_active = 1 AND routeAlias.rut_from_city_id=30804  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28334.491] [M: 27520.91] [ET: 3.086/28300.486] [MU: 2.12/27520.48] 
	SQL: SELECT *, (rte_vendor_amount + extraDistance * 10.55) as totalCost FROM (SELECT * FROM nearest_route_30804_30711) a
					INNER JOIN rate ON a.rut_id = rate.rte_route_id AND rte_status=1 AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <>0
					WHERE 1 ORDER BY rank DESC, totalCost ASC LIMIT 0,1 
	 [params: {"cabType":"83"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28335.34] [M: 27528.94] [ET: 0.71/28301.348] [MU: 0.74/27526.94] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"getNearestRoute_30804_30711_70","sql":"(INDEX getNearestRoute_30804_30711_70_index_rut_id (rut_id))\r\n\t\t\t\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id AS start, routeAlias.rut_to_city_id AS end,\r\n\t\t\t\t\t\t\t\trouteFrom.rut_name AS fromAlias, NULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance AS quotedDistance,\r\n\t\t\t\t\t\t\t\trouteAlias.rut_estm_distance AS rateDistance, \r\n\t\t\t\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance)\r\n\t\t\t\t\t\t\t\t\t - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance,\r\n\t\t\t\t\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance,\r\n\t\t\t\t\t\t\t\t0 AS rank, routeFrom.rut_estm_time AS startTime, 0 AS endTime, route.rut_estm_time, \r\n\t\t\t\t\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraTravelDistance\r\n\t\t\t\t\t\tFROM   route\r\n\t\t\t\t\t\tINNER JOIN route routeTo ON routeTo.rut_to_city_id=route.rut_from_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_from_city_id=30804 AND routeTo.rut_active=1\r\n\t\t\t\t\t\t\t\tAND routeTo.rut_estm_distance<70 AND route.rut_active=1\r\n\t\t\t\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_from_city_id=route.rut_to_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_active = 1\r\n\t\t\t\t\t\t\t\tAND routeFrom.rut_estm_distance<70 AND route.rut_active = 1\r\n\t\t\t\t\t\tINNER JOIN route routeAlias ON routeAlias.rut_to_city_id=routeFrom.rut_to_city_id\r\n\t\t\t\t\t\t\tAND routeAlias.rut_from_city_id=routeTo.rut_from_city_id AND routeAlias.rut_active = 1"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28338.379] [M: 27534.2] [ET: 2.95/28304.389] [MU: 2.41/27533.58] 
	SQL: SELECT *, (rte_vendor_amount + extradistance * 10.55 ) AS totalCost, 
						ABS(quotedDistance-rateDistance) AS extraChargeableDistance
					FROM getNearestRoute_30804_30711_70 a
					INNER JOIN rate ON a.rut_id=rate.rte_route_id AND rte_status=1 
						AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <> 0
					WHERE  1
					ORDER  BY rank DESC, extraStartDistance, extraChargeableDistance ASC, totalcost ASC
					LIMIT  0, 1 
	 [params: {"cabType":"83"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28341.658] [M: 27549.34] [ET: 0.689/28307.674] [MU: 3.46/27548.46] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28342.831] [M: 27559.58] [ET: 25.991/28308.842] [MU: 114.09/27559.42] 
	Quote::calculateOneWay  for CAB 83 Date: 2024-10-24 04:00:00
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28343.313] [M: 27563.17] [ET: 0.361/28309.332] [MU: 0.89/27562.92] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28344.551] [M: 27575.88] [ET: 0.664/28310.569] [MU: 3.34/27575.45] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28345.214] [M: 27605.05] [ET: 0.541/28311.229] [MU: 22.53/27604.3] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp423)) OR (apr_area_type = 5 AND apr_area_id IN (:gp421)) OR (apr_area_type = 2 AND apr_area_id IN (:gp424)) OR (apr_area_type = 4 AND apr_area_id IN (:gp425)) OR (apr_area_type = 1 AND apr_area_id IN (:gp422))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp421":"3699",":gp422":"31",":gp423":"30804",":gp424":"105",":gp425":"1","cab":"83"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28346.7] [M: 27592.07] [ET: 0.483/28312.719] [MU: 3.34/27591.63] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28349.697] [M: 27602.57] [ET: 2.869/28315.686] [MU: 3.49/27601.7] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp428)) OR (scr_area_type = 5 AND scr_area_id IN (:gp426)) OR (scr_area_type = 2 AND scr_area_id IN (:gp429)) OR (scr_area_type = 4 AND scr_area_id IN (:gp430)) OR (scr_area_type = 1 AND scr_area_id IN (:gp427)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp426":"3699",":gp427":"31",":gp428":"3699",":gp429":"105",":gp430":"1","scv_id":"83"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28350.337] [M: 27603.74] [ET: 0.336/28316.359] [MU: 2.98/27603.63] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28352.42] [M: 27613.99] [ET: 0.661/28318.436] [MU: 2.84/27613.37] 
	SQL: SELECT 
						fc.cty_id as c2id, 
						fc.cty_name as c2name, 
						fc.cty_garage_address as c2address,
						tc.cty_id as c4id,
						tc.cty_name as c4name, tc.cty_garage_address as c4address,
						0 as totalExtraDistance FROM route
						INNER JOIN cities fc ON rut_from_city_id=fc.cty_id
						INNER JOIN cities tc ON rut_to_city_id=tc.cty_id
						INNER JOIN rate on  rate.rte_route_id=route.rut_id  AND rate.rte_vehicletype_id IN (3)
						WHERE route.rut_from_city_id=30804 AND route.rut_to_city_id=30711 AND route.rut_active=1 
	 [params: []]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28352.905] [M: 27627.88] [ET: 0.41/28318.92] [MU: 6.53/27625.88] 
	SQL: 
				SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address, tc.cty_id as c4id, 
				tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
					FROM
					 (
						(
							SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id,  
								r3.rut_to_city_id, route.rut_name , route.rut_id,
								(route.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, 
								r3.rut_estm_distance
							FROM route
							INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_from_city_id=30804  
									AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=route.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) 
									AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
						UNION
						(
							SELECT r3.rut_id, r3.rut_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,(route.rut_estm_distance + r1.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
							FROM route
							INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND  route.rut_to_city_id=30711 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND route.rut_to_city_id=r3.rut_to_city_id))	AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
                     ) a
					INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
					INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1 
	 [params: []]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28353.354] [M: 27638.38] [ET: 0.38/28319.373] [MU: 5.04/27636.88] 
	SQL: SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
                              tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
                        FROM (SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,
                                    (route.rut_estm_distance + r1.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
                                FROM route
								INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
								INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
								INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) AND r3.rut_active=1 
								INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3) LIMIT 1
							)a
                        INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
                        INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1
                         
	 [params: []]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28353.839] [M: 27644.76] [ET: 0.412/28319.855] [MU: 0.75/27643.88] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"GarageRoute_30804_30711","sql":" (INDEX GarageRoute_30804_30711_index_rut_id (rut_id), INDEX GarageRoute_30804_30711_index_rut_from_city_id (rut_from_city_id), INDEX GarageRoute_30804_30711_index_rut_to_city_id (rut_to_city_id))\r\n\t\t\t\t\t\t\tSELECT route.rut_id, route.rut_from_city_id, route.rut_to_city_id, route.rut_name, rut_estm_distance FROM route \r\n\t\t\t\t\t\t\tINNER JOIN cities_stats   ON cities_stats.cts_cty_id = route.rut_from_city_id\r\n\t\t\t\t\t\t\tAND rut_estm_distance < 300\r\n\t\t\t\t\t\t\tAND rut_active = 1\r\n\t\t\t\t\t\t\tAND route.rut_to_city_id=30804\r\n\t\t\t\t\t\t\tAND cities_stats.cts_vnd_cnt >= 3\r\n\t\t\t\t\t\t\tORDER BY rut_estm_distance LIMIT 10"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28354.459] [M: 27656.68] [ET: 0.542/28320.474] [MU: 6.69/27654.93] 
	SQL: SELECT a.*, fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
								tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address 
						FROM ((SELECT xyz.rut_from_city_id as startCity, r1.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r3.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_from_city_id
							INNER JOIN rate ON rate.rte_route_id=r1.rut_id  AND rate.rte_vehicletype_id IN (3)
							INNER JOIN route r2 ON r2.rut_to_city_id=r1.rut_to_city_id AND r2.rut_from_city_id=:dropCity AND r2.rut_active=1
							INNER JOIN route r3 ON r3.rut_from_city_id=xyz.rut_to_city_id AND r3.rut_to_city_id=r2.rut_from_city_id AND r3.rut_active=1
							ORDER BY ExtraDistance LIMIT 1
							)
							UNION
							(
							SELECT xyz.rut_from_city_id as startCity, r2.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r2.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_to_city_id AND r1.rut_to_city_id=:dropCity
							INNER JOIN route r2 ON r2.rut_to_city_id=xyz.rut_from_city_id AND r2.rut_from_city_id=r1.rut_to_city_id
							ORDER BY ExtraDistance ASC LIMIT 1
							)) a
						INNER JOIN cities fc ON startCity=fc.cty_id
						INNER JOIN cities tc ON endCity=tc.cty_id 
						ORDER BY ExtraDistance 
	 [params: {"pickupCity":"30804","dropCity":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28356.985] [M: 27668.02] [ET: 1.131/28323.002] [MU: 7.89/27667.91] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28357.954] [M: 27673.59] [ET: 0.878/28323.976] [MU: 8.27/27673.48] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28358.834] [M: 27681.22] [ET: 0.34/28324.834] [MU: 1/27680.84] 
	SQL: SELECT cts_airport_pickup_entry_fee
               FROM   cities
               INNER JOIN cities_stats
               ON cities.cty_id = cities_stats.cts_cty_id
               WHERE  cty_id = :cityId
               AND cty_is_airport = 1 AND cty_active = 1 
	 [params: {"cityId":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28361.394] [M: 27695.13] [ET: 1.431/28327.394] [MU: 8.14/27695.02] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28362.373] [M: 27702.97] [ET: 0.862/28328.393] [MU: 8.08/27702.86] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28362.816] [M: 27702.4] [ET: 0.348/28328.818] [MU: 0.9/27702.15] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28364.386] [M: 27715.11] [ET: 0.796/28330.403] [MU: 3.33/27714.67] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28365.058] [M: 27744.28] [ET: 0.564/28331.076] [MU: 22.53/27743.53] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp433)) OR (apr_area_type = 5 AND apr_area_id IN (:gp431)) OR (apr_area_type = 2 AND apr_area_id IN (:gp434)) OR (apr_area_type = 4 AND apr_area_id IN (:gp435)) OR (apr_area_type = 1 AND apr_area_id IN (:gp432))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp431":"3699",":gp432":"31",":gp433":"30804",":gp434":"105",":gp435":"1","cab":"83"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28366.379] [M: 27731.3] [ET: 0.439/28332.4] [MU: 3.33/27730.86] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28368.835] [M: 27741.8] [ET: 2.348/28334.844] [MU: 3.48/27740.92] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp438)) OR (scr_area_type = 5 AND scr_area_id IN (:gp436)) OR (scr_area_type = 2 AND scr_area_id IN (:gp439)) OR (scr_area_type = 4 AND scr_area_id IN (:gp440)) OR (scr_area_type = 1 AND scr_area_id IN (:gp437)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp436":"3699",":gp437":"31",":gp438":"3699",":gp439":"105",":gp440":"1","scv_id":"83"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28369.61] [M: 27745.01] [ET: 0.372/28335.616] [MU: 2.98/27744.9] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28371.466] [M: 27758.02] [ET: 0.258/28337.489] [MU: 2.98/27757.91] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28371.737] [M: 27762.2] [ET: 0.203/28337.757] [MU: 2.98/27762.09] 
	BookingRoute::calculateDistance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28376.798] [M: 27796.2] [ET: 1.014/28342.797] [MU: 6.33/27794.2] 
	SQL: 
                SELECT cities.cty_id as c2id, cities.cty_name as c2name, cities.cty_garage_address as c2address,
                    cities.cty_id as c4id, cities.cty_name as c4name, cities.cty_garage_address as c4address,
                        (distance * 2) as totalExtraDistance
                 FROM (SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<40
                     INNER JOIN route r1 ON route.rut_to_city_id=r1.rut_from_city_id AND r1.rut_active=1
                     INNER JOIN rate ON r1.rut_id=rate.rte_route_id AND rate.rte_status=1  AND rate.rte_vehicletype_id IN (3) GROUP BY route.rut_id HAVING count(*) >30
                   UNION
                     SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<600
                     INNER JOIN cities tc ON tc.cty_id=route.rut_to_city_id AND tc.cty_service_active=1 AND CalcDistance(cities.cty_lat, cities.cty_long, tc.cty_lat, tc.cty_long)<=route.rut_estm_distance						 
                     INNER JOIN cities_stats ON cities_stats.cts_cty_id = route.rut_to_city_id AND cities_stats.cts_vnd_cnt >= 2
                   UNION
                    SELECT cts_cty_id AS city, 0 AS distance
					FROM cities_stats WHERE 1 AND cities_stats.cts_cty_id= 30817 and cities_stats.cts_vnd_cnt>1) a
                    INNER JOIN cities ON cities.cty_id=a.city
                    ORDER BY totalExtraDistance LIMIT 1 
	 [params: []]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28379.83] [M: 27811.02] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.255.12
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"3","tripDistance":"","tripDuration":"","multiCityData":"","bookingType":"1","pickupAddress":"","pickupDate":"24\/10\/2024","pickupTime":"04:00 AM","isGozonow":"0","minTripDistance":"0","sccId":"0","tripUser":"1","YII_CSRF_TOKEN":"N3VxRE1WeG9UeHk5UWFBUFpPT216eWVyY0xWTVpoTkcUoJ2aBoup1fU2M5E4ePVZVcUNlKiYZZysUqEklNiKWw==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=3&tripDistance=&tripDuration=&multiCityData=&bookingType=1&pickupAddress=&pickupDate=24%2F10%2F2024&pickupTime=04%3A00+AM&isGozonow=0&minTripDistance=0&sccId=0&tripUser=1&YII_CSRF_TOKEN=N3VxRE1WeG9UeHk5UWFBUFpPT216eWVyY0xWTVpoTkcUoJ2aBoup1fU2M5E4ePVZVcUNlKiYZZysUqEklNiKWw%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28380.829] [M: 27830.58] [ET: 1.545/28346.838] [MU: 20.76/27830.47] 
	models.RouteRates.calculateDriverAllowance
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28380.88] [M: 27832.26] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28382.249] [M: 27845.72] [ET: 1.204/28348.233] [MU: 2.99/27843.22] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+10013),(IF((cpm_value_type=2),(10013+(10013*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30937 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30937) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-24 04:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=83 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28384.658] [M: 27887.95] [ET: 5.457/28350.651] [MU: 78.59/27887.79] 
	RouteRates::calculate for CAB 83 2024-10-24 04:00:00 - Trip Type: 1 885210109
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28384.936] [M: 27865.63] [ET: 42.001/28350.935] [MU: 304.5/27865.48] 
	Quote::calculateRules for CAB 83, From City Id: 30804, To city Id: 30711
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28385.449] [M: 27837.34] [ET: 0.376/28351.448] [MU: 0.9/27837.09] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"83"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28385.574] [M: 27838.91] [ET: 75.39/28351.58] [MU: 440.82/27838.81] 
	Quote For CabType: 83
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28387.458] [M: 27849.25] [ET: 0.673/28353.454] [MU: 3.34/27848.81] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28388.331] [M: 27855.06] [ET: 0.754/28354.331] [MU: 3.34/27854.63] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28389.1] [M: 27858] [ET: 0.64/28355.095] [MU: 0.9/27857.75] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28390.234] [M: 27890.36] [ET: 0.937/28356.221] [MU: 24.22/27888.86] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (100) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30711) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp441)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp444,:gp445)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp442,:gp443)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp446,:gp447))
			OR (scr_area_type = 5 AND scr_area_id IN (3699))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (84)
		ORDER BY rank DESC
		 
	 [params: {":gp441":"31",":gp442":"30804",":gp443":"30711",":gp444":"105",":gp445":"100",":gp446":"1",":gp447":"1","tripType":"1"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28391.577] [M: 27870.54] [ET: 0.447/28357.575] [MU: 0.83/27870.35] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28392.253] [M: 27873.41] [ET: 0.544/28358.25] [MU: 0.96/27873.1] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"1"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28394.197] [M: 27886.18] [ET: 0.617/28360.189] [MU: 2.04/27885.68] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"84"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28399.257] [M: 27895.52] [ET: 4.551/28365.103] [MU: 3.48/27894.64] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"84","fromCity":"30804","toCity":"30711"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28402.133] [M: 27898.77] [ET: 0.868/28368.142] [MU: 0.87/27898.55] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":0}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28403.154] [M: 27906.09] [ET: 0.816/28369.152] [MU: 3.02/27905.66] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28404.066] [M: 27934.27] [ET: 0.739/28370.058] [MU: 22.04/27933.64] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp449)) OR (apr_area_type = 2 AND apr_area_id IN (:gp450)) OR (apr_area_type = 4 AND apr_area_id IN (:gp451)) OR (apr_area_type = 1 AND apr_area_id IN (:gp448))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp448":"31",":gp449":"30804",":gp450":"105",":gp451":"1","cab":"84"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28405.979] [M: 27920.98] [ET: 0.774/28371.976] [MU: 3.34/27920.55] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28409.813] [M: 27931.22] [ET: 3.653/28375.806] [MU: 3.36/27930.34] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp453)) OR (scr_area_type = 2 AND scr_area_id IN (:gp454)) OR (scr_area_type = 4 AND scr_area_id IN (:gp455)) OR (scr_area_type = 1 AND scr_area_id IN (:gp452)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp452":"31",":gp453":"30804",":gp454":"105",":gp455":"1","scv_id":"84"}]
2024/10/24 00:02:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28414.538] [M: 27959] [ET: 3.53/28380.506] [MU: 0.74/27951] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"nearest_route_30804_30711","sql":"(INDEX indx_nearest_rt_rutid (rut_id)) \r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, routeFrom.rut_name as fromAlias, \r\n\t\t\t\tNULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, \r\n\t\t\t\t0 as rank, routeFrom.rut_estm_time as startTime, 0 as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 \r\n\t\t\t\tAND routeFrom.rut_from_city_id<>routeFrom.rut_to_city_id AND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\t\tAND (routeAlias.rut_to_city_id=route.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, NULL, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) \r\n\t\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\t0 AS extraStartDistance, 0, 0 as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND route.rut_from_city_id = 30804 AND route.rut_to_city_id=30711 \r\n\t\t\t\tAND routeTo.rut_from_city_id=30711\r\n\t\t\t\tAND route.rut_active = 1 AND routeTo.rut_active = 1 AND routeTo.rut_estm_distance < 50 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = route.rut_from_city_id) \r\n\t\t\t   AND (routeAlias.rut_to_city_id = routeTo.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, \r\n\t\t\t\trouteFrom.rut_name, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t+ IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) \r\n\t\t\t\tAS extraDistance, IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, 0, \r\n\t\t\t\trouteFrom.rut_estm_time as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 AND routeFrom.rut_from_city_id <> routeFrom.rut_to_city_id\r\n\t\t\t\t\tAND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND routeTo.rut_estm_distance < 50 \r\n\t\t\t\t\tAND routeTo.rut_from_city_id=30711 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\tAND (routeAlias.rut_to_city_id=routeTo.rut_to_city_id) AND routeAlias.rut_active = 1 AND routeAlias.rut_from_city_id=30804  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28418.573] [M: 27963.03] [ET: 3.882/28384.559] [MU: 2.12/27962.59] 
	SQL: SELECT *, (rte_vendor_amount + extraDistance * 10.55) as totalCost FROM (SELECT * FROM nearest_route_30804_30711) a
					INNER JOIN rate ON a.rut_id = rate.rte_route_id AND rte_status=1 AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <>0
					WHERE 1 ORDER BY rank DESC, totalCost ASC LIMIT 0,1 
	 [params: {"cabType":"84"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28420.657] [M: 27971.05] [ET: 1.918/28386.632] [MU: 0.74/27969.05] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"getNearestRoute_30804_30711_70","sql":"(INDEX getNearestRoute_30804_30711_70_index_rut_id (rut_id))\r\n\t\t\t\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id AS start, routeAlias.rut_to_city_id AS end,\r\n\t\t\t\t\t\t\t\trouteFrom.rut_name AS fromAlias, NULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance AS quotedDistance,\r\n\t\t\t\t\t\t\t\trouteAlias.rut_estm_distance AS rateDistance, \r\n\t\t\t\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance)\r\n\t\t\t\t\t\t\t\t\t - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance,\r\n\t\t\t\t\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance,\r\n\t\t\t\t\t\t\t\t0 AS rank, routeFrom.rut_estm_time AS startTime, 0 AS endTime, route.rut_estm_time, \r\n\t\t\t\t\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraTravelDistance\r\n\t\t\t\t\t\tFROM   route\r\n\t\t\t\t\t\tINNER JOIN route routeTo ON routeTo.rut_to_city_id=route.rut_from_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_from_city_id=30804 AND routeTo.rut_active=1\r\n\t\t\t\t\t\t\t\tAND routeTo.rut_estm_distance<70 AND route.rut_active=1\r\n\t\t\t\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_from_city_id=route.rut_to_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_active = 1\r\n\t\t\t\t\t\t\t\tAND routeFrom.rut_estm_distance<70 AND route.rut_active = 1\r\n\t\t\t\t\t\tINNER JOIN route routeAlias ON routeAlias.rut_to_city_id=routeFrom.rut_to_city_id\r\n\t\t\t\t\t\t\tAND routeAlias.rut_from_city_id=routeTo.rut_from_city_id AND routeAlias.rut_active = 1"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28424.918] [M: 27976.32] [ET: 4.106/28390.901] [MU: 2.42/27975.7] 
	SQL: SELECT *, (rte_vendor_amount + extradistance * 10.55 ) AS totalCost, 
						ABS(quotedDistance-rateDistance) AS extraChargeableDistance
					FROM getNearestRoute_30804_30711_70 a
					INNER JOIN rate ON a.rut_id=rate.rte_route_id AND rte_status=1 
						AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <> 0
					WHERE  1
					ORDER  BY rank DESC, extraStartDistance, extraChargeableDistance ASC, totalcost ASC
					LIMIT  0, 1 
	 [params: {"cabType":"84"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28429.734] [M: 27991.45] [ET: 1.108/28395.725] [MU: 3.46/27990.58] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30711"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28432.171] [M: 28001.7] [ET: 37.862/28398.19] [MU: 114.09/28001.54] 
	Quote::calculateOneWay  for CAB 84 Date: 2024-10-24 04:00:00
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28432.878] [M: 28005.2] [ET: 0.591/28398.891] [MU: 0.9/28004.95] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28434.317] [M: 28017.91] [ET: 0.688/28400.329] [MU: 3.33/28017.47] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28435.061] [M: 28047.08] [ET: 0.616/28401.07] [MU: 22.53/28046.33] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp458)) OR (apr_area_type = 5 AND apr_area_id IN (:gp456)) OR (apr_area_type = 2 AND apr_area_id IN (:gp459)) OR (apr_area_type = 4 AND apr_area_id IN (:gp460)) OR (apr_area_type = 1 AND apr_area_id IN (:gp457))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp456":"3699",":gp457":"31",":gp458":"30804",":gp459":"105",":gp460":"1","cab":"84"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28436.928] [M: 28034.09] [ET: 0.669/28402.932] [MU: 3.34/28033.66] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28440.747] [M: 28044.59] [ET: 3.675/28406.734] [MU: 3.48/28043.72] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp463)) OR (scr_area_type = 5 AND scr_area_id IN (:gp461)) OR (scr_area_type = 2 AND scr_area_id IN (:gp464)) OR (scr_area_type = 4 AND scr_area_id IN (:gp465)) OR (scr_area_type = 1 AND scr_area_id IN (:gp462)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp461":"3699",":gp462":"31",":gp463":"3699",":gp464":"105",":gp465":"1","scv_id":"84"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28441.623] [M: 28049.77] [ET: 0.434/28407.627] [MU: 2.98/28049.66] 
	BookingRoute::calculateDistance
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28443.932] [M: 28060.02] [ET: 0.752/28409.945] [MU: 2.83/28059.39] 
	SQL: SELECT 
						fc.cty_id as c2id, 
						fc.cty_name as c2name, 
						fc.cty_garage_address as c2address,
						tc.cty_id as c4id,
						tc.cty_name as c4name, tc.cty_garage_address as c4address,
						0 as totalExtraDistance FROM route
						INNER JOIN cities fc ON rut_from_city_id=fc.cty_id
						INNER JOIN cities tc ON rut_to_city_id=tc.cty_id
						INNER JOIN rate on  rate.rte_route_id=route.rut_id  AND rate.rte_vehicletype_id IN (3)
						WHERE route.rut_from_city_id=30804 AND route.rut_to_city_id=30711 AND route.rut_active=1 
	 [params: []]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28444.526] [M: 28073.9] [ET: 0.503/28410.538] [MU: 6.53/28071.9] 
	SQL: 
				SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address, tc.cty_id as c4id, 
				tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
					FROM
					 (
						(
							SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id,  
								r3.rut_to_city_id, route.rut_name , route.rut_id,
								(route.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, 
								r3.rut_estm_distance
							FROM route
							INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_from_city_id=30804  
									AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=route.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) 
									AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
						UNION
						(
							SELECT r3.rut_id, r3.rut_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,(route.rut_estm_distance + r1.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
							FROM route
							INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND  route.rut_to_city_id=30711 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND route.rut_to_city_id=r3.rut_to_city_id))	AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
                     ) a
					INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
					INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1 
	 [params: []]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28445.048] [M: 28084.41] [ET: 0.444/28411.062] [MU: 5.03/28082.91] 
	SQL: SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
                              tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
                        FROM (SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,
                                    (route.rut_estm_distance + r1.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
                                FROM route
								INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
								INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
								INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) AND r3.rut_active=1 
								INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3) LIMIT 1
							)a
                        INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
                        INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1
                         
	 [params: []]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28445.564] [M: 28090.78] [ET: 0.438/28411.577] [MU: 0.74/28089.91] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"GarageRoute_30804_30711","sql":" (INDEX GarageRoute_30804_30711_index_rut_id (rut_id), INDEX GarageRoute_30804_30711_index_rut_from_city_id (rut_from_city_id), INDEX GarageRoute_30804_30711_index_rut_to_city_id (rut_to_city_id))\r\n\t\t\t\t\t\t\tSELECT route.rut_id, route.rut_from_city_id, route.rut_to_city_id, route.rut_name, rut_estm_distance FROM route \r\n\t\t\t\t\t\t\tINNER JOIN cities_stats   ON cities_stats.cts_cty_id = route.rut_from_city_id\r\n\t\t\t\t\t\t\tAND rut_estm_distance < 300\r\n\t\t\t\t\t\t\tAND rut_active = 1\r\n\t\t\t\t\t\t\tAND route.rut_to_city_id=30804\r\n\t\t\t\t\t\t\tAND cities_stats.cts_vnd_cnt >= 3\r\n\t\t\t\t\t\t\tORDER BY rut_estm_distance LIMIT 10"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28446.295] [M: 28102.7] [ET: 0.645/28412.306] [MU: 6.69/28100.95] 
	SQL: SELECT a.*, fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
								tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address 
						FROM ((SELECT xyz.rut_from_city_id as startCity, r1.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r3.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_from_city_id
							INNER JOIN rate ON rate.rte_route_id=r1.rut_id  AND rate.rte_vehicletype_id IN (3)
							INNER JOIN route r2 ON r2.rut_to_city_id=r1.rut_to_city_id AND r2.rut_from_city_id=:dropCity AND r2.rut_active=1
							INNER JOIN route r3 ON r3.rut_from_city_id=xyz.rut_to_city_id AND r3.rut_to_city_id=r2.rut_from_city_id AND r3.rut_active=1
							ORDER BY ExtraDistance LIMIT 1
							)
							UNION
							(
							SELECT xyz.rut_from_city_id as startCity, r2.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r2.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_to_city_id AND r1.rut_to_city_id=:dropCity
							INNER JOIN route r2 ON r2.rut_to_city_id=xyz.rut_from_city_id AND r2.rut_from_city_id=r1.rut_to_city_id
							ORDER BY ExtraDistance ASC LIMIT 1
							)) a
						INNER JOIN cities fc ON startCity=fc.cty_id
						INNER JOIN cities tc ON endCity=tc.cty_id 
						ORDER BY ExtraDistance 
	 [params: {"pickupCity":"30804","dropCity":"30711"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28449.942] [M: 28114.05] [ET: 1.629/28415.94] [MU: 7.88/28113.94] 
	BookingRoute::calculateDistance
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28451.57] [M: 28119.52] [ET: 1.48/28417.565] [MU: 8.27/28119.41] 
	BookingRoute::calculateDistance
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28452.895] [M: 28127.05] [ET: 0.54/28418.872] [MU: 0.99/28126.68] 
	SQL: SELECT cts_airport_pickup_entry_fee
               FROM   cities
               INNER JOIN cities_stats
               ON cities.cty_id = cities_stats.cts_cty_id
               WHERE  cty_id = :cityId
               AND cty_is_airport = 1 AND cty_active = 1 
	 [params: {"cityId":"30804"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28455.01] [M: 28140.97] [ET: 1.293/28421.011] [MU: 8.13/28140.86] 
	BookingRoute::calculateDistance
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28456.504] [M: 28148.71] [ET: 1.333/28422.504] [MU: 8.07/28148.6] 
	BookingRoute::calculateDistance
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28457.126] [M: 28148.05] [ET: 0.489/28423.118] [MU: 0.9/28147.8] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28458.932] [M: 28160.76] [ET: 0.838/28424.929] [MU: 3.33/28160.32] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28459.824] [M: 28189.93] [ET: 0.667/28425.817] [MU: 22.53/28189.18] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp468)) OR (apr_area_type = 5 AND apr_area_id IN (:gp466)) OR (apr_area_type = 2 AND apr_area_id IN (:gp469)) OR (apr_area_type = 4 AND apr_area_id IN (:gp470)) OR (apr_area_type = 1 AND apr_area_id IN (:gp467))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp466":"3699",":gp467":"31",":gp468":"30804",":gp469":"105",":gp470":"1","cab":"84"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28462.073] [M: 28176.95] [ET: 0.538/28428.087] [MU: 3.34/28176.51] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28465.048] [M: 28187.45] [ET: 2.851/28431.056] [MU: 3.48/28186.57] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp473)) OR (scr_area_type = 5 AND scr_area_id IN (:gp471)) OR (scr_area_type = 2 AND scr_area_id IN (:gp474)) OR (scr_area_type = 4 AND scr_area_id IN (:gp475)) OR (scr_area_type = 1 AND scr_area_id IN (:gp472)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp471":"3699",":gp472":"31",":gp473":"3699",":gp474":"105",":gp475":"1","scv_id":"84"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28465.737] [M: 28190.66] [ET: 0.263/28431.758] [MU: 2.98/28190.55] 
	BookingRoute::calculateDistance
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28467.187] [M: 28203.77] [ET: 0.263/28433.209] [MU: 2.98/28203.66] 
	BookingRoute::calculateDistance
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28467.474] [M: 28207.94] [ET: 0.215/28433.498] [MU: 2.98/28207.83] 
	BookingRoute::calculateDistance
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28472.04] [M: 28242.04] [ET: 0.657/28438.052] [MU: 6.33/28240.04] 
	SQL: 
                SELECT cities.cty_id as c2id, cities.cty_name as c2name, cities.cty_garage_address as c2address,
                    cities.cty_id as c4id, cities.cty_name as c4name, cities.cty_garage_address as c4address,
                        (distance * 2) as totalExtraDistance
                 FROM (SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<40
                     INNER JOIN route r1 ON route.rut_to_city_id=r1.rut_from_city_id AND r1.rut_active=1
                     INNER JOIN rate ON r1.rut_id=rate.rte_route_id AND rate.rte_status=1  AND rate.rte_vehicletype_id IN (3) GROUP BY route.rut_id HAVING count(*) >30
                   UNION
                     SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<600
                     INNER JOIN cities tc ON tc.cty_id=route.rut_to_city_id AND tc.cty_service_active=1 AND CalcDistance(cities.cty_lat, cities.cty_long, tc.cty_lat, tc.cty_long)<=route.rut_estm_distance						 
                     INNER JOIN cities_stats ON cities_stats.cts_cty_id = route.rut_to_city_id AND cities_stats.cts_vnd_cnt >= 2
                   UNION
                    SELECT cts_cty_id AS city, 0 AS distance
					FROM cities_stats WHERE 1 AND cities_stats.cts_cty_id= 30817 and cities_stats.cts_vnd_cnt>1) a
                    INNER JOIN cities ON cities.cty_id=a.city
                    ORDER BY totalExtraDistance LIMIT 1 
	 [params: []]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28475.553] [M: 28256.85] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.255.12
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"3","tripDistance":"","tripDuration":"","multiCityData":"","bookingType":"1","pickupAddress":"","pickupDate":"24\/10\/2024","pickupTime":"04:00 AM","isGozonow":"0","minTripDistance":"0","sccId":"0","tripUser":"1","YII_CSRF_TOKEN":"N3VxRE1WeG9UeHk5UWFBUFpPT216eWVyY0xWTVpoTkcUoJ2aBoup1fU2M5E4ePVZVcUNlKiYZZysUqEklNiKWw==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=3&tripDistance=&tripDuration=&multiCityData=&bookingType=1&pickupAddress=&pickupDate=24%2F10%2F2024&pickupTime=04%3A00+AM&isGozonow=0&minTripDistance=0&sccId=0&tripUser=1&YII_CSRF_TOKEN=N3VxRE1WeG9UeHk5UWFBUFpPT216eWVyY0xWTVpoTkcUoJ2aBoup1fU2M5E4ePVZVcUNlKiYZZysUqEklNiKWw%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28476.054] [M: 28276.41] [ET: 0.936/28442.079] [MU: 20.77/28276.3] 
	models.RouteRates.calculateDriverAllowance
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28476.086] [M: 28278.09] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28477.051] [M: 28291.55] [ET: 0.831/28443.057] [MU: 2.99/28289.05] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+10013),(IF((cpm_value_type=2),(10013+(10013*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30937 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30937) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-24 04:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=84 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28478.532] [M: 28333.78] [ET: 3.474/28444.554] [MU: 78.6/28333.63] 
	RouteRates::calculate for CAB 84 2024-10-24 04:00:00 - Trip Type: 1 993542501
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28478.673] [M: 28311.47] [ET: 46.436/28444.699] [MU: 308.32/28311.31] 
	Quote::calculateRules for CAB 84, From City Id: 30804, To city Id: 30711
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28478.949] [M: 28283.18] [ET: 0.202/28444.972] [MU: 0.9/28282.93] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"84"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28479.02] [M: 28284.74] [ET: 93.371/28445.046] [MU: 444.53/28284.65] 
	Quote For CabType: 84
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28480.647] [M: 28295.09] [ET: 0.839/28446.659] [MU: 3.33/28294.65] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28481.265] [M: 28300.9] [ET: 0.539/28447.283] [MU: 3.33/28300.46] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30711"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28481.836] [M: 28303.84] [ET: 0.495/28447.849] [MU: 0.9/28303.59] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28482.422] [M: 28336.2] [ET: 0.476/28448.43] [MU: 24.22/28334.7] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (100) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30711) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp476)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp479,:gp480)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp477,:gp478)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp481,:gp482))
			OR (scr_area_type = 5 AND scr_area_id IN (3699))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (93)
		ORDER BY rank DESC
		 
	 [params: {":gp476":"31",":gp477":"30804",":gp478":"30711",":gp479":"105",":gp480":"100",":gp481":"1",":gp482":"1","tripType":"1"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28483.04] [M: 28316.38] [ET: 0.192/28449.061] [MU: 0.84/28316.2] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28483.367] [M: 28319.26] [ET: 0.254/28449.389] [MU: 0.96/28318.95] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"2"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28484.757] [M: 28332.01] [ET: 0.44/28450.774] [MU: 2.05/28331.51] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"93"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28487.74] [M: 28341.34] [ET: 2.761/28453.732] [MU: 3.48/28340.47] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"93","fromCity":"30804","toCity":"30711"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28489.227] [M: 28344.59] [ET: 0.571/28455.233] [MU: 0.87/28344.38] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":0}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28490.326] [M: 28351.92] [ET: 0.884/28456.343] [MU: 3.02/28351.48] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28491.008] [M: 28380.09] [ET: 0.526/28457.003] [MU: 22.05/28379.47] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp484)) OR (apr_area_type = 2 AND apr_area_id IN (:gp485)) OR (apr_area_type = 4 AND apr_area_id IN (:gp486)) OR (apr_area_type = 1 AND apr_area_id IN (:gp483))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp483":"31",":gp484":"30804",":gp485":"105",":gp486":"1","cab":"93"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28492.09] [M: 28366.82] [ET: 0.446/28458.111] [MU: 3.34/28366.38] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28494.83] [M: 28377.05] [ET: 2.618/28460.821] [MU: 3.36/28376.18] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp488)) OR (scr_area_type = 2 AND scr_area_id IN (:gp489)) OR (scr_area_type = 4 AND scr_area_id IN (:gp490)) OR (scr_area_type = 1 AND scr_area_id IN (:gp487)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp487":"31",":gp488":"30804",":gp489":"105",":gp490":"1","scv_id":"93"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28498.015] [M: 28404.83] [ET: 2.241/28464.008] [MU: 0.74/28396.83] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"nearest_route_30804_30711","sql":"(INDEX indx_nearest_rt_rutid (rut_id)) \r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, routeFrom.rut_name as fromAlias, \r\n\t\t\t\tNULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, \r\n\t\t\t\t0 as rank, routeFrom.rut_estm_time as startTime, 0 as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 \r\n\t\t\t\tAND routeFrom.rut_from_city_id<>routeFrom.rut_to_city_id AND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\t\tAND (routeAlias.rut_to_city_id=route.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, NULL, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) \r\n\t\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\t0 AS extraStartDistance, 0, 0 as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND route.rut_from_city_id = 30804 AND route.rut_to_city_id=30711 \r\n\t\t\t\tAND routeTo.rut_from_city_id=30711\r\n\t\t\t\tAND route.rut_active = 1 AND routeTo.rut_active = 1 AND routeTo.rut_estm_distance < 50 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = route.rut_from_city_id) \r\n\t\t\t   AND (routeAlias.rut_to_city_id = routeTo.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, \r\n\t\t\t\trouteFrom.rut_name, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t+ IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) \r\n\t\t\t\tAS extraDistance, IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, 0, \r\n\t\t\t\trouteFrom.rut_estm_time as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 AND routeFrom.rut_from_city_id <> routeFrom.rut_to_city_id\r\n\t\t\t\t\tAND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND routeTo.rut_estm_distance < 50 \r\n\t\t\t\t\tAND routeTo.rut_from_city_id=30711 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\tAND (routeAlias.rut_to_city_id=routeTo.rut_to_city_id) AND routeAlias.rut_active = 1 AND routeAlias.rut_from_city_id=30804  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28501.369] [M: 28408.86] [ET: 3.25/28467.362] [MU: 2.11/28408.42] 
	SQL: SELECT *, (rte_vendor_amount + extraDistance * 10.55) as totalCost FROM (SELECT * FROM nearest_route_30804_30711) a
					INNER JOIN rate ON a.rut_id = rate.rte_route_id AND rte_status=1 AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <>0
					WHERE 1 ORDER BY rank DESC, totalCost ASC LIMIT 0,1 
	 [params: {"cabType":"93"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28502.097] [M: 28416.88] [ET: 0.589/28468.106] [MU: 0.75/28414.88] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"getNearestRoute_30804_30711_70","sql":"(INDEX getNearestRoute_30804_30711_70_index_rut_id (rut_id))\r\n\t\t\t\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id AS start, routeAlias.rut_to_city_id AS end,\r\n\t\t\t\t\t\t\t\trouteFrom.rut_name AS fromAlias, NULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance AS quotedDistance,\r\n\t\t\t\t\t\t\t\trouteAlias.rut_estm_distance AS rateDistance, \r\n\t\t\t\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance)\r\n\t\t\t\t\t\t\t\t\t - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance,\r\n\t\t\t\t\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance,\r\n\t\t\t\t\t\t\t\t0 AS rank, routeFrom.rut_estm_time AS startTime, 0 AS endTime, route.rut_estm_time, \r\n\t\t\t\t\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraTravelDistance\r\n\t\t\t\t\t\tFROM   route\r\n\t\t\t\t\t\tINNER JOIN route routeTo ON routeTo.rut_to_city_id=route.rut_from_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_from_city_id=30804 AND routeTo.rut_active=1\r\n\t\t\t\t\t\t\t\tAND routeTo.rut_estm_distance<70 AND route.rut_active=1\r\n\t\t\t\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_from_city_id=route.rut_to_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_active = 1\r\n\t\t\t\t\t\t\t\tAND routeFrom.rut_estm_distance<70 AND route.rut_active = 1\r\n\t\t\t\t\t\tINNER JOIN route routeAlias ON routeAlias.rut_to_city_id=routeFrom.rut_to_city_id\r\n\t\t\t\t\t\t\tAND routeAlias.rut_from_city_id=routeTo.rut_from_city_id AND routeAlias.rut_active = 1"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28504.473] [M: 28422.15] [ET: 2.292/28470.485] [MU: 2.42/28421.52] 
	SQL: SELECT *, (rte_vendor_amount + extradistance * 10.55 ) AS totalCost, 
						ABS(quotedDistance-rateDistance) AS extraChargeableDistance
					FROM getNearestRoute_30804_30711_70 a
					INNER JOIN rate ON a.rut_id=rate.rte_route_id AND rte_status=1 
						AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <> 0
					WHERE  1
					ORDER  BY rank DESC, extraStartDistance, extraChargeableDistance ASC, totalcost ASC
					LIMIT  0, 1 
	 [params: {"cabType":"93"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28507.462] [M: 28437.29] [ET: 0.572/28473.478] [MU: 3.46/28436.41] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"16","fromCity":"30804","toCity":"30711"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28509.075] [M: 28453.91] [ET: 0.507/28475.052] [MU: 3.78/28453.03] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30711"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28510.814] [M: 28465] [ET: 25.974/28476.819] [MU: 131.57/28464.84] 
	Quote::calculateOneWay  for CAB 93 Date: 2024-10-24 04:00:00
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28511.487] [M: 28468.5] [ET: 0.543/28477.503] [MU: 0.9/28468.25] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28512.722] [M: 28481.21] [ET: 0.583/28478.741] [MU: 3.34/28480.77] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28513.403] [M: 28510.38] [ET: 0.575/28479.421] [MU: 22.54/28509.63] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp493)) OR (apr_area_type = 5 AND apr_area_id IN (:gp491)) OR (apr_area_type = 2 AND apr_area_id IN (:gp494)) OR (apr_area_type = 4 AND apr_area_id IN (:gp495)) OR (apr_area_type = 1 AND apr_area_id IN (:gp492))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp491":"3699",":gp492":"31",":gp493":"30804",":gp494":"105",":gp495":"1","cab":"93"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28515.458] [M: 28497.41] [ET: 0.494/28481.475] [MU: 3.33/28496.97] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28518.52] [M: 28507.91] [ET: 2.93/28484.509] [MU: 3.48/28507.03] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp498)) OR (scr_area_type = 5 AND scr_area_id IN (:gp496)) OR (scr_area_type = 2 AND scr_area_id IN (:gp499)) OR (scr_area_type = 4 AND scr_area_id IN (:gp500)) OR (scr_area_type = 1 AND scr_area_id IN (:gp497)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp496":"3699",":gp497":"31",":gp498":"3699",":gp499":"105",":gp500":"1","scv_id":"93"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28519.129] [M: 28509.07] [ET: 0.26/28485.14] [MU: 2.97/28508.96] 
	BookingRoute::calculateDistance
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28521.417] [M: 28519.23] [ET: 0.673/28487.433] [MU: 2.83/28518.6] 
	SQL: SELECT 
						fc.cty_id as c2id, 
						fc.cty_name as c2name, 
						fc.cty_garage_address as c2address,
						tc.cty_id as c4id,
						tc.cty_name as c4name, tc.cty_garage_address as c4address,
						0 as totalExtraDistance FROM route
						INNER JOIN cities fc ON rut_from_city_id=fc.cty_id
						INNER JOIN cities tc ON rut_to_city_id=tc.cty_id
						INNER JOIN rate on  rate.rte_route_id=route.rut_id  AND rate.rte_vehicletype_id IN (3)
						WHERE route.rut_from_city_id=30804 AND route.rut_to_city_id=30711 AND route.rut_active=1 
	 [params: []]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28521.958] [M: 28533.11] [ET: 0.448/28487.957] [MU: 6.53/28531.11] 
	SQL: 
				SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address, tc.cty_id as c4id, 
				tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
					FROM
					 (
						(
							SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id,  
								r3.rut_to_city_id, route.rut_name , route.rut_id,
								(route.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, 
								r3.rut_estm_distance
							FROM route
							INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_from_city_id=30804  
									AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=route.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) 
									AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
						UNION
						(
							SELECT r3.rut_id, r3.rut_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,(route.rut_estm_distance + r1.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
							FROM route
							INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND  route.rut_to_city_id=30711 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND route.rut_to_city_id=r3.rut_to_city_id))	AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
                     ) a
					INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
					INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1 
	 [params: []]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28522.745] [M: 28543.62] [ET: 0.67/28488.739] [MU: 5.03/28542.12] 
	SQL: SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
                              tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
                        FROM (SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,
                                    (route.rut_estm_distance + r1.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
                                FROM route
								INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
								INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
								INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) AND r3.rut_active=1 
								INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3) LIMIT 1
							)a
                        INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
                        INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1
                         
	 [params: []]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28523.421] [M: 28549.99] [ET: 0.57/28489.434] [MU: 0.74/28549.12] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"GarageRoute_30804_30711","sql":" (INDEX GarageRoute_30804_30711_index_rut_id (rut_id), INDEX GarageRoute_30804_30711_index_rut_from_city_id (rut_from_city_id), INDEX GarageRoute_30804_30711_index_rut_to_city_id (rut_to_city_id))\r\n\t\t\t\t\t\t\tSELECT route.rut_id, route.rut_from_city_id, route.rut_to_city_id, route.rut_name, rut_estm_distance FROM route \r\n\t\t\t\t\t\t\tINNER JOIN cities_stats   ON cities_stats.cts_cty_id = route.rut_from_city_id\r\n\t\t\t\t\t\t\tAND rut_estm_distance < 300\r\n\t\t\t\t\t\t\tAND rut_active = 1\r\n\t\t\t\t\t\t\tAND route.rut_to_city_id=30804\r\n\t\t\t\t\t\t\tAND cities_stats.cts_vnd_cnt >= 3\r\n\t\t\t\t\t\t\tORDER BY rut_estm_distance LIMIT 10"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28524.085] [M: 28561.91] [ET: 0.58/28490.099] [MU: 6.69/28560.16] 
	SQL: SELECT a.*, fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
								tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address 
						FROM ((SELECT xyz.rut_from_city_id as startCity, r1.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r3.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_from_city_id
							INNER JOIN rate ON rate.rte_route_id=r1.rut_id  AND rate.rte_vehicletype_id IN (3)
							INNER JOIN route r2 ON r2.rut_to_city_id=r1.rut_to_city_id AND r2.rut_from_city_id=:dropCity AND r2.rut_active=1
							INNER JOIN route r3 ON r3.rut_from_city_id=xyz.rut_to_city_id AND r3.rut_to_city_id=r2.rut_from_city_id AND r3.rut_active=1
							ORDER BY ExtraDistance LIMIT 1
							)
							UNION
							(
							SELECT xyz.rut_from_city_id as startCity, r2.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r2.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_to_city_id AND r1.rut_to_city_id=:dropCity
							INNER JOIN route r2 ON r2.rut_to_city_id=xyz.rut_from_city_id AND r2.rut_from_city_id=r1.rut_to_city_id
							ORDER BY ExtraDistance ASC LIMIT 1
							)) a
						INNER JOIN cities fc ON startCity=fc.cty_id
						INNER JOIN cities tc ON endCity=tc.cty_id 
						ORDER BY ExtraDistance 
	 [params: {"pickupCity":"30804","dropCity":"30711"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28527.019] [M: 28573.26] [ET: 1.218/28493.035] [MU: 7.88/28573.15] 
	BookingRoute::calculateDistance
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28527.913] [M: 28578.83] [ET: 0.801/28493.93] [MU: 8.26/28578.72] 
	BookingRoute::calculateDistance
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28528.733] [M: 28586.36] [ET: 0.339/28494.751] [MU: 1/28585.98] 
	SQL: SELECT cts_airport_pickup_entry_fee
               FROM   cities
               INNER JOIN cities_stats
               ON cities.cty_id = cities_stats.cts_cty_id
               WHERE  cty_id = :cityId
               AND cty_is_airport = 1 AND cty_active = 1 
	 [params: {"cityId":"30804"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28530.815] [M: 28600.27] [ET: 1.366/28496.832] [MU: 8.14/28600.16] 
	BookingRoute::calculateDistance
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28531.892] [M: 28608.11] [ET: 0.936/28497.912] [MU: 8.08/28608] 
	BookingRoute::calculateDistance
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28532.314] [M: 28607.45] [ET: 0.336/28498.334] [MU: 0.9/28607.2] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28533.455] [M: 28620.16] [ET: 0.571/28499.47] [MU: 3.33/28619.72] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28534.089] [M: 28649.33] [ET: 0.523/28500.106] [MU: 22.53/28648.58] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp503)) OR (apr_area_type = 5 AND apr_area_id IN (:gp501)) OR (apr_area_type = 2 AND apr_area_id IN (:gp504)) OR (apr_area_type = 4 AND apr_area_id IN (:gp505)) OR (apr_area_type = 1 AND apr_area_id IN (:gp502))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp501":"3699",":gp502":"31",":gp503":"30804",":gp504":"105",":gp505":"1","cab":"93"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28535.57] [M: 28636.35] [ET: 0.507/28501.589] [MU: 3.34/28635.91] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28538.391] [M: 28646.85] [ET: 2.699/28504.386] [MU: 3.49/28645.98] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp508)) OR (scr_area_type = 5 AND scr_area_id IN (:gp506)) OR (scr_area_type = 2 AND scr_area_id IN (:gp509)) OR (scr_area_type = 4 AND scr_area_id IN (:gp510)) OR (scr_area_type = 1 AND scr_area_id IN (:gp507)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp506":"3699",":gp507":"31",":gp508":"3699",":gp509":"105",":gp510":"1","scv_id":"93"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28538.966] [M: 28650.05] [ET: 0.231/28504.989] [MU: 2.98/28649.95] 
	BookingRoute::calculateDistance
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28540.788] [M: 28663.16] [ET: 0.279/28506.808] [MU: 2.98/28663.05] 
	BookingRoute::calculateDistance
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28541.073] [M: 28667.34] [ET: 0.207/28507.09] [MU: 2.98/28667.23] 
	BookingRoute::calculateDistance
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28545.684] [M: 28701.34] [ET: 0.79/28511.693] [MU: 6.33/28699.34] 
	SQL: 
                SELECT cities.cty_id as c2id, cities.cty_name as c2name, cities.cty_garage_address as c2address,
                    cities.cty_id as c4id, cities.cty_name as c4name, cities.cty_garage_address as c4address,
                        (distance * 2) as totalExtraDistance
                 FROM (SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<40
                     INNER JOIN route r1 ON route.rut_to_city_id=r1.rut_from_city_id AND r1.rut_active=1
                     INNER JOIN rate ON r1.rut_id=rate.rte_route_id AND rate.rte_status=1  AND rate.rte_vehicletype_id IN (3) GROUP BY route.rut_id HAVING count(*) >30
                   UNION
                     SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<600
                     INNER JOIN cities tc ON tc.cty_id=route.rut_to_city_id AND tc.cty_service_active=1 AND CalcDistance(cities.cty_lat, cities.cty_long, tc.cty_lat, tc.cty_long)<=route.rut_estm_distance						 
                     INNER JOIN cities_stats ON cities_stats.cts_cty_id = route.rut_to_city_id AND cities_stats.cts_vnd_cnt >= 2
                   UNION
                    SELECT cts_cty_id AS city, 0 AS distance
					FROM cities_stats WHERE 1 AND cities_stats.cts_cty_id= 30817 and cities_stats.cts_vnd_cnt>1) a
                    INNER JOIN cities ON cities.cty_id=a.city
                    ORDER BY totalExtraDistance LIMIT 1 
	 [params: []]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28548.373] [M: 28716.16] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.255.12
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"3","tripDistance":"","tripDuration":"","multiCityData":"","bookingType":"1","pickupAddress":"","pickupDate":"24\/10\/2024","pickupTime":"04:00 AM","isGozonow":"0","minTripDistance":"0","sccId":"0","tripUser":"1","YII_CSRF_TOKEN":"N3VxRE1WeG9UeHk5UWFBUFpPT216eWVyY0xWTVpoTkcUoJ2aBoup1fU2M5E4ePVZVcUNlKiYZZysUqEklNiKWw==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=3&tripDistance=&tripDuration=&multiCityData=&bookingType=1&pickupAddress=&pickupDate=24%2F10%2F2024&pickupTime=04%3A00+AM&isGozonow=0&minTripDistance=0&sccId=0&tripUser=1&YII_CSRF_TOKEN=N3VxRE1WeG9UeHk5UWFBUFpPT216eWVyY0xWTVpoTkcUoJ2aBoup1fU2M5E4ePVZVcUNlKiYZZysUqEklNiKWw%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28548.862] [M: 28735.72] [ET: 0.962/28514.887] [MU: 20.76/28735.61] 
	models.RouteRates.calculateDriverAllowance
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28548.894] [M: 28737.4] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28550.007] [M: 28750.86] [ET: 0.966/28515.988] [MU: 2.99/28748.36] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+10013),(IF((cpm_value_type=2),(10013+(10013*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30937 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30937) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-24 04:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=93 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28552.16] [M: 28793.09] [ET: 4.299/28518.158] [MU: 78.59/28792.93] 
	RouteRates::calculate for CAB 93 2024-10-24 04:00:00 - Trip Type: 1 891375648
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28552.41] [M: 28770.77] [ET: 41.502/28518.417] [MU: 304.31/28770.62] 
	Quote::calculateRules for CAB 93, From City Id: 30804, To city Id: 30711
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28552.815] [M: 28742.49] [ET: 0.298/28518.833] [MU: 0.89/28742.24] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"93"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28552.892] [M: 28744.05] [ET: 73.821/28518.917] [MU: 458/28743.96] 
	Quote For CabType: 93
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28554.256] [M: 28754.4] [ET: 0.489/28520.271] [MU: 3.33/28753.96] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28554.77] [M: 28760.21] [ET: 0.443/28520.789] [MU: 3.34/28759.77] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30711"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28555.351] [M: 28763.15] [ET: 0.506/28521.369] [MU: 0.9/28762.9] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28555.938] [M: 28795.51] [ET: 0.478/28521.954] [MU: 24.22/28794.01] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (100) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30711) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp511)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp514,:gp515)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp512,:gp513)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp516,:gp517))
			OR (scr_area_type = 5 AND scr_area_id IN (3699))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (96)
		ORDER BY rank DESC
		 
	 [params: {":gp511":"31",":gp512":"30804",":gp513":"30711",":gp514":"105",":gp515":"100",":gp516":"1",":gp517":"1","tripType":"1"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28556.585] [M: 28775.69] [ET: 0.194/28522.606] [MU: 0.83/28775.5] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28556.895] [M: 28778.56] [ET: 0.239/28522.917] [MU: 0.96/28778.25] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"2"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28557.966] [M: 28791.31] [ET: 0.316/28523.987] [MU: 2.05/28790.81] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"96"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28561.069] [M: 28800.65] [ET: 2.899/28527.077] [MU: 3.49/28799.77] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"96","fromCity":"30804","toCity":"30711"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28562.531] [M: 28803.9] [ET: 0.515/28528.532] [MU: 0.86/28803.68] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":0}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28563.405] [M: 28811.23] [ET: 0.65/28529.417] [MU: 3.01/28810.79] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28564.179] [M: 28839.4] [ET: 0.624/28530.177] [MU: 22.05/28838.77] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp519)) OR (apr_area_type = 2 AND apr_area_id IN (:gp520)) OR (apr_area_type = 4 AND apr_area_id IN (:gp521)) OR (apr_area_type = 1 AND apr_area_id IN (:gp518))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp518":"31",":gp519":"30804",":gp520":"105",":gp521":"1","cab":"96"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28565.316] [M: 28826.12] [ET: 0.46/28531.336] [MU: 3.33/28825.68] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28568.327] [M: 28836.35] [ET: 2.885/28534.316] [MU: 3.36/28835.48] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp523)) OR (scr_area_type = 2 AND scr_area_id IN (:gp524)) OR (scr_area_type = 4 AND scr_area_id IN (:gp525)) OR (scr_area_type = 1 AND scr_area_id IN (:gp522)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp522":"31",":gp523":"30804",":gp524":"105",":gp525":"1","scv_id":"96"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28571.416] [M: 28864.13] [ET: 2.095/28537.409] [MU: 0.75/28856.13] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"nearest_route_30804_30711","sql":"(INDEX indx_nearest_rt_rutid (rut_id)) \r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, routeFrom.rut_name as fromAlias, \r\n\t\t\t\tNULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, \r\n\t\t\t\t0 as rank, routeFrom.rut_estm_time as startTime, 0 as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 \r\n\t\t\t\tAND routeFrom.rut_from_city_id<>routeFrom.rut_to_city_id AND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\t\tAND (routeAlias.rut_to_city_id=route.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, NULL, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) \r\n\t\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\t0 AS extraStartDistance, 0, 0 as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND route.rut_from_city_id = 30804 AND route.rut_to_city_id=30711 \r\n\t\t\t\tAND routeTo.rut_from_city_id=30711\r\n\t\t\t\tAND route.rut_active = 1 AND routeTo.rut_active = 1 AND routeTo.rut_estm_distance < 50 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = route.rut_from_city_id) \r\n\t\t\t   AND (routeAlias.rut_to_city_id = routeTo.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, \r\n\t\t\t\trouteFrom.rut_name, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t+ IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) \r\n\t\t\t\tAS extraDistance, IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, 0, \r\n\t\t\t\trouteFrom.rut_estm_time as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 AND routeFrom.rut_from_city_id <> routeFrom.rut_to_city_id\r\n\t\t\t\t\tAND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND routeTo.rut_estm_distance < 50 \r\n\t\t\t\t\tAND routeTo.rut_from_city_id=30711 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\tAND (routeAlias.rut_to_city_id=routeTo.rut_to_city_id) AND routeAlias.rut_active = 1 AND routeAlias.rut_from_city_id=30804  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28574.041] [M: 28868.16] [ET: 2.527/28540.053] [MU: 2.12/28867.73] 
	SQL: SELECT *, (rte_vendor_amount + extraDistance * 10.55) as totalCost FROM (SELECT * FROM nearest_route_30804_30711) a
					INNER JOIN rate ON a.rut_id = rate.rte_route_id AND rte_status=1 AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <>0
					WHERE 1 ORDER BY rank DESC, totalCost ASC LIMIT 0,1 
	 [params: {"cabType":"96"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28574.804] [M: 28876.19] [ET: 0.64/28540.789] [MU: 0.74/28874.19] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"getNearestRoute_30804_30711_70","sql":"(INDEX getNearestRoute_30804_30711_70_index_rut_id (rut_id))\r\n\t\t\t\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id AS start, routeAlias.rut_to_city_id AS end,\r\n\t\t\t\t\t\t\t\trouteFrom.rut_name AS fromAlias, NULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance AS quotedDistance,\r\n\t\t\t\t\t\t\t\trouteAlias.rut_estm_distance AS rateDistance, \r\n\t\t\t\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance)\r\n\t\t\t\t\t\t\t\t\t - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance,\r\n\t\t\t\t\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance,\r\n\t\t\t\t\t\t\t\t0 AS rank, routeFrom.rut_estm_time AS startTime, 0 AS endTime, route.rut_estm_time, \r\n\t\t\t\t\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraTravelDistance\r\n\t\t\t\t\t\tFROM   route\r\n\t\t\t\t\t\tINNER JOIN route routeTo ON routeTo.rut_to_city_id=route.rut_from_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_from_city_id=30804 AND routeTo.rut_active=1\r\n\t\t\t\t\t\t\t\tAND routeTo.rut_estm_distance<70 AND route.rut_active=1\r\n\t\t\t\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_from_city_id=route.rut_to_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_active = 1\r\n\t\t\t\t\t\t\t\tAND routeFrom.rut_estm_distance<70 AND route.rut_active = 1\r\n\t\t\t\t\t\tINNER JOIN route routeAlias ON routeAlias.rut_to_city_id=routeFrom.rut_to_city_id\r\n\t\t\t\t\t\t\tAND routeAlias.rut_from_city_id=routeTo.rut_from_city_id AND routeAlias.rut_active = 1"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28577.867] [M: 28881.45] [ET: 2.932/28543.859] [MU: 2.41/28880.83] 
	SQL: SELECT *, (rte_vendor_amount + extradistance * 10.55 ) AS totalCost, 
						ABS(quotedDistance-rateDistance) AS extraChargeableDistance
					FROM getNearestRoute_30804_30711_70 a
					INNER JOIN rate ON a.rut_id=rate.rte_route_id AND rte_status=1 
						AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <> 0
					WHERE  1
					ORDER  BY rank DESC, extraStartDistance, extraChargeableDistance ASC, totalcost ASC
					LIMIT  0, 1 
	 [params: {"cabType":"96"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28581.697] [M: 28896.59] [ET: 0.69/28547.712] [MU: 3.46/28895.71] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"16","fromCity":"30804","toCity":"30711"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28583.345] [M: 28913.2] [ET: 0.486/28549.361] [MU: 3.78/28912.33] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30711"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28584.476] [M: 28924.3] [ET: 26.443/28550.499] [MU: 131.57/28924.15] 
	Quote::calculateOneWay  for CAB 96 Date: 2024-10-24 04:00:00
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28584.975] [M: 28927.8] [ET: 0.388/28550.973] [MU: 0.9/28927.55] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28586.513] [M: 28940.52] [ET: 0.743/28552.492] [MU: 3.34/28940.08] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28587.232] [M: 28969.69] [ET: 0.548/28553.246] [MU: 22.53/28968.94] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp528)) OR (apr_area_type = 5 AND apr_area_id IN (:gp526)) OR (apr_area_type = 2 AND apr_area_id IN (:gp529)) OR (apr_area_type = 4 AND apr_area_id IN (:gp530)) OR (apr_area_type = 1 AND apr_area_id IN (:gp527))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp526":"3699",":gp527":"31",":gp528":"30804",":gp529":"105",":gp530":"1","cab":"96"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28588.984] [M: 28956.7] [ET: 0.613/28554.985] [MU: 3.34/28956.27] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28592.786] [M: 28967.2] [ET: 3.628/28558.774] [MU: 3.48/28966.33] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp533)) OR (scr_area_type = 5 AND scr_area_id IN (:gp531)) OR (scr_area_type = 2 AND scr_area_id IN (:gp534)) OR (scr_area_type = 4 AND scr_area_id IN (:gp535)) OR (scr_area_type = 1 AND scr_area_id IN (:gp532)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp531":"3699",":gp532":"31",":gp533":"3699",":gp534":"105",":gp535":"1","scv_id":"96"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28593.641] [M: 28968.38] [ET: 0.433/28559.646] [MU: 2.98/28968.27] 
	BookingRoute::calculateDistance
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28596.614] [M: 28978.63] [ET: 0.993/28562.611] [MU: 2.83/28978] 
	SQL: SELECT 
						fc.cty_id as c2id, 
						fc.cty_name as c2name, 
						fc.cty_garage_address as c2address,
						tc.cty_id as c4id,
						tc.cty_name as c4name, tc.cty_garage_address as c4address,
						0 as totalExtraDistance FROM route
						INNER JOIN cities fc ON rut_from_city_id=fc.cty_id
						INNER JOIN cities tc ON rut_to_city_id=tc.cty_id
						INNER JOIN rate on  rate.rte_route_id=route.rut_id  AND rate.rte_vehicletype_id IN (3)
						WHERE route.rut_from_city_id=30804 AND route.rut_to_city_id=30711 AND route.rut_active=1 
	 [params: []]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28597.527] [M: 28992.51] [ET: 0.787/28563.537] [MU: 6.53/28990.51] 
	SQL: 
				SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address, tc.cty_id as c4id, 
				tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
					FROM
					 (
						(
							SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id,  
								r3.rut_to_city_id, route.rut_name , route.rut_id,
								(route.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, 
								r3.rut_estm_distance
							FROM route
							INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_from_city_id=30804  
									AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=route.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) 
									AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
						UNION
						(
							SELECT r3.rut_id, r3.rut_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,(route.rut_estm_distance + r1.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
							FROM route
							INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND  route.rut_to_city_id=30711 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND route.rut_to_city_id=r3.rut_to_city_id))	AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
                     ) a
					INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
					INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1 
	 [params: []]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28598.03] [M: 29003.02] [ET: 0.429/28564.047] [MU: 5.03/29001.52] 
	SQL: SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
                              tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
                        FROM (SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,
                                    (route.rut_estm_distance + r1.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
                                FROM route
								INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
								INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
								INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) AND r3.rut_active=1 
								INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3) LIMIT 1
							)a
                        INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
                        INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1
                         
	 [params: []]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28598.531] [M: 29009.39] [ET: 0.413/28564.53] [MU: 0.74/29008.52] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"GarageRoute_30804_30711","sql":" (INDEX GarageRoute_30804_30711_index_rut_id (rut_id), INDEX GarageRoute_30804_30711_index_rut_from_city_id (rut_from_city_id), INDEX GarageRoute_30804_30711_index_rut_to_city_id (rut_to_city_id))\r\n\t\t\t\t\t\t\tSELECT route.rut_id, route.rut_from_city_id, route.rut_to_city_id, route.rut_name, rut_estm_distance FROM route \r\n\t\t\t\t\t\t\tINNER JOIN cities_stats   ON cities_stats.cts_cty_id = route.rut_from_city_id\r\n\t\t\t\t\t\t\tAND rut_estm_distance < 300\r\n\t\t\t\t\t\t\tAND rut_active = 1\r\n\t\t\t\t\t\t\tAND route.rut_to_city_id=30804\r\n\t\t\t\t\t\t\tAND cities_stats.cts_vnd_cnt >= 3\r\n\t\t\t\t\t\t\tORDER BY rut_estm_distance LIMIT 10"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28599.396] [M: 29021.31] [ET: 0.747/28565.391] [MU: 6.69/29019.56] 
	SQL: SELECT a.*, fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
								tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address 
						FROM ((SELECT xyz.rut_from_city_id as startCity, r1.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r3.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_from_city_id
							INNER JOIN rate ON rate.rte_route_id=r1.rut_id  AND rate.rte_vehicletype_id IN (3)
							INNER JOIN route r2 ON r2.rut_to_city_id=r1.rut_to_city_id AND r2.rut_from_city_id=:dropCity AND r2.rut_active=1
							INNER JOIN route r3 ON r3.rut_from_city_id=xyz.rut_to_city_id AND r3.rut_to_city_id=r2.rut_from_city_id AND r3.rut_active=1
							ORDER BY ExtraDistance LIMIT 1
							)
							UNION
							(
							SELECT xyz.rut_from_city_id as startCity, r2.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r2.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_to_city_id AND r1.rut_to_city_id=:dropCity
							INNER JOIN route r2 ON r2.rut_to_city_id=xyz.rut_from_city_id AND r2.rut_from_city_id=r1.rut_to_city_id
							ORDER BY ExtraDistance ASC LIMIT 1
							)) a
						INNER JOIN cities fc ON startCity=fc.cty_id
						INNER JOIN cities tc ON endCity=tc.cty_id 
						ORDER BY ExtraDistance 
	 [params: {"pickupCity":"30804","dropCity":"30711"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28602.365] [M: 29032.66] [ET: 1.311/28568.362] [MU: 7.88/29032.55] 
	BookingRoute::calculateDistance
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28603.776] [M: 29038.23] [ET: 1.272/28569.776] [MU: 8.27/29038.12] 
	BookingRoute::calculateDistance
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28604.884] [M: 29045.85] [ET: 0.363/28570.901] [MU: 0.99/29045.48] 
	SQL: SELECT cts_airport_pickup_entry_fee
               FROM   cities
               INNER JOIN cities_stats
               ON cities.cty_id = cities_stats.cts_cty_id
               WHERE  cty_id = :cityId
               AND cty_is_airport = 1 AND cty_active = 1 
	 [params: {"cityId":"30804"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28606.588] [M: 29059.77] [ET: 1.052/28572.588] [MU: 8.13/29059.66] 
	BookingRoute::calculateDistance
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28608.013] [M: 29067.6] [ET: 1.265/28574.023] [MU: 8.07/29067.49] 
	BookingRoute::calculateDistance
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28609.073] [M: 29066.94] [ET: 0.902/28575.02] [MU: 0.9/29066.69] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28611.198] [M: 29079.65] [ET: 0.968/28577.181] [MU: 3.33/29079.21] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28611.994] [M: 29108.82] [ET: 0.656/28578.009] [MU: 22.53/29108.07] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp538)) OR (apr_area_type = 5 AND apr_area_id IN (:gp536)) OR (apr_area_type = 2 AND apr_area_id IN (:gp539)) OR (apr_area_type = 4 AND apr_area_id IN (:gp540)) OR (apr_area_type = 1 AND apr_area_id IN (:gp537))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp536":"3699",":gp537":"31",":gp538":"30804",":gp539":"105",":gp540":"1","cab":"96"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28613.687] [M: 29095.84] [ET: 0.71/28579.679] [MU: 3.33/29095.4] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28616.423] [M: 29106.34] [ET: 2.569/28582.431] [MU: 3.48/29105.46] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp543)) OR (scr_area_type = 5 AND scr_area_id IN (:gp541)) OR (scr_area_type = 2 AND scr_area_id IN (:gp544)) OR (scr_area_type = 4 AND scr_area_id IN (:gp545)) OR (scr_area_type = 1 AND scr_area_id IN (:gp542)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp541":"3699",":gp542":"31",":gp543":"3699",":gp544":"105",":gp545":"1","scv_id":"96"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28617.208] [M: 29109.55] [ET: 0.384/28583.214] [MU: 2.98/29109.44] 
	BookingRoute::calculateDistance
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28618.686] [M: 29122.66] [ET: 0.25/28584.705] [MU: 2.98/29122.55] 
	BookingRoute::calculateDistance
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28618.966] [M: 29126.73] [ET: 0.208/28584.99] [MU: 2.98/29126.63] 
	BookingRoute::calculateDistance
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28623.769] [M: 29160.74] [ET: 0.73/28589.779] [MU: 6.32/29158.74] 
	SQL: 
                SELECT cities.cty_id as c2id, cities.cty_name as c2name, cities.cty_garage_address as c2address,
                    cities.cty_id as c4id, cities.cty_name as c4name, cities.cty_garage_address as c4address,
                        (distance * 2) as totalExtraDistance
                 FROM (SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<40
                     INNER JOIN route r1 ON route.rut_to_city_id=r1.rut_from_city_id AND r1.rut_active=1
                     INNER JOIN rate ON r1.rut_id=rate.rte_route_id AND rate.rte_status=1  AND rate.rte_vehicletype_id IN (3) GROUP BY route.rut_id HAVING count(*) >30
                   UNION
                     SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<600
                     INNER JOIN cities tc ON tc.cty_id=route.rut_to_city_id AND tc.cty_service_active=1 AND CalcDistance(cities.cty_lat, cities.cty_long, tc.cty_lat, tc.cty_long)<=route.rut_estm_distance						 
                     INNER JOIN cities_stats ON cities_stats.cts_cty_id = route.rut_to_city_id AND cities_stats.cts_vnd_cnt >= 2
                   UNION
                    SELECT cts_cty_id AS city, 0 AS distance
					FROM cities_stats WHERE 1 AND cities_stats.cts_cty_id= 30817 and cities_stats.cts_vnd_cnt>1) a
                    INNER JOIN cities ON cities.cty_id=a.city
                    ORDER BY totalExtraDistance LIMIT 1 
	 [params: []]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28626.04] [M: 29175.55] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.255.12
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"3","tripDistance":"","tripDuration":"","multiCityData":"","bookingType":"1","pickupAddress":"","pickupDate":"24\/10\/2024","pickupTime":"04:00 AM","isGozonow":"0","minTripDistance":"0","sccId":"0","tripUser":"1","YII_CSRF_TOKEN":"N3VxRE1WeG9UeHk5UWFBUFpPT216eWVyY0xWTVpoTkcUoJ2aBoup1fU2M5E4ePVZVcUNlKiYZZysUqEklNiKWw==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=3&tripDistance=&tripDuration=&multiCityData=&bookingType=1&pickupAddress=&pickupDate=24%2F10%2F2024&pickupTime=04%3A00+AM&isGozonow=0&minTripDistance=0&sccId=0&tripUser=1&YII_CSRF_TOKEN=N3VxRE1WeG9UeHk5UWFBUFpPT216eWVyY0xWTVpoTkcUoJ2aBoup1fU2M5E4ePVZVcUNlKiYZZysUqEklNiKWw%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28626.54] [M: 29195.12] [ET: 0.99/28592.565] [MU: 20.77/29195.01] 
	models.RouteRates.calculateDriverAllowance
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28626.57] [M: 29196.8] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28627.606] [M: 29210.26] [ET: 0.909/28593.613] [MU: 2.99/29207.76] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+10013),(IF((cpm_value_type=2),(10013+(10013*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30937 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30937) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-24 04:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=96 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28629.07] [M: 29252.48] [ET: 3.576/28595.091] [MU: 78.59/29252.33] 
	RouteRates::calculate for CAB 96 2024-10-24 04:00:00 - Trip Type: 1 762312756
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28629.25] [M: 29230.17] [ET: 44.713/28595.274] [MU: 304.41/29230.02] 
	Quote::calculateRules for CAB 96, From City Id: 30804, To city Id: 30711
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28629.679] [M: 29201.9] [ET: 0.326/28595.697] [MU: 0.9/29201.65] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"96"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28629.758] [M: 29203.46] [ET: 76.813/28595.782] [MU: 458.1/29203.37] 
	Quote For CabType: 96
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28631.517] [M: 29213.8] [ET: 0.473/28597.534] [MU: 3.34/29213.37] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28631.967] [M: 29219.62] [ET: 0.377/28597.984] [MU: 3.33/29219.18] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30711"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28632.518] [M: 29222.55] [ET: 0.479/28598.536] [MU: 0.9/29222.3] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28633.061] [M: 29254.91] [ET: 0.436/28599.07] [MU: 24.22/29253.41] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (100) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30711) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp546)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp549,:gp550)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp547,:gp548)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp551,:gp552))
			OR (scr_area_type = 5 AND scr_area_id IN (3699))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (97)
		ORDER BY rank DESC
		 
	 [params: {":gp546":"31",":gp547":"30804",":gp548":"30711",":gp549":"105",":gp550":"100",":gp551":"1",":gp552":"1","tripType":"1"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28633.746] [M: 29235.09] [ET: 0.243/28599.767] [MU: 0.84/29234.91] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28634.084] [M: 29237.97] [ET: 0.265/28600.106] [MU: 0.96/29237.66] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"2"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28635.18] [M: 29250.72] [ET: 0.319/28601.201] [MU: 2.05/29250.22] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"97"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28638.6] [M: 29260.05] [ET: 3.219/28604.609] [MU: 3.48/29259.18] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"97","fromCity":"30804","toCity":"30711"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28640.009] [M: 29263.3] [ET: 0.642/28606.025] [MU: 0.87/29263.09] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":0}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28641.078] [M: 29270.63] [ET: 0.754/28607.095] [MU: 3.02/29270.2] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28641.856] [M: 29298.8] [ET: 0.653/28607.854] [MU: 22.04/29298.18] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp554)) OR (apr_area_type = 2 AND apr_area_id IN (:gp555)) OR (apr_area_type = 4 AND apr_area_id IN (:gp556)) OR (apr_area_type = 1 AND apr_area_id IN (:gp553))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp553":"31",":gp554":"30804",":gp555":"105",":gp556":"1","cab":"97"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28643.192] [M: 29285.52] [ET: 0.576/28609.195] [MU: 3.34/29285.09] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28645.985] [M: 29295.76] [ET: 2.626/28611.979] [MU: 3.36/29294.88] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp558)) OR (scr_area_type = 2 AND scr_area_id IN (:gp559)) OR (scr_area_type = 4 AND scr_area_id IN (:gp560)) OR (scr_area_type = 1 AND scr_area_id IN (:gp557)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp557":"31",":gp558":"30804",":gp559":"105",":gp560":"1","scv_id":"97"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28649.609] [M: 29323.54] [ET: 2.705/28615.583] [MU: 0.74/29315.54] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"nearest_route_30804_30711","sql":"(INDEX indx_nearest_rt_rutid (rut_id)) \r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, routeFrom.rut_name as fromAlias, \r\n\t\t\t\tNULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, \r\n\t\t\t\t0 as rank, routeFrom.rut_estm_time as startTime, 0 as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 \r\n\t\t\t\tAND routeFrom.rut_from_city_id<>routeFrom.rut_to_city_id AND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\t\tAND (routeAlias.rut_to_city_id=route.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, NULL, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) \r\n\t\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\t0 AS extraStartDistance, 0, 0 as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND route.rut_from_city_id = 30804 AND route.rut_to_city_id=30711 \r\n\t\t\t\tAND routeTo.rut_from_city_id=30711\r\n\t\t\t\tAND route.rut_active = 1 AND routeTo.rut_active = 1 AND routeTo.rut_estm_distance < 50 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = route.rut_from_city_id) \r\n\t\t\t   AND (routeAlias.rut_to_city_id = routeTo.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, \r\n\t\t\t\trouteFrom.rut_name, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t+ IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) \r\n\t\t\t\tAS extraDistance, IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, 0, \r\n\t\t\t\trouteFrom.rut_estm_time as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 AND routeFrom.rut_from_city_id <> routeFrom.rut_to_city_id\r\n\t\t\t\t\tAND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND routeTo.rut_estm_distance < 50 \r\n\t\t\t\t\tAND routeTo.rut_from_city_id=30711 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\tAND (routeAlias.rut_to_city_id=routeTo.rut_to_city_id) AND routeAlias.rut_active = 1 AND routeAlias.rut_from_city_id=30804  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28652.5] [M: 29327.57] [ET: 2.773/28618.512] [MU: 2.12/29327.13] 
	SQL: SELECT *, (rte_vendor_amount + extraDistance * 10.55) as totalCost FROM (SELECT * FROM nearest_route_30804_30711) a
					INNER JOIN rate ON a.rut_id = rate.rte_route_id AND rte_status=1 AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <>0
					WHERE 1 ORDER BY rank DESC, totalCost ASC LIMIT 0,1 
	 [params: {"cabType":"97"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28653.202] [M: 29335.59] [ET: 0.596/28619.209] [MU: 0.75/29333.59] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"getNearestRoute_30804_30711_70","sql":"(INDEX getNearestRoute_30804_30711_70_index_rut_id (rut_id))\r\n\t\t\t\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id AS start, routeAlias.rut_to_city_id AS end,\r\n\t\t\t\t\t\t\t\trouteFrom.rut_name AS fromAlias, NULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance AS quotedDistance,\r\n\t\t\t\t\t\t\t\trouteAlias.rut_estm_distance AS rateDistance, \r\n\t\t\t\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance)\r\n\t\t\t\t\t\t\t\t\t - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance,\r\n\t\t\t\t\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance,\r\n\t\t\t\t\t\t\t\t0 AS rank, routeFrom.rut_estm_time AS startTime, 0 AS endTime, route.rut_estm_time, \r\n\t\t\t\t\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraTravelDistance\r\n\t\t\t\t\t\tFROM   route\r\n\t\t\t\t\t\tINNER JOIN route routeTo ON routeTo.rut_to_city_id=route.rut_from_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_from_city_id=30804 AND routeTo.rut_active=1\r\n\t\t\t\t\t\t\t\tAND routeTo.rut_estm_distance<70 AND route.rut_active=1\r\n\t\t\t\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_from_city_id=route.rut_to_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_active = 1\r\n\t\t\t\t\t\t\t\tAND routeFrom.rut_estm_distance<70 AND route.rut_active = 1\r\n\t\t\t\t\t\tINNER JOIN route routeAlias ON routeAlias.rut_to_city_id=routeFrom.rut_to_city_id\r\n\t\t\t\t\t\t\tAND routeAlias.rut_from_city_id=routeTo.rut_from_city_id AND routeAlias.rut_active = 1"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28656.125] [M: 29340.86] [ET: 2.835/28622.135] [MU: 2.42/29340.23] 
	SQL: SELECT *, (rte_vendor_amount + extradistance * 10.55 ) AS totalCost, 
						ABS(quotedDistance-rateDistance) AS extraChargeableDistance
					FROM getNearestRoute_30804_30711_70 a
					INNER JOIN rate ON a.rut_id=rate.rte_route_id AND rte_status=1 
						AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <> 0
					WHERE  1
					ORDER  BY rank DESC, extraStartDistance, extraChargeableDistance ASC, totalcost ASC
					LIMIT  0, 1 
	 [params: {"cabType":"97"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28660.113] [M: 29355.99] [ET: 0.637/28626.062] [MU: 3.46/29355.12] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"16","fromCity":"30804","toCity":"30711"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28662.6] [M: 29372.61] [ET: 0.733/28628.6] [MU: 3.78/29371.73] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30711"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28664.369] [M: 29383.71] [ET: 29.112/28630.378] [MU: 131.57/29383.55] 
	Quote::calculateOneWay  for CAB 97 Date: 2024-10-24 04:00:00
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28664.995] [M: 29387.3] [ET: 0.496/28631.014] [MU: 0.9/29387.05] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28666.146] [M: 29400.02] [ET: 0.555/28632.165] [MU: 3.34/29399.58] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28666.796] [M: 29429.19] [ET: 0.549/28632.815] [MU: 22.53/29428.44] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp563)) OR (apr_area_type = 5 AND apr_area_id IN (:gp561)) OR (apr_area_type = 2 AND apr_area_id IN (:gp564)) OR (apr_area_type = 4 AND apr_area_id IN (:gp565)) OR (apr_area_type = 1 AND apr_area_id IN (:gp562))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp561":"3699",":gp562":"31",":gp563":"30804",":gp564":"105",":gp565":"1","cab":"97"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28668.297] [M: 29416.2] [ET: 0.489/28634.309] [MU: 3.34/29415.77] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28671.503] [M: 29426.7] [ET: 3.081/28637.495] [MU: 3.48/29425.83] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp568)) OR (scr_area_type = 5 AND scr_area_id IN (:gp566)) OR (scr_area_type = 2 AND scr_area_id IN (:gp569)) OR (scr_area_type = 4 AND scr_area_id IN (:gp570)) OR (scr_area_type = 1 AND scr_area_id IN (:gp567)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp566":"3699",":gp567":"31",":gp568":"3699",":gp569":"105",":gp570":"1","scv_id":"97"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28672.292] [M: 29427.88] [ET: 0.406/28638.298] [MU: 2.98/29427.77] 
	BookingRoute::calculateDistance
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28674.655] [M: 29438.13] [ET: 0.772/28640.655] [MU: 2.83/29437.5] 
	SQL: SELECT 
						fc.cty_id as c2id, 
						fc.cty_name as c2name, 
						fc.cty_garage_address as c2address,
						tc.cty_id as c4id,
						tc.cty_name as c4name, tc.cty_garage_address as c4address,
						0 as totalExtraDistance FROM route
						INNER JOIN cities fc ON rut_from_city_id=fc.cty_id
						INNER JOIN cities tc ON rut_to_city_id=tc.cty_id
						INNER JOIN rate on  rate.rte_route_id=route.rut_id  AND rate.rte_vehicletype_id IN (3)
						WHERE route.rut_from_city_id=30804 AND route.rut_to_city_id=30711 AND route.rut_active=1 
	 [params: []]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28675.267] [M: 29452.01] [ET: 0.505/28641.266] [MU: 6.53/29450.01] 
	SQL: 
				SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address, tc.cty_id as c4id, 
				tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
					FROM
					 (
						(
							SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id,  
								r3.rut_to_city_id, route.rut_name , route.rut_id,
								(route.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, 
								r3.rut_estm_distance
							FROM route
							INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_from_city_id=30804  
									AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=route.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) 
									AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
						UNION
						(
							SELECT r3.rut_id, r3.rut_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,(route.rut_estm_distance + r1.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
							FROM route
							INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND  route.rut_to_city_id=30711 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND route.rut_to_city_id=r3.rut_to_city_id))	AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
                     ) a
					INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
					INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1 
	 [params: []]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28675.854] [M: 29462.52] [ET: 0.488/28641.857] [MU: 5.03/29461.02] 
	SQL: SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
                              tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
                        FROM (SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,
                                    (route.rut_estm_distance + r1.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
                                FROM route
								INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
								INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
								INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) AND r3.rut_active=1 
								INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3) LIMIT 1
							)a
                        INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
                        INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1
                         
	 [params: []]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28676.386] [M: 29468.89] [ET: 0.429/28642.395] [MU: 0.74/29468.02] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"GarageRoute_30804_30711","sql":" (INDEX GarageRoute_30804_30711_index_rut_id (rut_id), INDEX GarageRoute_30804_30711_index_rut_from_city_id (rut_from_city_id), INDEX GarageRoute_30804_30711_index_rut_to_city_id (rut_to_city_id))\r\n\t\t\t\t\t\t\tSELECT route.rut_id, route.rut_from_city_id, route.rut_to_city_id, route.rut_name, rut_estm_distance FROM route \r\n\t\t\t\t\t\t\tINNER JOIN cities_stats   ON cities_stats.cts_cty_id = route.rut_from_city_id\r\n\t\t\t\t\t\t\tAND rut_estm_distance < 300\r\n\t\t\t\t\t\t\tAND rut_active = 1\r\n\t\t\t\t\t\t\tAND route.rut_to_city_id=30804\r\n\t\t\t\t\t\t\tAND cities_stats.cts_vnd_cnt >= 3\r\n\t\t\t\t\t\t\tORDER BY rut_estm_distance LIMIT 10"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28676.993] [M: 29480.81] [ET: 0.528/28643.008] [MU: 6.69/29479.06] 
	SQL: SELECT a.*, fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
								tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address 
						FROM ((SELECT xyz.rut_from_city_id as startCity, r1.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r3.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_from_city_id
							INNER JOIN rate ON rate.rte_route_id=r1.rut_id  AND rate.rte_vehicletype_id IN (3)
							INNER JOIN route r2 ON r2.rut_to_city_id=r1.rut_to_city_id AND r2.rut_from_city_id=:dropCity AND r2.rut_active=1
							INNER JOIN route r3 ON r3.rut_from_city_id=xyz.rut_to_city_id AND r3.rut_to_city_id=r2.rut_from_city_id AND r3.rut_active=1
							ORDER BY ExtraDistance LIMIT 1
							)
							UNION
							(
							SELECT xyz.rut_from_city_id as startCity, r2.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r2.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_to_city_id AND r1.rut_to_city_id=:dropCity
							INNER JOIN route r2 ON r2.rut_to_city_id=xyz.rut_from_city_id AND r2.rut_from_city_id=r1.rut_to_city_id
							ORDER BY ExtraDistance ASC LIMIT 1
							)) a
						INNER JOIN cities fc ON startCity=fc.cty_id
						INNER JOIN cities tc ON endCity=tc.cty_id 
						ORDER BY ExtraDistance 
	 [params: {"pickupCity":"30804","dropCity":"30711"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28679.816] [M: 29492.16] [ET: 1.436/28645.83] [MU: 7.88/29492.05] 
	BookingRoute::calculateDistance
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28681.263] [M: 29497.63] [ET: 1.333/28647.259] [MU: 8.27/29497.52] 
	BookingRoute::calculateDistance
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28682.459] [M: 29505.26] [ET: 0.402/28648.476] [MU: 1/29504.88] 
	SQL: SELECT cts_airport_pickup_entry_fee
               FROM   cities
               INNER JOIN cities_stats
               ON cities.cty_id = cities_stats.cts_cty_id
               WHERE  cty_id = :cityId
               AND cty_is_airport = 1 AND cty_active = 1 
	 [params: {"cityId":"30804"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28684.1] [M: 29519.17] [ET: 0.952/28650.103] [MU: 8.14/29519.06] 
	BookingRoute::calculateDistance
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28685.252] [M: 29526.91] [ET: 1.008/28651.273] [MU: 8.08/29526.8] 
	BookingRoute::calculateDistance
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28685.672] [M: 29526.22] [ET: 0.338/28651.692] [MU: 0.9/29526] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28686.959] [M: 29538.96] [ET: 0.715/28652.96] [MU: 3.34/29538.52] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28687.657] [M: 29568.13] [ET: 0.54/28653.674] [MU: 22.54/29567.38] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp573)) OR (apr_area_type = 5 AND apr_area_id IN (:gp571)) OR (apr_area_type = 2 AND apr_area_id IN (:gp574)) OR (apr_area_type = 4 AND apr_area_id IN (:gp575)) OR (apr_area_type = 1 AND apr_area_id IN (:gp572))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp571":"3699",":gp572":"31",":gp573":"30804",":gp574":"105",":gp575":"1","cab":"97"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28689.159] [M: 29555.15] [ET: 0.523/28655.16] [MU: 3.33/29554.71] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28692.322] [M: 29565.65] [ET: 2.996/28658.313] [MU: 3.49/29564.77] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp578)) OR (scr_area_type = 5 AND scr_area_id IN (:gp576)) OR (scr_area_type = 2 AND scr_area_id IN (:gp579)) OR (scr_area_type = 4 AND scr_area_id IN (:gp580)) OR (scr_area_type = 1 AND scr_area_id IN (:gp577)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp576":"3699",":gp577":"31",":gp578":"3699",":gp579":"105",":gp580":"1","scv_id":"97"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28693.174] [M: 29568.86] [ET: 0.351/28659.182] [MU: 2.97/29568.75] 
	BookingRoute::calculateDistance
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28694.663] [M: 29581.97] [ET: 0.249/28660.687] [MU: 2.97/29581.86] 
	BookingRoute::calculateDistance
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28694.934] [M: 29586.14] [ET: 0.204/28660.96] [MU: 2.97/29586.03] 
	BookingRoute::calculateDistance
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28698.918] [M: 29620.15] [ET: 0.703/28664.928] [MU: 6.33/29618.15] 
	SQL: 
                SELECT cities.cty_id as c2id, cities.cty_name as c2name, cities.cty_garage_address as c2address,
                    cities.cty_id as c4id, cities.cty_name as c4name, cities.cty_garage_address as c4address,
                        (distance * 2) as totalExtraDistance
                 FROM (SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<40
                     INNER JOIN route r1 ON route.rut_to_city_id=r1.rut_from_city_id AND r1.rut_active=1
                     INNER JOIN rate ON r1.rut_id=rate.rte_route_id AND rate.rte_status=1  AND rate.rte_vehicletype_id IN (3) GROUP BY route.rut_id HAVING count(*) >30
                   UNION
                     SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<600
                     INNER JOIN cities tc ON tc.cty_id=route.rut_to_city_id AND tc.cty_service_active=1 AND CalcDistance(cities.cty_lat, cities.cty_long, tc.cty_lat, tc.cty_long)<=route.rut_estm_distance						 
                     INNER JOIN cities_stats ON cities_stats.cts_cty_id = route.rut_to_city_id AND cities_stats.cts_vnd_cnt >= 2
                   UNION
                    SELECT cts_cty_id AS city, 0 AS distance
					FROM cities_stats WHERE 1 AND cities_stats.cts_cty_id= 30817 and cities_stats.cts_vnd_cnt>1) a
                    INNER JOIN cities ON cities.cty_id=a.city
                    ORDER BY totalExtraDistance LIMIT 1 
	 [params: []]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28701.945] [M: 29634.96] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.255.12
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"3","tripDistance":"","tripDuration":"","multiCityData":"","bookingType":"1","pickupAddress":"","pickupDate":"24\/10\/2024","pickupTime":"04:00 AM","isGozonow":"0","minTripDistance":"0","sccId":"0","tripUser":"1","YII_CSRF_TOKEN":"N3VxRE1WeG9UeHk5UWFBUFpPT216eWVyY0xWTVpoTkcUoJ2aBoup1fU2M5E4ePVZVcUNlKiYZZysUqEklNiKWw==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=3&tripDistance=&tripDuration=&multiCityData=&bookingType=1&pickupAddress=&pickupDate=24%2F10%2F2024&pickupTime=04%3A00+AM&isGozonow=0&minTripDistance=0&sccId=0&tripUser=1&YII_CSRF_TOKEN=N3VxRE1WeG9UeHk5UWFBUFpPT216eWVyY0xWTVpoTkcUoJ2aBoup1fU2M5E4ePVZVcUNlKiYZZysUqEklNiKWw%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28702.44] [M: 29654.52] [ET: 1.023/28668.463] [MU: 20.77/29654.41] 
	models.RouteRates.calculateDriverAllowance
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28702.471] [M: 29656.2] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28703.403] [M: 29669.66] [ET: 0.805/28669.409] [MU: 3/29667.16] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+10013),(IF((cpm_value_type=2),(10013+(10013*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30937 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30937) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-24 04:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=97 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28705.196] [M: 29711.89] [ET: 3.849/28671.2] [MU: 78.6/29711.73] 
	RouteRates::calculate for CAB 97 2024-10-24 04:00:00 - Trip Type: 1 848988462
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28705.411] [M: 29689.58] [ET: 40.951/28671.42] [MU: 304.31/29689.42] 
	Quote::calculateRules for CAB 97, From City Id: 30804, To city Id: 30711
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28705.769] [M: 29661.3] [ET: 0.243/28671.774] [MU: 0.9/29661.05] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"97"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28705.876] [M: 29663.49] [ET: 76.046/28671.886] [MU: 458.73/29663.4] 
	Quote For CabType: 97
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28707.364] [M: 29673.84] [ET: 0.507/28673.368] [MU: 3.33/29673.4] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28707.944] [M: 29679.65] [ET: 0.477/28673.95] [MU: 3.33/29679.21] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30711"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28708.67] [M: 29682.59] [ET: 0.63/28674.685] [MU: 0.9/29682.34] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28709.43] [M: 29714.95] [ET: 0.638/28675.44] [MU: 24.22/29713.45] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (100) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30711) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp581)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp584,:gp585)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp582,:gp583)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp586,:gp587))
			OR (scr_area_type = 5 AND scr_area_id IN (3699))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (98)
		ORDER BY rank DESC
		 
	 [params: {":gp581":"31",":gp582":"30804",":gp583":"30711",":gp584":"105",":gp585":"100",":gp586":"1",":gp587":"1","tripType":"1"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28710.33] [M: 29695.13] [ET: 0.293/28676.332] [MU: 0.84/29694.94] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28710.852] [M: 29698] [ET: 0.401/28676.853] [MU: 0.96/29697.69] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"2"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28712.255] [M: 29710.75] [ET: 0.394/28678.272] [MU: 2.04/29710.25] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"98"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28715.56] [M: 29720.09] [ET: 3.093/28681.553] [MU: 3.48/29719.21] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"98","fromCity":"30804","toCity":"30711"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28716.851] [M: 29723.34] [ET: 0.491/28682.844] [MU: 0.87/29723.12] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":0}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28717.873] [M: 29730.66] [ET: 0.78/28683.891] [MU: 3.02/29730.23] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28718.488] [M: 29758.84] [ET: 0.49/28684.482] [MU: 22.04/29758.21] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp589)) OR (apr_area_type = 2 AND apr_area_id IN (:gp590)) OR (apr_area_type = 4 AND apr_area_id IN (:gp591)) OR (apr_area_type = 1 AND apr_area_id IN (:gp588))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp588":"31",":gp589":"30804",":gp590":"105",":gp591":"1","cab":"98"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28719.75] [M: 29745.55] [ET: 0.554/28685.768] [MU: 3.34/29745.12] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28722.817] [M: 29755.79] [ET: 2.94/28688.809] [MU: 3.36/29754.91] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp593)) OR (scr_area_type = 2 AND scr_area_id IN (:gp594)) OR (scr_area_type = 4 AND scr_area_id IN (:gp595)) OR (scr_area_type = 1 AND scr_area_id IN (:gp592)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp592":"31",":gp593":"30804",":gp594":"105",":gp595":"1","scv_id":"98"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28726.067] [M: 29783.57] [ET: 2.444/28692.059] [MU: 0.74/29775.57] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"nearest_route_30804_30711","sql":"(INDEX indx_nearest_rt_rutid (rut_id)) \r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, routeFrom.rut_name as fromAlias, \r\n\t\t\t\tNULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, \r\n\t\t\t\t0 as rank, routeFrom.rut_estm_time as startTime, 0 as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 \r\n\t\t\t\tAND routeFrom.rut_from_city_id<>routeFrom.rut_to_city_id AND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\t\tAND (routeAlias.rut_to_city_id=route.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, NULL, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) \r\n\t\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\t0 AS extraStartDistance, 0, 0 as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND route.rut_from_city_id = 30804 AND route.rut_to_city_id=30711 \r\n\t\t\t\tAND routeTo.rut_from_city_id=30711\r\n\t\t\t\tAND route.rut_active = 1 AND routeTo.rut_active = 1 AND routeTo.rut_estm_distance < 50 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = route.rut_from_city_id) \r\n\t\t\t   AND (routeAlias.rut_to_city_id = routeTo.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, \r\n\t\t\t\trouteFrom.rut_name, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t+ IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) \r\n\t\t\t\tAS extraDistance, IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, 0, \r\n\t\t\t\trouteFrom.rut_estm_time as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 AND routeFrom.rut_from_city_id <> routeFrom.rut_to_city_id\r\n\t\t\t\t\tAND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND routeTo.rut_estm_distance < 50 \r\n\t\t\t\t\tAND routeTo.rut_from_city_id=30711 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\tAND (routeAlias.rut_to_city_id=routeTo.rut_to_city_id) AND routeAlias.rut_active = 1 AND routeAlias.rut_from_city_id=30804  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28729.077] [M: 29787.6] [ET: 2.897/28695.069] [MU: 2.12/29787.16] 
	SQL: SELECT *, (rte_vendor_amount + extraDistance * 10.55) as totalCost FROM (SELECT * FROM nearest_route_30804_30711) a
					INNER JOIN rate ON a.rut_id = rate.rte_route_id AND rte_status=1 AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <>0
					WHERE 1 ORDER BY rank DESC, totalCost ASC LIMIT 0,1 
	 [params: {"cabType":"98"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28729.907] [M: 29795.63] [ET: 0.697/28695.91] [MU: 0.74/29793.63] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"getNearestRoute_30804_30711_70","sql":"(INDEX getNearestRoute_30804_30711_70_index_rut_id (rut_id))\r\n\t\t\t\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id AS start, routeAlias.rut_to_city_id AS end,\r\n\t\t\t\t\t\t\t\trouteFrom.rut_name AS fromAlias, NULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance AS quotedDistance,\r\n\t\t\t\t\t\t\t\trouteAlias.rut_estm_distance AS rateDistance, \r\n\t\t\t\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance)\r\n\t\t\t\t\t\t\t\t\t - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance,\r\n\t\t\t\t\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance,\r\n\t\t\t\t\t\t\t\t0 AS rank, routeFrom.rut_estm_time AS startTime, 0 AS endTime, route.rut_estm_time, \r\n\t\t\t\t\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraTravelDistance\r\n\t\t\t\t\t\tFROM   route\r\n\t\t\t\t\t\tINNER JOIN route routeTo ON routeTo.rut_to_city_id=route.rut_from_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_from_city_id=30804 AND routeTo.rut_active=1\r\n\t\t\t\t\t\t\t\tAND routeTo.rut_estm_distance<70 AND route.rut_active=1\r\n\t\t\t\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_from_city_id=route.rut_to_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_active = 1\r\n\t\t\t\t\t\t\t\tAND routeFrom.rut_estm_distance<70 AND route.rut_active = 1\r\n\t\t\t\t\t\tINNER JOIN route routeAlias ON routeAlias.rut_to_city_id=routeFrom.rut_to_city_id\r\n\t\t\t\t\t\t\tAND routeAlias.rut_from_city_id=routeTo.rut_from_city_id AND routeAlias.rut_active = 1"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28735.313] [M: 29800.89] [ET: 5.17/28701.304] [MU: 2.42/29800.27] 
	SQL: SELECT *, (rte_vendor_amount + extradistance * 10.55 ) AS totalCost, 
						ABS(quotedDistance-rateDistance) AS extraChargeableDistance
					FROM getNearestRoute_30804_30711_70 a
					INNER JOIN rate ON a.rut_id=rate.rte_route_id AND rte_status=1 
						AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <> 0
					WHERE  1
					ORDER  BY rank DESC, extraStartDistance, extraChargeableDistance ASC, totalcost ASC
					LIMIT  0, 1 
	 [params: {"cabType":"98"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28738.259] [M: 29816.02] [ET: 0.554/28704.275] [MU: 3.46/29815.15] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"16","fromCity":"30804","toCity":"30711"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28740.266] [M: 29832.64] [ET: 0.679/28706.264] [MU: 3.78/29831.77] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30711"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28741.644] [M: 29843.74] [ET: 29.323/28707.667] [MU: 131.57/29843.59] 
	Quote::calculateOneWay  for CAB 98 Date: 2024-10-24 04:00:00
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28742.134] [M: 29847.34] [ET: 0.393/28708.153] [MU: 0.9/29847.09] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28743.295] [M: 29860.05] [ET: 0.568/28709.313] [MU: 3.33/29859.61] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28743.918] [M: 29889.22] [ET: 0.518/28709.936] [MU: 22.53/29888.47] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp598)) OR (apr_area_type = 5 AND apr_area_id IN (:gp596)) OR (apr_area_type = 2 AND apr_area_id IN (:gp599)) OR (apr_area_type = 4 AND apr_area_id IN (:gp600)) OR (apr_area_type = 1 AND apr_area_id IN (:gp597))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp596":"3699",":gp597":"31",":gp598":"30804",":gp599":"105",":gp600":"1","cab":"98"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28745.288] [M: 29876.23] [ET: 0.451/28711.308] [MU: 3.34/29875.8] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28747.877] [M: 29886.73] [ET: 2.482/28713.88] [MU: 3.48/29885.86] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp603)) OR (scr_area_type = 5 AND scr_area_id IN (:gp601)) OR (scr_area_type = 2 AND scr_area_id IN (:gp604)) OR (scr_area_type = 4 AND scr_area_id IN (:gp605)) OR (scr_area_type = 1 AND scr_area_id IN (:gp602)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp601":"3699",":gp602":"31",":gp603":"3699",":gp604":"105",":gp605":"1","scv_id":"98"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28748.485] [M: 29887.91] [ET: 0.32/28714.488] [MU: 2.98/29887.8] 
	BookingRoute::calculateDistance
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28750.934] [M: 29898.06] [ET: 0.856/28716.93] [MU: 2.84/29897.44] 
	SQL: SELECT 
						fc.cty_id as c2id, 
						fc.cty_name as c2name, 
						fc.cty_garage_address as c2address,
						tc.cty_id as c4id,
						tc.cty_name as c4name, tc.cty_garage_address as c4address,
						0 as totalExtraDistance FROM route
						INNER JOIN cities fc ON rut_from_city_id=fc.cty_id
						INNER JOIN cities tc ON rut_to_city_id=tc.cty_id
						INNER JOIN rate on  rate.rte_route_id=route.rut_id  AND rate.rte_vehicletype_id IN (3)
						WHERE route.rut_from_city_id=30804 AND route.rut_to_city_id=30711 AND route.rut_active=1 
	 [params: []]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28751.565] [M: 29911.95] [ET: 0.528/28717.579] [MU: 6.53/29909.95] 
	SQL: 
				SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address, tc.cty_id as c4id, 
				tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
					FROM
					 (
						(
							SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id,  
								r3.rut_to_city_id, route.rut_name , route.rut_id,
								(route.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, 
								r3.rut_estm_distance
							FROM route
							INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_from_city_id=30804  
									AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=route.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) 
									AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
						UNION
						(
							SELECT r3.rut_id, r3.rut_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,(route.rut_estm_distance + r1.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
							FROM route
							INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND  route.rut_to_city_id=30711 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND route.rut_to_city_id=r3.rut_to_city_id))	AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
                     ) a
					INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
					INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1 
	 [params: []]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28752.032] [M: 29922.45] [ET: 0.394/28718.051] [MU: 5.04/29920.95] 
	SQL: SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
                              tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
                        FROM (SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,
                                    (route.rut_estm_distance + r1.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
                                FROM route
								INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
								INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
								INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) AND r3.rut_active=1 
								INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3) LIMIT 1
							)a
                        INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
                        INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1
                         
	 [params: []]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28752.576] [M: 29928.83] [ET: 0.471/28718.594] [MU: 0.75/29927.95] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"GarageRoute_30804_30711","sql":" (INDEX GarageRoute_30804_30711_index_rut_id (rut_id), INDEX GarageRoute_30804_30711_index_rut_from_city_id (rut_from_city_id), INDEX GarageRoute_30804_30711_index_rut_to_city_id (rut_to_city_id))\r\n\t\t\t\t\t\t\tSELECT route.rut_id, route.rut_from_city_id, route.rut_to_city_id, route.rut_name, rut_estm_distance FROM route \r\n\t\t\t\t\t\t\tINNER JOIN cities_stats   ON cities_stats.cts_cty_id = route.rut_from_city_id\r\n\t\t\t\t\t\t\tAND rut_estm_distance < 300\r\n\t\t\t\t\t\t\tAND rut_active = 1\r\n\t\t\t\t\t\t\tAND route.rut_to_city_id=30804\r\n\t\t\t\t\t\t\tAND cities_stats.cts_vnd_cnt >= 3\r\n\t\t\t\t\t\t\tORDER BY rut_estm_distance LIMIT 10"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28753.128] [M: 29940.75] [ET: 0.477/28719.144] [MU: 6.68/29939] 
	SQL: SELECT a.*, fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
								tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address 
						FROM ((SELECT xyz.rut_from_city_id as startCity, r1.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r3.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_from_city_id
							INNER JOIN rate ON rate.rte_route_id=r1.rut_id  AND rate.rte_vehicletype_id IN (3)
							INNER JOIN route r2 ON r2.rut_to_city_id=r1.rut_to_city_id AND r2.rut_from_city_id=:dropCity AND r2.rut_active=1
							INNER JOIN route r3 ON r3.rut_from_city_id=xyz.rut_to_city_id AND r3.rut_to_city_id=r2.rut_from_city_id AND r3.rut_active=1
							ORDER BY ExtraDistance LIMIT 1
							)
							UNION
							(
							SELECT xyz.rut_from_city_id as startCity, r2.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r2.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_to_city_id AND r1.rut_to_city_id=:dropCity
							INNER JOIN route r2 ON r2.rut_to_city_id=xyz.rut_from_city_id AND r2.rut_from_city_id=r1.rut_to_city_id
							ORDER BY ExtraDistance ASC LIMIT 1
							)) a
						INNER JOIN cities fc ON startCity=fc.cty_id
						INNER JOIN cities tc ON endCity=tc.cty_id 
						ORDER BY ExtraDistance 
	 [params: {"pickupCity":"30804","dropCity":"30711"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28755.395] [M: 29952.09] [ET: 1.044/28721.412] [MU: 7.89/29951.98] 
	BookingRoute::calculateDistance
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28756.404] [M: 29957.66] [ET: 0.913/28722.426] [MU: 8.27/29957.55] 
	BookingRoute::calculateDistance
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28757.159] [M: 29965.29] [ET: 0.287/28723.181] [MU: 1/29964.91] 
	SQL: SELECT cts_airport_pickup_entry_fee
               FROM   cities
               INNER JOIN cities_stats
               ON cities.cty_id = cities_stats.cts_cty_id
               WHERE  cty_id = :cityId
               AND cty_is_airport = 1 AND cty_active = 1 
	 [params: {"cityId":"30804"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28758.758] [M: 29979.2] [ET: 0.959/28724.761] [MU: 8.14/29979.09] 
	BookingRoute::calculateDistance
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28759.984] [M: 29986.95] [ET: 1.088/28726.005] [MU: 8.08/29986.84] 
	BookingRoute::calculateDistance
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28760.642] [M: 29986.38] [ET: 0.55/28726.644] [MU: 0.9/29986.13] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28762.099] [M: 29999.09] [ET: 0.604/28728.119] [MU: 3.33/29998.65] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28762.796] [M: 30028.26] [ET: 0.586/28728.814] [MU: 22.53/30027.51] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp608)) OR (apr_area_type = 5 AND apr_area_id IN (:gp606)) OR (apr_area_type = 2 AND apr_area_id IN (:gp609)) OR (apr_area_type = 4 AND apr_area_id IN (:gp610)) OR (apr_area_type = 1 AND apr_area_id IN (:gp607))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp606":"3699",":gp607":"31",":gp608":"30804",":gp609":"105",":gp610":"1","cab":"98"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28764.343] [M: 30015.27] [ET: 0.506/28730.349] [MU: 3.34/30014.84] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28767.964] [M: 30025.77] [ET: 3.485/28733.955] [MU: 3.48/30024.9] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp613)) OR (scr_area_type = 5 AND scr_area_id IN (:gp611)) OR (scr_area_type = 2 AND scr_area_id IN (:gp614)) OR (scr_area_type = 4 AND scr_area_id IN (:gp615)) OR (scr_area_type = 1 AND scr_area_id IN (:gp612)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp611":"3699",":gp612":"31",":gp613":"3699",":gp614":"105",":gp615":"1","scv_id":"98"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28768.758] [M: 30028.98] [ET: 0.316/28734.782] [MU: 2.98/30028.88] 
	BookingRoute::calculateDistance
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28770.413] [M: 30042.09] [ET: 0.327/28736.425] [MU: 2.98/30041.98] 
	BookingRoute::calculateDistance
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28770.714] [M: 30046.27] [ET: 0.209/28736.733] [MU: 2.98/30046.16] 
	BookingRoute::calculateDistance
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28775.014] [M: 30080.37] [ET: 0.662/28741.024] [MU: 6.33/30078.37] 
	SQL: 
                SELECT cities.cty_id as c2id, cities.cty_name as c2name, cities.cty_garage_address as c2address,
                    cities.cty_id as c4id, cities.cty_name as c4name, cities.cty_garage_address as c4address,
                        (distance * 2) as totalExtraDistance
                 FROM (SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<40
                     INNER JOIN route r1 ON route.rut_to_city_id=r1.rut_from_city_id AND r1.rut_active=1
                     INNER JOIN rate ON r1.rut_id=rate.rte_route_id AND rate.rte_status=1  AND rate.rte_vehicletype_id IN (3) GROUP BY route.rut_id HAVING count(*) >30
                   UNION
                     SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<600
                     INNER JOIN cities tc ON tc.cty_id=route.rut_to_city_id AND tc.cty_service_active=1 AND CalcDistance(cities.cty_lat, cities.cty_long, tc.cty_lat, tc.cty_long)<=route.rut_estm_distance						 
                     INNER JOIN cities_stats ON cities_stats.cts_cty_id = route.rut_to_city_id AND cities_stats.cts_vnd_cnt >= 2
                   UNION
                    SELECT cts_cty_id AS city, 0 AS distance
					FROM cities_stats WHERE 1 AND cities_stats.cts_cty_id= 30817 and cities_stats.cts_vnd_cnt>1) a
                    INNER JOIN cities ON cities.cty_id=a.city
                    ORDER BY totalExtraDistance LIMIT 1 
	 [params: []]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28777.776] [M: 30095.18] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.255.12
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"3","tripDistance":"","tripDuration":"","multiCityData":"","bookingType":"1","pickupAddress":"","pickupDate":"24\/10\/2024","pickupTime":"04:00 AM","isGozonow":"0","minTripDistance":"0","sccId":"0","tripUser":"1","YII_CSRF_TOKEN":"N3VxRE1WeG9UeHk5UWFBUFpPT216eWVyY0xWTVpoTkcUoJ2aBoup1fU2M5E4ePVZVcUNlKiYZZysUqEklNiKWw==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=3&tripDistance=&tripDuration=&multiCityData=&bookingType=1&pickupAddress=&pickupDate=24%2F10%2F2024&pickupTime=04%3A00+AM&isGozonow=0&minTripDistance=0&sccId=0&tripUser=1&YII_CSRF_TOKEN=N3VxRE1WeG9UeHk5UWFBUFpPT216eWVyY0xWTVpoTkcUoJ2aBoup1fU2M5E4ePVZVcUNlKiYZZysUqEklNiKWw%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28778.529] [M: 30114.74] [ET: 1.32/28744.537] [MU: 20.77/30114.63] 
	models.RouteRates.calculateDriverAllowance
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28778.58] [M: 30116.42] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28779.806] [M: 30129.88] [ET: 1.051/28745.807] [MU: 3/30127.38] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+10013),(IF((cpm_value_type=2),(10013+(10013*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30937 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30937) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-24 04:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=98 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28781.881] [M: 30172.11] [ET: 4.748/28747.881] [MU: 78.6/30171.95] 
	RouteRates::calculate for CAB 98 2024-10-24 04:00:00 - Trip Type: 1 400603290
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28782.112] [M: 30149.8] [ET: 40.394/28748.119] [MU: 304.5/30149.64] 
	Quote::calculateRules for CAB 98, From City Id: 30804, To city Id: 30711
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28782.467] [M: 30121.52] [ET: 0.238/28748.472] [MU: 0.9/30121.27] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"98"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28782.579] [M: 30123.71] [ET: 76.625/28748.587] [MU: 458.91/30123.62] 
	Quote For CabType: 98
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28784.075] [M: 30134.05] [ET: 0.525/28750.077] [MU: 3.34/30133.62] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28784.665] [M: 30139.87] [ET: 0.49/28750.671] [MU: 3.33/30139.43] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30711"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28785.224] [M: 30142.8] [ET: 0.457/28751.229] [MU: 0.9/30142.55] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28785.839] [M: 30175.16] [ET: 0.457/28751.834] [MU: 24.22/30173.66] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (100) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30711) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp616)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp619,:gp620)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp617,:gp618)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp621,:gp622))
			OR (scr_area_type = 5 AND scr_area_id IN (3699))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (99)
		ORDER BY rank DESC
		 
	 [params: {":gp616":"31",":gp617":"30804",":gp618":"30711",":gp619":"105",":gp620":"100",":gp621":"1",":gp622":"1","tripType":"1"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28786.558] [M: 30155.34] [ET: 0.186/28752.574] [MU: 0.84/30155.16] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28787.051] [M: 30158.22] [ET: 0.378/28753.068] [MU: 0.96/30157.91] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"2"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28788.305] [M: 30170.97] [ET: 0.394/28754.321] [MU: 2.05/30170.47] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"99"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28791.847] [M: 30180.3] [ET: 3.318/28757.84] [MU: 3.48/30179.43] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"99","fromCity":"30804","toCity":"30711"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28793.162] [M: 30183.55] [ET: 0.486/28759.177] [MU: 0.87/30183.34] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":0}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28793.942] [M: 30190.88] [ET: 0.615/28759.961] [MU: 3.02/30190.45] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28794.528] [M: 30219.05] [ET: 0.467/28760.527] [MU: 22.04/30218.43] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp624)) OR (apr_area_type = 2 AND apr_area_id IN (:gp625)) OR (apr_area_type = 4 AND apr_area_id IN (:gp626)) OR (apr_area_type = 1 AND apr_area_id IN (:gp623))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp623":"31",":gp624":"30804",":gp625":"105",":gp626":"1","cab":"99"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28795.72] [M: 30461.77] [ET: 0.456/28761.74] [MU: 3.34/30461.34] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28798.641] [M: 30472.01] [ET: 2.785/28764.625] [MU: 3.36/30471.13] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp628)) OR (scr_area_type = 2 AND scr_area_id IN (:gp629)) OR (scr_area_type = 4 AND scr_area_id IN (:gp630)) OR (scr_area_type = 1 AND scr_area_id IN (:gp627)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp627":"31",":gp628":"30804",":gp629":"105",":gp630":"1","scv_id":"99"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28801.717] [M: 30499.79] [ET: 2.13/28767.71] [MU: 0.74/30491.79] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"nearest_route_30804_30711","sql":"(INDEX indx_nearest_rt_rutid (rut_id)) \r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, routeFrom.rut_name as fromAlias, \r\n\t\t\t\tNULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, \r\n\t\t\t\t0 as rank, routeFrom.rut_estm_time as startTime, 0 as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 \r\n\t\t\t\tAND routeFrom.rut_from_city_id<>routeFrom.rut_to_city_id AND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\t\tAND (routeAlias.rut_to_city_id=route.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, NULL, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) \r\n\t\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\t0 AS extraStartDistance, 0, 0 as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND route.rut_from_city_id = 30804 AND route.rut_to_city_id=30711 \r\n\t\t\t\tAND routeTo.rut_from_city_id=30711\r\n\t\t\t\tAND route.rut_active = 1 AND routeTo.rut_active = 1 AND routeTo.rut_estm_distance < 50 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = route.rut_from_city_id) \r\n\t\t\t   AND (routeAlias.rut_to_city_id = routeTo.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, \r\n\t\t\t\trouteFrom.rut_name, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t+ IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) \r\n\t\t\t\tAS extraDistance, IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, 0, \r\n\t\t\t\trouteFrom.rut_estm_time as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 AND routeFrom.rut_from_city_id <> routeFrom.rut_to_city_id\r\n\t\t\t\t\tAND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND routeTo.rut_estm_distance < 50 \r\n\t\t\t\t\tAND routeTo.rut_from_city_id=30711 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\tAND (routeAlias.rut_to_city_id=routeTo.rut_to_city_id) AND routeAlias.rut_active = 1 AND routeAlias.rut_from_city_id=30804  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28806.581] [M: 30503.82] [ET: 4.766/28772.591] [MU: 2.12/30503.38] 
	SQL: SELECT *, (rte_vendor_amount + extraDistance * 10.55) as totalCost FROM (SELECT * FROM nearest_route_30804_30711) a
					INNER JOIN rate ON a.rut_id = rate.rte_route_id AND rte_status=1 AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <>0
					WHERE 1 ORDER BY rank DESC, totalCost ASC LIMIT 0,1 
	 [params: {"cabType":"99"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28807.414] [M: 30511.84] [ET: 0.707/28773.404] [MU: 0.75/30509.84] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"getNearestRoute_30804_30711_70","sql":"(INDEX getNearestRoute_30804_30711_70_index_rut_id (rut_id))\r\n\t\t\t\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id AS start, routeAlias.rut_to_city_id AS end,\r\n\t\t\t\t\t\t\t\trouteFrom.rut_name AS fromAlias, NULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance AS quotedDistance,\r\n\t\t\t\t\t\t\t\trouteAlias.rut_estm_distance AS rateDistance, \r\n\t\t\t\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance)\r\n\t\t\t\t\t\t\t\t\t - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance,\r\n\t\t\t\t\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance,\r\n\t\t\t\t\t\t\t\t0 AS rank, routeFrom.rut_estm_time AS startTime, 0 AS endTime, route.rut_estm_time, \r\n\t\t\t\t\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraTravelDistance\r\n\t\t\t\t\t\tFROM   route\r\n\t\t\t\t\t\tINNER JOIN route routeTo ON routeTo.rut_to_city_id=route.rut_from_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_from_city_id=30804 AND routeTo.rut_active=1\r\n\t\t\t\t\t\t\t\tAND routeTo.rut_estm_distance<70 AND route.rut_active=1\r\n\t\t\t\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_from_city_id=route.rut_to_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_active = 1\r\n\t\t\t\t\t\t\t\tAND routeFrom.rut_estm_distance<70 AND route.rut_active = 1\r\n\t\t\t\t\t\tINNER JOIN route routeAlias ON routeAlias.rut_to_city_id=routeFrom.rut_to_city_id\r\n\t\t\t\t\t\t\tAND routeAlias.rut_from_city_id=routeTo.rut_from_city_id AND routeAlias.rut_active = 1"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28810.337] [M: 30517.11] [ET: 2.794/28776.33] [MU: 2.42/30516.48] 
	SQL: SELECT *, (rte_vendor_amount + extradistance * 10.55 ) AS totalCost, 
						ABS(quotedDistance-rateDistance) AS extraChargeableDistance
					FROM getNearestRoute_30804_30711_70 a
					INNER JOIN rate ON a.rut_id=rate.rte_route_id AND rte_status=1 
						AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <> 0
					WHERE  1
					ORDER  BY rank DESC, extraStartDistance, extraChargeableDistance ASC, totalcost ASC
					LIMIT  0, 1 
	 [params: {"cabType":"99"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28813.734] [M: 30532.24] [ET: 0.646/28779.748] [MU: 3.46/30531.37] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"16","fromCity":"30804","toCity":"30711"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28815.547] [M: 30548.86] [ET: 0.534/28781.563] [MU: 3.78/30547.98] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30711"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28816.691] [M: 30559.96] [ET: 28.318/28782.716] [MU: 387.57/30559.8] 
	Quote::calculateOneWay  for CAB 99 Date: 2024-10-24 04:00:00
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28817.178] [M: 30563.46] [ET: 0.394/28783.197] [MU: 0.89/30563.21] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28818.336] [M: 30576.17] [ET: 0.586/28784.355] [MU: 3.34/30575.73] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28818.941] [M: 30605.34] [ET: 0.494/28784.959] [MU: 22.53/30604.59] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp633)) OR (apr_area_type = 5 AND apr_area_id IN (:gp631)) OR (apr_area_type = 2 AND apr_area_id IN (:gp634)) OR (apr_area_type = 4 AND apr_area_id IN (:gp635)) OR (apr_area_type = 1 AND apr_area_id IN (:gp632))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp631":"3699",":gp632":"31",":gp633":"30804",":gp634":"105",":gp635":"1","cab":"99"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28820.509] [M: 30592.36] [ET: 0.565/28786.526] [MU: 3.33/30591.92] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28823.125] [M: 30602.86] [ET: 2.499/28789.135] [MU: 3.49/30601.98] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp638)) OR (scr_area_type = 5 AND scr_area_id IN (:gp636)) OR (scr_area_type = 2 AND scr_area_id IN (:gp639)) OR (scr_area_type = 4 AND scr_area_id IN (:gp640)) OR (scr_area_type = 1 AND scr_area_id IN (:gp637)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp636":"3699",":gp637":"31",":gp638":"3699",":gp639":"105",":gp640":"1","scv_id":"99"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28823.792] [M: 30604.03] [ET: 0.365/28789.798] [MU: 2.97/30603.92] 
	BookingRoute::calculateDistance
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28825.707] [M: 30614.28] [ET: 0.648/28791.725] [MU: 2.84/30613.66] 
	SQL: SELECT 
						fc.cty_id as c2id, 
						fc.cty_name as c2name, 
						fc.cty_garage_address as c2address,
						tc.cty_id as c4id,
						tc.cty_name as c4name, tc.cty_garage_address as c4address,
						0 as totalExtraDistance FROM route
						INNER JOIN cities fc ON rut_from_city_id=fc.cty_id
						INNER JOIN cities tc ON rut_to_city_id=tc.cty_id
						INNER JOIN rate on  rate.rte_route_id=route.rut_id  AND rate.rte_vehicletype_id IN (3)
						WHERE route.rut_from_city_id=30804 AND route.rut_to_city_id=30711 AND route.rut_active=1 
	 [params: []]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28826.204] [M: 30628.16] [ET: 0.422/28792.219] [MU: 6.53/30626.16] 
	SQL: 
				SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address, tc.cty_id as c4id, 
				tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
					FROM
					 (
						(
							SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id,  
								r3.rut_to_city_id, route.rut_name , route.rut_id,
								(route.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, 
								r3.rut_estm_distance
							FROM route
							INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_from_city_id=30804  
									AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=route.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) 
									AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
						UNION
						(
							SELECT r3.rut_id, r3.rut_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,(route.rut_estm_distance + r1.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
							FROM route
							INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND  route.rut_to_city_id=30711 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND route.rut_to_city_id=r3.rut_to_city_id))	AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
                     ) a
					INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
					INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1 
	 [params: []]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28826.664] [M: 30638.67] [ET: 0.386/28792.682] [MU: 5.03/30637.17] 
	SQL: SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
                              tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
                        FROM (SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,
                                    (route.rut_estm_distance + r1.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
                                FROM route
								INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
								INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
								INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) AND r3.rut_active=1 
								INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3) LIMIT 1
							)a
                        INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
                        INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1
                         
	 [params: []]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28827.185] [M: 30645.05] [ET: 0.45/28793.203] [MU: 0.74/30644.17] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"GarageRoute_30804_30711","sql":" (INDEX GarageRoute_30804_30711_index_rut_id (rut_id), INDEX GarageRoute_30804_30711_index_rut_from_city_id (rut_from_city_id), INDEX GarageRoute_30804_30711_index_rut_to_city_id (rut_to_city_id))\r\n\t\t\t\t\t\t\tSELECT route.rut_id, route.rut_from_city_id, route.rut_to_city_id, route.rut_name, rut_estm_distance FROM route \r\n\t\t\t\t\t\t\tINNER JOIN cities_stats   ON cities_stats.cts_cty_id = route.rut_from_city_id\r\n\t\t\t\t\t\t\tAND rut_estm_distance < 300\r\n\t\t\t\t\t\t\tAND rut_active = 1\r\n\t\t\t\t\t\t\tAND route.rut_to_city_id=30804\r\n\t\t\t\t\t\t\tAND cities_stats.cts_vnd_cnt >= 3\r\n\t\t\t\t\t\t\tORDER BY rut_estm_distance LIMIT 10"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28827.748] [M: 30656.97] [ET: 0.488/28793.764] [MU: 6.69/30655.22] 
	SQL: SELECT a.*, fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
								tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address 
						FROM ((SELECT xyz.rut_from_city_id as startCity, r1.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r3.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_from_city_id
							INNER JOIN rate ON rate.rte_route_id=r1.rut_id  AND rate.rte_vehicletype_id IN (3)
							INNER JOIN route r2 ON r2.rut_to_city_id=r1.rut_to_city_id AND r2.rut_from_city_id=:dropCity AND r2.rut_active=1
							INNER JOIN route r3 ON r3.rut_from_city_id=xyz.rut_to_city_id AND r3.rut_to_city_id=r2.rut_from_city_id AND r3.rut_active=1
							ORDER BY ExtraDistance LIMIT 1
							)
							UNION
							(
							SELECT xyz.rut_from_city_id as startCity, r2.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r2.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_to_city_id AND r1.rut_to_city_id=:dropCity
							INNER JOIN route r2 ON r2.rut_to_city_id=xyz.rut_from_city_id AND r2.rut_from_city_id=r1.rut_to_city_id
							ORDER BY ExtraDistance ASC LIMIT 1
							)) a
						INNER JOIN cities fc ON startCity=fc.cty_id
						INNER JOIN cities tc ON endCity=tc.cty_id 
						ORDER BY ExtraDistance 
	 [params: {"pickupCity":"30804","dropCity":"30711"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28830.904] [M: 30668.31] [ET: 1.475/28796.904] [MU: 7.89/30668.2] 
	BookingRoute::calculateDistance
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28832.125] [M: 30673.79] [ET: 1.085/28798.13] [MU: 8.26/30673.68] 
	BookingRoute::calculateDistance
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28833.176] [M: 30681.32] [ET: 0.326/28799.195] [MU: 0.99/30680.95] 
	SQL: SELECT cts_airport_pickup_entry_fee
               FROM   cities
               INNER JOIN cities_stats
               ON cities.cty_id = cities_stats.cts_cty_id
               WHERE  cty_id = :cityId
               AND cty_is_airport = 1 AND cty_active = 1 
	 [params: {"cityId":"30804"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28834.774] [M: 30695.23] [ET: 0.965/28800.796] [MU: 8.14/30695.13] 
	BookingRoute::calculateDistance
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28835.629] [M: 30703.07] [ET: 0.762/28801.651] [MU: 8.07/30702.96] 
	BookingRoute::calculateDistance
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28836.05] [M: 30702.5] [ET: 0.339/28802.068] [MU: 0.9/30702.25] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28837.328] [M: 30715.21] [ET: 0.726/28803.337] [MU: 3.34/30714.77] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28838.027] [M: 30744.38] [ET: 0.551/28804.008] [MU: 22.54/30743.63] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp643)) OR (apr_area_type = 5 AND apr_area_id IN (:gp641)) OR (apr_area_type = 2 AND apr_area_id IN (:gp644)) OR (apr_area_type = 4 AND apr_area_id IN (:gp645)) OR (apr_area_type = 1 AND apr_area_id IN (:gp642))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp641":"3699",":gp642":"31",":gp643":"30804",":gp644":"105",":gp645":"1","cab":"99"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28839.726] [M: 30731.4] [ET: 0.463/28805.746] [MU: 3.33/30730.96] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28842.813] [M: 30741.9] [ET: 2.966/28808.807] [MU: 3.49/30741.02] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp648)) OR (scr_area_type = 5 AND scr_area_id IN (:gp646)) OR (scr_area_type = 2 AND scr_area_id IN (:gp649)) OR (scr_area_type = 4 AND scr_area_id IN (:gp650)) OR (scr_area_type = 1 AND scr_area_id IN (:gp647)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp646":"3699",":gp647":"31",":gp648":"3699",":gp649":"105",":gp650":"1","scv_id":"99"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28843.673] [M: 30745.11] [ET: 0.378/28809.681] [MU: 2.97/30745] 
	BookingRoute::calculateDistance
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28845.119] [M: 30758.13] [ET: 0.241/28811.143] [MU: 2.98/30758.02] 
	BookingRoute::calculateDistance
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28845.384] [M: 30762.3] [ET: 0.198/28811.41] [MU: 2.98/30762.19] 
	BookingRoute::calculateDistance
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28849.97] [M: 30796.3] [ET: 0.74/28815.964] [MU: 6.33/30794.3] 
	SQL: 
                SELECT cities.cty_id as c2id, cities.cty_name as c2name, cities.cty_garage_address as c2address,
                    cities.cty_id as c4id, cities.cty_name as c4name, cities.cty_garage_address as c4address,
                        (distance * 2) as totalExtraDistance
                 FROM (SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<40
                     INNER JOIN route r1 ON route.rut_to_city_id=r1.rut_from_city_id AND r1.rut_active=1
                     INNER JOIN rate ON r1.rut_id=rate.rte_route_id AND rate.rte_status=1  AND rate.rte_vehicletype_id IN (3) GROUP BY route.rut_id HAVING count(*) >30
                   UNION
                     SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<600
                     INNER JOIN cities tc ON tc.cty_id=route.rut_to_city_id AND tc.cty_service_active=1 AND CalcDistance(cities.cty_lat, cities.cty_long, tc.cty_lat, tc.cty_long)<=route.rut_estm_distance						 
                     INNER JOIN cities_stats ON cities_stats.cts_cty_id = route.rut_to_city_id AND cities_stats.cts_vnd_cnt >= 2
                   UNION
                    SELECT cts_cty_id AS city, 0 AS distance
					FROM cities_stats WHERE 1 AND cities_stats.cts_cty_id= 30817 and cities_stats.cts_vnd_cnt>1) a
                    INNER JOIN cities ON cities.cty_id=a.city
                    ORDER BY totalExtraDistance LIMIT 1 
	 [params: []]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28852.757] [M: 30811.12] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.255.12
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"3","tripDistance":"","tripDuration":"","multiCityData":"","bookingType":"1","pickupAddress":"","pickupDate":"24\/10\/2024","pickupTime":"04:00 AM","isGozonow":"0","minTripDistance":"0","sccId":"0","tripUser":"1","YII_CSRF_TOKEN":"N3VxRE1WeG9UeHk5UWFBUFpPT216eWVyY0xWTVpoTkcUoJ2aBoup1fU2M5E4ePVZVcUNlKiYZZysUqEklNiKWw==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=3&tripDistance=&tripDuration=&multiCityData=&bookingType=1&pickupAddress=&pickupDate=24%2F10%2F2024&pickupTime=04%3A00+AM&isGozonow=0&minTripDistance=0&sccId=0&tripUser=1&YII_CSRF_TOKEN=N3VxRE1WeG9UeHk5UWFBUFpPT216eWVyY0xWTVpoTkcUoJ2aBoup1fU2M5E4ePVZVcUNlKiYZZysUqEklNiKWw%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28853.261] [M: 30830.68] [ET: 0.921/28819.286] [MU: 20.76/30830.57] 
	models.RouteRates.calculateDriverAllowance
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28853.293] [M: 30832.36] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28854.248] [M: 30845.82] [ET: 0.81/28820.237] [MU: 2.99/30843.32] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+10013),(IF((cpm_value_type=2),(10013+(10013*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30937 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30937) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-24 04:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=99 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28856.228] [M: 30888.05] [ET: 3.941/28822.246] [MU: 78.59/30887.89] 
	RouteRates::calculate for CAB 99 2024-10-24 04:00:00 - Trip Type: 1 46267636
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28856.39] [M: 30865.73] [ET: 39.64/28822.415] [MU: 304.31/30865.58] 
	Quote::calculateRules for CAB 99, From City Id: 30804, To city Id: 30711
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28856.689] [M: 30837.46] [ET: 0.22/28822.71] [MU: 0.89/30837.21] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"99"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28856.764] [M: 30839.65] [ET: 74.116/28822.788] [MU: 714.64/30839.55] 
	Quote For CabType: 99
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28858.037] [M: 30849.99] [ET: 0.448/28824.055] [MU: 3.34/30849.55] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28858.525] [M: 30855.8] [ET: 0.416/28824.545] [MU: 3.34/30855.37] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30711"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28859.157] [M: 30858.74] [ET: 0.543/28825.149] [MU: 0.89/30858.49] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28860.075] [M: 30891.1] [ET: 0.748/28826.071] [MU: 24.21/30889.6] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (100) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30711) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp651)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp654,:gp655)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp652,:gp653)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp656,:gp657))
			OR (scr_area_type = 5 AND scr_area_id IN (3699))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (108)
		ORDER BY rank DESC
		 
	 [params: {":gp651":"31",":gp652":"30804",":gp653":"30711",":gp654":"105",":gp655":"100",":gp656":"1",":gp657":"1","tripType":"1"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28861.297] [M: 30871.3] [ET: 0.332/28827.309] [MU: 0.83/30871.11] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28861.667] [M: 30874.14] [ET: 0.286/28827.685] [MU: 0.93/30873.83] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"6"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28863.219] [M: 30886.98] [ET: 0.408/28829.196] [MU: 2.05/30886.48] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"108"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28866.479] [M: 30896.31] [ET: 3.038/28832.489] [MU: 3.48/30895.44] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"108","fromCity":"30804","toCity":"30711"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28867.906] [M: 30899.56] [ET: 0.518/28833.92] [MU: 0.87/30899.34] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":0}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28868.786] [M: 30906.89] [ET: 0.675/28834.798] [MU: 3.02/30906.45] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28869.479] [M: 30935.06] [ET: 0.58/28835.49] [MU: 22.05/30934.44] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp659)) OR (apr_area_type = 2 AND apr_area_id IN (:gp660)) OR (apr_area_type = 4 AND apr_area_id IN (:gp661)) OR (apr_area_type = 1 AND apr_area_id IN (:gp658))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp658":"31",":gp659":"30804",":gp660":"105",":gp661":"1","cab":"108"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28870.718] [M: 30921.8] [ET: 0.64/28836.717] [MU: 3.33/30921.36] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28873.893] [M: 30932.03] [ET: 3.013/28839.902] [MU: 3.36/30931.16] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp663)) OR (scr_area_type = 2 AND scr_area_id IN (:gp664)) OR (scr_area_type = 4 AND scr_area_id IN (:gp665)) OR (scr_area_type = 1 AND scr_area_id IN (:gp662)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp662":"31",":gp663":"30804",":gp664":"105",":gp665":"1","scv_id":"108"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28876.823] [M: 30959.8] [ET: 2.11/28842.815] [MU: 0.74/30951.8] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"nearest_route_30804_30711","sql":"(INDEX indx_nearest_rt_rutid (rut_id)) \r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, routeFrom.rut_name as fromAlias, \r\n\t\t\t\tNULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, \r\n\t\t\t\t0 as rank, routeFrom.rut_estm_time as startTime, 0 as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 \r\n\t\t\t\tAND routeFrom.rut_from_city_id<>routeFrom.rut_to_city_id AND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\t\tAND (routeAlias.rut_to_city_id=route.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, NULL, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) \r\n\t\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\t0 AS extraStartDistance, 0, 0 as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND route.rut_from_city_id = 30804 AND route.rut_to_city_id=30711 \r\n\t\t\t\tAND routeTo.rut_from_city_id=30711\r\n\t\t\t\tAND route.rut_active = 1 AND routeTo.rut_active = 1 AND routeTo.rut_estm_distance < 50 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = route.rut_from_city_id) \r\n\t\t\t   AND (routeAlias.rut_to_city_id = routeTo.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, \r\n\t\t\t\trouteFrom.rut_name, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t+ IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) \r\n\t\t\t\tAS extraDistance, IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, 0, \r\n\t\t\t\trouteFrom.rut_estm_time as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 AND routeFrom.rut_from_city_id <> routeFrom.rut_to_city_id\r\n\t\t\t\t\tAND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND routeTo.rut_estm_distance < 50 \r\n\t\t\t\t\tAND routeTo.rut_from_city_id=30711 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\tAND (routeAlias.rut_to_city_id=routeTo.rut_to_city_id) AND routeAlias.rut_active = 1 AND routeAlias.rut_from_city_id=30804  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28879.465] [M: 30963.83] [ET: 2.54/28845.475] [MU: 2.11/30963.39] 
	SQL: SELECT *, (rte_vendor_amount + extraDistance * 10.55) as totalCost FROM (SELECT * FROM nearest_route_30804_30711) a
					INNER JOIN rate ON a.rut_id = rate.rte_route_id AND rte_status=1 AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <>0
					WHERE 1 ORDER BY rank DESC, totalCost ASC LIMIT 0,1 
	 [params: {"cabType":"108"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28880.589] [M: 30971.85] [ET: 1.014/28846.594] [MU: 0.74/30969.85] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"getNearestRoute_30804_30711_70","sql":"(INDEX getNearestRoute_30804_30711_70_index_rut_id (rut_id))\r\n\t\t\t\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id AS start, routeAlias.rut_to_city_id AS end,\r\n\t\t\t\t\t\t\t\trouteFrom.rut_name AS fromAlias, NULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance AS quotedDistance,\r\n\t\t\t\t\t\t\t\trouteAlias.rut_estm_distance AS rateDistance, \r\n\t\t\t\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance)\r\n\t\t\t\t\t\t\t\t\t - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance,\r\n\t\t\t\t\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance,\r\n\t\t\t\t\t\t\t\t0 AS rank, routeFrom.rut_estm_time AS startTime, 0 AS endTime, route.rut_estm_time, \r\n\t\t\t\t\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraTravelDistance\r\n\t\t\t\t\t\tFROM   route\r\n\t\t\t\t\t\tINNER JOIN route routeTo ON routeTo.rut_to_city_id=route.rut_from_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_from_city_id=30804 AND routeTo.rut_active=1\r\n\t\t\t\t\t\t\t\tAND routeTo.rut_estm_distance<70 AND route.rut_active=1\r\n\t\t\t\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_from_city_id=route.rut_to_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_active = 1\r\n\t\t\t\t\t\t\t\tAND routeFrom.rut_estm_distance<70 AND route.rut_active = 1\r\n\t\t\t\t\t\tINNER JOIN route routeAlias ON routeAlias.rut_to_city_id=routeFrom.rut_to_city_id\r\n\t\t\t\t\t\t\tAND routeAlias.rut_from_city_id=routeTo.rut_from_city_id AND routeAlias.rut_active = 1"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28883.383] [M: 30977.12] [ET: 2.705/28849.392] [MU: 2.41/30976.49] 
	SQL: SELECT *, (rte_vendor_amount + extradistance * 10.55 ) AS totalCost, 
						ABS(quotedDistance-rateDistance) AS extraChargeableDistance
					FROM getNearestRoute_30804_30711_70 a
					INNER JOIN rate ON a.rut_id=rate.rte_route_id AND rte_status=1 
						AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <> 0
					WHERE  1
					ORDER  BY rank DESC, extraStartDistance, extraChargeableDistance ASC, totalcost ASC
					LIMIT  0, 1 
	 [params: {"cabType":"108"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28886.182] [M: 30992.27] [ET: 0.593/28852.199] [MU: 3.46/30991.39] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"73","fromCity":"30804","toCity":"30711"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28887.806] [M: 31008.88] [ET: 0.518/28853.824] [MU: 3.78/31008.01] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30711"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28888.955] [M: 31019.97] [ET: 25.664/28854.979] [MU: 131.58/31019.81] 
	Quote::calculateOneWay  for CAB 108 Date: 2024-10-24 04:00:00
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28889.521] [M: 31023.56] [ET: 0.469/28855.538] [MU: 0.9/31023.31] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28890.81] [M: 31036.27] [ET: 0.665/28856.815] [MU: 3.34/31035.84] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28891.599] [M: 31065.45] [ET: 0.63/28857.612] [MU: 22.53/31064.7] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp668)) OR (apr_area_type = 5 AND apr_area_id IN (:gp666)) OR (apr_area_type = 2 AND apr_area_id IN (:gp669)) OR (apr_area_type = 4 AND apr_area_id IN (:gp670)) OR (apr_area_type = 1 AND apr_area_id IN (:gp667))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp666":"3699",":gp667":"31",":gp668":"30804",":gp669":"105",":gp670":"1","cab":"108"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28893.096] [M: 31052.48] [ET: 0.462/28859.115] [MU: 3.33/31052.04] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28895.716] [M: 31062.98] [ET: 2.513/28861.728] [MU: 3.48/31062.1] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp673)) OR (scr_area_type = 5 AND scr_area_id IN (:gp671)) OR (scr_area_type = 2 AND scr_area_id IN (:gp674)) OR (scr_area_type = 4 AND scr_area_id IN (:gp675)) OR (scr_area_type = 1 AND scr_area_id IN (:gp672)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp671":"3699",":gp672":"31",":gp673":"3699",":gp674":"105",":gp675":"1","scv_id":"108"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28896.242] [M: 31064.13] [ET: 0.271/28862.265] [MU: 2.98/31064.02] 
	BookingRoute::calculateDistance
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28898.638] [M: 31074.38] [ET: 0.793/28864.638] [MU: 2.84/31073.76] 
	SQL: SELECT 
						fc.cty_id as c2id, 
						fc.cty_name as c2name, 
						fc.cty_garage_address as c2address,
						tc.cty_id as c4id,
						tc.cty_name as c4name, tc.cty_garage_address as c4address,
						0 as totalExtraDistance FROM route
						INNER JOIN cities fc ON rut_from_city_id=fc.cty_id
						INNER JOIN cities tc ON rut_to_city_id=tc.cty_id
						INNER JOIN rate on  rate.rte_route_id=route.rut_id  AND rate.rte_vehicletype_id IN (3)
						WHERE route.rut_from_city_id=30804 AND route.rut_to_city_id=30711 AND route.rut_active=1 
	 [params: []]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28899.256] [M: 31088.27] [ET: 0.512/28865.268] [MU: 6.53/31086.27] 
	SQL: 
				SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address, tc.cty_id as c4id, 
				tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
					FROM
					 (
						(
							SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id,  
								r3.rut_to_city_id, route.rut_name , route.rut_id,
								(route.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, 
								r3.rut_estm_distance
							FROM route
							INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_from_city_id=30804  
									AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=route.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) 
									AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
						UNION
						(
							SELECT r3.rut_id, r3.rut_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,(route.rut_estm_distance + r1.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
							FROM route
							INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND  route.rut_to_city_id=30711 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND route.rut_to_city_id=r3.rut_to_city_id))	AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
                     ) a
					INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
					INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1 
	 [params: []]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28899.763] [M: 31098.77] [ET: 0.43/28865.779] [MU: 5.04/31097.27] 
	SQL: SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
                              tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
                        FROM (SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,
                                    (route.rut_estm_distance + r1.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
                                FROM route
								INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
								INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
								INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) AND r3.rut_active=1 
								INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3) LIMIT 1
							)a
                        INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
                        INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1
                         
	 [params: []]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28900.417] [M: 31105.15] [ET: 0.573/28866.421] [MU: 0.75/31104.27] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"GarageRoute_30804_30711","sql":" (INDEX GarageRoute_30804_30711_index_rut_id (rut_id), INDEX GarageRoute_30804_30711_index_rut_from_city_id (rut_from_city_id), INDEX GarageRoute_30804_30711_index_rut_to_city_id (rut_to_city_id))\r\n\t\t\t\t\t\t\tSELECT route.rut_id, route.rut_from_city_id, route.rut_to_city_id, route.rut_name, rut_estm_distance FROM route \r\n\t\t\t\t\t\t\tINNER JOIN cities_stats   ON cities_stats.cts_cty_id = route.rut_from_city_id\r\n\t\t\t\t\t\t\tAND rut_estm_distance < 300\r\n\t\t\t\t\t\t\tAND rut_active = 1\r\n\t\t\t\t\t\t\tAND route.rut_to_city_id=30804\r\n\t\t\t\t\t\t\tAND cities_stats.cts_vnd_cnt >= 3\r\n\t\t\t\t\t\t\tORDER BY rut_estm_distance LIMIT 10"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28901.093] [M: 31117.07] [ET: 0.581/28867.108] [MU: 6.68/31115.32] 
	SQL: SELECT a.*, fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
								tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address 
						FROM ((SELECT xyz.rut_from_city_id as startCity, r1.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r3.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_from_city_id
							INNER JOIN rate ON rate.rte_route_id=r1.rut_id  AND rate.rte_vehicletype_id IN (3)
							INNER JOIN route r2 ON r2.rut_to_city_id=r1.rut_to_city_id AND r2.rut_from_city_id=:dropCity AND r2.rut_active=1
							INNER JOIN route r3 ON r3.rut_from_city_id=xyz.rut_to_city_id AND r3.rut_to_city_id=r2.rut_from_city_id AND r3.rut_active=1
							ORDER BY ExtraDistance LIMIT 1
							)
							UNION
							(
							SELECT xyz.rut_from_city_id as startCity, r2.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r2.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_to_city_id AND r1.rut_to_city_id=:dropCity
							INNER JOIN route r2 ON r2.rut_to_city_id=xyz.rut_from_city_id AND r2.rut_from_city_id=r1.rut_to_city_id
							ORDER BY ExtraDistance ASC LIMIT 1
							)) a
						INNER JOIN cities fc ON startCity=fc.cty_id
						INNER JOIN cities tc ON endCity=tc.cty_id 
						ORDER BY ExtraDistance 
	 [params: {"pickupCity":"30804","dropCity":"30711"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28903.774] [M: 31128.41] [ET: 1.136/28869.776] [MU: 7.89/31128.3] 
	BookingRoute::calculateDistance
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28904.897] [M: 31133.89] [ET: 0.999/28870.916] [MU: 8.26/31133.78] 
	BookingRoute::calculateDistance
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28905.652] [M: 31141.52] [ET: 0.277/28871.669] [MU: 0.99/31141.14] 
	SQL: SELECT cts_airport_pickup_entry_fee
               FROM   cities
               INNER JOIN cities_stats
               ON cities.cty_id = cities_stats.cts_cty_id
               WHERE  cty_id = :cityId
               AND cty_is_airport = 1 AND cty_active = 1 
	 [params: {"cityId":"30804"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28907.194] [M: 31155.43] [ET: 0.914/28873.197] [MU: 8.13/31155.32] 
	BookingRoute::calculateDistance
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28908.217] [M: 31163.27] [ET: 0.913/28874.237] [MU: 8.08/31163.16] 
	BookingRoute::calculateDistance
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28908.743] [M: 31162.7] [ET: 0.445/28874.764] [MU: 0.9/31162.45] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28910.018] [M: 31175.41] [ET: 0.643/28876.039] [MU: 3.33/31174.97] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28910.829] [M: 31204.58] [ET: 0.668/28876.827] [MU: 22.53/31203.83] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp678)) OR (apr_area_type = 5 AND apr_area_id IN (:gp676)) OR (apr_area_type = 2 AND apr_area_id IN (:gp679)) OR (apr_area_type = 4 AND apr_area_id IN (:gp680)) OR (apr_area_type = 1 AND apr_area_id IN (:gp677))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp676":"3699",":gp677":"31",":gp678":"30804",":gp679":"105",":gp680":"1","cab":"108"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28912.998] [M: 31191.61] [ET: 0.651/28878.993] [MU: 3.33/31191.17] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28916.147] [M: 31202.11] [ET: 2.98/28882.139] [MU: 3.49/31201.23] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp683)) OR (scr_area_type = 5 AND scr_area_id IN (:gp681)) OR (scr_area_type = 2 AND scr_area_id IN (:gp684)) OR (scr_area_type = 4 AND scr_area_id IN (:gp685)) OR (scr_area_type = 1 AND scr_area_id IN (:gp682)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp681":"3699",":gp682":"31",":gp683":"3699",":gp684":"105",":gp685":"1","scv_id":"108"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28916.832] [M: 31205.3] [ET: 0.262/28882.837] [MU: 2.98/31205.2] 
	BookingRoute::calculateDistance
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28918.213] [M: 31218.32] [ET: 0.233/28884.232] [MU: 2.97/31218.21] 
	BookingRoute::calculateDistance
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28918.477] [M: 31222.49] [ET: 0.196/28884.503] [MU: 2.98/31222.38] 
	BookingRoute::calculateDistance
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28924.06] [M: 31256.59] [ET: 1.002/28890.043] [MU: 6.33/31254.59] 
	SQL: 
                SELECT cities.cty_id as c2id, cities.cty_name as c2name, cities.cty_garage_address as c2address,
                    cities.cty_id as c4id, cities.cty_name as c4name, cities.cty_garage_address as c4address,
                        (distance * 2) as totalExtraDistance
                 FROM (SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<40
                     INNER JOIN route r1 ON route.rut_to_city_id=r1.rut_from_city_id AND r1.rut_active=1
                     INNER JOIN rate ON r1.rut_id=rate.rte_route_id AND rate.rte_status=1  AND rate.rte_vehicletype_id IN (3) GROUP BY route.rut_id HAVING count(*) >30
                   UNION
                     SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<600
                     INNER JOIN cities tc ON tc.cty_id=route.rut_to_city_id AND tc.cty_service_active=1 AND CalcDistance(cities.cty_lat, cities.cty_long, tc.cty_lat, tc.cty_long)<=route.rut_estm_distance						 
                     INNER JOIN cities_stats ON cities_stats.cts_cty_id = route.rut_to_city_id AND cities_stats.cts_vnd_cnt >= 2
                   UNION
                    SELECT cts_cty_id AS city, 0 AS distance
					FROM cities_stats WHERE 1 AND cities_stats.cts_cty_id= 30817 and cities_stats.cts_vnd_cnt>1) a
                    INNER JOIN cities ON cities.cty_id=a.city
                    ORDER BY totalExtraDistance LIMIT 1 
	 [params: []]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28927.444] [M: 31271.41] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.255.12
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"3","tripDistance":"","tripDuration":"","multiCityData":"","bookingType":"1","pickupAddress":"","pickupDate":"24\/10\/2024","pickupTime":"04:00 AM","isGozonow":"0","minTripDistance":"0","sccId":"0","tripUser":"1","YII_CSRF_TOKEN":"N3VxRE1WeG9UeHk5UWFBUFpPT216eWVyY0xWTVpoTkcUoJ2aBoup1fU2M5E4ePVZVcUNlKiYZZysUqEklNiKWw==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=3&tripDistance=&tripDuration=&multiCityData=&bookingType=1&pickupAddress=&pickupDate=24%2F10%2F2024&pickupTime=04%3A00+AM&isGozonow=0&minTripDistance=0&sccId=0&tripUser=1&YII_CSRF_TOKEN=N3VxRE1WeG9UeHk5UWFBUFpPT216eWVyY0xWTVpoTkcUoJ2aBoup1fU2M5E4ePVZVcUNlKiYZZysUqEklNiKWw%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28928.087] [M: 31290.97] [ET: 1.207/28894.095] [MU: 20.76/31290.86] 
	models.RouteRates.calculateDriverAllowance
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28928.139] [M: 31292.65] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28929.555] [M: 31306.11] [ET: 1.213/28895.539] [MU: 2.99/31303.61] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+10013),(IF((cpm_value_type=2),(10013+(10013*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30937 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30937) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-24 04:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=108 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28932.362] [M: 31348.34] [ET: 5.575/28898.358] [MU: 78.59/31348.18] 
	RouteRates::calculate for CAB 108 2024-10-24 04:00:00 - Trip Type: 1 30590339
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28932.609] [M: 31326.02] [ET: 43.579/28898.614] [MU: 304.5/31325.87] 
	Quote::calculateRules for CAB 108, From City Id: 30804, To city Id: 30711
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28933.058] [M: 31297.65] [ET: 0.327/28899.062] [MU: 0.9/31297.4] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"108"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28933.176] [M: 31299.84] [ET: 76.347/28899.183] [MU: 458.88/31299.74] 
	Quote For CabType: 108
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28934.548] [M: 31310.18] [ET: 0.425/28900.565] [MU: 3.33/31309.74] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28935.031] [M: 31315.99] [ET: 0.411/28901.05] [MU: 3.34/31315.55] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30711"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28935.602] [M: 31318.93] [ET: 0.496/28901.618] [MU: 0.9/31318.68] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28936.244] [M: 31351.29] [ET: 0.529/28902.258] [MU: 24.22/31349.79] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (100) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30711) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp686)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp689,:gp690)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp687,:gp688)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp691,:gp692))
			OR (scr_area_type = 5 AND scr_area_id IN (3699))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (111)
		ORDER BY rank DESC
		 
	 [params: {":gp686":"31",":gp687":"30804",":gp688":"30711",":gp689":"105",":gp690":"100",":gp691":"1",":gp692":"1","tripType":"1"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28937.072] [M: 31331.48] [ET: 0.284/28903.089] [MU: 0.83/31331.29] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28937.451] [M: 31334.32] [ET: 0.299/28903.471] [MU: 0.93/31334.01] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"6"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28938.949] [M: 31347.16] [ET: 0.436/28904.939] [MU: 2.05/31346.66] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"111"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28943.955] [M: 31356.49] [ET: 4.656/28909.964] [MU: 3.48/31355.62] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"111","fromCity":"30804","toCity":"30711"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28945.343] [M: 31359.74] [ET: 0.6/28911.357] [MU: 0.87/31359.52] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":0}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28946.165] [M: 31367.07] [ET: 0.649/28912.176] [MU: 3.02/31366.63] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28946.908] [M: 31395.24] [ET: 0.632/28912.918] [MU: 22.05/31394.62] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp694)) OR (apr_area_type = 2 AND apr_area_id IN (:gp695)) OR (apr_area_type = 4 AND apr_area_id IN (:gp696)) OR (apr_area_type = 1 AND apr_area_id IN (:gp693))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp693":"31",":gp694":"30804",":gp695":"105",":gp696":"1","cab":"111"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28947.933] [M: 31381.97] [ET: 0.444/28913.953] [MU: 3.33/31381.53] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28950.771] [M: 31392.2] [ET: 2.702/28916.749] [MU: 3.36/31391.33] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp698)) OR (scr_area_type = 2 AND scr_area_id IN (:gp699)) OR (scr_area_type = 4 AND scr_area_id IN (:gp700)) OR (scr_area_type = 1 AND scr_area_id IN (:gp697)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp697":"31",":gp698":"30804",":gp699":"105",":gp700":"1","scv_id":"111"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28953.699] [M: 31419.98] [ET: 1.884/28919.671] [MU: 0.74/31411.98] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"nearest_route_30804_30711","sql":"(INDEX indx_nearest_rt_rutid (rut_id)) \r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, routeFrom.rut_name as fromAlias, \r\n\t\t\t\tNULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, \r\n\t\t\t\t0 as rank, routeFrom.rut_estm_time as startTime, 0 as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 \r\n\t\t\t\tAND routeFrom.rut_from_city_id<>routeFrom.rut_to_city_id AND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\t\tAND (routeAlias.rut_to_city_id=route.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, NULL, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) \r\n\t\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\t0 AS extraStartDistance, 0, 0 as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND route.rut_from_city_id = 30804 AND route.rut_to_city_id=30711 \r\n\t\t\t\tAND routeTo.rut_from_city_id=30711\r\n\t\t\t\tAND route.rut_active = 1 AND routeTo.rut_active = 1 AND routeTo.rut_estm_distance < 50 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = route.rut_from_city_id) \r\n\t\t\t   AND (routeAlias.rut_to_city_id = routeTo.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, \r\n\t\t\t\trouteFrom.rut_name, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t+ IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) \r\n\t\t\t\tAS extraDistance, IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, 0, \r\n\t\t\t\trouteFrom.rut_estm_time as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 AND routeFrom.rut_from_city_id <> routeFrom.rut_to_city_id\r\n\t\t\t\t\tAND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND routeTo.rut_estm_distance < 50 \r\n\t\t\t\t\tAND routeTo.rut_from_city_id=30711 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\tAND (routeAlias.rut_to_city_id=routeTo.rut_to_city_id) AND routeAlias.rut_active = 1 AND routeAlias.rut_from_city_id=30804  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28956.831] [M: 31424.01] [ET: 3.008/28922.826] [MU: 2.11/31423.57] 
	SQL: SELECT *, (rte_vendor_amount + extraDistance * 10.55) as totalCost FROM (SELECT * FROM nearest_route_30804_30711) a
					INNER JOIN rate ON a.rut_id = rate.rte_route_id AND rte_status=1 AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <>0
					WHERE 1 ORDER BY rank DESC, totalCost ASC LIMIT 0,1 
	 [params: {"cabType":"111"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28957.685] [M: 31432.03] [ET: 0.705/28923.676] [MU: 0.74/31430.03] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"getNearestRoute_30804_30711_70","sql":"(INDEX getNearestRoute_30804_30711_70_index_rut_id (rut_id))\r\n\t\t\t\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id AS start, routeAlias.rut_to_city_id AS end,\r\n\t\t\t\t\t\t\t\trouteFrom.rut_name AS fromAlias, NULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance AS quotedDistance,\r\n\t\t\t\t\t\t\t\trouteAlias.rut_estm_distance AS rateDistance, \r\n\t\t\t\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance)\r\n\t\t\t\t\t\t\t\t\t - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance,\r\n\t\t\t\t\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance,\r\n\t\t\t\t\t\t\t\t0 AS rank, routeFrom.rut_estm_time AS startTime, 0 AS endTime, route.rut_estm_time, \r\n\t\t\t\t\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraTravelDistance\r\n\t\t\t\t\t\tFROM   route\r\n\t\t\t\t\t\tINNER JOIN route routeTo ON routeTo.rut_to_city_id=route.rut_from_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_from_city_id=30804 AND routeTo.rut_active=1\r\n\t\t\t\t\t\t\t\tAND routeTo.rut_estm_distance<70 AND route.rut_active=1\r\n\t\t\t\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_from_city_id=route.rut_to_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_active = 1\r\n\t\t\t\t\t\t\t\tAND routeFrom.rut_estm_distance<70 AND route.rut_active = 1\r\n\t\t\t\t\t\tINNER JOIN route routeAlias ON routeAlias.rut_to_city_id=routeFrom.rut_to_city_id\r\n\t\t\t\t\t\t\tAND routeAlias.rut_from_city_id=routeTo.rut_from_city_id AND routeAlias.rut_active = 1"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28961.026] [M: 31437.3] [ET: 3.218/28927.016] [MU: 2.41/31436.67] 
	SQL: SELECT *, (rte_vendor_amount + extradistance * 10.55 ) AS totalCost, 
						ABS(quotedDistance-rateDistance) AS extraChargeableDistance
					FROM getNearestRoute_30804_30711_70 a
					INNER JOIN rate ON a.rut_id=rate.rte_route_id AND rte_status=1 
						AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <> 0
					WHERE  1
					ORDER  BY rank DESC, extraStartDistance, extraChargeableDistance ASC, totalcost ASC
					LIMIT  0, 1 
	 [params: {"cabType":"111"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28964.67] [M: 31452.44] [ET: 0.693/28930.671] [MU: 3.47/31451.56] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"73","fromCity":"30804","toCity":"30711"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28966.472] [M: 31469.05] [ET: 0.526/28932.487] [MU: 3.78/31468.18] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30711"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28967.798] [M: 31480.15] [ET: 28.741/28933.806] [MU: 131.57/31479.99] 
	Quote::calculateOneWay  for CAB 111 Date: 2024-10-24 04:00:00
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28968.358] [M: 31483.74] [ET: 0.432/28934.376] [MU: 0.89/31483.49] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28969.754] [M: 31496.45] [ET: 0.728/28935.756] [MU: 3.34/31496.02] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28970.713] [M: 31525.63] [ET: 0.789/28936.708] [MU: 22.53/31524.88] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp703)) OR (apr_area_type = 5 AND apr_area_id IN (:gp701)) OR (apr_area_type = 2 AND apr_area_id IN (:gp704)) OR (apr_area_type = 4 AND apr_area_id IN (:gp705)) OR (apr_area_type = 1 AND apr_area_id IN (:gp702))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp701":"3699",":gp702":"31",":gp703":"30804",":gp704":"105",":gp705":"1","cab":"111"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28973.101] [M: 31512.65] [ET: 0.605/28939.103] [MU: 3.33/31512.21] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28976.302] [M: 31523.15] [ET: 3.026/28942.29] [MU: 3.49/31522.27] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp708)) OR (scr_area_type = 5 AND scr_area_id IN (:gp706)) OR (scr_area_type = 2 AND scr_area_id IN (:gp709)) OR (scr_area_type = 4 AND scr_area_id IN (:gp710)) OR (scr_area_type = 1 AND scr_area_id IN (:gp707)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp706":"3699",":gp707":"31",":gp708":"3699",":gp709":"105",":gp710":"1","scv_id":"111"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28977.08] [M: 31524.31] [ET: 0.371/28943.085] [MU: 2.98/31524.2] 
	BookingRoute::calculateDistance
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28979.436] [M: 31534.47] [ET: 0.903/28945.44] [MU: 2.84/31533.84] 
	SQL: SELECT 
						fc.cty_id as c2id, 
						fc.cty_name as c2name, 
						fc.cty_garage_address as c2address,
						tc.cty_id as c4id,
						tc.cty_name as c4name, tc.cty_garage_address as c4address,
						0 as totalExtraDistance FROM route
						INNER JOIN cities fc ON rut_from_city_id=fc.cty_id
						INNER JOIN cities tc ON rut_to_city_id=tc.cty_id
						INNER JOIN rate on  rate.rte_route_id=route.rut_id  AND rate.rte_vehicletype_id IN (3)
						WHERE route.rut_from_city_id=30804 AND route.rut_to_city_id=30711 AND route.rut_active=1 
	 [params: []]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28980.227] [M: 31548.35] [ET: 0.669/28946.161] [MU: 6.53/31546.35] 
	SQL: 
				SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address, tc.cty_id as c4id, 
				tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
					FROM
					 (
						(
							SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id,  
								r3.rut_to_city_id, route.rut_name , route.rut_id,
								(route.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, 
								r3.rut_estm_distance
							FROM route
							INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_from_city_id=30804  
									AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=route.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) 
									AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
						UNION
						(
							SELECT r3.rut_id, r3.rut_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,(route.rut_estm_distance + r1.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
							FROM route
							INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND  route.rut_to_city_id=30711 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND route.rut_to_city_id=r3.rut_to_city_id))	AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
                     ) a
					INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
					INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1 
	 [params: []]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28981.067] [M: 31558.86] [ET: 0.707/28947.055] [MU: 5.03/31557.36] 
	SQL: SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
                              tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
                        FROM (SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,
                                    (route.rut_estm_distance + r1.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
                                FROM route
								INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
								INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
								INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) AND r3.rut_active=1 
								INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3) LIMIT 1
							)a
                        INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
                        INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1
                         
	 [params: []]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28981.591] [M: 31565.23] [ET: 0.431/28947.605] [MU: 0.74/31564.36] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"GarageRoute_30804_30711","sql":" (INDEX GarageRoute_30804_30711_index_rut_id (rut_id), INDEX GarageRoute_30804_30711_index_rut_from_city_id (rut_from_city_id), INDEX GarageRoute_30804_30711_index_rut_to_city_id (rut_to_city_id))\r\n\t\t\t\t\t\t\tSELECT route.rut_id, route.rut_from_city_id, route.rut_to_city_id, route.rut_name, rut_estm_distance FROM route \r\n\t\t\t\t\t\t\tINNER JOIN cities_stats   ON cities_stats.cts_cty_id = route.rut_from_city_id\r\n\t\t\t\t\t\t\tAND rut_estm_distance < 300\r\n\t\t\t\t\t\t\tAND rut_active = 1\r\n\t\t\t\t\t\t\tAND route.rut_to_city_id=30804\r\n\t\t\t\t\t\t\tAND cities_stats.cts_vnd_cnt >= 3\r\n\t\t\t\t\t\t\tORDER BY rut_estm_distance LIMIT 10"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28982.229] [M: 31577.16] [ET: 0.557/28948.242] [MU: 6.69/31575.41] 
	SQL: SELECT a.*, fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
								tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address 
						FROM ((SELECT xyz.rut_from_city_id as startCity, r1.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r3.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_from_city_id
							INNER JOIN rate ON rate.rte_route_id=r1.rut_id  AND rate.rte_vehicletype_id IN (3)
							INNER JOIN route r2 ON r2.rut_to_city_id=r1.rut_to_city_id AND r2.rut_from_city_id=:dropCity AND r2.rut_active=1
							INNER JOIN route r3 ON r3.rut_from_city_id=xyz.rut_to_city_id AND r3.rut_to_city_id=r2.rut_from_city_id AND r3.rut_active=1
							ORDER BY ExtraDistance LIMIT 1
							)
							UNION
							(
							SELECT xyz.rut_from_city_id as startCity, r2.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r2.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_to_city_id AND r1.rut_to_city_id=:dropCity
							INNER JOIN route r2 ON r2.rut_to_city_id=xyz.rut_from_city_id AND r2.rut_from_city_id=r1.rut_to_city_id
							ORDER BY ExtraDistance ASC LIMIT 1
							)) a
						INNER JOIN cities fc ON startCity=fc.cty_id
						INNER JOIN cities tc ON endCity=tc.cty_id 
						ORDER BY ExtraDistance 
	 [params: {"pickupCity":"30804","dropCity":"30711"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28984.788] [M: 31588.5] [ET: 1.147/28950.806] [MU: 7.88/31588.39] 
	BookingRoute::calculateDistance
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28985.695] [M: 31593.98] [ET: 0.814/28951.71] [MU: 8.27/31593.87] 
	BookingRoute::calculateDistance
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28986.51] [M: 31601.51] [ET: 0.329/28952.526] [MU: 1/31601.13] 
	SQL: SELECT cts_airport_pickup_entry_fee
               FROM   cities
               INNER JOIN cities_stats
               ON cities.cty_id = cities_stats.cts_cty_id
               WHERE  cty_id = :cityId
               AND cty_is_airport = 1 AND cty_active = 1 
	 [params: {"cityId":"30804"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28988.102] [M: 31615.42] [ET: 0.983/28954.106] [MU: 8.14/31615.31] 
	BookingRoute::calculateDistance
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28989.347] [M: 31623.26] [ET: 1.096/28955.351] [MU: 8.08/31623.15] 
	BookingRoute::calculateDistance
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28989.936] [M: 31622.69] [ET: 0.487/28955.956] [MU: 0.9/31622.44] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28991.46] [M: 31635.4] [ET: 0.757/28957.476] [MU: 3.33/31634.96] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28992.122] [M: 31664.57] [ET: 0.538/28958.14] [MU: 22.53/31663.82] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp713)) OR (apr_area_type = 5 AND apr_area_id IN (:gp711)) OR (apr_area_type = 2 AND apr_area_id IN (:gp714)) OR (apr_area_type = 4 AND apr_area_id IN (:gp715)) OR (apr_area_type = 1 AND apr_area_id IN (:gp712))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp711":"3699",":gp712":"31",":gp713":"30804",":gp714":"105",":gp715":"1","cab":"111"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28993.589] [M: 31651.59] [ET: 0.468/28959.608] [MU: 3.34/31651.16] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28997.077] [M: 31662.09] [ET: 3.368/28963.069] [MU: 3.48/31661.22] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp718)) OR (scr_area_type = 5 AND scr_area_id IN (:gp716)) OR (scr_area_type = 2 AND scr_area_id IN (:gp719)) OR (scr_area_type = 4 AND scr_area_id IN (:gp720)) OR (scr_area_type = 1 AND scr_area_id IN (:gp717)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp716":"3699",":gp717":"31",":gp718":"3699",":gp719":"105",":gp720":"1","scv_id":"111"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28997.72] [M: 31665.3] [ET: 0.244/28963.742] [MU: 2.98/31665.19] 
	BookingRoute::calculateDistance
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28999.179] [M: 31678.31] [ET: 0.247/28965.187] [MU: 2.98/31678.2] 
	BookingRoute::calculateDistance
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28999.614] [M: 31682.39] [ET: 0.324/28965.623] [MU: 2.97/31682.28] 
	BookingRoute::calculateDistance
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 29004.279] [M: 31716.49] [ET: 0.643/28970.291] [MU: 6.32/31714.49] 
	SQL: 
                SELECT cities.cty_id as c2id, cities.cty_name as c2name, cities.cty_garage_address as c2address,
                    cities.cty_id as c4id, cities.cty_name as c4name, cities.cty_garage_address as c4address,
                        (distance * 2) as totalExtraDistance
                 FROM (SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<40
                     INNER JOIN route r1 ON route.rut_to_city_id=r1.rut_from_city_id AND r1.rut_active=1
                     INNER JOIN rate ON r1.rut_id=rate.rte_route_id AND rate.rte_status=1  AND rate.rte_vehicletype_id IN (3) GROUP BY route.rut_id HAVING count(*) >30
                   UNION
                     SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<600
                     INNER JOIN cities tc ON tc.cty_id=route.rut_to_city_id AND tc.cty_service_active=1 AND CalcDistance(cities.cty_lat, cities.cty_long, tc.cty_lat, tc.cty_long)<=route.rut_estm_distance						 
                     INNER JOIN cities_stats ON cities_stats.cts_cty_id = route.rut_to_city_id AND cities_stats.cts_vnd_cnt >= 2
                   UNION
                    SELECT cts_cty_id AS city, 0 AS distance
					FROM cities_stats WHERE 1 AND cities_stats.cts_cty_id= 30817 and cities_stats.cts_vnd_cnt>1) a
                    INNER JOIN cities ON cities.cty_id=a.city
                    ORDER BY totalExtraDistance LIMIT 1 
	 [params: []]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 29007.092] [M: 31731.3] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.255.12
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"3","tripDistance":"","tripDuration":"","multiCityData":"","bookingType":"1","pickupAddress":"","pickupDate":"24\/10\/2024","pickupTime":"04:00 AM","isGozonow":"0","minTripDistance":"0","sccId":"0","tripUser":"1","YII_CSRF_TOKEN":"N3VxRE1WeG9UeHk5UWFBUFpPT216eWVyY0xWTVpoTkcUoJ2aBoup1fU2M5E4ePVZVcUNlKiYZZysUqEklNiKWw==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=3&tripDistance=&tripDuration=&multiCityData=&bookingType=1&pickupAddress=&pickupDate=24%2F10%2F2024&pickupTime=04%3A00+AM&isGozonow=0&minTripDistance=0&sccId=0&tripUser=1&YII_CSRF_TOKEN=N3VxRE1WeG9UeHk5UWFBUFpPT216eWVyY0xWTVpoTkcUoJ2aBoup1fU2M5E4ePVZVcUNlKiYZZysUqEklNiKWw%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 29007.587] [M: 31750.87] [ET: 0.923/28973.612] [MU: 20.77/31750.76] 
	models.RouteRates.calculateDriverAllowance
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 29007.617] [M: 31752.55] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 29008.606] [M: 31766.01] [ET: 0.863/28974.612] [MU: 2.99/31763.51] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+10013),(IF((cpm_value_type=2),(10013+(10013*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30937 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30937) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-24 04:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=111 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 29010.288] [M: 31808.23] [ET: 3.709/28976.305] [MU: 78.59/31808.08] 
	RouteRates::calculate for CAB 111 2024-10-24 04:00:00 - Trip Type: 1 213204056
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 29010.446] [M: 31785.92] [ET: 42.57/28976.471] [MU: 304.22/31785.77] 
	Quote::calculateRules for CAB 111, From City Id: 30804, To city Id: 30711
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 29010.783] [M: 31757.55] [ET: 0.258/28976.804] [MU: 0.9/31757.3] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"111"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 29010.861] [M: 31759.74] [ET: 77.615/28976.887] [MU: 458.6/31759.65] 
	Quote For CabType: 111
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 29012.127] [M: 31770.09] [ET: 0.456/28978.144] [MU: 3.33/31769.65] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 29012.663] [M: 31775.9] [ET: 0.463/28978.681] [MU: 3.33/31775.46] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30711"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 29013.411] [M: 31778.84] [ET: 0.646/28979.396] [MU: 0.9/31778.59] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 29014.353] [M: 31811.2] [ET: 0.775/28980.362] [MU: 24.22/31809.7] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (100) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30711) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp721)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp724,:gp725)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp722,:gp723)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp726,:gp727))
			OR (scr_area_type = 5 AND scr_area_id IN (3699))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (112)
		ORDER BY rank DESC
		 
	 [params: {":gp721":"31",":gp722":"30804",":gp723":"30711",":gp724":"105",":gp725":"100",":gp726":"1",":gp727":"1","tripType":"1"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 29015.446] [M: 31791.38] [ET: 0.404/28981.448] [MU: 0.84/31791.2] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 29015.968] [M: 31794.23] [ET: 0.409/28981.983] [MU: 0.93/31793.91] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"6"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 29017.491] [M: 31807.06] [ET: 0.477/28983.489] [MU: 2.05/31806.56] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"112"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 29021.689] [M: 31816.4] [ET: 3.863/28987.675] [MU: 3.49/31815.52] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"112","fromCity":"30804","toCity":"30711"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 29023.146] [M: 31819.65] [ET: 0.511/28989.162] [MU: 0.86/31819.43] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":0}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 29023.963] [M: 31826.98] [ET: 0.648/28989.982] [MU: 3.01/31826.54] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 29024.533] [M: 31855.15] [ET: 0.452/28990.533] [MU: 22.05/31854.52] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp729)) OR (apr_area_type = 2 AND apr_area_id IN (:gp730)) OR (apr_area_type = 4 AND apr_area_id IN (:gp731)) OR (apr_area_type = 1 AND apr_area_id IN (:gp728))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp728":"31",":gp729":"30804",":gp730":"105",":gp731":"1","cab":"112"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 29025.64] [M: 31841.88] [ET: 0.439/28991.661] [MU: 3.34/31841.44] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 29028.157] [M: 31852.11] [ET: 2.409/28994.166] [MU: 3.36/31851.23] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp733)) OR (scr_area_type = 2 AND scr_area_id IN (:gp734)) OR (scr_area_type = 4 AND scr_area_id IN (:gp735)) OR (scr_area_type = 1 AND scr_area_id IN (:gp732)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp732":"31",":gp733":"30804",":gp734":"105",":gp735":"1","scv_id":"112"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 29031.751] [M: 31879.88] [ET: 2.768/28997.72] [MU: 0.75/31871.88] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"nearest_route_30804_30711","sql":"(INDEX indx_nearest_rt_rutid (rut_id)) \r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, routeFrom.rut_name as fromAlias, \r\n\t\t\t\tNULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, \r\n\t\t\t\t0 as rank, routeFrom.rut_estm_time as startTime, 0 as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 \r\n\t\t\t\tAND routeFrom.rut_from_city_id<>routeFrom.rut_to_city_id AND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\t\tAND (routeAlias.rut_to_city_id=route.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, NULL, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) \r\n\t\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\t0 AS extraStartDistance, 0, 0 as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND route.rut_from_city_id = 30804 AND route.rut_to_city_id=30711 \r\n\t\t\t\tAND routeTo.rut_from_city_id=30711\r\n\t\t\t\tAND route.rut_active = 1 AND routeTo.rut_active = 1 AND routeTo.rut_estm_distance < 50 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = route.rut_from_city_id) \r\n\t\t\t   AND (routeAlias.rut_to_city_id = routeTo.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, \r\n\t\t\t\trouteFrom.rut_name, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t+ IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) \r\n\t\t\t\tAS extraDistance, IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, 0, \r\n\t\t\t\trouteFrom.rut_estm_time as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 AND routeFrom.rut_from_city_id <> routeFrom.rut_to_city_id\r\n\t\t\t\t\tAND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND routeTo.rut_estm_distance < 50 \r\n\t\t\t\t\tAND routeTo.rut_from_city_id=30711 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\tAND (routeAlias.rut_to_city_id=routeTo.rut_to_city_id) AND routeAlias.rut_active = 1 AND routeAlias.rut_from_city_id=30804  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 29034.706] [M: 31883.91] [ET: 2.784/29000.688] [MU: 2.12/31883.48] 
	SQL: SELECT *, (rte_vendor_amount + extraDistance * 10.55) as totalCost FROM (SELECT * FROM nearest_route_30804_30711) a
					INNER JOIN rate ON a.rut_id = rate.rte_route_id AND rte_status=1 AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <>0
					WHERE 1 ORDER BY rank DESC, totalCost ASC LIMIT 0,1 
	 [params: {"cabType":"112"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 29035.644] [M: 31891.94] [ET: 0.781/29001.643] [MU: 0.74/31889.94] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"getNearestRoute_30804_30711_70","sql":"(INDEX getNearestRoute_30804_30711_70_index_rut_id (rut_id))\r\n\t\t\t\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id AS start, routeAlias.rut_to_city_id AS end,\r\n\t\t\t\t\t\t\t\trouteFrom.rut_name AS fromAlias, NULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance AS quotedDistance,\r\n\t\t\t\t\t\t\t\trouteAlias.rut_estm_distance AS rateDistance, \r\n\t\t\t\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance)\r\n\t\t\t\t\t\t\t\t\t - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance,\r\n\t\t\t\t\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance,\r\n\t\t\t\t\t\t\t\t0 AS rank, routeFrom.rut_estm_time AS startTime, 0 AS endTime, route.rut_estm_time, \r\n\t\t\t\t\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraTravelDistance\r\n\t\t\t\t\t\tFROM   route\r\n\t\t\t\t\t\tINNER JOIN route routeTo ON routeTo.rut_to_city_id=route.rut_from_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_from_city_id=30804 AND routeTo.rut_active=1\r\n\t\t\t\t\t\t\t\tAND routeTo.rut_estm_distance<70 AND route.rut_active=1\r\n\t\t\t\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_from_city_id=route.rut_to_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_active = 1\r\n\t\t\t\t\t\t\t\tAND routeFrom.rut_estm_distance<70 AND route.rut_active = 1\r\n\t\t\t\t\t\tINNER JOIN route routeAlias ON routeAlias.rut_to_city_id=routeFrom.rut_to_city_id\r\n\t\t\t\t\t\t\tAND routeAlias.rut_from_city_id=routeTo.rut_from_city_id AND routeAlias.rut_active = 1"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 29040.65] [M: 31897.2] [ET: 4.885/29006.639] [MU: 2.41/31896.58] 
	SQL: SELECT *, (rte_vendor_amount + extradistance * 10.55 ) AS totalCost, 
						ABS(quotedDistance-rateDistance) AS extraChargeableDistance
					FROM getNearestRoute_30804_30711_70 a
					INNER JOIN rate ON a.rut_id=rate.rte_route_id AND rte_status=1 
						AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <> 0
					WHERE  1
					ORDER  BY rank DESC, extraStartDistance, extraChargeableDistance ASC, totalcost ASC
					LIMIT  0, 1 
	 [params: {"cabType":"112"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 29043.647] [M: 31912.34] [ET: 0.567/29009.663] [MU: 3.46/31911.47] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"73","fromCity":"30804","toCity":"30711"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 29045.595] [M: 31928.96] [ET: 0.508/29011.61] [MU: 3.78/31928.09] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30711"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 29046.991] [M: 31940.05] [ET: 29.373/29012.982] [MU: 131.57/31939.9] 
	Quote::calculateOneWay  for CAB 112 Date: 2024-10-24 04:00:00
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 29047.625] [M: 31943.62] [ET: 0.51/29013.637] [MU: 0.9/31943.4] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 29049.074] [M: 31956.36] [ET: 0.697/29015.041] [MU: 3.33/31955.92] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 29049.918] [M: 31985.53] [ET: 0.659/29015.928] [MU: 22.53/31984.78] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp738)) OR (apr_area_type = 5 AND apr_area_id IN (:gp736)) OR (apr_area_type = 2 AND apr_area_id IN (:gp739)) OR (apr_area_type = 4 AND apr_area_id IN (:gp740)) OR (apr_area_type = 1 AND apr_area_id IN (:gp737))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp736":"3699",":gp737":"31",":gp738":"30804",":gp739":"105",":gp740":"1","cab":"112"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 29051.863] [M: 31972.55] [ET: 0.517/29017.881] [MU: 3.34/31972.12] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 29054.769] [M: 31983.05] [ET: 2.776/29020.759] [MU: 3.48/31982.18] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp743)) OR (scr_area_type = 5 AND scr_area_id IN (:gp741)) OR (scr_area_type = 2 AND scr_area_id IN (:gp744)) OR (scr_area_type = 4 AND scr_area_id IN (:gp745)) OR (scr_area_type = 1 AND scr_area_id IN (:gp742)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp741":"3699",":gp742":"31",":gp743":"3699",":gp744":"105",":gp745":"1","scv_id":"112"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 29055.457] [M: 31984.22] [ET: 0.325/29021.481] [MU: 2.97/31984.11] 
	BookingRoute::calculateDistance
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 29057.452] [M: 31994.47] [ET: 0.675/29023.46] [MU: 2.84/31993.84] 
	SQL: SELECT 
						fc.cty_id as c2id, 
						fc.cty_name as c2name, 
						fc.cty_garage_address as c2address,
						tc.cty_id as c4id,
						tc.cty_name as c4name, tc.cty_garage_address as c4address,
						0 as totalExtraDistance FROM route
						INNER JOIN cities fc ON rut_from_city_id=fc.cty_id
						INNER JOIN cities tc ON rut_to_city_id=tc.cty_id
						INNER JOIN rate on  rate.rte_route_id=route.rut_id  AND rate.rte_vehicletype_id IN (3)
						WHERE route.rut_from_city_id=30804 AND route.rut_to_city_id=30711 AND route.rut_active=1 
	 [params: []]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 29057.966] [M: 32008.35] [ET: 0.434/29023.976] [MU: 6.53/32006.35] 
	SQL: 
				SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address, tc.cty_id as c4id, 
				tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
					FROM
					 (
						(
							SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id,  
								r3.rut_to_city_id, route.rut_name , route.rut_id,
								(route.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, 
								r3.rut_estm_distance
							FROM route
							INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_from_city_id=30804  
									AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=route.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) 
									AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
						UNION
						(
							SELECT r3.rut_id, r3.rut_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,(route.rut_estm_distance + r1.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
							FROM route
							INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND  route.rut_to_city_id=30711 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND route.rut_to_city_id=r3.rut_to_city_id))	AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
                     ) a
					INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
					INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1 
	 [params: []]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 29058.574] [M: 32018.86] [ET: 0.525/29024.588] [MU: 5.03/32017.36] 
	SQL: SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
                              tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
                        FROM (SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,
                                    (route.rut_estm_distance + r1.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
                                FROM route
								INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
								INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
								INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) AND r3.rut_active=1 
								INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3) LIMIT 1
							)a
                        INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
                        INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1
                         
	 [params: []]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 29059.103] [M: 32025.23] [ET: 0.434/29025.097] [MU: 0.74/32024.36] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"GarageRoute_30804_30711","sql":" (INDEX GarageRoute_30804_30711_index_rut_id (rut_id), INDEX GarageRoute_30804_30711_index_rut_from_city_id (rut_from_city_id), INDEX GarageRoute_30804_30711_index_rut_to_city_id (rut_to_city_id))\r\n\t\t\t\t\t\t\tSELECT route.rut_id, route.rut_from_city_id, route.rut_to_city_id, route.rut_name, rut_estm_distance FROM route \r\n\t\t\t\t\t\t\tINNER JOIN cities_stats   ON cities_stats.cts_cty_id = route.rut_from_city_id\r\n\t\t\t\t\t\t\tAND rut_estm_distance < 300\r\n\t\t\t\t\t\t\tAND rut_active = 1\r\n\t\t\t\t\t\t\tAND route.rut_to_city_id=30804\r\n\t\t\t\t\t\t\tAND cities_stats.cts_vnd_cnt >= 3\r\n\t\t\t\t\t\t\tORDER BY rut_estm_distance LIMIT 10"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 29059.819] [M: 32037.16] [ET: 0.607/29025.832] [MU: 6.69/32035.41] 
	SQL: SELECT a.*, fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
								tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address 
						FROM ((SELECT xyz.rut_from_city_id as startCity, r1.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r3.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_from_city_id
							INNER JOIN rate ON rate.rte_route_id=r1.rut_id  AND rate.rte_vehicletype_id IN (3)
							INNER JOIN route r2 ON r2.rut_to_city_id=r1.rut_to_city_id AND r2.rut_from_city_id=:dropCity AND r2.rut_active=1
							INNER JOIN route r3 ON r3.rut_from_city_id=xyz.rut_to_city_id AND r3.rut_to_city_id=r2.rut_from_city_id AND r3.rut_active=1
							ORDER BY ExtraDistance LIMIT 1
							)
							UNION
							(
							SELECT xyz.rut_from_city_id as startCity, r2.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r2.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_to_city_id AND r1.rut_to_city_id=:dropCity
							INNER JOIN route r2 ON r2.rut_to_city_id=xyz.rut_from_city_id AND r2.rut_from_city_id=r1.rut_to_city_id
							ORDER BY ExtraDistance ASC LIMIT 1
							)) a
						INNER JOIN cities fc ON startCity=fc.cty_id
						INNER JOIN cities tc ON endCity=tc.cty_id 
						ORDER BY ExtraDistance 
	 [params: {"pickupCity":"30804","dropCity":"30711"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 29062.76] [M: 32048.5] [ET: 1.302/29028.776] [MU: 7.88/32048.39] 
	BookingRoute::calculateDistance
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 29064.118] [M: 32053.98] [ET: 1.24/29030.135] [MU: 8.27/32053.87] 
	BookingRoute::calculateDistance
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 29064.963] [M: 32061.51] [ET: 0.298/29030.963] [MU: 1/32061.13] 
	SQL: SELECT cts_airport_pickup_entry_fee
               FROM   cities
               INNER JOIN cities_stats
               ON cities.cty_id = cities_stats.cts_cty_id
               WHERE  cty_id = :cityId
               AND cty_is_airport = 1 AND cty_active = 1 
	 [params: {"cityId":"30804"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 29066.807] [M: 32075.42] [ET: 1.076/29032.828] [MU: 8.14/32075.31] 
	BookingRoute::calculateDistance
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 29067.745] [M: 32083.26] [ET: 0.824/29033.749] [MU: 8.08/32083.15] 
	BookingRoute::calculateDistance
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 29068.202] [M: 32082.69] [ET: 0.347/29034.223] [MU: 0.9/32082.44] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 29069.616] [M: 32095.4] [ET: 0.781/29035.63] [MU: 3.33/32094.96] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 29070.43] [M: 32124.57] [ET: 0.679/29036.423] [MU: 22.53/32123.82] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp748)) OR (apr_area_type = 5 AND apr_area_id IN (:gp746)) OR (apr_area_type = 2 AND apr_area_id IN (:gp749)) OR (apr_area_type = 4 AND apr_area_id IN (:gp750)) OR (apr_area_type = 1 AND apr_area_id IN (:gp747))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp746":"3699",":gp747":"31",":gp748":"30804",":gp749":"105",":gp750":"1","cab":"112"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 29072.275] [M: 32111.59] [ET: 0.466/29038.293] [MU: 3.34/32111.16] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 29075.411] [M: 32122.09] [ET: 3.026/29041.416] [MU: 3.48/32121.22] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp753)) OR (scr_area_type = 5 AND scr_area_id IN (:gp751)) OR (scr_area_type = 2 AND scr_area_id IN (:gp754)) OR (scr_area_type = 4 AND scr_area_id IN (:gp755)) OR (scr_area_type = 1 AND scr_area_id IN (:gp752)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp751":"3699",":gp752":"31",":gp753":"3699",":gp754":"105",":gp755":"1","scv_id":"112"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 29076.192] [M: 32125.3] [ET: 0.356/29042.213] [MU: 2.98/32125.19] 
	BookingRoute::calculateDistance
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 29077.524] [M: 32138.31] [ET: 0.23/29043.549] [MU: 2.98/32138.2] 
	BookingRoute::calculateDistance
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 29077.784] [M: 32142.39] [ET: 0.193/29043.809] [MU: 2.97/32142.28] 
	BookingRoute::calculateDistance
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 29082.157] [M: 32176.49] [ET: 0.786/29048.161] [MU: 6.32/32174.49] 
	SQL: 
                SELECT cities.cty_id as c2id, cities.cty_name as c2name, cities.cty_garage_address as c2address,
                    cities.cty_id as c4id, cities.cty_name as c4name, cities.cty_garage_address as c4address,
                        (distance * 2) as totalExtraDistance
                 FROM (SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<40
                     INNER JOIN route r1 ON route.rut_to_city_id=r1.rut_from_city_id AND r1.rut_active=1
                     INNER JOIN rate ON r1.rut_id=rate.rte_route_id AND rate.rte_status=1  AND rate.rte_vehicletype_id IN (3) GROUP BY route.rut_id HAVING count(*) >30
                   UNION
                     SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<600
                     INNER JOIN cities tc ON tc.cty_id=route.rut_to_city_id AND tc.cty_service_active=1 AND CalcDistance(cities.cty_lat, cities.cty_long, tc.cty_lat, tc.cty_long)<=route.rut_estm_distance						 
                     INNER JOIN cities_stats ON cities_stats.cts_cty_id = route.rut_to_city_id AND cities_stats.cts_vnd_cnt >= 2
                   UNION
                    SELECT cts_cty_id AS city, 0 AS distance
					FROM cities_stats WHERE 1 AND cities_stats.cts_cty_id= 30817 and cities_stats.cts_vnd_cnt>1) a
                    INNER JOIN cities ON cities.cty_id=a.city
                    ORDER BY totalExtraDistance LIMIT 1 
	 [params: []]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 29084.435] [M: 32191.3] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.255.12
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"3","tripDistance":"","tripDuration":"","multiCityData":"","bookingType":"1","pickupAddress":"","pickupDate":"24\/10\/2024","pickupTime":"04:00 AM","isGozonow":"0","minTripDistance":"0","sccId":"0","tripUser":"1","YII_CSRF_TOKEN":"N3VxRE1WeG9UeHk5UWFBUFpPT216eWVyY0xWTVpoTkcUoJ2aBoup1fU2M5E4ePVZVcUNlKiYZZysUqEklNiKWw==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=3&tripDistance=&tripDuration=&multiCityData=&bookingType=1&pickupAddress=&pickupDate=24%2F10%2F2024&pickupTime=04%3A00+AM&isGozonow=0&minTripDistance=0&sccId=0&tripUser=1&YII_CSRF_TOKEN=N3VxRE1WeG9UeHk5UWFBUFpPT216eWVyY0xWTVpoTkcUoJ2aBoup1fU2M5E4ePVZVcUNlKiYZZysUqEklNiKWw%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 29084.938] [M: 32210.87] [ET: 0.921/29050.963] [MU: 20.77/32210.76] 
	models.RouteRates.calculateDriverAllowance
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 29084.97] [M: 32212.55] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 29086.05] [M: 32226.01] [ET: 0.957/29052.061] [MU: 2.99/32223.51] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+10013),(IF((cpm_value_type=2),(10013+(10013*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30937 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30937) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-24 04:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=112 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 29087.753] [M: 32268.23] [ET: 3.778/29053.758] [MU: 78.59/32268.08] 
	RouteRates::calculate for CAB 112 2024-10-24 04:00:00 - Trip Type: 1 11600796
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 29087.967] [M: 32245.92] [ET: 40.885/29053.977] [MU: 304.31/32245.77] 
	Quote::calculateRules for CAB 112, From City Id: 30804, To city Id: 30711
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 29088.298] [M: 32217.55] [ET: 0.23/29054.32] [MU: 0.9/32217.3] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"112"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 29088.392] [M: 32219.74] [ET: 77.455/29054.399] [MU: 458.69/32219.65] 
	Quote For CabType: 112
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 29089.726] [M: 32230.09] [ET: 0.545/29055.735] [MU: 3.33/32229.65] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 29090.57] [M: 32235.9] [ET: 0.739/29056.568] [MU: 3.33/32235.46] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30711"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 29091.33] [M: 32238.84] [ET: 0.658/29057.345] [MU: 0.9/32238.59] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 29091.949] [M: 32271.2] [ET: 0.493/29057.957] [MU: 24.22/32269.7] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (100) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30711) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp756)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp759,:gp760)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp757,:gp758)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp761,:gp762))
			OR (scr_area_type = 5 AND scr_area_id IN (3699))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (113)
		ORDER BY rank DESC
		 
	 [params: {":gp756":"31",":gp757":"30804",":gp758":"30711",":gp759":"105",":gp760":"100",":gp761":"1",":gp762":"1","tripType":"1"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 29092.682] [M: 32251.38] [ET: 0.246/29058.704] [MU: 0.84/32251.2] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 29093.01] [M: 32254.23] [ET: 0.256/29059.032] [MU: 0.93/32253.91] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"6"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 29094.042] [M: 32267.06] [ET: 0.312/29060.062] [MU: 2.05/32266.56] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"113"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 29101.76] [M: 32276.4] [ET: 7.491/29067.735] [MU: 3.49/32275.52] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"113","fromCity":"30804","toCity":"30711"}]
2024/10/24 00:02:17 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 29103.011] [M: 32279.65] [ET: 0.578/29069.023] [MU: 0.86/32279.43] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":0}]
2024/10/24 00:02:30 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 88.898] [M: 10046.09] 
------------------------------------------------------module.admin.controller.booking.getamountbyvehicle ACTION START------------------------------------------------------
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.255.12
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"7","tripDistance":"","tripDuration":"","multiCityData":"","bookingType":"1","pickupAddress":"","pickupDate":"24\/10\/2024","pickupTime":"04:00 AM","isGozonow":"0","minTripDistance":"0","sccId":"0","tripUser":"1","YII_CSRF_TOKEN":"N3VxRE1WeG9UeHk5UWFBUFpPT216eWVyY0xWTVpoTkcUoJ2aBoup1fU2M5E4ePVZVcUNlKiYZZysUqEklNiKWw==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=7&tripDistance=&tripDuration=&multiCityData=&bookingType=1&pickupAddress=&pickupDate=24%2F10%2F2024&pickupTime=04%3A00+AM&isGozonow=0&minTripDistance=0&sccId=0&tripUser=1&YII_CSRF_TOKEN=N3VxRE1WeG9UeHk5UWFBUFpPT216eWVyY0xWTVpoTkcUoJ2aBoup1fU2M5E4ePVZVcUNlKiYZZysUqEklNiKWw%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/24 00:02:30 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 125.81] [M: 11282.29] setLocationRequest start
2024/10/24 00:02:30 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 213.389] [M: 11282.8] setLocationRequest ends
2024/10/24 00:02:30 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 295.626] [M: 18107.8] [ET: 9.272/272.047] [MU: 0.84/18107.62] 
	SQL: SELECT COUNT(1) as cnt FROM cities WHERE cty_active=1 AND cty_service_active=1 AND cty_id=30804 
	 [params: []]
2024/10/24 00:02:30 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 297.945] [M: 18109.1] [ET: 2.21/274.37] [MU: 0.84/18108.91] 
	SQL: SELECT COUNT(1) as cnt FROM cities WHERE cty_active=1 AND cty_service_active=1 AND cty_id=30711 
	 [params: []]
2024/10/24 00:02:30 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 338.739] [M: 18592.36] [ET: 40.716/315.182] [MU: 483.15/18592.25] 
	BookingRoute::calculateDistance
2024/10/24 00:02:30 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 339.152] [M: 18589.65] [ET: 0.202/315.603] [MU: 1.24/18589.54] 
	BookingRoute::calculateDistance
2024/10/24 00:02:30 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 339.205] [M: 18589.45] [ET: 88.604/315.657] [MU: 5974.33/18589.35] 
	validateRoutes
2024/10/24 00:02:30 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 341.822] [M: 18822.56] [ET: 0.796/318.247] [MU: 27.08/18822.34] 
	SQL: SELECT scv_id FROM svc_class_vhc_cat WHERE scv_active = 1 AND scv_scc_id IN (1,2,4,6) ORDER BY scv_vct_id ASC,scv_scc_id ASC 
	 [params: []]
2024/10/24 00:02:30 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 349.003] [M: 18808.58] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.Quote.getQuote START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.255.12
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"7","tripDistance":"","tripDuration":"","multiCityData":"","bookingType":"1","pickupAddress":"","pickupDate":"24\/10\/2024","pickupTime":"04:00 AM","isGozonow":"0","minTripDistance":"0","sccId":"0","tripUser":"1","YII_CSRF_TOKEN":"N3VxRE1WeG9UeHk5UWFBUFpPT216eWVyY0xWTVpoTkcUoJ2aBoup1fU2M5E4ePVZVcUNlKiYZZysUqEklNiKWw==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=7&tripDistance=&tripDuration=&multiCityData=&bookingType=1&pickupAddress=&pickupDate=24%2F10%2F2024&pickupTime=04%3A00+AM&isGozonow=0&minTripDistance=0&sccId=0&tripUser=1&YII_CSRF_TOKEN=N3VxRE1WeG9UeHk5UWFBUFpPT216eWVyY0xWTVpoTkcUoJ2aBoup1fU2M5E4ePVZVcUNlKiYZZysUqEklNiKWw%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/24 00:02:30 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 351.627] [M: 18937.21] [ET: 0.395/328.062] [MU: 8.84/18936.77] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:30 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 352.248] [M: 18942.16] [ET: 0.538/328.694] [MU: 3.33/18941.72] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30711"}]
2024/10/24 00:02:30 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 352.908] [M: 18944.2] [ET: 0.579/329.334] [MU: 0.9/18943.98] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/24 00:02:30 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 354.983] [M: 18995.36] [ET: 1.916/331.397] [MU: 43.61/18993.86] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (100) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30711) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp0)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp3,:gp4)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp1,:gp2)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp5,:gp6))
			OR (scr_area_type = 5 AND scr_area_id IN (3699))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (7)
		ORDER BY rank DESC
		 
	 [params: {":gp0":"31",":gp1":"30804",":gp2":"30711",":gp3":"105",":gp4":"100",":gp5":"1",":gp6":"1","tripType":"1"}]
2024/10/24 00:02:30 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 399.589] [M: 19045.74] [ET: 24.635/376.022] [MU: 0.84/19045.55] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/24 00:02:30 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 400.371] [M: 19048.03] [ET: 0.664/376.786] [MU: 0.96/19047.72] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"1"}]
2024/10/24 00:02:30 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 426.268] [M: 19498.54] [ET: 3.766/402.682] [MU: 3.82/19497.66] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"7","fromCity":"30804","toCity":"30711"}]
2024/10/24 00:02:30 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 429.725] [M: 19663.49] [ET: 0.736/406.158] [MU: 0.87/19663.27] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":0}]
2024/10/24 00:02:30 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 431.95] [M: 19785.63] [ET: 0.583/408.392] [MU: 2.97/19785.19] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:30 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 432.67] [M: 19814.46] [ET: 0.577/409.079] [MU: 22.74/19813.84] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp8)) OR (apr_area_type = 2 AND apr_area_id IN (:gp9)) OR (apr_area_type = 4 AND apr_area_id IN (:gp10)) OR (apr_area_type = 1 AND apr_area_id IN (:gp7))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp7":"31",":gp8":"30804",":gp9":"105",":gp10":"1","cab":"7"}]
2024/10/24 00:02:30 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 479.203] [M: 19896.05] [ET: 31.487/455.591] [MU: 0.74/19888.05] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"nearest_route_30804_30711","sql":"(INDEX indx_nearest_rt_rutid (rut_id)) \r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, routeFrom.rut_name as fromAlias, \r\n\t\t\t\tNULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, \r\n\t\t\t\t0 as rank, routeFrom.rut_estm_time as startTime, 0 as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 \r\n\t\t\t\tAND routeFrom.rut_from_city_id<>routeFrom.rut_to_city_id AND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\t\tAND (routeAlias.rut_to_city_id=route.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, NULL, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) \r\n\t\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\t0 AS extraStartDistance, 0, 0 as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND route.rut_from_city_id = 30804 AND route.rut_to_city_id=30711 \r\n\t\t\t\tAND routeTo.rut_from_city_id=30711\r\n\t\t\t\tAND route.rut_active = 1 AND routeTo.rut_active = 1 AND routeTo.rut_estm_distance < 50 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = route.rut_from_city_id) \r\n\t\t\t   AND (routeAlias.rut_to_city_id = routeTo.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, \r\n\t\t\t\trouteFrom.rut_name, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t+ IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) \r\n\t\t\t\tAS extraDistance, IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, 0, \r\n\t\t\t\trouteFrom.rut_estm_time as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 AND routeFrom.rut_from_city_id <> routeFrom.rut_to_city_id\r\n\t\t\t\t\tAND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND routeTo.rut_estm_distance < 50 \r\n\t\t\t\t\tAND routeTo.rut_from_city_id=30711 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\tAND (routeAlias.rut_to_city_id=routeTo.rut_to_city_id) AND routeAlias.rut_active = 1 AND routeAlias.rut_from_city_id=30804  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)"}]
2024/10/24 00:02:30 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 481.394] [M: 19900.74] [ET: 2.091/457.822] [MU: 2.78/19900.3] 
	SQL: SELECT *, (rte_vendor_amount + extraDistance * 26) as totalCost FROM (SELECT * FROM nearest_route_30804_30711) a
					INNER JOIN rate ON a.rut_id = rate.rte_route_id AND rte_status=1 AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <>0
					WHERE 1 ORDER BY rank DESC, totalCost ASC LIMIT 0,1 
	 [params: {"cabType":"7"}]
2024/10/24 00:02:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 9318.193] [M: 19908.77] [ET: 8836.688/9294.624] [MU: 0.74/19906.77] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"getNearestRoute_30804_30711_70","sql":"(INDEX getNearestRoute_30804_30711_70_index_rut_id (rut_id))\r\n\t\t\t\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id AS start, routeAlias.rut_to_city_id AS end,\r\n\t\t\t\t\t\t\t\trouteFrom.rut_name AS fromAlias, NULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance AS quotedDistance,\r\n\t\t\t\t\t\t\t\trouteAlias.rut_estm_distance AS rateDistance, \r\n\t\t\t\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance)\r\n\t\t\t\t\t\t\t\t\t - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance,\r\n\t\t\t\t\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance,\r\n\t\t\t\t\t\t\t\t0 AS rank, routeFrom.rut_estm_time AS startTime, 0 AS endTime, route.rut_estm_time, \r\n\t\t\t\t\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraTravelDistance\r\n\t\t\t\t\t\tFROM   route\r\n\t\t\t\t\t\tINNER JOIN route routeTo ON routeTo.rut_to_city_id=route.rut_from_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_from_city_id=30804 AND routeTo.rut_active=1\r\n\t\t\t\t\t\t\t\tAND routeTo.rut_estm_distance<70 AND route.rut_active=1\r\n\t\t\t\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_from_city_id=route.rut_to_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_active = 1\r\n\t\t\t\t\t\t\t\tAND routeFrom.rut_estm_distance<70 AND route.rut_active = 1\r\n\t\t\t\t\t\tINNER JOIN route routeAlias ON routeAlias.rut_to_city_id=routeFrom.rut_to_city_id\r\n\t\t\t\t\t\t\tAND routeAlias.rut_from_city_id=routeTo.rut_from_city_id AND routeAlias.rut_active = 1"}]
2024/10/24 00:02:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 9325.182] [M: 19914.08] [ET: 6.89/9301.618] [MU: 2.47/19913.45] 
	SQL: SELECT *, (rte_vendor_amount + extradistance * 26 ) AS totalCost, 
						ABS(quotedDistance-rateDistance) AS extraChargeableDistance
					FROM getNearestRoute_30804_30711_70 a
					INNER JOIN rate ON a.rut_id=rate.rte_route_id AND rte_status=1 
						AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <> 0
					WHERE  1
					ORDER  BY rank DESC, extraStartDistance, extraChargeableDistance ASC, totalcost ASC
					LIMIT  0, 1 
	 [params: {"cabType":"7"}]
2024/10/24 00:02:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 9334.566] [M: 19922.3] [ET: 8912.299/9310.993] [MU: 432/19922.14] 
	Quote::calculateOneWay  for CAB 7 Date: 2024-10-24 04:00:00
2024/10/24 00:02:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 9403.09] [M: 19927.02] [ET: 68.377/9379.509] [MU: 2.14/19926.77] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/24 00:02:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 9407.123] [M: 19939.41] [ET: 0.737/9383.549] [MU: 3.02/19938.98] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 9407.928] [M: 19968.95] [ET: 0.649/9384.361] [MU: 23.03/19968.2] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp13)) OR (apr_area_type = 5 AND apr_area_id IN (:gp11)) OR (apr_area_type = 2 AND apr_area_id IN (:gp14)) OR (apr_area_type = 4 AND apr_area_id IN (:gp15)) OR (apr_area_type = 1 AND apr_area_id IN (:gp12))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp11":"3699",":gp12":"31",":gp13":"30804",":gp14":"105",":gp15":"1","cab":"7"}]
2024/10/24 00:02:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 9409.115] [M: 19953.19] [ET: 0.368/9385.539] [MU: 2.98/19953.08] 
	BookingRoute::calculateDistance
2024/10/24 00:02:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 9457.358] [M: 20014.68] [ET: 2.8/9433.772] [MU: 2.65/20014.05] 
	SQL: SELECT 
						fc.cty_id as c2id, 
						fc.cty_name as c2name, 
						fc.cty_garage_address as c2address,
						tc.cty_id as c4id,
						tc.cty_name as c4name, tc.cty_garage_address as c4address,
						0 as totalExtraDistance FROM route
						INNER JOIN cities fc ON rut_from_city_id=fc.cty_id
						INNER JOIN cities tc ON rut_to_city_id=tc.cty_id
						INNER JOIN rate on  rate.rte_route_id=route.rut_id  AND rate.rte_vehicletype_id IN (7)
						WHERE route.rut_from_city_id=30804 AND route.rut_to_city_id=30711 AND route.rut_active=1 
	 [params: []]
2024/10/24 00:02:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 9556.254] [M: 20027.95] [ET: 98.75/9532.667] [MU: 5.92/20025.95] 
	SQL: 
				SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address, tc.cty_id as c4id, 
				tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
					FROM
					 (
						(
							SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id,  
								r3.rut_to_city_id, route.rut_name , route.rut_id,
								(route.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, 
								r3.rut_estm_distance
							FROM route
							INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_from_city_id=30804  
									AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=route.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) 
									AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (7)
						)
						UNION
						(
							SELECT r3.rut_id, r3.rut_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,(route.rut_estm_distance + r1.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
							FROM route
							INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND  route.rut_to_city_id=30711 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND route.rut_to_city_id=r3.rut_to_city_id))	AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (7)
						)
                     ) a
					INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
					INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1 
	 [params: []]
2024/10/24 00:02:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 9588.458] [M: 20037.84] [ET: 32.067/9564.873] [MU: 4.42/20036.34] 
	SQL: SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
                              tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
                        FROM (SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,
                                    (route.rut_estm_distance + r1.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
                                FROM route
								INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
								INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
								INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) AND r3.rut_active=1 
								INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (7) LIMIT 1
							)a
                        INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
                        INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1
                         
	 [params: []]
2024/10/24 00:02:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 10099.287] [M: 20044.21] [ET: 510.676/10075.721] [MU: 0.74/20043.34] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"GarageRoute_30804_30711","sql":" (INDEX GarageRoute_30804_30711_index_rut_id (rut_id), INDEX GarageRoute_30804_30711_index_rut_from_city_id (rut_from_city_id), INDEX GarageRoute_30804_30711_index_rut_to_city_id (rut_to_city_id))\r\n\t\t\t\t\t\t\tSELECT route.rut_id, route.rut_from_city_id, route.rut_to_city_id, route.rut_name, rut_estm_distance FROM route \r\n\t\t\t\t\t\t\tINNER JOIN cities_stats   ON cities_stats.cts_cty_id = route.rut_from_city_id\r\n\t\t\t\t\t\t\tAND rut_estm_distance < 300\r\n\t\t\t\t\t\t\tAND rut_active = 1\r\n\t\t\t\t\t\t\tAND route.rut_to_city_id=30804\r\n\t\t\t\t\t\t\tAND cities_stats.cts_vnd_cnt >= 3\r\n\t\t\t\t\t\t\tORDER BY rut_estm_distance LIMIT 10"}]
2024/10/24 00:02:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 10144.404] [M: 20056.02] [ET: 45.007/10120.818] [MU: 6.57/20054.27] 
	SQL: SELECT a.*, fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
								tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address 
						FROM ((SELECT xyz.rut_from_city_id as startCity, r1.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r3.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_from_city_id
							INNER JOIN rate ON rate.rte_route_id=r1.rut_id  AND rate.rte_vehicletype_id IN (7)
							INNER JOIN route r2 ON r2.rut_to_city_id=r1.rut_to_city_id AND r2.rut_from_city_id=:dropCity AND r2.rut_active=1
							INNER JOIN route r3 ON r3.rut_from_city_id=xyz.rut_to_city_id AND r3.rut_to_city_id=r2.rut_from_city_id AND r3.rut_active=1
							ORDER BY ExtraDistance LIMIT 1
							)
							UNION
							(
							SELECT xyz.rut_from_city_id as startCity, r2.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r2.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_to_city_id AND r1.rut_to_city_id=:dropCity
							INNER JOIN route r2 ON r2.rut_to_city_id=xyz.rut_from_city_id AND r2.rut_from_city_id=r1.rut_to_city_id
							ORDER BY ExtraDistance ASC LIMIT 1
							)) a
						INNER JOIN cities fc ON startCity=fc.cty_id
						INNER JOIN cities tc ON endCity=tc.cty_id 
						ORDER BY ExtraDistance 
	 [params: {"pickupCity":"30804","dropCity":"30711"}]
2024/10/24 00:02:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 10228.431] [M: 20066.99] [ET: 81.723/10204.853] [MU: 7.95/20066.88] 
	BookingRoute::calculateDistance
2024/10/24 00:02:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 10256.22] [M: 20072.13] [ET: 27.611/10232.641] [MU: 7.89/20072.02] 
	BookingRoute::calculateDistance
2024/10/24 00:02:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 10272.398] [M: 20088.16] [ET: 15.092/10248.816] [MU: 0.99/20087.79] 
	SQL: SELECT cts_airport_pickup_entry_fee
               FROM   cities
               INNER JOIN cities_stats
               ON cities.cty_id = cities_stats.cts_cty_id
               WHERE  cty_id = :cityId
               AND cty_is_airport = 1 AND cty_active = 1 
	 [params: {"cityId":"30804"}]
2024/10/24 00:02:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 10274.801] [M: 20102.08] [ET: 1.43/10251.22] [MU: 8.13/20101.97] 
	BookingRoute::calculateDistance
2024/10/24 00:02:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 10276.04] [M: 20109.82] [ET: 1.075/10252.487] [MU: 8.07/20109.71] 
	BookingRoute::calculateDistance
2024/10/24 00:02:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 10296.728] [M: 20109.16] [ET: 20.594/10273.163] [MU: 0.9/20108.91] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/24 00:02:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 10298.056] [M: 20121.5] [ET: 0.652/10274.489] [MU: 2.97/20121.06] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 10298.85] [M: 20151.04] [ET: 0.676/10275.29] [MU: 23.02/20150.29] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp18)) OR (apr_area_type = 5 AND apr_area_id IN (:gp16)) OR (apr_area_type = 2 AND apr_area_id IN (:gp19)) OR (apr_area_type = 4 AND apr_area_id IN (:gp20)) OR (apr_area_type = 1 AND apr_area_id IN (:gp17))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp16":"3699",":gp17":"31",":gp18":"30804",":gp19":"105",":gp20":"1","cab":"7"}]
2024/10/24 00:02:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 10300.166] [M: 20137.31] [ET: 0.348/10276.6] [MU: 2.98/20137.2] 
	BookingRoute::calculateDistance
2024/10/24 00:02:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 10302.11] [M: 20150.34] [ET: 0.365/10278.544] [MU: 2.99/20150.23] 
	BookingRoute::calculateDistance
2024/10/24 00:02:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 10302.687] [M: 20154.41] [ET: 0.465/10279.119] [MU: 2.98/20154.3] 
	BookingRoute::calculateDistance
2024/10/24 00:02:42 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 11630.993] [M: 20189.77] [ET: 1306.811/11607.407] [MU: 6.32/20187.77] 
	SQL: 
                SELECT cities.cty_id as c2id, cities.cty_name as c2name, cities.cty_garage_address as c2address,
                    cities.cty_id as c4id, cities.cty_name as c4name, cities.cty_garage_address as c4address,
                        (distance * 2) as totalExtraDistance
                 FROM (SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<40
                     INNER JOIN route r1 ON route.rut_to_city_id=r1.rut_from_city_id AND r1.rut_active=1
                     INNER JOIN rate ON r1.rut_id=rate.rte_route_id AND rate.rte_status=1  AND rate.rte_vehicletype_id IN (7) GROUP BY route.rut_id HAVING count(*) >30
                   UNION
                     SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<600
                     INNER JOIN cities tc ON tc.cty_id=route.rut_to_city_id AND tc.cty_service_active=1 AND CalcDistance(cities.cty_lat, cities.cty_long, tc.cty_lat, tc.cty_long)<=route.rut_estm_distance						 
                     INNER JOIN cities_stats ON cities_stats.cts_cty_id = route.rut_to_city_id AND cities_stats.cts_vnd_cnt >= 2
                   UNION
                    SELECT cts_cty_id AS city, 0 AS distance
					FROM cities_stats WHERE 1 AND cities_stats.cts_cty_id= 30817 and cities_stats.cts_vnd_cnt>1) a
                    INNER JOIN cities ON cities.cty_id=a.city
                    ORDER BY totalExtraDistance LIMIT 1 
	 [params: []]
2024/10/24 00:02:42 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 11633.916] [M: 20204.3] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.255.12
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"7","tripDistance":"","tripDuration":"","multiCityData":"","bookingType":"1","pickupAddress":"","pickupDate":"24\/10\/2024","pickupTime":"04:00 AM","isGozonow":"0","minTripDistance":"0","sccId":"0","tripUser":"1","YII_CSRF_TOKEN":"N3VxRE1WeG9UeHk5UWFBUFpPT216eWVyY0xWTVpoTkcUoJ2aBoup1fU2M5E4ePVZVcUNlKiYZZysUqEklNiKWw==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=7&tripDistance=&tripDuration=&multiCityData=&bookingType=1&pickupAddress=&pickupDate=24%2F10%2F2024&pickupTime=04%3A00+AM&isGozonow=0&minTripDistance=0&sccId=0&tripUser=1&YII_CSRF_TOKEN=N3VxRE1WeG9UeHk5UWFBUFpPT216eWVyY0xWTVpoTkcUoJ2aBoup1fU2M5E4ePVZVcUNlKiYZZysUqEklNiKWw%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/24 00:02:42 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 11634.474] [M: 20223.87] [ET: 1.1/11610.91] [MU: 20.77/20223.76] 
	models.RouteRates.calculateDriverAllowance
2024/10/24 00:02:42 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 11634.525] [M: 20225.55] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/24 00:02:42 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 11659.533] [M: 20308.82] [ET: 23.549/11635.962] [MU: 3.19/20306.32] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+30790),(IF((cpm_value_type=2),(30790+(30790*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30817 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30817 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30817) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30817) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-24 04:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=7 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/24 00:02:42 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 11697.167] [M: 21663.8] [ET: 63.89/11673.61] [MU: 1461.16/21663.65] 
	RouteRates::calculate for CAB 7 2024-10-24 04:00:00 - Trip Type: 1 984871673
2024/10/24 00:02:42 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 11697.321] [M: 21641.48] [ET: 2362.669/11673.773] [MU: 1717.73/21641.32] 
	Quote::calculateRules for CAB 7, From City Id: 30804, To city Id: 30711
2024/10/24 00:02:42 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 11697.654] [M: 21614.07] [ET: 0.24/11674.082] [MU: 0.9/21613.82] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"7"}]
2024/10/24 00:02:42 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 11697.769] [M: 21615.35] [ET: 11348.666/11674.205] [MU: 2804.28/21615.26] 
	Quote For CabType: 7
2024/10/24 00:02:42 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 11730.501] [M: 21657.41] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.QuotesDataCreated.setData START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.255.12
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"7","tripDistance":"","tripDuration":"","multiCityData":"","bookingType":"1","pickupAddress":"","pickupDate":"24\/10\/2024","pickupTime":"04:00 AM","isGozonow":"0","minTripDistance":"0","sccId":"0","tripUser":"1","YII_CSRF_TOKEN":"N3VxRE1WeG9UeHk5UWFBUFpPT216eWVyY0xWTVpoTkcUoJ2aBoup1fU2M5E4ePVZVcUNlKiYZZysUqEklNiKWw==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=7&tripDistance=&tripDuration=&multiCityData=&bookingType=1&pickupAddress=&pickupDate=24%2F10%2F2024&pickupTime=04%3A00+AM&isGozonow=0&minTripDistance=0&sccId=0&tripUser=1&YII_CSRF_TOKEN=N3VxRE1WeG9UeHk5UWFBUFpPT216eWVyY0xWTVpoTkcUoJ2aBoup1fU2M5E4ePVZVcUNlKiYZZysUqEklNiKWw%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/24 00:02:42 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 11837.423] [M: 21739.39] [ET: 28.075/11813.838] [MU: 15.61/21739.28] 
	QuotesDataPickup::setData for CAB Array
2024/10/24 00:02:42 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 11837.57] [M: 21734.97] [ET: 107.549/11813.996] [MU: 78.76/21734.86] 
	models.QuotesDataCreated.setData
2024/10/24 00:02:42 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 11837.627] [M: 21736.65] 
============================================================Profile models.QuotesDataCreated.setData DONE==================================================
2024/10/24 00:02:42 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 11837.793] [M: 21733.05] [ET: 11489.13/11814.218] [MU: 2924.44/21732.95] 
	models.Quote.getQuote
2024/10/24 00:02:42 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 11837.982] [M: 21736.54] 
============================================================Profile models.Quote.getQuote DONE==================================================
2024/10/24 00:02:42 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 11945.646] [M: 22415.32] [ET: 0.545/11922.086] [MU: 1.03/22414.95] 
	SQL: SELECT GROUP_CONCAT(zones.zon_id) as zones FROM cities c1
					INNER JOIN zone_cities ON zone_cities.zct_cty_id = c1.cty_id AND zct_active=1
					INNER JOIN zones ON zone_cities.zct_zon_id = zones.zon_id AND zon_active=1
					WHERE c1.cty_id = 30804 
	 [params: []]
2024/10/24 00:02:42 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 11948.612] [M: 22418.38] [ET: 0.731/11925.032] [MU: 1.02/22418] 
	SQL: SELECT GROUP_CONCAT(zones.zon_id) as zones FROM cities c1
					INNER JOIN zone_cities ON zone_cities.zct_cty_id = c1.cty_id AND zct_active=1
					INNER JOIN zones ON zone_cities.zct_zon_id = zones.zon_id AND zon_active=1
					WHERE c1.cty_id = 30711 
	 [params: []]
2024/10/24 00:02:42 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 11956.598] [M: 22423.67] [ET: 6.012/11933.019] [MU: 1.98/22423.3] 
	SQL: SELECT dzs_zone_type FROM dynamic_zone_surge WHERE dzs_fromzoneid IN (:gp21) AND dzs_tozoneid IN (:gp22,:gp23) AND dzs_scv_id=:cab AND dzs_booking_type=:tripType  ORDER BY  dzs_zone_type ASC 
	 [params: {":gp22":"238",":gp23":"79",":gp21":"31","cab":7,"tripType":"1"}]
2024/10/24 00:02:42 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 11980.236] [M: 22426.58] [ET: 23.043/11956.673] [MU: 1.25/22425.95] 
	SQL: SELECT prc_cancel_rule_id FROM `partner_cancel_rule` 
			WHERE (prc_zone_category = :zoneType OR prc_zone_category IS NULL)
		AND (prc_scc_id = :sccId OR prc_scc_id IS NULL)
		AND (prc_partner_id = :partnerId OR prc_partner_id IS NULL) 
		AND (prc_bkg_type = :tripType OR prc_bkg_type IS NULL) 
		 AND (prc_is_gozonow IS NULL) 
		AND prc_active=1  
		ORDER BY prc_partner_id DESC, prc_bkg_type DESC  
	 [params: {"zoneType":1,"sccId":"1","partnerId":null,"tripType":"1"}]
2024/10/24 00:02:42 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 12011.166] [M: 22484.9] [ET: 0.524/11987.61] [MU: 3.01/22484.46] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:42 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 12013.621] [M: 22491.48] [ET: 1.768/11990.058] [MU: 2.34/22491.1] 
	SQL: SELECT dzs_zone_type FROM dynamic_zone_surge WHERE dzs_fromzoneid IN (:gp24) AND dzs_tozoneid IN (:gp25,:gp26) AND dzs_scv_id=:cab AND dzs_booking_type=:tripType  ORDER BY  dzs_zone_type ASC 
	 [params: {":gp25":"238",":gp26":"79",":gp24":"31","cab":7,"tripType":"1"}]
2024/10/24 00:02:42 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 12034.962] [M: 22521.41] [ET: 21.201/12011.373] [MU: 25.14/22520.16] 
	SQL: SELECT addon_cancellation_policy.*,
								CASE
											WHEN acp_area_type=1 AND acp_area_id IN (31) THEN 5
											WHEN acp_area_type=2 AND acp_area_id IN (105) THEN 15
											WHEN acp_area_type=3 AND acp_area_id IN (30804) THEN 20
											WHEN acp_area_type=4 AND acp_area_id IN (1) THEN 1
											WHEN acp_area_type=5 AND acp_area_id IN (-1) THEN 10
											ELSE 0
											END AS rank FROM addon_cancellation_policy
						WHERE (
								(acp_area_type = 1 AND acp_area_id IN (:gp27))
								OR (acp_area_type = 2 AND acp_area_id IN (:gp29))
								OR (acp_area_type = 3 AND acp_area_id IN (:gp28))
								OR (acp_area_type = 4 AND acp_area_id IN (:gp30))
								OR (acp_area_type = 5 AND acp_area_id IN (-1))
								OR acp_area_type IS NULL)
							AND acp_cr_from = :defCanRuleId AND acp_active=1 AND acp_is_allowed = 1
						ORDER BY rank DESC 
	 [params: {":gp27":"31",":gp28":"30804",":gp29":"105",":gp30":"1","defCanRuleId":"4"}]
2024/10/24 00:02:42 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 12068.291] [M: 22518.24] [ET: 3.839/12044.707] [MU: 2.6/22518.05] 
	SQL: SELECT acp_cr_to,acp_margin_data FROM `addon_cancellation_policy` WHERE `acp_id` = :id 
	 [params: {"id":"8"}]
2024/10/24 00:02:42 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 12157.434] [M: 22555.48] [ET: 0.476/12133.849] [MU: 1.42/22555.29] 
	SQL: SELECT acp_cr_to,acp_margin_data FROM `addon_cancellation_policy` WHERE `acp_id` = :id 
	 [params: {"id":"9"}]
2024/10/24 00:02:42 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 12201.5] [M: 22643.52] [ET: 0.518/12177.926] [MU: 3.01/22643.08] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/24 00:02:42 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 12205.982] [M: 22649.97] [ET: 2.243/12182.419] [MU: 2.35/22649.59] 
	SQL: SELECT dzs_zone_type FROM dynamic_zone_surge WHERE dzs_fromzoneid IN (:gp31) AND dzs_tozoneid IN (:gp32,:gp33) AND dzs_scv_id=:cab AND dzs_booking_type=:tripType  ORDER BY  dzs_zone_type ASC 
	 [params: {":gp32":"238",":gp33":"79",":gp31":"31","cab":7,"tripType":"1"}]
2024/10/24 00:02:42 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 12222.16] [M: 22677.05] [ET: 16.055/12198.593] [MU: 22.67/22676.05] 
	SQL: SELECT addon_cab_models.*,
								CASE
											WHEN acm_area_type=1 AND acm_area_id IN (31) THEN 5
											WHEN acm_area_type=2 AND acm_area_id IN (105) THEN 15
											WHEN acm_area_type=3 AND acm_area_id IN (30804) THEN 20
											WHEN acm_area_type=4 AND acm_area_id IN (1) THEN 1
											WHEN acm_area_type=5 AND acm_area_id IN (-1) THEN 10
											ELSE 0
											END AS rank FROM addon_cab_models
						WHERE (
								(acm_area_type = 1 AND acm_area_id IN (:gp34))
								OR (acm_area_type = 2 AND acm_area_id IN (:gp36))
								OR (acm_area_type = 3 AND acm_area_id IN (:gp35))
								OR (acm_area_type = 4 AND acm_area_id IN (:gp37))
								OR (acm_area_type = 5 AND acm_area_id IN (-1))
								OR acm_area_type IS NULL)
							AND acm_scv_id_from = :svcId AND acm_active=1
						ORDER BY rank DESC 
	 [params: {":gp34":"31",":gp35":"30804",":gp36":"105",":gp37":"1","svcId":7}]
2024/10/24 00:02:42 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 12284.451] [M: 22971.11] [ET: 12.215/12260.881] [MU: 23.68/22969.86] 
	SQL:  SELECT scv_id,scc_id, vct_id, scc_cancel_rule, scc_label,scc_rank, scv_label, scv_code, scc_model_year, 
								CONCAT(vct_label, ' (', scc_label , ')') label,
									vct_label,vct_rank, vct_desc, CONCAT(vct_label, ' ', vct_desc) vhcName, 
									vct_capacity, IF(vct_image IS NULL, 'images/cabs/no-image.png', vct_image) as vct_image, vct_big_bag_capacity, vct_small_bag_capacity, vcsc_small_bag, FLOOR(vcsc_small_bag/2) AS big_bag,
									scc_is_cng, scc_is_petrol_diesel, scc_id, scc_desc, IF( vct_id IN(5, 6), '1', '0' ) AS is_assured, scv_vct_id,scv_parent_id,scv_vct_id,scv_model,scv_scc_id
						FROM svc_class_vhc_cat
						INNER JOIN service_class ON scc_id = scv_scc_id
						INNER JOIN vehicle_category ON vct_id = scv_vct_id
						INNER JOIN vehicle_cat_svc_class on vcsc_ssc_id = scv_scc_id AND vcsc_vct_id = scv_vct_id
						WHERE scv_active = 1 
							AND scc_active = 1 
						AND vct_active = 1
		 AND scv_vct_id = 7 
	 [params: []]
2024/10/24 00:02:42 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 12316.271] [M: 22952.16] [ET: 12227.307/12292.714] [MU: 12903.6/22952.04] 
	module.admin.controller.booking.getamountbyvehicle
2024/10/24 00:02:42 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 12316.309] [M: 22952.81] 
*******************************************************module.admin.controller.booking.getamountbyvehicle ACTION DONE****************************************************************
