2024/09/10 00:26:58 [profile] [profile.module.admin.controller.booking.create] [T: 134.416] [M: 9524.02] 
------------------------------------------------------module.admin.controller.booking.create ACTION START------------------------------------------------------
	URL: [GET]/aaohome/booking/create
	User IP: 192.168.176.12
	Referrer: http://localhost:84/aaohome/index/dashboard
	[UserID: 30] [UserType: 4]
2024/09/10 00:26:58 [profile] [profile.module.admin.controller.booking.create] [T: 164.473] [M: 10760.55] setLocationRequest start
2024/09/10 00:26:58 [profile] [profile.module.admin.controller.booking.create] [T: 246.202] [M: 10761.06] setLocationRequest ends
2024/09/10 00:26:58 [profile] [profile.module.admin.controller.booking.create] [T: 675.837] [M: 20773.37] [ET: 0.609/636.524] [MU: 1.99/20771.87] 
	SQL: SELECT  teams.tea_id 
					FROM   admins adm
					LEFT JOIN `admin_profiles` adp ON adp.adp_adm_id = adm.adm_id
					LEFT JOIN
					(
						SELECT 
						admin_profiles.adp_adm_id,
						JSON_UNQUOTE(JSON_EXTRACT(admin_profiles.adp_cdt_id, CONCAT('$[', pseudo_rows.row, '].cdtWeight'))) AS cdtWeight,
						JSON_UNQUOTE(JSON_EXTRACT(admin_profiles.adp_cdt_id, CONCAT('$[', pseudo_rows.row, '].cdtId'))) AS cdtId
						FROM admin_profiles
						JOIN pseudo_rows
						WHERE 1 AND  adp_adm_id = :admId
						HAVING cdtId IS NOT NULL
					) temp ON temp.adp_adm_id=adp.adp_adm_id
					LEFT JOIN `cat_depart_team_map` cdt  ON temp.cdtId=cdt.cdt_id
					LEFT JOIN teams ON cdt.cdt_tea_id = teams.tea_id								   
					WHERE  adm_id = :admId
					AND
					( 
						(tea_start_time IS NULL AND tea_stop_time IS NULL)
							OR           
						(tea_start_time < tea_stop_time AND CURRENT_TIME() BETWEEN tea_start_time AND tea_stop_time)
							OR
						(tea_stop_time < tea_start_time AND CURRENT_TIME() < tea_start_time AND CURRENT_TIME() < tea_stop_time)
							OR
						(tea_stop_time < tea_start_time AND CURRENT_TIME() > tea_start_time)
					)
					ORDER BY temp.cdtWeight  ASC LIMIT 0,1 
	 [params: {"admId":"30"}]
2024/09/10 00:26:58 [profile] [profile.module.admin.controller.booking.create] [T: 676.245] [M: 20774.44] [ET: 0.332/636.936] [MU: 1.19/20774] 
	SQL: SELECT  COUNT(*) as active_cbr_count_byId FROM `service_call_queue`
					WHERE 1 AND scq_status IN (1,3) AND scq_follow_up_queue_type=9
					AND scq_create_date >='2021-01-01 00:00:00'
					AND scq_active=1
				    AND scq_follow_up_date_time  < DATE_ADD(NOW(),INTERVAL 24 HOUR) AND scq_to_be_followed_up_by_id = :team_id 
	 [params: {"team_id":null}]
2024/09/10 00:26:58 [profile] [profile.module.admin.controller.booking.create] [T: 676.679] [M: 20776.45] [ET: 0.34/637.376] [MU: 1.15/20775.95] 
	SQL: SELECT  COUNT(*) as active_cbr_count_byId FROM `service_call_queue`
					WHERE 1 AND scq_status IN (1,3)  AND scq_follow_up_queue_type=9
					 AND scq_create_date >='2021-01-01 00:00:00'
					 AND scq_active=1
				   AND scq_follow_up_date_time  < DATE_ADD(NOW(),INTERVAL 24 HOUR) AND scq_to_be_followed_up_by_id = :adm_id AND scq_to_be_followed_up_by_type=2 
	 [params: {"adm_id":"30"}]
2024/09/10 00:26:58 [profile] [profile.module.admin.controller.booking.create] [T: 696.466] [M: 21116.45] [ET: 2.188/657.059] [MU: 2/21115.2] 
	SQL: SELECT cdt.cdt_id
			FROM admins adm
			LEFT JOIN `admin_profiles` adp ON adp.adp_adm_id = adm.adm_id
			LEFT JOIN
			(
				SELECT 
				admin_profiles.adp_adm_id,
				JSON_UNQUOTE(JSON_EXTRACT(admin_profiles.adp_cdt_id, CONCAT('$[', pseudo_rows.row, '].cdtWeight'))) AS cdtWeight,
				JSON_UNQUOTE(JSON_EXTRACT(admin_profiles.adp_cdt_id, CONCAT('$[', pseudo_rows.row, '].cdtId'))) AS cdtId
				FROM admin_profiles
				JOIN pseudo_rows
				WHERE 1
				HAVING cdtId IS NOT NULL
			) temp ON temp.adp_adm_id=adp.adp_adm_id
			LEFT JOIN `cat_depart_team_map` cdt  ON temp.cdtId=cdt.cdt_id
			LEFT JOIN teams ON cdt.cdt_tea_id = teams.tea_id
			WHERE cdt.cdt_id IN (:gp0)
			AND
			(
				(tea_start_time IS NULL AND tea_stop_time IS NULL)
				OR
				(tea_start_time < tea_stop_time AND CURRENT_TIME() BETWEEN tea_start_time AND tea_stop_time)
				OR
				(tea_stop_time < tea_start_time AND CURRENT_TIME() < tea_start_time AND CURRENT_TIME() < tea_stop_time)
				OR
				(tea_stop_time < tea_start_time AND CURRENT_TIME() > tea_start_time)
			)
			ORDER BY temp.cdtWeight ASC LIMIT 0,1 
	 [params: {":gp0":"1"}]
2024/09/10 00:26:59 [profile] [profile.module.admin.controller.booking.create] [T: 881.811] [M: 21479.13] [ET: 747.254/842.472] [MU: 11953.54/21479.02] 
	module.admin.controller.booking.create
2024/09/10 00:26:59 [profile] [profile.module.admin.controller.booking.create] [T: 881.865] [M: 21479.27] 
*******************************************************module.admin.controller.booking.create ACTION DONE****************************************************************
2024/09/10 00:28:24 [profile] [profile.module.admin.controller.booking.create] [T: 94.925] [M: 9523.98] 
------------------------------------------------------module.admin.controller.booking.create ACTION START------------------------------------------------------
	URL: [GET]/aaohome/booking/create
	User IP: 192.168.176.12
	Referrer: http://localhost:84/aaohome/vendor/add
	[UserID: 30] [UserType: 4]
2024/09/10 00:28:24 [profile] [profile.module.admin.controller.booking.create] [T: 130.538] [M: 10760.52] setLocationRequest start
2024/09/10 00:28:24 [profile] [profile.module.admin.controller.booking.create] [T: 211.597] [M: 10761.03] setLocationRequest ends
2024/09/10 00:28:24 [profile] [profile.module.admin.controller.booking.create] [T: 342.813] [M: 20744.16] [ET: 1.229/308.558] [MU: 2/20742.66] 
	SQL: SELECT  teams.tea_id 
					FROM   admins adm
					LEFT JOIN `admin_profiles` adp ON adp.adp_adm_id = adm.adm_id
					LEFT JOIN
					(
						SELECT 
						admin_profiles.adp_adm_id,
						JSON_UNQUOTE(JSON_EXTRACT(admin_profiles.adp_cdt_id, CONCAT('$[', pseudo_rows.row, '].cdtWeight'))) AS cdtWeight,
						JSON_UNQUOTE(JSON_EXTRACT(admin_profiles.adp_cdt_id, CONCAT('$[', pseudo_rows.row, '].cdtId'))) AS cdtId
						FROM admin_profiles
						JOIN pseudo_rows
						WHERE 1 AND  adp_adm_id = :admId
						HAVING cdtId IS NOT NULL
					) temp ON temp.adp_adm_id=adp.adp_adm_id
					LEFT JOIN `cat_depart_team_map` cdt  ON temp.cdtId=cdt.cdt_id
					LEFT JOIN teams ON cdt.cdt_tea_id = teams.tea_id								   
					WHERE  adm_id = :admId
					AND
					( 
						(tea_start_time IS NULL AND tea_stop_time IS NULL)
							OR           
						(tea_start_time < tea_stop_time AND CURRENT_TIME() BETWEEN tea_start_time AND tea_stop_time)
							OR
						(tea_stop_time < tea_start_time AND CURRENT_TIME() < tea_start_time AND CURRENT_TIME() < tea_stop_time)
							OR
						(tea_stop_time < tea_start_time AND CURRENT_TIME() > tea_start_time)
					)
					ORDER BY temp.cdtWeight  ASC LIMIT 0,1 
	 [params: {"admId":"30"}]
2024/09/10 00:28:24 [profile] [profile.module.admin.controller.booking.create] [T: 343.684] [M: 20745.23] [ET: 0.744/309.483] [MU: 1.2/20744.8] 
	SQL: SELECT  COUNT(*) as active_cbr_count_byId FROM `service_call_queue`
					WHERE 1 AND scq_status IN (1,3) AND scq_follow_up_queue_type=9
					AND scq_create_date >='2021-01-01 00:00:00'
					AND scq_active=1
				    AND scq_follow_up_date_time  < DATE_ADD(NOW(),INTERVAL 24 HOUR) AND scq_to_be_followed_up_by_id = :team_id 
	 [params: {"team_id":null}]
2024/09/10 00:28:24 [profile] [profile.module.admin.controller.booking.create] [T: 344.353] [M: 20747.25] [ET: 0.524/310.17] [MU: 1.15/20746.75] 
	SQL: SELECT  COUNT(*) as active_cbr_count_byId FROM `service_call_queue`
					WHERE 1 AND scq_status IN (1,3)  AND scq_follow_up_queue_type=9
					 AND scq_create_date >='2021-01-01 00:00:00'
					 AND scq_active=1
				   AND scq_follow_up_date_time  < DATE_ADD(NOW(),INTERVAL 24 HOUR) AND scq_to_be_followed_up_by_id = :adm_id AND scq_to_be_followed_up_by_type=2 
	 [params: {"adm_id":"30"}]
2024/09/10 00:28:24 [profile] [profile.module.admin.controller.booking.create] [T: 367.452] [M: 21087.25] [ET: 0.681/333.264] [MU: 1.99/21086] 
	SQL: SELECT cdt.cdt_id
			FROM admins adm
			LEFT JOIN `admin_profiles` adp ON adp.adp_adm_id = adm.adm_id
			LEFT JOIN
			(
				SELECT 
				admin_profiles.adp_adm_id,
				JSON_UNQUOTE(JSON_EXTRACT(admin_profiles.adp_cdt_id, CONCAT('$[', pseudo_rows.row, '].cdtWeight'))) AS cdtWeight,
				JSON_UNQUOTE(JSON_EXTRACT(admin_profiles.adp_cdt_id, CONCAT('$[', pseudo_rows.row, '].cdtId'))) AS cdtId
				FROM admin_profiles
				JOIN pseudo_rows
				WHERE 1
				HAVING cdtId IS NOT NULL
			) temp ON temp.adp_adm_id=adp.adp_adm_id
			LEFT JOIN `cat_depart_team_map` cdt  ON temp.cdtId=cdt.cdt_id
			LEFT JOIN teams ON cdt.cdt_tea_id = teams.tea_id
			WHERE cdt.cdt_id IN (:gp0)
			AND
			(
				(tea_start_time IS NULL AND tea_stop_time IS NULL)
				OR
				(tea_start_time < tea_stop_time AND CURRENT_TIME() BETWEEN tea_start_time AND tea_stop_time)
				OR
				(tea_stop_time < tea_start_time AND CURRENT_TIME() < tea_start_time AND CURRENT_TIME() < tea_stop_time)
				OR
				(tea_stop_time < tea_start_time AND CURRENT_TIME() > tea_start_time)
			)
			ORDER BY temp.cdtWeight ASC LIMIT 0,1 
	 [params: {":gp0":"1"}]
2024/09/10 00:28:24 [profile] [profile.module.admin.controller.booking.create] [T: 483.284] [M: 21385.93] [ET: 388.28/449.087] [MU: 11860.36/21385.82] 
	module.admin.controller.booking.create
2024/09/10 00:28:24 [profile] [profile.module.admin.controller.booking.create] [T: 483.33] [M: 21386.07] 
*******************************************************module.admin.controller.booking.create ACTION DONE****************************************************************
2024/09/14 16:28:02 [profile] [profile.module.admin.controller.booking.create] [T: 144.783] [M: 9524.02] 
------------------------------------------------------module.admin.controller.booking.create ACTION START------------------------------------------------------
	URL: [GET]/aaohome/booking/create
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/index/dashboard
	[UserID: 30] [UserType: 4]
2024/09/14 16:28:02 [profile] [profile.module.admin.controller.booking.create] [T: 184.718] [M: 10760.55] setLocationRequest start
2024/09/14 16:28:02 [profile] [profile.module.admin.controller.booking.create] [T: 277.415] [M: 10761.06] setLocationRequest ends
2024/09/14 16:28:03 [profile] [profile.module.admin.controller.booking.create] [T: 1046.792] [M: 20773.33] [ET: 0.823/1015.554] [MU: 1.99/20771.83] 
	SQL: SELECT  teams.tea_id 
					FROM   admins adm
					LEFT JOIN `admin_profiles` adp ON adp.adp_adm_id = adm.adm_id
					LEFT JOIN
					(
						SELECT 
						admin_profiles.adp_adm_id,
						JSON_UNQUOTE(JSON_EXTRACT(admin_profiles.adp_cdt_id, CONCAT('$[', pseudo_rows.row, '].cdtWeight'))) AS cdtWeight,
						JSON_UNQUOTE(JSON_EXTRACT(admin_profiles.adp_cdt_id, CONCAT('$[', pseudo_rows.row, '].cdtId'))) AS cdtId
						FROM admin_profiles
						JOIN pseudo_rows
						WHERE 1 AND  adp_adm_id = :admId
						HAVING cdtId IS NOT NULL
					) temp ON temp.adp_adm_id=adp.adp_adm_id
					LEFT JOIN `cat_depart_team_map` cdt  ON temp.cdtId=cdt.cdt_id
					LEFT JOIN teams ON cdt.cdt_tea_id = teams.tea_id								   
					WHERE  adm_id = :admId
					AND
					( 
						(tea_start_time IS NULL AND tea_stop_time IS NULL)
							OR           
						(tea_start_time < tea_stop_time AND CURRENT_TIME() BETWEEN tea_start_time AND tea_stop_time)
							OR
						(tea_stop_time < tea_start_time AND CURRENT_TIME() < tea_start_time AND CURRENT_TIME() < tea_stop_time)
							OR
						(tea_stop_time < tea_start_time AND CURRENT_TIME() > tea_start_time)
					)
					ORDER BY temp.cdtWeight  ASC LIMIT 0,1 
	 [params: {"admId":"30"}]
2024/09/14 16:28:03 [profile] [profile.module.admin.controller.booking.create] [T: 1047.397] [M: 20774.4] [ET: 0.481/1016.17] [MU: 1.19/20773.96] 
	SQL: SELECT  COUNT(*) as active_cbr_count_byId FROM `service_call_queue`
					WHERE 1 AND scq_status IN (1,3) AND scq_follow_up_queue_type=9
					AND scq_create_date >='2021-01-01 00:00:00'
					AND scq_active=1
				    AND scq_follow_up_date_time  < DATE_ADD(NOW(),INTERVAL 24 HOUR) AND scq_to_be_followed_up_by_id = :team_id 
	 [params: {"team_id":null}]
2024/09/14 16:28:03 [profile] [profile.module.admin.controller.booking.create] [T: 1047.932] [M: 20776.41] [ET: 0.41/1016.729] [MU: 1.15/20775.91] 
	SQL: SELECT  COUNT(*) as active_cbr_count_byId FROM `service_call_queue`
					WHERE 1 AND scq_status IN (1,3)  AND scq_follow_up_queue_type=9
					 AND scq_create_date >='2021-01-01 00:00:00'
					 AND scq_active=1
				   AND scq_follow_up_date_time  < DATE_ADD(NOW(),INTERVAL 24 HOUR) AND scq_to_be_followed_up_by_id = :adm_id AND scq_to_be_followed_up_by_type=2 
	 [params: {"adm_id":"30"}]
2024/09/14 16:28:03 [profile] [profile.module.admin.controller.booking.create] [T: 1074.278] [M: 21116.41] [ET: 0.845/1043.04] [MU: 2/21115.16] 
	SQL: SELECT cdt.cdt_id
			FROM admins adm
			LEFT JOIN `admin_profiles` adp ON adp.adp_adm_id = adm.adm_id
			LEFT JOIN
			(
				SELECT 
				admin_profiles.adp_adm_id,
				JSON_UNQUOTE(JSON_EXTRACT(admin_profiles.adp_cdt_id, CONCAT('$[', pseudo_rows.row, '].cdtWeight'))) AS cdtWeight,
				JSON_UNQUOTE(JSON_EXTRACT(admin_profiles.adp_cdt_id, CONCAT('$[', pseudo_rows.row, '].cdtId'))) AS cdtId
				FROM admin_profiles
				JOIN pseudo_rows
				WHERE 1
				HAVING cdtId IS NOT NULL
			) temp ON temp.adp_adm_id=adp.adp_adm_id
			LEFT JOIN `cat_depart_team_map` cdt  ON temp.cdtId=cdt.cdt_id
			LEFT JOIN teams ON cdt.cdt_tea_id = teams.tea_id
			WHERE cdt.cdt_id IN (:gp0)
			AND
			(
				(tea_start_time IS NULL AND tea_stop_time IS NULL)
				OR
				(tea_start_time < tea_stop_time AND CURRENT_TIME() BETWEEN tea_start_time AND tea_stop_time)
				OR
				(tea_stop_time < tea_start_time AND CURRENT_TIME() < tea_start_time AND CURRENT_TIME() < tea_stop_time)
				OR
				(tea_stop_time < tea_start_time AND CURRENT_TIME() > tea_start_time)
			)
			ORDER BY temp.cdtWeight ASC LIMIT 0,1 
	 [params: {":gp0":"1"}]
2024/09/14 16:28:05 [profile] [profile.module.admin.controller.booking.create] [T: 2868.391] [M: 21530.19] [ET: 2723.506/2837.163] [MU: 12004.58/21530.06] 
	module.admin.controller.booking.create
2024/09/14 16:28:05 [profile] [profile.module.admin.controller.booking.create] [T: 2868.44] [M: 21530.31] 
*******************************************************module.admin.controller.booking.create ACTION DONE****************************************************************
2024/10/02 00:27:21 [profile] [profile.module.admin.controller.booking.create] [T: 114.919] [M: 9524.02] 
------------------------------------------------------module.admin.controller.booking.create ACTION START------------------------------------------------------
	URL: [GET]/aaohome/booking/create
	User IP: 192.168.142.12
	Referrer: http://localhost:84/aaohome/index/dashboard
	[UserID: 30] [UserType: 4]
2024/10/02 00:27:21 [profile] [profile.module.admin.controller.booking.create] [T: 151.344] [M: 10760.55] setLocationRequest start
2024/10/02 00:27:21 [profile] [profile.module.admin.controller.booking.create] [T: 246.564] [M: 10761.06] setLocationRequest ends
2024/10/02 00:27:21 [profile] [profile.module.admin.controller.booking.create] [T: 734.479] [M: 20773.37] [ET: 0.811/696.336] [MU: 1.99/20771.87] 
	SQL: SELECT  teams.tea_id 
					FROM   admins adm
					LEFT JOIN `admin_profiles` adp ON adp.adp_adm_id = adm.adm_id
					LEFT JOIN
					(
						SELECT 
						admin_profiles.adp_adm_id,
						JSON_UNQUOTE(JSON_EXTRACT(admin_profiles.adp_cdt_id, CONCAT('$[', pseudo_rows.row, '].cdtWeight'))) AS cdtWeight,
						JSON_UNQUOTE(JSON_EXTRACT(admin_profiles.adp_cdt_id, CONCAT('$[', pseudo_rows.row, '].cdtId'))) AS cdtId
						FROM admin_profiles
						JOIN pseudo_rows
						WHERE 1 AND  adp_adm_id = :admId
						HAVING cdtId IS NOT NULL
					) temp ON temp.adp_adm_id=adp.adp_adm_id
					LEFT JOIN `cat_depart_team_map` cdt  ON temp.cdtId=cdt.cdt_id
					LEFT JOIN teams ON cdt.cdt_tea_id = teams.tea_id								   
					WHERE  adm_id = :admId
					AND
					( 
						(tea_start_time IS NULL AND tea_stop_time IS NULL)
							OR           
						(tea_start_time < tea_stop_time AND CURRENT_TIME() BETWEEN tea_start_time AND tea_stop_time)
							OR
						(tea_stop_time < tea_start_time AND CURRENT_TIME() < tea_start_time AND CURRENT_TIME() < tea_stop_time)
							OR
						(tea_stop_time < tea_start_time AND CURRENT_TIME() > tea_start_time)
					)
					ORDER BY temp.cdtWeight  ASC LIMIT 0,1 
	 [params: {"admId":"30"}]
2024/10/02 00:27:21 [profile] [profile.module.admin.controller.booking.create] [T: 735.095] [M: 20774.44] [ET: 0.493/696.967] [MU: 1.19/20774] 
	SQL: SELECT  COUNT(*) as active_cbr_count_byId FROM `service_call_queue`
					WHERE 1 AND scq_status IN (1,3) AND scq_follow_up_queue_type=9
					AND scq_create_date >='2021-01-01 00:00:00'
					AND scq_active=1
				    AND scq_follow_up_date_time  < DATE_ADD(NOW(),INTERVAL 24 HOUR) AND scq_to_be_followed_up_by_id = :team_id 
	 [params: {"team_id":null}]
2024/10/02 00:27:21 [profile] [profile.module.admin.controller.booking.create] [T: 735.679] [M: 20776.45] [ET: 0.417/697.55] [MU: 1.15/20775.95] 
	SQL: SELECT  COUNT(*) as active_cbr_count_byId FROM `service_call_queue`
					WHERE 1 AND scq_status IN (1,3)  AND scq_follow_up_queue_type=9
					 AND scq_create_date >='2021-01-01 00:00:00'
					 AND scq_active=1
				   AND scq_follow_up_date_time  < DATE_ADD(NOW(),INTERVAL 24 HOUR) AND scq_to_be_followed_up_by_id = :adm_id AND scq_to_be_followed_up_by_type=2 
	 [params: {"adm_id":"30"}]
2024/10/02 00:27:21 [profile] [profile.module.admin.controller.booking.create] [T: 758.051] [M: 21116.45] [ET: 0.842/719.912] [MU: 2/21115.2] 
	SQL: SELECT cdt.cdt_id
			FROM admins adm
			LEFT JOIN `admin_profiles` adp ON adp.adp_adm_id = adm.adm_id
			LEFT JOIN
			(
				SELECT 
				admin_profiles.adp_adm_id,
				JSON_UNQUOTE(JSON_EXTRACT(admin_profiles.adp_cdt_id, CONCAT('$[', pseudo_rows.row, '].cdtWeight'))) AS cdtWeight,
				JSON_UNQUOTE(JSON_EXTRACT(admin_profiles.adp_cdt_id, CONCAT('$[', pseudo_rows.row, '].cdtId'))) AS cdtId
				FROM admin_profiles
				JOIN pseudo_rows
				WHERE 1
				HAVING cdtId IS NOT NULL
			) temp ON temp.adp_adm_id=adp.adp_adm_id
			LEFT JOIN `cat_depart_team_map` cdt  ON temp.cdtId=cdt.cdt_id
			LEFT JOIN teams ON cdt.cdt_tea_id = teams.tea_id
			WHERE cdt.cdt_id IN (:gp0)
			AND
			(
				(tea_start_time IS NULL AND tea_stop_time IS NULL)
				OR
				(tea_start_time < tea_stop_time AND CURRENT_TIME() BETWEEN tea_start_time AND tea_stop_time)
				OR
				(tea_stop_time < tea_start_time AND CURRENT_TIME() < tea_start_time AND CURRENT_TIME() < tea_stop_time)
				OR
				(tea_stop_time < tea_start_time AND CURRENT_TIME() > tea_start_time)
			)
			ORDER BY temp.cdtWeight ASC LIMIT 0,1 
	 [params: {":gp0":"1"}]
2024/10/02 00:27:22 [profile] [profile.module.admin.controller.booking.create] [T: 949.319] [M: 21479.13] [ET: 834.292/911.196] [MU: 11953.54/21479.02] 
	module.admin.controller.booking.create
2024/10/02 00:27:22 [profile] [profile.module.admin.controller.booking.create] [T: 949.373] [M: 21479.27] 
*******************************************************module.admin.controller.booking.create ACTION DONE****************************************************************
2024/10/17 13:51:57 [profile] [profile.module.admin.controller.booking.create] [T: 210.08] [M: 9522.56] 
------------------------------------------------------module.admin.controller.booking.create ACTION START------------------------------------------------------
	URL: [GET]/aaohome/booking/create
	User IP: 192.168.1.240
	[UserID: 30] [UserType: 4]
2024/10/17 13:51:57 [profile] [profile.module.admin.controller.booking.create] [T: 273.09] [M: 10758.83] setLocationRequest start
2024/10/17 13:51:57 [profile] [profile.module.admin.controller.booking.create] [T: 355.411] [M: 10759.34] setLocationRequest ends
2024/10/17 13:51:58 [profile] [profile.module.admin.controller.booking.create] [T: 917.556] [M: 20771.34] [ET: 15.952/889.419] [MU: 1.99/20769.84] 
	SQL: SELECT  teams.tea_id 
					FROM   admins adm
					LEFT JOIN `admin_profiles` adp ON adp.adp_adm_id = adm.adm_id
					LEFT JOIN
					(
						SELECT 
						admin_profiles.adp_adm_id,
						JSON_UNQUOTE(JSON_EXTRACT(admin_profiles.adp_cdt_id, CONCAT('$[', pseudo_rows.row, '].cdtWeight'))) AS cdtWeight,
						JSON_UNQUOTE(JSON_EXTRACT(admin_profiles.adp_cdt_id, CONCAT('$[', pseudo_rows.row, '].cdtId'))) AS cdtId
						FROM admin_profiles
						JOIN pseudo_rows
						WHERE 1 AND  adp_adm_id = :admId
						HAVING cdtId IS NOT NULL
					) temp ON temp.adp_adm_id=adp.adp_adm_id
					LEFT JOIN `cat_depart_team_map` cdt  ON temp.cdtId=cdt.cdt_id
					LEFT JOIN teams ON cdt.cdt_tea_id = teams.tea_id								   
					WHERE  adm_id = :admId
					AND
					( 
						(tea_start_time IS NULL AND tea_stop_time IS NULL)
							OR           
						(tea_start_time < tea_stop_time AND CURRENT_TIME() BETWEEN tea_start_time AND tea_stop_time)
							OR
						(tea_stop_time < tea_start_time AND CURRENT_TIME() < tea_start_time AND CURRENT_TIME() < tea_stop_time)
							OR
						(tea_stop_time < tea_start_time AND CURRENT_TIME() > tea_start_time)
					)
					ORDER BY temp.cdtWeight  ASC LIMIT 0,1 
	 [params: {"admId":"30"}]
2024/10/17 13:51:58 [profile] [profile.module.admin.controller.booking.create] [T: 921.882] [M: 20772.41] [ET: 4.165/893.722] [MU: 1.19/20771.97] 
	SQL: SELECT  COUNT(*) as active_cbr_count_byId FROM `service_call_queue`
					WHERE 1 AND scq_status IN (1,3) AND scq_follow_up_queue_type=9
					AND scq_create_date >='2021-01-01 00:00:00'
					AND scq_active=1
				    AND scq_follow_up_date_time  < DATE_ADD(NOW(),INTERVAL 24 HOUR) AND scq_to_be_followed_up_by_id = :team_id 
	 [params: {"team_id":null}]
2024/10/17 13:51:58 [profile] [profile.module.admin.controller.booking.create] [T: 923.06] [M: 20774.42] [ET: 0.986/894.897] [MU: 1.14/20773.92] 
	SQL: SELECT  COUNT(*) as active_cbr_count_byId FROM `service_call_queue`
					WHERE 1 AND scq_status IN (1,3)  AND scq_follow_up_queue_type=9
					 AND scq_create_date >='2021-01-01 00:00:00'
					 AND scq_active=1
				   AND scq_follow_up_date_time  < DATE_ADD(NOW(),INTERVAL 24 HOUR) AND scq_to_be_followed_up_by_id = :adm_id AND scq_to_be_followed_up_by_type=2 
	 [params: {"adm_id":"30"}]
2024/10/17 13:51:58 [profile] [profile.module.admin.controller.booking.create] [T: 960.124] [M: 21114.42] [ET: 11.286/931.996] [MU: 1.99/21113.17] 
	SQL: SELECT cdt.cdt_id
			FROM admins adm
			LEFT JOIN `admin_profiles` adp ON adp.adp_adm_id = adm.adm_id
			LEFT JOIN
			(
				SELECT 
				admin_profiles.adp_adm_id,
				JSON_UNQUOTE(JSON_EXTRACT(admin_profiles.adp_cdt_id, CONCAT('$[', pseudo_rows.row, '].cdtWeight'))) AS cdtWeight,
				JSON_UNQUOTE(JSON_EXTRACT(admin_profiles.adp_cdt_id, CONCAT('$[', pseudo_rows.row, '].cdtId'))) AS cdtId
				FROM admin_profiles
				JOIN pseudo_rows
				WHERE 1
				HAVING cdtId IS NOT NULL
			) temp ON temp.adp_adm_id=adp.adp_adm_id
			LEFT JOIN `cat_depart_team_map` cdt  ON temp.cdtId=cdt.cdt_id
			LEFT JOIN teams ON cdt.cdt_tea_id = teams.tea_id
			WHERE cdt.cdt_id IN (:gp0)
			AND
			(
				(tea_start_time IS NULL AND tea_stop_time IS NULL)
				OR
				(tea_start_time < tea_stop_time AND CURRENT_TIME() BETWEEN tea_start_time AND tea_stop_time)
				OR
				(tea_stop_time < tea_start_time AND CURRENT_TIME() < tea_start_time AND CURRENT_TIME() < tea_stop_time)
				OR
				(tea_stop_time < tea_start_time AND CURRENT_TIME() > tea_start_time)
			)
			ORDER BY temp.cdtWeight ASC LIMIT 0,1 
	 [params: {":gp0":"1"}]
2024/10/17 13:51:58 [profile] [profile.module.admin.controller.booking.create] [T: 1093.422] [M: 21477.1] [ET: 883.168/1065.243] [MU: 11953.01/21476.99] 
	module.admin.controller.booking.create
2024/10/17 13:51:58 [profile] [profile.module.admin.controller.booking.create] [T: 1093.488] [M: 21477.24] 
*******************************************************module.admin.controller.booking.create ACTION DONE****************************************************************
2024/10/17 13:53:15 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 100.562] [M: 10045.42] 
------------------------------------------------------module.admin.controller.booking.getamountbyvehicle ACTION START------------------------------------------------------
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"3","tripDistance":"","tripDuration":"","multiCityData":"","bookingType":"1","pickupAddress":"","pickupDate":"31\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","sccId":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=3&tripDistance=&tripDuration=&multiCityData=&bookingType=1&pickupAddress=&pickupDate=31%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&sccId=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 13:53:15 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 160.593] [M: 11281.63] setLocationRequest start
2024/10/17 13:53:15 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 246.326] [M: 11282.13] setLocationRequest ends
2024/10/17 13:53:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 386.897] [M: 18107.56] [ET: 11.982/360.908] [MU: 0.84/18107.38] 
	SQL: SELECT COUNT(1) as cnt FROM cities WHERE cty_active=1 AND cty_service_active=1 AND cty_id=30804 
	 [params: []]
2024/10/17 13:53:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 389.841] [M: 18108.86] [ET: 2.834/363.85] [MU: 0.83/18108.67] 
	SQL: SELECT COUNT(1) as cnt FROM cities WHERE cty_active=1 AND cty_service_active=1 AND cty_id=30711 
	 [params: []]
2024/10/17 13:53:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 487.321] [M: 18592.12] [ET: 97.395/461.35] [MU: 483.16/18592.01] 
	BookingRoute::calculateDistance
2024/10/17 13:53:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 487.755] [M: 18589.39] [ET: 0.21/461.795] [MU: 1.24/18589.3] 
	BookingRoute::calculateDistance
2024/10/17 13:53:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 487.809] [M: 18589.2] [ET: 172.925/461.85] [MU: 5974.33/18589.11] 
	validateRoutes
2024/10/17 13:53:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 500.742] [M: 18822.39] [ET: 11.096/474.766] [MU: 27.14/18822.17] 
	SQL: SELECT scv_id FROM svc_class_vhc_cat WHERE scv_active = 1 AND scv_scc_id IN (1,2,4,6) ORDER BY scv_vct_id ASC,scv_scc_id ASC 
	 [params: []]
2024/10/17 13:53:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 512.198] [M: 18810] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.Quote.getQuote START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"3","tripDistance":"","tripDuration":"","multiCityData":"","bookingType":"1","pickupAddress":"","pickupDate":"31\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","sccId":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=3&tripDistance=&tripDuration=&multiCityData=&bookingType=1&pickupAddress=&pickupDate=31%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&sccId=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 13:53:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 576.719] [M: 19261.77] [ET: 2.875/550.727] [MU: 1.89/19261.45] 
	SQL: SELECT GROUP_CONCAT(zct_zon_id) as zones FROM zone_cities 
						INNER JOIN zones ON zon_id=zct_zon_id AND zon_active=1
						WHERE zct_cty_id=:city AND zct_active=1 
	 [params: {":city":"30804"}]
2024/10/17 13:53:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 683.348] [M: 19674.67] [ET: 3.328/657.355] [MU: 2.85/19674.23] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 686.928] [M: 19679.13] [ET: 3.445/660.929] [MU: 2.84/19678.69] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30711"}]
2024/10/17 13:53:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 687.841] [M: 19681.16] [ET: 0.769/661.846] [MU: 0.9/19680.95] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 728.761] [M: 19732.33] [ET: 40.747/702.783] [MU: 43.61/19730.83] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (100) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30711) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp0)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp3,:gp4)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp1,:gp2)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp5,:gp6))
			OR (scr_area_type = 5 AND scr_area_id IN (3699))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (3)
		ORDER BY rank DESC
		 
	 [params: {":gp0":"31",":gp1":"30804",":gp2":"30711",":gp3":"105",":gp4":"100",":gp5":"1",":gp6":"1","tripType":"1"}]
2024/10/17 13:53:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 793.016] [M: 19782.75] [ET: 10.699/767.04] [MU: 0.84/19782.56] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 824.422] [M: 19785.04] [ET: 31.309/798.444] [MU: 0.96/19784.73] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"1"}]
2024/10/17 13:53:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 888.897] [M: 19925.64] [ET: 6.284/862.899] [MU: 3.45/19924.77] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 938.821] [M: 20090.55] [ET: 8.963/912.812] [MU: 0.87/20090.34] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":0}]
2024/10/17 13:53:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 968.053] [M: 20212.52] [ET: 0.712/942.072] [MU: 2.96/20212.08] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:16 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 987.201] [M: 20247.59] [ET: 18.961/961.201] [MU: 28.98/20246.97] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp8)) OR (apr_area_type = 2 AND apr_area_id IN (:gp9)) OR (apr_area_type = 4 AND apr_area_id IN (:gp10)) OR (apr_area_type = 1 AND apr_area_id IN (:gp7))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp7":"31",":gp8":"30804",":gp9":"105",":gp10":"1","cab":"3"}]
2024/10/17 13:53:19 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 3406.643] [M: 20322.57] [ET: 2380.116/3380.647] [MU: 0.74/20314.57] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"nearest_route_30804_30711","sql":"(INDEX indx_nearest_rt_rutid (rut_id)) \r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, routeFrom.rut_name as fromAlias, \r\n\t\t\t\tNULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, \r\n\t\t\t\t0 as rank, routeFrom.rut_estm_time as startTime, 0 as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 \r\n\t\t\t\tAND routeFrom.rut_from_city_id<>routeFrom.rut_to_city_id AND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\t\tAND (routeAlias.rut_to_city_id=route.rut_to_city_id) AND routeAlias.rut_active = 1 \r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, NULL, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) \r\n\t\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\t0 AS extraStartDistance, 0, 0 as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND route.rut_from_city_id = 30804 AND route.rut_to_city_id=30711 \r\n\t\t\t\tAND routeTo.rut_from_city_id=30711\r\n\t\t\t\tAND route.rut_active = 1 AND routeTo.rut_active = 1 AND routeTo.rut_estm_distance < 50 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = route.rut_from_city_id) \r\n\t\t\t   AND (routeAlias.rut_to_city_id = routeTo.rut_to_city_id) AND routeAlias.rut_active = 1 \r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, \r\n\t\t\t\trouteFrom.rut_name, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t+ IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) \r\n\t\t\t\tAS extraDistance, IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, 0, \r\n\t\t\t\trouteFrom.rut_estm_time as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 AND routeFrom.rut_from_city_id <> routeFrom.rut_to_city_id\r\n\t\t\t\t\tAND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND routeTo.rut_estm_distance < 50 \r\n\t\t\t\t\tAND routeTo.rut_from_city_id=30711 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\tAND (routeAlias.rut_to_city_id=routeTo.rut_to_city_id) AND routeAlias.rut_active = 1 AND routeAlias.rut_from_city_id=30804 "}]
2024/10/17 13:53:19 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 3407.061] [M: 20332.44] [ET: 0.338/3381.092] [MU: 0.88/20332.28] 
	SQL: SELECT GROUP_CONCAT(rut_id) as rutIds FROM nearest_route_30804_30711 
	 [params: []]
2024/10/17 13:53:19 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 3414.456] [M: 20330.46] [ET: 5.635/3388.474] [MU: 2.78/20330.02] 
	SQL: SELECT *, (rte_vendor_amount + extraDistance * 10.55) as totalCost FROM (SELECT * FROM nearest_route_30804_30711) a
					INNER JOIN rate ON a.rut_id = rate.rte_route_id AND rte_status=1 AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <>0
					WHERE 1 ORDER BY rank DESC, totalCost ASC LIMIT 0,1 
	 [params: {"cabType":"3"}]
2024/10/17 13:53:27 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 11430.075] [M: 20338.48] [ET: 8015.479/11404.072] [MU: 0.75/20336.48] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"getNearestRoute_30804_30711_70","sql":"(INDEX getNearestRoute_30804_30711_70_index_rut_id (rut_id))\r\n\t\t\t\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id AS start, routeAlias.rut_to_city_id AS end,\r\n\t\t\t\t\t\t\t\trouteFrom.rut_name AS fromAlias, NULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance AS quotedDistance,\r\n\t\t\t\t\t\t\t\trouteAlias.rut_estm_distance AS rateDistance, \r\n\t\t\t\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance)\r\n\t\t\t\t\t\t\t\t\t - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance,\r\n\t\t\t\t\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance,\r\n\t\t\t\t\t\t\t\t0 AS rank, routeFrom.rut_estm_time AS startTime, 0 AS endTime, route.rut_estm_time, \r\n\t\t\t\t\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraTravelDistance\r\n\t\t\t\t\t\tFROM   route\r\n\t\t\t\t\t\tINNER JOIN route routeTo ON routeTo.rut_to_city_id=route.rut_from_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_from_city_id=30804 AND routeTo.rut_active=1\r\n\t\t\t\t\t\t\t\tAND routeTo.rut_estm_distance<70 AND route.rut_active=1\r\n\t\t\t\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_from_city_id=route.rut_to_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_active = 1\r\n\t\t\t\t\t\t\t\tAND routeFrom.rut_estm_distance<70 AND route.rut_active = 1\r\n\t\t\t\t\t\tINNER JOIN route routeAlias ON routeAlias.rut_to_city_id=routeFrom.rut_to_city_id\r\n\t\t\t\t\t\t\tAND routeAlias.rut_from_city_id=routeTo.rut_from_city_id AND routeAlias.rut_active = 1"}]
2024/10/17 13:53:27 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 11436.06] [M: 20343.8] [ET: 5.846/11410.062] [MU: 2.46/20343.17] 
	SQL: SELECT *, (rte_vendor_amount + extradistance * 10.55 ) AS totalCost, 
						ABS(quotedDistance-rateDistance) AS extraChargeableDistance
					FROM getNearestRoute_30804_30711_70 a
					INNER JOIN rate ON a.rut_id=rate.rte_route_id AND rte_status=1 
						AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <> 0
					WHERE  1
					ORDER  BY rank DESC, extraStartDistance, extraChargeableDistance ASC, totalcost ASC
					LIMIT  0, 1 
	 [params: {"cabType":"3"}]
2024/10/17 13:53:27 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 11444.536] [M: 20352.02] [ET: 10562.124/11418.549] [MU: 434.25/20351.86] 
	Quote::calculateOneWay  for CAB 3 Date: 2024-10-31 18:00:00
2024/10/17 13:53:27 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 11500.991] [M: 20420.88] [ET: 56.281/11474.997] [MU: 2.19/20420.63] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:27 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 11506.252] [M: 20433.41] [ET: 0.718/11480.263] [MU: 2.97/20432.98] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:27 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 11507.047] [M: 20465.2] [ET: 0.635/11481.075] [MU: 25.27/20464.45] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp13)) OR (apr_area_type = 5 AND apr_area_id IN (:gp11)) OR (apr_area_type = 2 AND apr_area_id IN (:gp14)) OR (apr_area_type = 4 AND apr_area_id IN (:gp15)) OR (apr_area_type = 1 AND apr_area_id IN (:gp12))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp11":"3699",":gp12":"31",":gp13":"30804",":gp14":"105",":gp15":"1","cab":"3"}]
2024/10/17 13:53:27 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 11507.994] [M: 20447.05] [ET: 0.22/11482.033] [MU: 2.98/20446.94] 
	BookingRoute::calculateDistance
2024/10/17 13:53:27 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 11534.729] [M: 20481.7] [ET: 3.23/11508.728] [MU: 2.65/20481.07] 
	SQL: SELECT 
						fc.cty_id as c2id, 
						fc.cty_name as c2name, 
						fc.cty_garage_address as c2address,
						tc.cty_id as c4id,
						tc.cty_name as c4name, tc.cty_garage_address as c4address,
						0 as totalExtraDistance FROM route
						INNER JOIN cities fc ON rut_from_city_id=fc.cty_id
						INNER JOIN cities tc ON rut_to_city_id=tc.cty_id
						INNER JOIN rate on  rate.rte_route_id=route.rut_id  AND rate.rte_vehicletype_id IN (3)
						WHERE route.rut_from_city_id=30804 AND route.rut_to_city_id=30711 AND route.rut_active=1 
	 [params: []]
2024/10/17 13:53:29 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 13447.131] [M: 20494.96] [ET: 1912.28/13421.151] [MU: 5.91/20492.96] 
	SQL: 
				SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address, tc.cty_id as c4id, 
				tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
					FROM
					 (
						(
							SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id,  
								r3.rut_to_city_id, route.rut_name , route.rut_id,
								(route.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, 
								r3.rut_estm_distance
							FROM route
							INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_from_city_id=30804  
									AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=route.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) 
									AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
						UNION
						(
							SELECT r3.rut_id, r3.rut_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,(route.rut_estm_distance + r1.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
							FROM route
							INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND  route.rut_to_city_id=30711 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND route.rut_to_city_id=r3.rut_to_city_id))	AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
                     ) a
					INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
					INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1 
	 [params: []]
2024/10/17 13:53:31 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 15699.468] [M: 20504.85] [ET: 2252.226/15673.47] [MU: 4.41/20503.35] 
	SQL: SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
                              tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
                        FROM (SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,
                                    (route.rut_estm_distance + r1.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
                                FROM route
								INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
								INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
								INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) AND r3.rut_active=1 
								INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3) LIMIT 1
							)a
                        INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
                        INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1
                         
	 [params: []]
2024/10/17 13:53:31 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 16189.227] [M: 20511.23] [ET: 489.632/16163.244] [MU: 0.74/20510.35] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"GarageRoute_30804_30711","sql":" (INDEX GarageRoute_30804_30711_index_rut_id (rut_id), INDEX GarageRoute_30804_30711_index_rut_from_city_id (rut_from_city_id), INDEX GarageRoute_30804_30711_index_rut_to_city_id (rut_to_city_id))\r\n\t\t\t\t\t\t\tSELECT route.rut_id, route.rut_from_city_id, route.rut_to_city_id, route.rut_name, rut_estm_distance FROM route \r\n\t\t\t\t\t\t\tINNER JOIN cities_stats   ON cities_stats.cts_cty_id = route.rut_from_city_id\r\n\t\t\t\t\t\t\tAND rut_estm_distance < 300\r\n\t\t\t\t\t\t\tAND rut_active = 1\r\n\t\t\t\t\t\t\tAND route.rut_to_city_id=30804\r\n\t\t\t\t\t\t\tAND cities_stats.cts_vnd_cnt >= 3\r\n\t\t\t\t\t\t\tORDER BY rut_estm_distance LIMIT 10"}]
2024/10/17 13:53:36 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 20657.239] [M: 20523.04] [ET: 4467.882/20631.222] [MU: 6.58/20521.29] 
	SQL: SELECT a.*, fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
								tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address 
						FROM ((SELECT xyz.rut_from_city_id as startCity, r1.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r3.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_from_city_id
							INNER JOIN rate ON rate.rte_route_id=r1.rut_id  AND rate.rte_vehicletype_id IN (3)
							INNER JOIN route r2 ON r2.rut_to_city_id=r1.rut_to_city_id AND r2.rut_from_city_id=:dropCity AND r2.rut_active=1
							INNER JOIN route r3 ON r3.rut_from_city_id=xyz.rut_to_city_id AND r3.rut_to_city_id=r2.rut_from_city_id AND r3.rut_active=1
							ORDER BY ExtraDistance LIMIT 1
							)
							UNION
							(
							SELECT xyz.rut_from_city_id as startCity, r2.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r2.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_to_city_id AND r1.rut_to_city_id=:dropCity
							INNER JOIN route r2 ON r2.rut_to_city_id=xyz.rut_from_city_id AND r2.rut_from_city_id=r1.rut_to_city_id
							ORDER BY ExtraDistance ASC LIMIT 1
							)) a
						INNER JOIN cities fc ON startCity=fc.cty_id
						INNER JOIN cities tc ON endCity=tc.cty_id 
						ORDER BY ExtraDistance 
	 [params: {"pickupCity":"30804","dropCity":"30711"}]
2024/10/17 13:53:36 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 20726.79] [M: 20533.95] [ET: 67.717/20700.807] [MU: 7.89/20533.84] 
	BookingRoute::calculateDistance
2024/10/17 13:53:36 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 20740.719] [M: 20547.52] [ET: 13.766/20714.712] [MU: 8.27/20547.41] 
	BookingRoute::calculateDistance
2024/10/17 13:53:36 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 20755.84] [M: 20555.15] [ET: 14.04/20729.85] [MU: 1/20554.77] 
	SQL: SELECT cts_airport_pickup_entry_fee
               FROM   cities
               INNER JOIN cities_stats
               ON cities.cty_id = cities_stats.cts_cty_id
               WHERE  cty_id = :cityId
               AND cty_is_airport = 1 AND cty_active = 1 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:36 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 20756.95] [M: 20558.49] [ET: 0.734/20730.968] [MU: 0.74/20558.34] 
	SQL: CALL prcDropTempTable(:tableName) 
	 [table: GarageRoute1337389578]
2024/10/17 13:53:37 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 21375.827] [M: 20563] [ET: 618.765/21349.846] [MU: 0.74/20562.25] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"GarageRoute1337389578","sql":" (INDEX my_index_name (rut_id), INDEX my_index_name1 (rut_from_city_id))\r\n\t\t\t\t\t\t\tSELECT route.rut_id, route.rut_from_city_id, route.rut_to_city_id, route.rut_name, rut_estm_distance, rut_estm_time\r\n\t\t\t\t\t\t\tFROM route \r\n\t\t\t\t\t\t\tINNER JOIN cities_stats   ON cities_stats.cts_cty_id = route.rut_from_city_id\r\n\t\t\t\t\t\t\tAND rut_estm_distance < 300\r\n\t\t\t\t\t\t\tAND rut_active = 1\r\n\t\t\t\t\t\t\tAND route.rut_to_city_id=30804\r\n\t\t\t\t\t\t\tAND cities_stats.cts_vnd_cnt >= 3\r\n\t\t\t\t\t\t\tORDER BY rut_estm_distance LIMIT 10"}]
2024/10/17 13:53:37 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 21388.298] [M: 20573.88] [ET: 12.354/21362.301] [MU: 5.77/20572.63] 
	SQL: SELECT a.*, fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
								tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address 
						FROM (
							(
							SELECT xyz.rut_from_city_id as startCity, r2.rut_to_city_id as endCity, 
									xyz.rut_estm_distance as startDistance,
									IFNULL(r2.rut_actual_distance, r2.rut_estm_distance) as endDistance,
									xyz.rut_estm_time as startTime,
									IFNULL(r2.rut_actual_time, r2.rut_estm_time) as endTime,
									xyz.rut_name as startRoute, r1.rut_name as servingRoute, r2.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute1337389578 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_to_city_id AND r1.rut_to_city_id=:dropCity
							INNER JOIN route r2 ON r2.rut_to_city_id=xyz.rut_from_city_id AND r2.rut_from_city_id=r1.rut_to_city_id
							ORDER BY ExtraDistance ASC LIMIT 1
							)) a
						INNER JOIN cities fc ON startCity=fc.cty_id
						INNER JOIN cities tc ON endCity=tc.cty_id 
						ORDER BY ExtraDistance 
	 [params: {"dropCity":"30711"}]
2024/10/17 13:53:37 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 21390.81] [M: 20578.15] [ET: 0.551/21364.82] [MU: 0.74/20577.99] 
	SQL: CALL prcDropTempTable(:tableName) 
	 [table: GarageRoute1337389578]
2024/10/17 13:53:37 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 21406.839] [M: 20586.81] [ET: 15.841/21380.868] [MU: 8.14/20586.7] 
	BookingRoute::calculateDistance
2024/10/17 13:53:37 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 21417.438] [M: 20594.65] [ET: 10.487/21391.468] [MU: 8.08/20594.54] 
	BookingRoute::calculateDistance
2024/10/17 13:53:37 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 21427.265] [M: 20593.47] [ET: 9.7/21401.252] [MU: 0.9/20593.25] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:37 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 21429.67] [M: 20605.84] [ET: 0.886/21403.664] [MU: 2.97/20605.41] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:37 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 21430.59] [M: 20637.63] [ET: 0.727/21404.618] [MU: 25.27/20636.88] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp18)) OR (apr_area_type = 5 AND apr_area_id IN (:gp16)) OR (apr_area_type = 2 AND apr_area_id IN (:gp19)) OR (apr_area_type = 4 AND apr_area_id IN (:gp20)) OR (apr_area_type = 1 AND apr_area_id IN (:gp17))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp16":"3699",":gp17":"31",":gp18":"30804",":gp19":"105",":gp20":"1","cab":"3"}]
2024/10/17 13:53:37 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 21432.11] [M: 20621.52] [ET: 0.353/21406.115] [MU: 2.98/20621.41] 
	BookingRoute::calculateDistance
2024/10/17 13:53:37 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 21434.059] [M: 20634.54] [ET: 0.335/21408.098] [MU: 2.98/20634.43] 
	BookingRoute::calculateDistance
2024/10/17 13:53:37 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 21434.332] [M: 20638.71] [ET: 0.202/21408.373] [MU: 2.97/20638.6] 
	BookingRoute::calculateDistance
2024/10/17 13:53:38 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 22587.49] [M: 20674.07] [ET: 1132.09/22561.466] [MU: 6.31/20672.07] 
	SQL: 
                SELECT cities.cty_id as c2id, cities.cty_name as c2name, cities.cty_garage_address as c2address,
                    cities.cty_id as c4id, cities.cty_name as c4name, cities.cty_garage_address as c4address,
                        (distance * 2) as totalExtraDistance
                 FROM (SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<40
                     INNER JOIN route r1 ON route.rut_to_city_id=r1.rut_from_city_id AND r1.rut_active=1
                     INNER JOIN rate ON r1.rut_id=rate.rte_route_id AND rate.rte_status=1  AND rate.rte_vehicletype_id IN (3) GROUP BY route.rut_id HAVING count(*) >30
                   UNION
                     SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<600
                     INNER JOIN cities tc ON tc.cty_id=route.rut_to_city_id AND tc.cty_service_active=1 AND CalcDistance(cities.cty_lat, cities.cty_long, tc.cty_lat, tc.cty_long)<=route.rut_estm_distance						 
                     INNER JOIN cities_stats ON cities_stats.cts_cty_id = route.rut_to_city_id AND cities_stats.cts_vnd_cnt >= 2
                   UNION
                    SELECT cts_cty_id AS city, 0 AS distance
					FROM cities_stats WHERE 1 AND cities_stats.cts_cty_id= 30817 and cities_stats.cts_vnd_cnt>1) a
                    INNER JOIN cities ON cities.cty_id=a.city
                    ORDER BY totalExtraDistance LIMIT 1 
	 [params: []]
2024/10/17 13:53:38 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 22592.509] [M: 20688.6] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"3","tripDistance":"","tripDuration":"","multiCityData":"","bookingType":"1","pickupAddress":"","pickupDate":"31\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","sccId":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=3&tripDistance=&tripDuration=&multiCityData=&bookingType=1&pickupAddress=&pickupDate=31%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&sccId=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 13:53:38 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 22594.274] [M: 20705.45] [ET: 2.702/22568.289] [MU: 18.05/20705.34] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 13:53:38 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 22594.343] [M: 20707.13] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 13:53:38 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 22694.733] [M: 20790.09] [ET: 53.139/22668.731] [MU: 3.2/20787.59] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+10013),(IF((cpm_value_type=2),(10013+(10013*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30937 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30937) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-31 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=3 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 13:53:38 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 22794.944] [M: 22152.99] [ET: 203.511/22768.951] [MU: 1466.06/22152.84] 
	RouteRates::calculate for CAB 3 2024-10-31 18:00:00 - Trip Type: 1 192157172
2024/10/17 13:53:38 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 22795.307] [M: 22130.66] [ET: 11350.648/22769.312] [MU: 1713.11/22130.51] 
	Quote::calculateRules for CAB 3, From City Id: 30804, To city Id: 30711
2024/10/17 13:53:38 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 22795.896] [M: 22103.28] [ET: 0.439/22769.899] [MU: 0.89/22103.03] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"3"}]
2024/10/17 13:53:38 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 22796.045] [M: 22104.56] [ET: 22283.749/22770.068] [MU: 3292.07/22104.47] 
	Quote For CabType: 3
2024/10/17 13:53:38 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 22797.553] [M: 22118.5] [ET: 0.511/22771.572] [MU: 2.97/22118.06] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:38 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 22798.094] [M: 22124.31] [ET: 0.451/22772.131] [MU: 3.34/22123.88] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30711"}]
2024/10/17 13:53:38 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 22856.545] [M: 22127.22] [ET: 58.368/22830.558] [MU: 0.9/22127] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:38 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 22871.871] [M: 22159.61] [ET: 15.17/22845.889] [MU: 24.22/22158.11] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (100) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30711) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp21)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp24,:gp25)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp22,:gp23)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp26,:gp27))
			OR (scr_area_type = 5 AND scr_area_id IN (3699))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (16)
		ORDER BY rank DESC
		 
	 [params: {":gp21":"31",":gp22":"30804",":gp23":"30711",":gp24":"105",":gp25":"100",":gp26":"1",":gp27":"1","tripType":"1"}]
2024/10/17 13:53:38 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 22872.642] [M: 22139.78] [ET: 0.217/22846.678] [MU: 0.84/22139.59] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:38 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 22882.996] [M: 22142.66] [ET: 10.259/22857.004] [MU: 0.96/22142.34] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"2"}]
2024/10/17 13:53:38 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 22888.948] [M: 22160.27] [ET: 4.501/22862.972] [MU: 3.53/22159.39] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"16","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:38 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 22897.836] [M: 22163.52] [ET: 8.619/22871.848] [MU: 0.87/22163.3] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":0}]
2024/10/17 13:53:38 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 22898.749] [M: 22170.8] [ET: 0.675/22872.771] [MU: 2.97/22170.36] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:38 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 22899.603] [M: 22214.97] [ET: 0.702/22873.62] [MU: 22.05/22214.34] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp29)) OR (apr_area_type = 2 AND apr_area_id IN (:gp30)) OR (apr_area_type = 4 AND apr_area_id IN (:gp31)) OR (apr_area_type = 1 AND apr_area_id IN (:gp28))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp28":"31",":gp29":"30804",":gp30":"105",":gp31":"1","cab":"16"}]
2024/10/17 13:53:38 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 22900.943] [M: 22201.68] [ET: 0.591/22874.964] [MU: 3.33/22201.24] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:38 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 22903.708] [M: 22212] [ET: 2.589/22877.692] [MU: 3.57/22211.13] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp33)) OR (scr_area_type = 2 AND scr_area_id IN (:gp34)) OR (scr_area_type = 4 AND scr_area_id IN (:gp35)) OR (scr_area_type = 1 AND scr_area_id IN (:gp32)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp32":"31",":gp33":"30804",":gp34":"105",":gp35":"1","scv_id":"16"}]
2024/10/17 13:53:38 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23280.73] [M: 22239.87] [ET: 375.643/23254.717] [MU: 0.74/22231.87] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"nearest_route_30804_30711","sql":"(INDEX indx_nearest_rt_rutid (rut_id)) \r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, routeFrom.rut_name as fromAlias, \r\n\t\t\t\tNULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, \r\n\t\t\t\t0 as rank, routeFrom.rut_estm_time as startTime, 0 as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 \r\n\t\t\t\tAND routeFrom.rut_from_city_id<>routeFrom.rut_to_city_id AND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\t\tAND (routeAlias.rut_to_city_id=route.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, NULL, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) \r\n\t\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\t0 AS extraStartDistance, 0, 0 as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND route.rut_from_city_id = 30804 AND route.rut_to_city_id=30711 \r\n\t\t\t\tAND routeTo.rut_from_city_id=30711\r\n\t\t\t\tAND route.rut_active = 1 AND routeTo.rut_active = 1 AND routeTo.rut_estm_distance < 50 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = route.rut_from_city_id) \r\n\t\t\t   AND (routeAlias.rut_to_city_id = routeTo.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, \r\n\t\t\t\trouteFrom.rut_name, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t+ IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) \r\n\t\t\t\tAS extraDistance, IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, 0, \r\n\t\t\t\trouteFrom.rut_estm_time as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 AND routeFrom.rut_from_city_id <> routeFrom.rut_to_city_id\r\n\t\t\t\t\tAND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND routeTo.rut_estm_distance < 50 \r\n\t\t\t\t\tAND routeTo.rut_from_city_id=30711 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\tAND (routeAlias.rut_to_city_id=routeTo.rut_to_city_id) AND routeAlias.rut_active = 1 AND routeAlias.rut_from_city_id=30804  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)"}]
2024/10/17 13:53:38 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23285.747] [M: 22243.95] [ET: 4.865/23259.754] [MU: 2.16/22243.51] 
	SQL: SELECT *, (rte_vendor_amount + extraDistance * 10.55) as totalCost FROM (SELECT * FROM nearest_route_30804_30711) a
					INNER JOIN rate ON a.rut_id = rate.rte_route_id AND rte_status=1 AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <>0
					WHERE 1 ORDER BY rank DESC, totalCost ASC LIMIT 0,1 
	 [params: {"cabType":"16"}]
2024/10/17 13:53:38 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23286.563] [M: 22251.97] [ET: 0.677/23260.584] [MU: 0.74/22249.97] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"getNearestRoute_30804_30711_70","sql":"(INDEX getNearestRoute_30804_30711_70_index_rut_id (rut_id))\r\n\t\t\t\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id AS start, routeAlias.rut_to_city_id AS end,\r\n\t\t\t\t\t\t\t\trouteFrom.rut_name AS fromAlias, NULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance AS quotedDistance,\r\n\t\t\t\t\t\t\t\trouteAlias.rut_estm_distance AS rateDistance, \r\n\t\t\t\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance)\r\n\t\t\t\t\t\t\t\t\t - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance,\r\n\t\t\t\t\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance,\r\n\t\t\t\t\t\t\t\t0 AS rank, routeFrom.rut_estm_time AS startTime, 0 AS endTime, route.rut_estm_time, \r\n\t\t\t\t\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraTravelDistance\r\n\t\t\t\t\t\tFROM   route\r\n\t\t\t\t\t\tINNER JOIN route routeTo ON routeTo.rut_to_city_id=route.rut_from_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_from_city_id=30804 AND routeTo.rut_active=1\r\n\t\t\t\t\t\t\t\tAND routeTo.rut_estm_distance<70 AND route.rut_active=1\r\n\t\t\t\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_from_city_id=route.rut_to_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_active = 1\r\n\t\t\t\t\t\t\t\tAND routeFrom.rut_estm_distance<70 AND route.rut_active = 1\r\n\t\t\t\t\t\tINNER JOIN route routeAlias ON routeAlias.rut_to_city_id=routeFrom.rut_to_city_id\r\n\t\t\t\t\t\t\tAND routeAlias.rut_from_city_id=routeTo.rut_from_city_id AND routeAlias.rut_active = 1"}]
2024/10/17 13:53:38 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23289.215] [M: 22257.23] [ET: 2.528/23263.202] [MU: 2.41/22256.61] 
	SQL: SELECT *, (rte_vendor_amount + extradistance * 10.55 ) AS totalCost, 
						ABS(quotedDistance-rateDistance) AS extraChargeableDistance
					FROM getNearestRoute_30804_30711_70 a
					INNER JOIN rate ON a.rut_id=rate.rte_route_id AND rte_status=1 
						AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <> 0
					WHERE  1
					ORDER  BY rank DESC, extraStartDistance, extraChargeableDistance ASC, totalcost ASC
					LIMIT  0, 1 
	 [params: {"cabType":"16"}]
2024/10/17 13:53:38 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23293.21] [M: 22272.31] [ET: 0.924/23267.219] [MU: 3.41/22271.44] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:38 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23295.183] [M: 22282.56] [ET: 410.925/23269.201] [MU: 130.26/22282.41] 
	Quote::calculateOneWay  for CAB 16 Date: 2024-10-31 18:00:00
2024/10/17 13:53:38 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23295.893] [M: 22286.16] [ET: 0.554/23269.904] [MU: 0.9/22285.91] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:38 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23297.643] [M: 22298.87] [ET: 0.807/23271.674] [MU: 3.33/22298.43] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:38 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23298.48] [M: 22327.79] [ET: 0.726/23272.512] [MU: 22.4/22327.04] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp38)) OR (apr_area_type = 5 AND apr_area_id IN (:gp36)) OR (apr_area_type = 2 AND apr_area_id IN (:gp39)) OR (apr_area_type = 4 AND apr_area_id IN (:gp40)) OR (apr_area_type = 1 AND apr_area_id IN (:gp37))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp36":"3699",":gp37":"31",":gp38":"30804",":gp39":"105",":gp40":"1","cab":"16"}]
2024/10/17 13:53:38 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23300.073] [M: 22315.05] [ET: 0.605/23274.09] [MU: 3.33/22314.61] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:38 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23302.47] [M: 22325.59] [ET: 2.242/23276.496] [MU: 3.53/22324.72] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp43)) OR (scr_area_type = 5 AND scr_area_id IN (:gp41)) OR (scr_area_type = 2 AND scr_area_id IN (:gp44)) OR (scr_area_type = 4 AND scr_area_id IN (:gp45)) OR (scr_area_type = 1 AND scr_area_id IN (:gp42)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp41":"3699",":gp42":"31",":gp43":"3699",":gp44":"105",":gp45":"1","scv_id":"16"}]
2024/10/17 13:53:38 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23303.121] [M: 22326.77] [ET: 0.299/23277.16] [MU: 2.98/22326.66] 
	BookingRoute::calculateDistance
2024/10/17 13:53:38 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23309.881] [M: 22336.88] [ET: 1.033/23283.884] [MU: 2.79/22336.26] 
	SQL: SELECT 
						fc.cty_id as c2id, 
						fc.cty_name as c2name, 
						fc.cty_garage_address as c2address,
						tc.cty_id as c4id,
						tc.cty_name as c4name, tc.cty_garage_address as c4address,
						0 as totalExtraDistance FROM route
						INNER JOIN cities fc ON rut_from_city_id=fc.cty_id
						INNER JOIN cities tc ON rut_to_city_id=tc.cty_id
						INNER JOIN rate on  rate.rte_route_id=route.rut_id  AND rate.rte_vehicletype_id IN (3)
						WHERE route.rut_from_city_id=30804 AND route.rut_to_city_id=30711 AND route.rut_active=1 
	 [params: []]
2024/10/17 13:53:38 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23310.791] [M: 22350.77] [ET: 0.786/23284.813] [MU: 6.53/22348.77] 
	SQL: 
				SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address, tc.cty_id as c4id, 
				tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
					FROM
					 (
						(
							SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id,  
								r3.rut_to_city_id, route.rut_name , route.rut_id,
								(route.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, 
								r3.rut_estm_distance
							FROM route
							INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_from_city_id=30804  
									AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=route.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) 
									AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
						UNION
						(
							SELECT r3.rut_id, r3.rut_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,(route.rut_estm_distance + r1.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
							FROM route
							INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND  route.rut_to_city_id=30711 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND route.rut_to_city_id=r3.rut_to_city_id))	AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
                     ) a
					INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
					INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1 
	 [params: []]
2024/10/17 13:53:38 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23311.406] [M: 22361.27] [ET: 0.532/23285.431] [MU: 5.04/22359.77] 
	SQL: SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
                              tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
                        FROM (SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,
                                    (route.rut_estm_distance + r1.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
                                FROM route
								INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
								INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
								INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) AND r3.rut_active=1 
								INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3) LIMIT 1
							)a
                        INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
                        INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1
                         
	 [params: []]
2024/10/17 13:53:38 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23311.977] [M: 22367.65] [ET: 0.484/23285.999] [MU: 0.75/22366.77] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"GarageRoute_30804_30711","sql":" (INDEX GarageRoute_30804_30711_index_rut_id (rut_id), INDEX GarageRoute_30804_30711_index_rut_from_city_id (rut_from_city_id), INDEX GarageRoute_30804_30711_index_rut_to_city_id (rut_to_city_id))\r\n\t\t\t\t\t\t\tSELECT route.rut_id, route.rut_from_city_id, route.rut_to_city_id, route.rut_name, rut_estm_distance FROM route \r\n\t\t\t\t\t\t\tINNER JOIN cities_stats   ON cities_stats.cts_cty_id = route.rut_from_city_id\r\n\t\t\t\t\t\t\tAND rut_estm_distance < 300\r\n\t\t\t\t\t\t\tAND rut_active = 1\r\n\t\t\t\t\t\t\tAND route.rut_to_city_id=30804\r\n\t\t\t\t\t\t\tAND cities_stats.cts_vnd_cnt >= 3\r\n\t\t\t\t\t\t\tORDER BY rut_estm_distance LIMIT 10"}]
2024/10/17 13:53:38 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23313.127] [M: 22379.57] [ET: 1.059/23287.15] [MU: 6.68/22377.82] 
	SQL: SELECT a.*, fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
								tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address 
						FROM ((SELECT xyz.rut_from_city_id as startCity, r1.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r3.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_from_city_id
							INNER JOIN rate ON rate.rte_route_id=r1.rut_id  AND rate.rte_vehicletype_id IN (3)
							INNER JOIN route r2 ON r2.rut_to_city_id=r1.rut_to_city_id AND r2.rut_from_city_id=:dropCity AND r2.rut_active=1
							INNER JOIN route r3 ON r3.rut_from_city_id=xyz.rut_to_city_id AND r3.rut_to_city_id=r2.rut_from_city_id AND r3.rut_active=1
							ORDER BY ExtraDistance LIMIT 1
							)
							UNION
							(
							SELECT xyz.rut_from_city_id as startCity, r2.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r2.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_to_city_id AND r1.rut_to_city_id=:dropCity
							INNER JOIN route r2 ON r2.rut_to_city_id=xyz.rut_from_city_id AND r2.rut_from_city_id=r1.rut_to_city_id
							ORDER BY ExtraDistance ASC LIMIT 1
							)) a
						INNER JOIN cities fc ON startCity=fc.cty_id
						INNER JOIN cities tc ON endCity=tc.cty_id 
						ORDER BY ExtraDistance 
	 [params: {"pickupCity":"30804","dropCity":"30711"}]
2024/10/17 13:53:38 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23316.502] [M: 22390.91] [ET: 1.202/23290.534] [MU: 7.89/22390.8] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23330.058] [M: 22396.39] [ET: 13.464/23304.091] [MU: 8.26/22396.28] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23330.915] [M: 22404.02] [ET: 0.363/23304.949] [MU: 0.99/22403.64] 
	SQL: SELECT cts_airport_pickup_entry_fee
               FROM   cities
               INNER JOIN cities_stats
               ON cities.cty_id = cities_stats.cts_cty_id
               WHERE  cty_id = :cityId
               AND cty_is_airport = 1 AND cty_active = 1 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23332.494] [M: 22417.93] [ET: 0.94/23306.531] [MU: 8.13/22417.82] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23342.884] [M: 22425.67] [ET: 10.227/23316.853] [MU: 8.08/22425.56] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23343.814] [M: 22425.1] [ET: 0.718/23317.82] [MU: 0.89/22424.85] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23345.338] [M: 22437.81] [ET: 0.532/23319.371] [MU: 3.34/22437.38] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23346.256] [M: 22466.73] [ET: 0.813/23320.288] [MU: 22.41/22465.98] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp48)) OR (apr_area_type = 5 AND apr_area_id IN (:gp46)) OR (apr_area_type = 2 AND apr_area_id IN (:gp49)) OR (apr_area_type = 4 AND apr_area_id IN (:gp50)) OR (apr_area_type = 1 AND apr_area_id IN (:gp47))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp46":"3699",":gp47":"31",":gp48":"30804",":gp49":"105",":gp50":"1","cab":"16"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23348.189] [M: 22453.99] [ET: 0.834/23322.156] [MU: 3.34/22453.55] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23350.653] [M: 22464.54] [ET: 2.248/23324.648] [MU: 3.53/22463.66] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp53)) OR (scr_area_type = 5 AND scr_area_id IN (:gp51)) OR (scr_area_type = 2 AND scr_area_id IN (:gp54)) OR (scr_area_type = 4 AND scr_area_id IN (:gp55)) OR (scr_area_type = 1 AND scr_area_id IN (:gp52)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp51":"3699",":gp52":"31",":gp53":"3699",":gp54":"105",":gp55":"1","scv_id":"16"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23351.462] [M: 22467.76] [ET: 0.342/23325.484] [MU: 2.98/22467.65] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23353.251] [M: 22480.87] [ET: 0.456/23327.262] [MU: 2.98/22480.76] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23353.78] [M: 22485.04] [ET: 0.397/23327.792] [MU: 2.97/22484.93] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23358.832] [M: 22519] [ET: 0.757/23332.841] [MU: 6.28/22517] 
	SQL: 
                SELECT cities.cty_id as c2id, cities.cty_name as c2name, cities.cty_garage_address as c2address,
                    cities.cty_id as c4id, cities.cty_name as c4name, cities.cty_garage_address as c4address,
                        (distance * 2) as totalExtraDistance
                 FROM (SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<40
                     INNER JOIN route r1 ON route.rut_to_city_id=r1.rut_from_city_id AND r1.rut_active=1
                     INNER JOIN rate ON r1.rut_id=rate.rte_route_id AND rate.rte_status=1  AND rate.rte_vehicletype_id IN (3) GROUP BY route.rut_id HAVING count(*) >30
                   UNION
                     SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<600
                     INNER JOIN cities tc ON tc.cty_id=route.rut_to_city_id AND tc.cty_service_active=1 AND CalcDistance(cities.cty_lat, cities.cty_long, tc.cty_lat, tc.cty_long)<=route.rut_estm_distance						 
                     INNER JOIN cities_stats ON cities_stats.cts_cty_id = route.rut_to_city_id AND cities_stats.cts_vnd_cnt >= 2
                   UNION
                    SELECT cts_cty_id AS city, 0 AS distance
					FROM cities_stats WHERE 1 AND cities_stats.cts_cty_id= 30817 and cities_stats.cts_vnd_cnt>1) a
                    INNER JOIN cities ON cities.cty_id=a.city
                    ORDER BY totalExtraDistance LIMIT 1 
	 [params: []]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23362.187] [M: 22533.81] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"3","tripDistance":"","tripDuration":"","multiCityData":"","bookingType":"1","pickupAddress":"","pickupDate":"31\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","sccId":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=3&tripDistance=&tripDuration=&multiCityData=&bookingType=1&pickupAddress=&pickupDate=31%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&sccId=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23362.825] [M: 22550.66] [ET: 1.173/23336.847] [MU: 18.05/22550.55] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23362.874] [M: 22552.34] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23363.943] [M: 22565.8] [ET: 0.891/23337.948] [MU: 2.99/22563.3] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+10013),(IF((cpm_value_type=2),(10013+(10013*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30937 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30937) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-31 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=16 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23365.815] [M: 22608.02] [ET: 4.241/23339.834] [MU: 75.88/22607.87] 
	RouteRates::calculate for CAB 16 2024-10-31 18:00:00 - Trip Type: 1 448539781
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23366.03] [M: 22585.71] [ET: 70.75/23340.054] [MU: 301.6/22585.55] 
	Quote::calculateRules for CAB 16, From City Id: 30804, To city Id: 30711
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23366.374] [M: 22558.31] [ET: 0.233/23340.395] [MU: 0.9/22558.06] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"16"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23366.484] [M: 22559.56] [ET: 570.359/23340.505] [MU: 453.69/22559.47] 
	Quote For CabType: 16
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23367.904] [M: 22569.91] [ET: 0.461/23341.922] [MU: 3.33/22569.47] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23368.437] [M: 22575.72] [ET: 0.431/23342.456] [MU: 3.33/22575.28] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23369.027] [M: 22578.66] [ET: 0.488/23343.045] [MU: 0.9/22578.41] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23369.668] [M: 22611.02] [ET: 0.484/23343.682] [MU: 24.22/22609.52] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (100) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30711) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp56)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp59,:gp60)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp57,:gp58)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp61,:gp62))
			OR (scr_area_type = 5 AND scr_area_id IN (3699))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (45)
		ORDER BY rank DESC
		 
	 [params: {":gp56":"31",":gp57":"30804",":gp58":"30711",":gp59":"105",":gp60":"100",":gp61":"1",":gp62":"1","tripType":"1"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23370.441] [M: 22591.19] [ET: 0.211/23344.461] [MU: 0.83/22591] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23370.859] [M: 22594.06] [ET: 0.306/23344.879] [MU: 0.96/22593.75] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"4"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23375.384] [M: 22611.89] [ET: 3.252/23349.379] [MU: 3.53/22611.02] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"45","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23376.444] [M: 22615.14] [ET: 0.74/23350.471] [MU: 0.86/22614.92] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":0}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23377.282] [M: 22622.42] [ET: 0.639/23351.296] [MU: 2.97/22621.98] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23378.03] [M: 22650.59] [ET: 0.593/23352.055] [MU: 22.05/22649.97] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp64)) OR (apr_area_type = 2 AND apr_area_id IN (:gp65)) OR (apr_area_type = 4 AND apr_area_id IN (:gp66)) OR (apr_area_type = 1 AND apr_area_id IN (:gp63))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp63":"31",":gp64":"30804",":gp65":"105",":gp66":"1","cab":"45"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23379.252] [M: 22637.3] [ET: 0.566/23353.27] [MU: 3.34/22636.87] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23381.644] [M: 22647.46] [ET: 2.233/23355.662] [MU: 3.41/22646.59] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp68)) OR (scr_area_type = 2 AND scr_area_id IN (:gp69)) OR (scr_area_type = 4 AND scr_area_id IN (:gp70)) OR (scr_area_type = 1 AND scr_area_id IN (:gp67)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp67":"31",":gp68":"30804",":gp69":"105",":gp70":"1","scv_id":"45"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23385.552] [M: 22675.33] [ET: 2.928/23359.54] [MU: 0.74/22667.33] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"nearest_route_30804_30711","sql":"(INDEX indx_nearest_rt_rutid (rut_id)) \r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, routeFrom.rut_name as fromAlias, \r\n\t\t\t\tNULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, \r\n\t\t\t\t0 as rank, routeFrom.rut_estm_time as startTime, 0 as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 \r\n\t\t\t\tAND routeFrom.rut_from_city_id<>routeFrom.rut_to_city_id AND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\t\tAND (routeAlias.rut_to_city_id=route.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, NULL, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) \r\n\t\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\t0 AS extraStartDistance, 0, 0 as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND route.rut_from_city_id = 30804 AND route.rut_to_city_id=30711 \r\n\t\t\t\tAND routeTo.rut_from_city_id=30711\r\n\t\t\t\tAND route.rut_active = 1 AND routeTo.rut_active = 1 AND routeTo.rut_estm_distance < 50 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = route.rut_from_city_id) \r\n\t\t\t   AND (routeAlias.rut_to_city_id = routeTo.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, \r\n\t\t\t\trouteFrom.rut_name, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t+ IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) \r\n\t\t\t\tAS extraDistance, IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, 0, \r\n\t\t\t\trouteFrom.rut_estm_time as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 AND routeFrom.rut_from_city_id <> routeFrom.rut_to_city_id\r\n\t\t\t\t\tAND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND routeTo.rut_estm_distance < 50 \r\n\t\t\t\t\tAND routeTo.rut_from_city_id=30711 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\tAND (routeAlias.rut_to_city_id=routeTo.rut_to_city_id) AND routeAlias.rut_active = 1 AND routeAlias.rut_from_city_id=30804  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23389.163] [M: 22679.41] [ET: 3.479/23363.167] [MU: 2.16/22678.97] 
	SQL: SELECT *, (rte_vendor_amount + extraDistance * 10.55) as totalCost FROM (SELECT * FROM nearest_route_30804_30711) a
					INNER JOIN rate ON a.rut_id = rate.rte_route_id AND rte_status=1 AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <>0
					WHERE 1 ORDER BY rank DESC, totalCost ASC LIMIT 0,1 
	 [params: {"cabType":"45"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23390.085] [M: 22687.43] [ET: 0.753/23364.073] [MU: 0.74/22685.43] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"getNearestRoute_30804_30711_70","sql":"(INDEX getNearestRoute_30804_30711_70_index_rut_id (rut_id))\r\n\t\t\t\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id AS start, routeAlias.rut_to_city_id AS end,\r\n\t\t\t\t\t\t\t\trouteFrom.rut_name AS fromAlias, NULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance AS quotedDistance,\r\n\t\t\t\t\t\t\t\trouteAlias.rut_estm_distance AS rateDistance, \r\n\t\t\t\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance)\r\n\t\t\t\t\t\t\t\t\t - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance,\r\n\t\t\t\t\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance,\r\n\t\t\t\t\t\t\t\t0 AS rank, routeFrom.rut_estm_time AS startTime, 0 AS endTime, route.rut_estm_time, \r\n\t\t\t\t\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraTravelDistance\r\n\t\t\t\t\t\tFROM   route\r\n\t\t\t\t\t\tINNER JOIN route routeTo ON routeTo.rut_to_city_id=route.rut_from_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_from_city_id=30804 AND routeTo.rut_active=1\r\n\t\t\t\t\t\t\t\tAND routeTo.rut_estm_distance<70 AND route.rut_active=1\r\n\t\t\t\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_from_city_id=route.rut_to_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_active = 1\r\n\t\t\t\t\t\t\t\tAND routeFrom.rut_estm_distance<70 AND route.rut_active = 1\r\n\t\t\t\t\t\tINNER JOIN route routeAlias ON routeAlias.rut_to_city_id=routeFrom.rut_to_city_id\r\n\t\t\t\t\t\t\tAND routeAlias.rut_from_city_id=routeTo.rut_from_city_id AND routeAlias.rut_active = 1"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23393.351] [M: 22692.7] [ET: 3.111/23367.347] [MU: 2.41/22692.07] 
	SQL: SELECT *, (rte_vendor_amount + extradistance * 10.55 ) AS totalCost, 
						ABS(quotedDistance-rateDistance) AS extraChargeableDistance
					FROM getNearestRoute_30804_30711_70 a
					INNER JOIN rate ON a.rut_id=rate.rte_route_id AND rte_status=1 
						AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <> 0
					WHERE  1
					ORDER  BY rank DESC, extraStartDistance, extraChargeableDistance ASC, totalcost ASC
					LIMIT  0, 1 
	 [params: {"cabType":"45"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23397.019] [M: 22707.77] [ET: 0.57/23371.048] [MU: 3.41/22706.9] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"16","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23398.689] [M: 22724.39] [ET: 0.491/23372.719] [MU: 3.78/22723.52] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23399.917] [M: 22767.5] [ET: 28.009/23373.953] [MU: 163.57/22767.34] 
	Quote::calculateOneWay  for CAB 45 Date: 2024-10-31 18:00:00
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23400.481] [M: 22771] [ET: 0.472/23374.514] [MU: 0.9/22770.75] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23401.649] [M: 22783.71] [ET: 0.617/23375.675] [MU: 3.34/22783.27] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23402.378] [M: 22812.63] [ET: 0.555/23376.408] [MU: 22.41/22811.88] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp73)) OR (apr_area_type = 5 AND apr_area_id IN (:gp71)) OR (apr_area_type = 2 AND apr_area_id IN (:gp74)) OR (apr_area_type = 4 AND apr_area_id IN (:gp75)) OR (apr_area_type = 1 AND apr_area_id IN (:gp72))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp71":"3699",":gp72":"31",":gp73":"30804",":gp74":"105",":gp75":"1","cab":"45"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23403.884] [M: 22799.89] [ET: 0.489/23377.917] [MU: 3.34/22799.45] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23406.1] [M: 22810.44] [ET: 2.098/23380.123] [MU: 3.54/22809.56] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp78)) OR (scr_area_type = 5 AND scr_area_id IN (:gp76)) OR (scr_area_type = 2 AND scr_area_id IN (:gp79)) OR (scr_area_type = 4 AND scr_area_id IN (:gp80)) OR (scr_area_type = 1 AND scr_area_id IN (:gp77)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp76":"3699",":gp77":"31",":gp78":"3699",":gp79":"105",":gp80":"1","scv_id":"45"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23406.617] [M: 22811.62] [ET: 0.241/23380.654] [MU: 2.98/22811.51] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23408.044] [M: 22821.82] [ET: 0.497/23382.075] [MU: 2.79/22821.2] 
	SQL: SELECT 
						fc.cty_id as c2id, 
						fc.cty_name as c2name, 
						fc.cty_garage_address as c2address,
						tc.cty_id as c4id,
						tc.cty_name as c4name, tc.cty_garage_address as c4address,
						0 as totalExtraDistance FROM route
						INNER JOIN cities fc ON rut_from_city_id=fc.cty_id
						INNER JOIN cities tc ON rut_to_city_id=tc.cty_id
						INNER JOIN rate on  rate.rte_route_id=route.rut_id  AND rate.rte_vehicletype_id IN (3)
						WHERE route.rut_from_city_id=30804 AND route.rut_to_city_id=30711 AND route.rut_active=1 
	 [params: []]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23408.476] [M: 22835.7] [ET: 0.357/23382.505] [MU: 6.54/22833.7] 
	SQL: 
				SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address, tc.cty_id as c4id, 
				tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
					FROM
					 (
						(
							SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id,  
								r3.rut_to_city_id, route.rut_name , route.rut_id,
								(route.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, 
								r3.rut_estm_distance
							FROM route
							INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_from_city_id=30804  
									AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=route.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) 
									AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
						UNION
						(
							SELECT r3.rut_id, r3.rut_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,(route.rut_estm_distance + r1.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
							FROM route
							INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND  route.rut_to_city_id=30711 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND route.rut_to_city_id=r3.rut_to_city_id))	AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
                     ) a
					INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
					INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1 
	 [params: []]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23408.877] [M: 22846.21] [ET: 0.328/23382.908] [MU: 5.03/22844.71] 
	SQL: SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
                              tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
                        FROM (SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,
                                    (route.rut_estm_distance + r1.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
                                FROM route
								INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
								INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
								INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) AND r3.rut_active=1 
								INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3) LIMIT 1
							)a
                        INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
                        INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1
                         
	 [params: []]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23409.8] [M: 22852.59] [ET: 0.662/23383.629] [MU: 0.74/22851.71] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"GarageRoute_30804_30711","sql":" (INDEX GarageRoute_30804_30711_index_rut_id (rut_id), INDEX GarageRoute_30804_30711_index_rut_from_city_id (rut_from_city_id), INDEX GarageRoute_30804_30711_index_rut_to_city_id (rut_to_city_id))\r\n\t\t\t\t\t\t\tSELECT route.rut_id, route.rut_from_city_id, route.rut_to_city_id, route.rut_name, rut_estm_distance FROM route \r\n\t\t\t\t\t\t\tINNER JOIN cities_stats   ON cities_stats.cts_cty_id = route.rut_from_city_id\r\n\t\t\t\t\t\t\tAND rut_estm_distance < 300\r\n\t\t\t\t\t\t\tAND rut_active = 1\r\n\t\t\t\t\t\t\tAND route.rut_to_city_id=30804\r\n\t\t\t\t\t\t\tAND cities_stats.cts_vnd_cnt >= 3\r\n\t\t\t\t\t\t\tORDER BY rut_estm_distance LIMIT 10"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23410.58] [M: 22864.51] [ET: 0.622/23384.606] [MU: 6.69/22862.76] 
	SQL: SELECT a.*, fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
								tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address 
						FROM ((SELECT xyz.rut_from_city_id as startCity, r1.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r3.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_from_city_id
							INNER JOIN rate ON rate.rte_route_id=r1.rut_id  AND rate.rte_vehicletype_id IN (3)
							INNER JOIN route r2 ON r2.rut_to_city_id=r1.rut_to_city_id AND r2.rut_from_city_id=:dropCity AND r2.rut_active=1
							INNER JOIN route r3 ON r3.rut_from_city_id=xyz.rut_to_city_id AND r3.rut_to_city_id=r2.rut_from_city_id AND r3.rut_active=1
							ORDER BY ExtraDistance LIMIT 1
							)
							UNION
							(
							SELECT xyz.rut_from_city_id as startCity, r2.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r2.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_to_city_id AND r1.rut_to_city_id=:dropCity
							INNER JOIN route r2 ON r2.rut_to_city_id=xyz.rut_from_city_id AND r2.rut_from_city_id=r1.rut_to_city_id
							ORDER BY ExtraDistance ASC LIMIT 1
							)) a
						INNER JOIN cities fc ON startCity=fc.cty_id
						INNER JOIN cities tc ON endCity=tc.cty_id 
						ORDER BY ExtraDistance 
	 [params: {"pickupCity":"30804","dropCity":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23413.123] [M: 22875.85] [ET: 1.008/23387.156] [MU: 7.88/22875.74] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23414.076] [M: 22881.42] [ET: 0.857/23388.111] [MU: 8.27/22881.31] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23414.851] [M: 22889.05] [ET: 0.291/23388.886] [MU: 0.99/22888.67] 
	SQL: SELECT cts_airport_pickup_entry_fee
               FROM   cities
               INNER JOIN cities_stats
               ON cities.cty_id = cities_stats.cts_cty_id
               WHERE  cty_id = :cityId
               AND cty_is_airport = 1 AND cty_active = 1 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23416.286] [M: 22902.96] [ET: 0.89/23390.322] [MU: 8.13/22902.85] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23417.153] [M: 22910.7] [ET: 0.771/23391.188] [MU: 8.08/22910.59] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23417.709] [M: 22910.04] [ET: 0.463/23391.735] [MU: 0.9/22909.79] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23418.824] [M: 22922.75] [ET: 0.504/23392.858] [MU: 3.34/22922.31] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23419.446] [M: 22951.67] [ET: 0.513/23393.478] [MU: 22.4/22950.92] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp83)) OR (apr_area_type = 5 AND apr_area_id IN (:gp81)) OR (apr_area_type = 2 AND apr_area_id IN (:gp84)) OR (apr_area_type = 4 AND apr_area_id IN (:gp85)) OR (apr_area_type = 1 AND apr_area_id IN (:gp82))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp81":"3699",":gp82":"31",":gp83":"30804",":gp84":"105",":gp85":"1","cab":"45"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23420.888] [M: 22938.93] [ET: 0.487/23394.919] [MU: 3.33/22938.49] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23423.506] [M: 22949.48] [ET: 2.471/23397.494] [MU: 3.53/22948.6] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp88)) OR (scr_area_type = 5 AND scr_area_id IN (:gp86)) OR (scr_area_type = 2 AND scr_area_id IN (:gp89)) OR (scr_area_type = 4 AND scr_area_id IN (:gp90)) OR (scr_area_type = 1 AND scr_area_id IN (:gp87)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp86":"3699",":gp87":"31",":gp88":"3699",":gp89":"105",":gp90":"1","scv_id":"45"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23424.186] [M: 22952.7] [ET: 0.257/23398.221] [MU: 2.98/22952.59] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23425.773] [M: 22965.71] [ET: 0.294/23399.792] [MU: 2.97/22965.6] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23426.25] [M: 22969.79] [ET: 0.386/23400.285] [MU: 2.97/22969.68] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23429.976] [M: 23003.75] [ET: 0.609/23403.987] [MU: 6.28/23001.75] 
	SQL: 
                SELECT cities.cty_id as c2id, cities.cty_name as c2name, cities.cty_garage_address as c2address,
                    cities.cty_id as c4id, cities.cty_name as c4name, cities.cty_garage_address as c4address,
                        (distance * 2) as totalExtraDistance
                 FROM (SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<40
                     INNER JOIN route r1 ON route.rut_to_city_id=r1.rut_from_city_id AND r1.rut_active=1
                     INNER JOIN rate ON r1.rut_id=rate.rte_route_id AND rate.rte_status=1  AND rate.rte_vehicletype_id IN (3) GROUP BY route.rut_id HAVING count(*) >30
                   UNION
                     SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<600
                     INNER JOIN cities tc ON tc.cty_id=route.rut_to_city_id AND tc.cty_service_active=1 AND CalcDistance(cities.cty_lat, cities.cty_long, tc.cty_lat, tc.cty_long)<=route.rut_estm_distance						 
                     INNER JOIN cities_stats ON cities_stats.cts_cty_id = route.rut_to_city_id AND cities_stats.cts_vnd_cnt >= 2
                   UNION
                    SELECT cts_cty_id AS city, 0 AS distance
					FROM cities_stats WHERE 1 AND cities_stats.cts_cty_id= 30817 and cities_stats.cts_vnd_cnt>1) a
                    INNER JOIN cities ON cities.cty_id=a.city
                    ORDER BY totalExtraDistance LIMIT 1 
	 [params: []]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23432.662] [M: 23018.56] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"3","tripDistance":"","tripDuration":"","multiCityData":"","bookingType":"1","pickupAddress":"","pickupDate":"31\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","sccId":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=3&tripDistance=&tripDuration=&multiCityData=&bookingType=1&pickupAddress=&pickupDate=31%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&sccId=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23433.075] [M: 23035.41] [ET: 0.825/23407.11] [MU: 18.05/23035.3] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23433.126] [M: 23037.09] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23434.277] [M: 23050.55] [ET: 1.014/23408.293] [MU: 2.99/23048.05] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+10013),(IF((cpm_value_type=2),(10013+(10013*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30937 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30937) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-31 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=45 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23435.73] [M: 23092.77] [ET: 3.572/23409.766] [MU: 75.88/23092.62] 
	RouteRates::calculate for CAB 45 2024-10-31 18:00:00 - Trip Type: 1 381204593
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23435.869] [M: 23070.46] [ET: 35.895/23409.91] [MU: 301.5/23070.3] 
	Quote::calculateRules for CAB 45, From City Id: 30804, To city Id: 30711
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23436.142] [M: 23042.84] [ET: 0.2/23410.179] [MU: 0.9/23042.59] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"45"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23436.212] [M: 23044.09] [ET: 69.643/23410.253] [MU: 483.22/23044] 
	Quote For CabType: 45
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23437.296] [M: 23054.44] [ET: 0.367/23411.331] [MU: 3.33/23054] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23437.766] [M: 23060.25] [ET: 0.39/23411.785] [MU: 3.34/23059.81] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23438.383] [M: 23063.19] [ET: 0.524/23412.413] [MU: 0.9/23062.94] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23439.079] [M: 23095.55] [ET: 0.578/23413.107] [MU: 24.22/23094.05] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (100) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30711) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp91)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp94,:gp95)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp92,:gp93)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp96,:gp97))
			OR (scr_area_type = 5 AND scr_area_id IN (3699))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (54)
		ORDER BY rank DESC
		 
	 [params: {":gp91":"31",":gp92":"30804",":gp93":"30711",":gp94":"105",":gp95":"100",":gp96":"1",":gp97":"1","tripType":"1"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23439.7] [M: 23075.73] [ET: 0.176/23413.737] [MU: 0.84/23075.55] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23440.057] [M: 23078.61] [ET: 0.286/23414.094] [MU: 0.96/23078.3] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"4"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23443.923] [M: 23091.58] [ET: 3.085/23417.945] [MU: 2.05/23091.08] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"54"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23447.474] [M: 23100.96] [ET: 3.306/23421.496] [MU: 3.53/23100.09] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"54","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23448.315] [M: 23104.21] [ET: 0.599/23422.344] [MU: 0.86/23103.99] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":0}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23449.143] [M: 23111.49] [ET: 0.638/23423.166] [MU: 2.97/23111.05] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23449.921] [M: 23139.66] [ET: 0.614/23423.946] [MU: 22.05/23139.04] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp99)) OR (apr_area_type = 2 AND apr_area_id IN (:gp100)) OR (apr_area_type = 4 AND apr_area_id IN (:gp101)) OR (apr_area_type = 1 AND apr_area_id IN (:gp98))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp98":"31",":gp99":"30804",":gp100":"105",":gp101":"1","cab":"54"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23451.032] [M: 23126.39] [ET: 0.494/23425.065] [MU: 3.34/23125.95] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23453.265] [M: 23136.67] [ET: 2.108/23427.268] [MU: 3.41/23135.8] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp103)) OR (scr_area_type = 2 AND scr_area_id IN (:gp104)) OR (scr_area_type = 4 AND scr_area_id IN (:gp105)) OR (scr_area_type = 1 AND scr_area_id IN (:gp102)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp102":"31",":gp103":"30804",":gp104":"105",":gp105":"1","scv_id":"54"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23456.294] [M: 23164.4] [ET: 2.179/23430.299] [MU: 0.74/23156.4] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"nearest_route_30804_30711","sql":"(INDEX indx_nearest_rt_rutid (rut_id)) \r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, routeFrom.rut_name as fromAlias, \r\n\t\t\t\tNULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, \r\n\t\t\t\t0 as rank, routeFrom.rut_estm_time as startTime, 0 as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 \r\n\t\t\t\tAND routeFrom.rut_from_city_id<>routeFrom.rut_to_city_id AND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\t\tAND (routeAlias.rut_to_city_id=route.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, NULL, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) \r\n\t\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\t0 AS extraStartDistance, 0, 0 as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND route.rut_from_city_id = 30804 AND route.rut_to_city_id=30711 \r\n\t\t\t\tAND routeTo.rut_from_city_id=30711\r\n\t\t\t\tAND route.rut_active = 1 AND routeTo.rut_active = 1 AND routeTo.rut_estm_distance < 50 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = route.rut_from_city_id) \r\n\t\t\t   AND (routeAlias.rut_to_city_id = routeTo.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, \r\n\t\t\t\trouteFrom.rut_name, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t+ IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) \r\n\t\t\t\tAS extraDistance, IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, 0, \r\n\t\t\t\trouteFrom.rut_estm_time as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 AND routeFrom.rut_from_city_id <> routeFrom.rut_to_city_id\r\n\t\t\t\t\tAND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND routeTo.rut_estm_distance < 50 \r\n\t\t\t\t\tAND routeTo.rut_from_city_id=30711 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\tAND (routeAlias.rut_to_city_id=routeTo.rut_to_city_id) AND routeAlias.rut_active = 1 AND routeAlias.rut_from_city_id=30804  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23459.142] [M: 23168.48] [ET: 2.733/23433.147] [MU: 2.16/23168.04] 
	SQL: SELECT *, (rte_vendor_amount + extraDistance * 10.55) as totalCost FROM (SELECT * FROM nearest_route_30804_30711) a
					INNER JOIN rate ON a.rut_id = rate.rte_route_id AND rte_status=1 AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <>0
					WHERE 1 ORDER BY rank DESC, totalCost ASC LIMIT 0,1 
	 [params: {"cabType":"54"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23460.252] [M: 23176.5] [ET: 0.963/23434.252] [MU: 0.74/23174.5] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"getNearestRoute_30804_30711_70","sql":"(INDEX getNearestRoute_30804_30711_70_index_rut_id (rut_id))\r\n\t\t\t\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id AS start, routeAlias.rut_to_city_id AS end,\r\n\t\t\t\t\t\t\t\trouteFrom.rut_name AS fromAlias, NULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance AS quotedDistance,\r\n\t\t\t\t\t\t\t\trouteAlias.rut_estm_distance AS rateDistance, \r\n\t\t\t\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance)\r\n\t\t\t\t\t\t\t\t\t - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance,\r\n\t\t\t\t\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance,\r\n\t\t\t\t\t\t\t\t0 AS rank, routeFrom.rut_estm_time AS startTime, 0 AS endTime, route.rut_estm_time, \r\n\t\t\t\t\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraTravelDistance\r\n\t\t\t\t\t\tFROM   route\r\n\t\t\t\t\t\tINNER JOIN route routeTo ON routeTo.rut_to_city_id=route.rut_from_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_from_city_id=30804 AND routeTo.rut_active=1\r\n\t\t\t\t\t\t\t\tAND routeTo.rut_estm_distance<70 AND route.rut_active=1\r\n\t\t\t\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_from_city_id=route.rut_to_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_active = 1\r\n\t\t\t\t\t\t\t\tAND routeFrom.rut_estm_distance<70 AND route.rut_active = 1\r\n\t\t\t\t\t\tINNER JOIN route routeAlias ON routeAlias.rut_to_city_id=routeFrom.rut_to_city_id\r\n\t\t\t\t\t\t\tAND routeAlias.rut_from_city_id=routeTo.rut_from_city_id AND routeAlias.rut_active = 1"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23462.726] [M: 23181.77] [ET: 2.349/23436.747] [MU: 2.41/23181.14] 
	SQL: SELECT *, (rte_vendor_amount + extradistance * 10.55 ) AS totalCost, 
						ABS(quotedDistance-rateDistance) AS extraChargeableDistance
					FROM getNearestRoute_30804_30711_70 a
					INNER JOIN rate ON a.rut_id=rate.rte_route_id AND rte_status=1 
						AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <> 0
					WHERE  1
					ORDER  BY rank DESC, extraStartDistance, extraChargeableDistance ASC, totalcost ASC
					LIMIT  0, 1 
	 [params: {"cabType":"54"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23466.248] [M: 23196.86] [ET: 0.657/23440.258] [MU: 3.42/23195.98] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"45","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23467.941] [M: 23213.48] [ET: 0.463/23441.972] [MU: 3.78/23212.6] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"16","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23469.41] [M: 23230.09] [ET: 0.433/23443.443] [MU: 3.78/23229.22] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23470.562] [M: 23242.05] [ET: 26.537/23444.583] [MU: 149.04/23241.89] 
	Quote::calculateOneWay  for CAB 54 Date: 2024-10-31 18:00:00
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23471.092] [M: 23245.64] [ET: 0.42/23445.107] [MU: 0.9/23245.39] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23472.582] [M: 23258.35] [ET: 0.682/23446.598] [MU: 3.34/23257.91] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23473.292] [M: 23287.52] [ET: 0.556/23447.308] [MU: 22.54/23286.77] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp108)) OR (apr_area_type = 5 AND apr_area_id IN (:gp106)) OR (apr_area_type = 2 AND apr_area_id IN (:gp109)) OR (apr_area_type = 4 AND apr_area_id IN (:gp110)) OR (apr_area_type = 1 AND apr_area_id IN (:gp107))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp106":"3699",":gp107":"31",":gp108":"30804",":gp109":"105",":gp110":"1","cab":"54"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23475.195] [M: 23274.55] [ET: 0.535/23449.226] [MU: 3.33/23274.11] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23477.679] [M: 23285.09] [ET: 2.369/23451.703] [MU: 3.53/23284.22] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp113)) OR (scr_area_type = 5 AND scr_area_id IN (:gp111)) OR (scr_area_type = 2 AND scr_area_id IN (:gp114)) OR (scr_area_type = 4 AND scr_area_id IN (:gp115)) OR (scr_area_type = 1 AND scr_area_id IN (:gp112)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp111":"3699",":gp112":"31",":gp113":"3699",":gp114":"105",":gp115":"1","scv_id":"54"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23478.259] [M: 23286.26] [ET: 0.286/23452.277] [MU: 2.98/23286.15] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23479.91] [M: 23296.46] [ET: 0.484/23453.941] [MU: 2.79/23295.84] 
	SQL: SELECT 
						fc.cty_id as c2id, 
						fc.cty_name as c2name, 
						fc.cty_garage_address as c2address,
						tc.cty_id as c4id,
						tc.cty_name as c4name, tc.cty_garage_address as c4address,
						0 as totalExtraDistance FROM route
						INNER JOIN cities fc ON rut_from_city_id=fc.cty_id
						INNER JOIN cities tc ON rut_to_city_id=tc.cty_id
						INNER JOIN rate on  rate.rte_route_id=route.rut_id  AND rate.rte_vehicletype_id IN (3)
						WHERE route.rut_from_city_id=30804 AND route.rut_to_city_id=30711 AND route.rut_active=1 
	 [params: []]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23480.34] [M: 23310.34] [ET: 0.354/23454.37] [MU: 6.53/23308.34] 
	SQL: 
				SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address, tc.cty_id as c4id, 
				tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
					FROM
					 (
						(
							SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id,  
								r3.rut_to_city_id, route.rut_name , route.rut_id,
								(route.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, 
								r3.rut_estm_distance
							FROM route
							INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_from_city_id=30804  
									AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=route.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) 
									AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
						UNION
						(
							SELECT r3.rut_id, r3.rut_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,(route.rut_estm_distance + r1.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
							FROM route
							INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND  route.rut_to_city_id=30711 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND route.rut_to_city_id=r3.rut_to_city_id))	AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
                     ) a
					INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
					INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1 
	 [params: []]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23480.736] [M: 23320.85] [ET: 0.322/23454.768] [MU: 5.03/23319.35] 
	SQL: SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
                              tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
                        FROM (SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,
                                    (route.rut_estm_distance + r1.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
                                FROM route
								INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
								INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
								INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) AND r3.rut_active=1 
								INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3) LIMIT 1
							)a
                        INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
                        INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1
                         
	 [params: []]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23481.224] [M: 23327.23] [ET: 0.417/23455.255] [MU: 0.74/23326.35] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"GarageRoute_30804_30711","sql":" (INDEX GarageRoute_30804_30711_index_rut_id (rut_id), INDEX GarageRoute_30804_30711_index_rut_from_city_id (rut_from_city_id), INDEX GarageRoute_30804_30711_index_rut_to_city_id (rut_to_city_id))\r\n\t\t\t\t\t\t\tSELECT route.rut_id, route.rut_from_city_id, route.rut_to_city_id, route.rut_name, rut_estm_distance FROM route \r\n\t\t\t\t\t\t\tINNER JOIN cities_stats   ON cities_stats.cts_cty_id = route.rut_from_city_id\r\n\t\t\t\t\t\t\tAND rut_estm_distance < 300\r\n\t\t\t\t\t\t\tAND rut_active = 1\r\n\t\t\t\t\t\t\tAND route.rut_to_city_id=30804\r\n\t\t\t\t\t\t\tAND cities_stats.cts_vnd_cnt >= 3\r\n\t\t\t\t\t\t\tORDER BY rut_estm_distance LIMIT 10"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23481.751] [M: 23339.15] [ET: 0.449/23455.781] [MU: 6.69/23337.4] 
	SQL: SELECT a.*, fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
								tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address 
						FROM ((SELECT xyz.rut_from_city_id as startCity, r1.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r3.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_from_city_id
							INNER JOIN rate ON rate.rte_route_id=r1.rut_id  AND rate.rte_vehicletype_id IN (3)
							INNER JOIN route r2 ON r2.rut_to_city_id=r1.rut_to_city_id AND r2.rut_from_city_id=:dropCity AND r2.rut_active=1
							INNER JOIN route r3 ON r3.rut_from_city_id=xyz.rut_to_city_id AND r3.rut_to_city_id=r2.rut_from_city_id AND r3.rut_active=1
							ORDER BY ExtraDistance LIMIT 1
							)
							UNION
							(
							SELECT xyz.rut_from_city_id as startCity, r2.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r2.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_to_city_id AND r1.rut_to_city_id=:dropCity
							INNER JOIN route r2 ON r2.rut_to_city_id=xyz.rut_from_city_id AND r2.rut_from_city_id=r1.rut_to_city_id
							ORDER BY ExtraDistance ASC LIMIT 1
							)) a
						INNER JOIN cities fc ON startCity=fc.cty_id
						INNER JOIN cities tc ON endCity=tc.cty_id 
						ORDER BY ExtraDistance 
	 [params: {"pickupCity":"30804","dropCity":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23484.521] [M: 23350.49] [ET: 1.228/23458.553] [MU: 7.89/23350.38] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23485.547] [M: 23356.06] [ET: 0.93/23459.584] [MU: 8.27/23355.95] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23486.329] [M: 23363.59] [ET: 0.29/23460.364] [MU: 0.99/23363.22] 
	SQL: SELECT cts_airport_pickup_entry_fee
               FROM   cities
               INNER JOIN cities_stats
               ON cities.cty_id = cities_stats.cts_cty_id
               WHERE  cty_id = :cityId
               AND cty_is_airport = 1 AND cty_active = 1 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23487.923] [M: 23377.51] [ET: 1.009/23461.941] [MU: 8.13/23377.4] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23489.064] [M: 23385.25] [ET: 0.993/23463.088] [MU: 8.07/23385.14] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23489.514] [M: 23384.68] [ET: 0.347/23463.532] [MU: 0.9/23384.43] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23490.927] [M: 23397.39] [ET: 0.664/23464.942] [MU: 3.34/23396.95] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23491.795] [M: 23426.56] [ET: 0.692/23465.819] [MU: 22.54/23425.81] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp118)) OR (apr_area_type = 5 AND apr_area_id IN (:gp116)) OR (apr_area_type = 2 AND apr_area_id IN (:gp119)) OR (apr_area_type = 4 AND apr_area_id IN (:gp120)) OR (apr_area_type = 1 AND apr_area_id IN (:gp117))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp116":"3699",":gp117":"31",":gp118":"30804",":gp119":"105",":gp120":"1","cab":"54"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23493.827] [M: 23413.59] [ET: 0.592/23467.858] [MU: 3.33/23413.15] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23496.259] [M: 23424.13] [ET: 2.308/23470.266] [MU: 3.53/23423.26] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp123)) OR (scr_area_type = 5 AND scr_area_id IN (:gp121)) OR (scr_area_type = 2 AND scr_area_id IN (:gp124)) OR (scr_area_type = 4 AND scr_area_id IN (:gp125)) OR (scr_area_type = 1 AND scr_area_id IN (:gp122)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp121":"3699",":gp122":"31",":gp123":"3699",":gp124":"105",":gp125":"1","scv_id":"54"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23497.124] [M: 23427.34] [ET: 0.37/23471.145] [MU: 2.98/23427.23] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23498.967] [M: 23440.34] [ET: 0.312/23473] [MU: 2.97/23440.24] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23499.298] [M: 23444.43] [ET: 0.248/23473.331] [MU: 2.97/23444.32] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23503.285] [M: 23478.48] [ET: 0.675/23477.295] [MU: 6.28/23476.48] 
	SQL: 
                SELECT cities.cty_id as c2id, cities.cty_name as c2name, cities.cty_garage_address as c2address,
                    cities.cty_id as c4id, cities.cty_name as c4name, cities.cty_garage_address as c4address,
                        (distance * 2) as totalExtraDistance
                 FROM (SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<40
                     INNER JOIN route r1 ON route.rut_to_city_id=r1.rut_from_city_id AND r1.rut_active=1
                     INNER JOIN rate ON r1.rut_id=rate.rte_route_id AND rate.rte_status=1  AND rate.rte_vehicletype_id IN (3) GROUP BY route.rut_id HAVING count(*) >30
                   UNION
                     SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<600
                     INNER JOIN cities tc ON tc.cty_id=route.rut_to_city_id AND tc.cty_service_active=1 AND CalcDistance(cities.cty_lat, cities.cty_long, tc.cty_lat, tc.cty_long)<=route.rut_estm_distance						 
                     INNER JOIN cities_stats ON cities_stats.cts_cty_id = route.rut_to_city_id AND cities_stats.cts_vnd_cnt >= 2
                   UNION
                    SELECT cts_cty_id AS city, 0 AS distance
					FROM cities_stats WHERE 1 AND cities_stats.cts_cty_id= 30817 and cities_stats.cts_vnd_cnt>1) a
                    INNER JOIN cities ON cities.cty_id=a.city
                    ORDER BY totalExtraDistance LIMIT 1 
	 [params: []]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23506.264] [M: 23493.3] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"3","tripDistance":"","tripDuration":"","multiCityData":"","bookingType":"1","pickupAddress":"","pickupDate":"31\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","sccId":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=3&tripDistance=&tripDuration=&multiCityData=&bookingType=1&pickupAddress=&pickupDate=31%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&sccId=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23506.915] [M: 23510.14] [ET: 1.2/23480.937] [MU: 18.04/23510.03] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23506.966] [M: 23511.82] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23508.209] [M: 23525.28] [ET: 1.06/23482.212] [MU: 2.99/23522.78] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+10013),(IF((cpm_value_type=2),(10013+(10013*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30937 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30937) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-31 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=54 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23510.852] [M: 23567.51] [ET: 5.234/23484.861] [MU: 75.87/23567.35] 
	RouteRates::calculate for CAB 54 2024-10-31 18:00:00 - Trip Type: 1 166263311
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23511.078] [M: 23545.2] [ET: 40.442/23485.101] [MU: 301.59/23545.04] 
	Quote::calculateRules for CAB 54, From City Id: 30804, To city Id: 30711
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23511.457] [M: 23516.7] [ET: 0.265/23485.477] [MU: 0.9/23516.45] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"54"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23511.565] [M: 23517.95] [ET: 75.291/23485.59] [MU: 472.54/23517.85] 
	Quote For CabType: 54
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23512.888] [M: 23528.29] [ET: 0.457/23486.907] [MU: 3.33/23527.85] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23513.405] [M: 23534.1] [ET: 0.417/23487.426] [MU: 3.34/23533.66] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23514.005] [M: 23537.01] [ET: 0.5/23488.025] [MU: 0.9/23536.79] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23514.711] [M: 23569.4] [ET: 0.557/23488.724] [MU: 24.22/23567.9] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (100) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30711) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp126)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp129,:gp130)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp127,:gp128)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp131,:gp132))
			OR (scr_area_type = 5 AND scr_area_id IN (3699))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (55)
		ORDER BY rank DESC
		 
	 [params: {":gp126":"31",":gp127":"30804",":gp128":"30711",":gp129":"105",":gp130":"100",":gp131":"1",":gp132":"1","tripType":"1"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23515.594] [M: 23549.58] [ET: 0.241/23489.616] [MU: 0.83/23549.39] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23516.04] [M: 23552.45] [ET: 0.342/23490.053] [MU: 0.96/23552.14] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"4"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23517.591] [M: 23565.42] [ET: 0.428/23491.604] [MU: 2.04/23564.92] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"55"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23522.773] [M: 23574.8] [ET: 4.867/23496.761] [MU: 3.53/23573.93] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"55","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23523.776] [M: 23578.05] [ET: 0.603/23497.793] [MU: 0.87/23577.84] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":0}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23524.761] [M: 23585.34] [ET: 0.677/23498.782] [MU: 2.97/23584.9] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23525.611] [M: 23613.51] [ET: 0.691/23499.64] [MU: 22.05/23612.88] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp134)) OR (apr_area_type = 2 AND apr_area_id IN (:gp135)) OR (apr_area_type = 4 AND apr_area_id IN (:gp136)) OR (apr_area_type = 1 AND apr_area_id IN (:gp133))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp133":"31",":gp134":"30804",":gp135":"105",":gp136":"1","cab":"55"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23527.119] [M: 23600.23] [ET: 0.697/23501.114] [MU: 3.33/23599.79] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23530.091] [M: 23610.51] [ET: 2.78/23504.056] [MU: 3.41/23609.63] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp138)) OR (scr_area_type = 2 AND scr_area_id IN (:gp139)) OR (scr_area_type = 4 AND scr_area_id IN (:gp140)) OR (scr_area_type = 1 AND scr_area_id IN (:gp137)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp137":"31",":gp138":"30804",":gp139":"105",":gp140":"1","scv_id":"55"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23533.495] [M: 23643.74] [ET: 2.393/23507.484] [MU: 0.74/23635.74] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"nearest_route_30804_30711","sql":"(INDEX indx_nearest_rt_rutid (rut_id)) \r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, routeFrom.rut_name as fromAlias, \r\n\t\t\t\tNULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, \r\n\t\t\t\t0 as rank, routeFrom.rut_estm_time as startTime, 0 as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 \r\n\t\t\t\tAND routeFrom.rut_from_city_id<>routeFrom.rut_to_city_id AND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\t\tAND (routeAlias.rut_to_city_id=route.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, NULL, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) \r\n\t\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\t0 AS extraStartDistance, 0, 0 as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND route.rut_from_city_id = 30804 AND route.rut_to_city_id=30711 \r\n\t\t\t\tAND routeTo.rut_from_city_id=30711\r\n\t\t\t\tAND route.rut_active = 1 AND routeTo.rut_active = 1 AND routeTo.rut_estm_distance < 50 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = route.rut_from_city_id) \r\n\t\t\t   AND (routeAlias.rut_to_city_id = routeTo.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, \r\n\t\t\t\trouteFrom.rut_name, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t+ IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) \r\n\t\t\t\tAS extraDistance, IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, 0, \r\n\t\t\t\trouteFrom.rut_estm_time as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 AND routeFrom.rut_from_city_id <> routeFrom.rut_to_city_id\r\n\t\t\t\t\tAND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND routeTo.rut_estm_distance < 50 \r\n\t\t\t\t\tAND routeTo.rut_from_city_id=30711 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\tAND (routeAlias.rut_to_city_id=routeTo.rut_to_city_id) AND routeAlias.rut_active = 1 AND routeAlias.rut_from_city_id=30804  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23536.526] [M: 23647.82] [ET: 2.898/23510.549] [MU: 2.17/23647.38] 
	SQL: SELECT *, (rte_vendor_amount + extraDistance * 10.55) as totalCost FROM (SELECT * FROM nearest_route_30804_30711) a
					INNER JOIN rate ON a.rut_id = rate.rte_route_id AND rte_status=1 AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <>0
					WHERE 1 ORDER BY rank DESC, totalCost ASC LIMIT 0,1 
	 [params: {"cabType":"55"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23537.254] [M: 23655.84] [ET: 0.613/23511.275] [MU: 0.75/23653.84] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"getNearestRoute_30804_30711_70","sql":"(INDEX getNearestRoute_30804_30711_70_index_rut_id (rut_id))\r\n\t\t\t\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id AS start, routeAlias.rut_to_city_id AS end,\r\n\t\t\t\t\t\t\t\trouteFrom.rut_name AS fromAlias, NULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance AS quotedDistance,\r\n\t\t\t\t\t\t\t\trouteAlias.rut_estm_distance AS rateDistance, \r\n\t\t\t\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance)\r\n\t\t\t\t\t\t\t\t\t - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance,\r\n\t\t\t\t\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance,\r\n\t\t\t\t\t\t\t\t0 AS rank, routeFrom.rut_estm_time AS startTime, 0 AS endTime, route.rut_estm_time, \r\n\t\t\t\t\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraTravelDistance\r\n\t\t\t\t\t\tFROM   route\r\n\t\t\t\t\t\tINNER JOIN route routeTo ON routeTo.rut_to_city_id=route.rut_from_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_from_city_id=30804 AND routeTo.rut_active=1\r\n\t\t\t\t\t\t\t\tAND routeTo.rut_estm_distance<70 AND route.rut_active=1\r\n\t\t\t\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_from_city_id=route.rut_to_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_active = 1\r\n\t\t\t\t\t\t\t\tAND routeFrom.rut_estm_distance<70 AND route.rut_active = 1\r\n\t\t\t\t\t\tINNER JOIN route routeAlias ON routeAlias.rut_to_city_id=routeFrom.rut_to_city_id\r\n\t\t\t\t\t\t\tAND routeAlias.rut_from_city_id=routeTo.rut_from_city_id AND routeAlias.rut_active = 1"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23539.705] [M: 23661.11] [ET: 2.327/23513.684] [MU: 2.42/23660.48] 
	SQL: SELECT *, (rte_vendor_amount + extradistance * 10.55 ) AS totalCost, 
						ABS(quotedDistance-rateDistance) AS extraChargeableDistance
					FROM getNearestRoute_30804_30711_70 a
					INNER JOIN rate ON a.rut_id=rate.rte_route_id AND rte_status=1 
						AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <> 0
					WHERE  1
					ORDER  BY rank DESC, extraStartDistance, extraChargeableDistance ASC, totalcost ASC
					LIMIT  0, 1 
	 [params: {"cabType":"55"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23543.713] [M: 23676.2] [ET: 0.757/23517.741] [MU: 3.41/23675.32] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"45","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23545.605] [M: 23692.81] [ET: 0.633/23519.622] [MU: 3.78/23691.94] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"16","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23547.571] [M: 23709.43] [ET: 0.588/23521.59] [MU: 3.78/23708.55] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23549.098] [M: 23721.39] [ET: 31.412/23523.127] [MU: 154.55/23721.23] 
	Quote::calculateOneWay  for CAB 55 Date: 2024-10-31 18:00:00
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23549.666] [M: 23724.98] [ET: 0.446/23523.69] [MU: 0.9/23724.73] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23551.121] [M: 23737.7] [ET: 0.665/23525.142] [MU: 3.34/23737.26] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23551.929] [M: 23766.87] [ET: 0.617/23525.925] [MU: 22.53/23766.12] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp143)) OR (apr_area_type = 5 AND apr_area_id IN (:gp141)) OR (apr_area_type = 2 AND apr_area_id IN (:gp144)) OR (apr_area_type = 4 AND apr_area_id IN (:gp145)) OR (apr_area_type = 1 AND apr_area_id IN (:gp142))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp141":"3699",":gp142":"31",":gp143":"30804",":gp144":"105",":gp145":"1","cab":"55"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23553.881] [M: 23753.88] [ET: 0.661/23527.903] [MU: 3.34/23753.45] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23556.178] [M: 23764.43] [ET: 2.137/23530.198] [MU: 3.53/23763.55] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp148)) OR (scr_area_type = 5 AND scr_area_id IN (:gp146)) OR (scr_area_type = 2 AND scr_area_id IN (:gp149)) OR (scr_area_type = 4 AND scr_area_id IN (:gp150)) OR (scr_area_type = 1 AND scr_area_id IN (:gp147)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp146":"3699",":gp147":"31",":gp148":"3699",":gp149":"105",":gp150":"1","scv_id":"55"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23557.047] [M: 23765.6] [ET: 0.419/23531.08] [MU: 2.97/23765.49] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23558.695] [M: 23775.71] [ET: 0.542/23532.707] [MU: 2.79/23775.09] 
	SQL: SELECT 
						fc.cty_id as c2id, 
						fc.cty_name as c2name, 
						fc.cty_garage_address as c2address,
						tc.cty_id as c4id,
						tc.cty_name as c4name, tc.cty_garage_address as c4address,
						0 as totalExtraDistance FROM route
						INNER JOIN cities fc ON rut_from_city_id=fc.cty_id
						INNER JOIN cities tc ON rut_to_city_id=tc.cty_id
						INNER JOIN rate on  rate.rte_route_id=route.rut_id  AND rate.rte_vehicletype_id IN (3)
						WHERE route.rut_from_city_id=30804 AND route.rut_to_city_id=30711 AND route.rut_active=1 
	 [params: []]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23559.493] [M: 23789.59] [ET: 0.703/23533.467] [MU: 6.53/23787.59] 
	SQL: 
				SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address, tc.cty_id as c4id, 
				tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
					FROM
					 (
						(
							SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id,  
								r3.rut_to_city_id, route.rut_name , route.rut_id,
								(route.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, 
								r3.rut_estm_distance
							FROM route
							INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_from_city_id=30804  
									AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=route.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) 
									AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
						UNION
						(
							SELECT r3.rut_id, r3.rut_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,(route.rut_estm_distance + r1.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
							FROM route
							INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND  route.rut_to_city_id=30711 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND route.rut_to_city_id=r3.rut_to_city_id))	AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
                     ) a
					INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
					INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1 
	 [params: []]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23560.128] [M: 23864.1] [ET: 0.533/23534.156] [MU: 5.03/23862.6] 
	SQL: SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
                              tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
                        FROM (SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,
                                    (route.rut_estm_distance + r1.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
                                FROM route
								INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
								INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
								INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) AND r3.rut_active=1 
								INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3) LIMIT 1
							)a
                        INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
                        INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1
                         
	 [params: []]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23560.623] [M: 23870.48] [ET: 0.412/23534.647] [MU: 0.74/23869.6] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"GarageRoute_30804_30711","sql":" (INDEX GarageRoute_30804_30711_index_rut_id (rut_id), INDEX GarageRoute_30804_30711_index_rut_from_city_id (rut_from_city_id), INDEX GarageRoute_30804_30711_index_rut_to_city_id (rut_to_city_id))\r\n\t\t\t\t\t\t\tSELECT route.rut_id, route.rut_from_city_id, route.rut_to_city_id, route.rut_name, rut_estm_distance FROM route \r\n\t\t\t\t\t\t\tINNER JOIN cities_stats   ON cities_stats.cts_cty_id = route.rut_from_city_id\r\n\t\t\t\t\t\t\tAND rut_estm_distance < 300\r\n\t\t\t\t\t\t\tAND rut_active = 1\r\n\t\t\t\t\t\t\tAND route.rut_to_city_id=30804\r\n\t\t\t\t\t\t\tAND cities_stats.cts_vnd_cnt >= 3\r\n\t\t\t\t\t\t\tORDER BY rut_estm_distance LIMIT 10"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23561.325] [M: 23882.4] [ET: 0.613/23535.353] [MU: 6.69/23880.65] 
	SQL: SELECT a.*, fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
								tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address 
						FROM ((SELECT xyz.rut_from_city_id as startCity, r1.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r3.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_from_city_id
							INNER JOIN rate ON rate.rte_route_id=r1.rut_id  AND rate.rte_vehicletype_id IN (3)
							INNER JOIN route r2 ON r2.rut_to_city_id=r1.rut_to_city_id AND r2.rut_from_city_id=:dropCity AND r2.rut_active=1
							INNER JOIN route r3 ON r3.rut_from_city_id=xyz.rut_to_city_id AND r3.rut_to_city_id=r2.rut_from_city_id AND r3.rut_active=1
							ORDER BY ExtraDistance LIMIT 1
							)
							UNION
							(
							SELECT xyz.rut_from_city_id as startCity, r2.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r2.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_to_city_id AND r1.rut_to_city_id=:dropCity
							INNER JOIN route r2 ON r2.rut_to_city_id=xyz.rut_from_city_id AND r2.rut_from_city_id=r1.rut_to_city_id
							ORDER BY ExtraDistance ASC LIMIT 1
							)) a
						INNER JOIN cities fc ON startCity=fc.cty_id
						INNER JOIN cities tc ON endCity=tc.cty_id 
						ORDER BY ExtraDistance 
	 [params: {"pickupCity":"30804","dropCity":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23563.928] [M: 23893.74] [ET: 1.04/23537.96] [MU: 7.89/23893.63] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23564.899] [M: 23899.22] [ET: 0.865/23538.916] [MU: 8.26/23899.11] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23565.963] [M: 23906.84] [ET: 0.334/23539.996] [MU: 0.99/23906.47] 
	SQL: SELECT cts_airport_pickup_entry_fee
               FROM   cities
               INNER JOIN cities_stats
               ON cities.cty_id = cities_stats.cts_cty_id
               WHERE  cty_id = :cityId
               AND cty_is_airport = 1 AND cty_active = 1 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23567.485] [M: 23920.76] [ET: 0.931/23541.503] [MU: 8.13/23920.65] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23568.628] [M: 23928.59] [ET: 1.001/23542.665] [MU: 8.08/23928.48] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23569.063] [M: 23928.02] [ET: 0.337/23543.081] [MU: 0.9/23927.77] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23570.5] [M: 23940.73] [ET: 0.698/23544.513] [MU: 3.34/23940.3] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23571.171] [M: 23969.91] [ET: 0.527/23545.202] [MU: 22.53/23969.16] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp153)) OR (apr_area_type = 5 AND apr_area_id IN (:gp151)) OR (apr_area_type = 2 AND apr_area_id IN (:gp154)) OR (apr_area_type = 4 AND apr_area_id IN (:gp155)) OR (apr_area_type = 1 AND apr_area_id IN (:gp152))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp151":"3699",":gp152":"31",":gp153":"30804",":gp154":"105",":gp155":"1","cab":"55"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23572.949] [M: 23956.92] [ET: 0.608/23546.967] [MU: 3.34/23956.48] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23575.433] [M: 23967.47] [ET: 2.314/23549.436] [MU: 3.53/23966.59] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp158)) OR (scr_area_type = 5 AND scr_area_id IN (:gp156)) OR (scr_area_type = 2 AND scr_area_id IN (:gp159)) OR (scr_area_type = 4 AND scr_area_id IN (:gp160)) OR (scr_area_type = 1 AND scr_area_id IN (:gp157)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp156":"3699",":gp157":"31",":gp158":"3699",":gp159":"105",":gp160":"1","scv_id":"55"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23576.407] [M: 23970.68] [ET: 0.42/23550.432] [MU: 2.97/23970.57] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23578.33] [M: 23983.7] [ET: 0.362/23552.352] [MU: 2.98/23983.59] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23578.756] [M: 23987.77] [ET: 0.319/23552.779] [MU: 2.98/23987.66] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23582.916] [M: 24021.83] [ET: 0.65/23556.925] [MU: 6.28/24019.83] 
	SQL: 
                SELECT cities.cty_id as c2id, cities.cty_name as c2name, cities.cty_garage_address as c2address,
                    cities.cty_id as c4id, cities.cty_name as c4name, cities.cty_garage_address as c4address,
                        (distance * 2) as totalExtraDistance
                 FROM (SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<40
                     INNER JOIN route r1 ON route.rut_to_city_id=r1.rut_from_city_id AND r1.rut_active=1
                     INNER JOIN rate ON r1.rut_id=rate.rte_route_id AND rate.rte_status=1  AND rate.rte_vehicletype_id IN (3) GROUP BY route.rut_id HAVING count(*) >30
                   UNION
                     SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<600
                     INNER JOIN cities tc ON tc.cty_id=route.rut_to_city_id AND tc.cty_service_active=1 AND CalcDistance(cities.cty_lat, cities.cty_long, tc.cty_lat, tc.cty_long)<=route.rut_estm_distance						 
                     INNER JOIN cities_stats ON cities_stats.cts_cty_id = route.rut_to_city_id AND cities_stats.cts_vnd_cnt >= 2
                   UNION
                    SELECT cts_cty_id AS city, 0 AS distance
					FROM cities_stats WHERE 1 AND cities_stats.cts_cty_id= 30817 and cities_stats.cts_vnd_cnt>1) a
                    INNER JOIN cities ON cities.cty_id=a.city
                    ORDER BY totalExtraDistance LIMIT 1 
	 [params: []]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23586.866] [M: 24036.64] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"3","tripDistance":"","tripDuration":"","multiCityData":"","bookingType":"1","pickupAddress":"","pickupDate":"31\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","sccId":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=3&tripDistance=&tripDuration=&multiCityData=&bookingType=1&pickupAddress=&pickupDate=31%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&sccId=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23587.722] [M: 24053.48] [ET: 1.532/23561.725] [MU: 18.05/24053.38] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23587.79] [M: 24055.16] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23589.023] [M: 24068.63] [ET: 1.001/23563.042] [MU: 2.99/24066.13] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+10013),(IF((cpm_value_type=2),(10013+(10013*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30937 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30937) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-31 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=55 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23591.712] [M: 24110.85] [ET: 5.634/23565.722] [MU: 75.88/24110.7] 
	RouteRates::calculate for CAB 55 2024-10-31 18:00:00 - Trip Type: 1 325754843
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23591.967] [M: 24088.54] [ET: 42.783/23565.987] [MU: 365.6/24088.38] 
	Quote::calculateRules for CAB 55, From City Id: 30804, To city Id: 30711
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23592.653] [M: 24060.05] [ET: 0.38/23566.482] [MU: 0.9/24059.8] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"55"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23592.876] [M: 24061.3] [ET: 81.216/23566.879] [MU: 542.05/24061.2] 
	Quote For CabType: 55
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23594.519] [M: 24071.64] [ET: 0.458/23568.547] [MU: 3.34/24071.2] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23594.989] [M: 24077.45] [ET: 0.39/23569.019] [MU: 3.34/24077.02] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23595.628] [M: 24080.39] [ET: 0.548/23569.641] [MU: 0.9/24080.14] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23596.313] [M: 24112.75] [ET: 0.53/23570.327] [MU: 24.22/24111.25] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (100) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30711) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp161)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp164,:gp165)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp162,:gp163)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp166,:gp167))
			OR (scr_area_type = 5 AND scr_area_id IN (3699))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (57)
		ORDER BY rank DESC
		 
	 [params: {":gp161":"31",":gp162":"30804",":gp163":"30711",":gp164":"105",":gp165":"100",":gp166":"1",":gp167":"1","tripType":"1"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23597.088] [M: 24092.93] [ET: 0.219/23571.119] [MU: 0.83/24092.74] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23597.45] [M: 24095.8] [ET: 0.279/23571.482] [MU: 0.96/24095.49] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"4"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23598.651] [M: 24108.77] [ET: 0.374/23572.68] [MU: 2.05/24108.27] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"57"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23601.869] [M: 24118.16] [ET: 2.97/23575.864] [MU: 3.53/24117.28] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"57","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23602.754] [M: 24121.41] [ET: 0.559/23576.777] [MU: 0.87/24121.19] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":0}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23603.537] [M: 24128.69] [ET: 0.581/23577.563] [MU: 2.97/24128.25] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23604.255] [M: 24156.86] [ET: 0.591/23578.281] [MU: 22.05/24156.23] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp169)) OR (apr_area_type = 2 AND apr_area_id IN (:gp170)) OR (apr_area_type = 4 AND apr_area_id IN (:gp171)) OR (apr_area_type = 1 AND apr_area_id IN (:gp168))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp168":"31",":gp169":"30804",":gp170":"105",":gp171":"1","cab":"57"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23605.388] [M: 24143.58] [ET: 0.477/23579.41] [MU: 3.33/24143.14] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23607.656] [M: 24153.86] [ET: 2.131/23581.661] [MU: 3.41/24152.98] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp173)) OR (scr_area_type = 2 AND scr_area_id IN (:gp174)) OR (scr_area_type = 4 AND scr_area_id IN (:gp175)) OR (scr_area_type = 1 AND scr_area_id IN (:gp172)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp172":"31",":gp173":"30804",":gp174":"105",":gp175":"1","scv_id":"57"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23611.37] [M: 24181.59] [ET: 2.758/23585.376] [MU: 0.75/24173.59] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"nearest_route_30804_30711","sql":"(INDEX indx_nearest_rt_rutid (rut_id)) \r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, routeFrom.rut_name as fromAlias, \r\n\t\t\t\tNULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, \r\n\t\t\t\t0 as rank, routeFrom.rut_estm_time as startTime, 0 as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 \r\n\t\t\t\tAND routeFrom.rut_from_city_id<>routeFrom.rut_to_city_id AND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\t\tAND (routeAlias.rut_to_city_id=route.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, NULL, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) \r\n\t\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\t0 AS extraStartDistance, 0, 0 as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND route.rut_from_city_id = 30804 AND route.rut_to_city_id=30711 \r\n\t\t\t\tAND routeTo.rut_from_city_id=30711\r\n\t\t\t\tAND route.rut_active = 1 AND routeTo.rut_active = 1 AND routeTo.rut_estm_distance < 50 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = route.rut_from_city_id) \r\n\t\t\t   AND (routeAlias.rut_to_city_id = routeTo.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, \r\n\t\t\t\trouteFrom.rut_name, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t+ IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) \r\n\t\t\t\tAS extraDistance, IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, 0, \r\n\t\t\t\trouteFrom.rut_estm_time as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 AND routeFrom.rut_from_city_id <> routeFrom.rut_to_city_id\r\n\t\t\t\t\tAND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND routeTo.rut_estm_distance < 50 \r\n\t\t\t\t\tAND routeTo.rut_from_city_id=30711 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\tAND (routeAlias.rut_to_city_id=routeTo.rut_to_city_id) AND routeAlias.rut_active = 1 AND routeAlias.rut_from_city_id=30804  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23613.841] [M: 24185.67] [ET: 2.367/23587.849] [MU: 2.17/24185.23] 
	SQL: SELECT *, (rte_vendor_amount + extraDistance * 10.55) as totalCost FROM (SELECT * FROM nearest_route_30804_30711) a
					INNER JOIN rate ON a.rut_id = rate.rte_route_id AND rte_status=1 AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <>0
					WHERE 1 ORDER BY rank DESC, totalCost ASC LIMIT 0,1 
	 [params: {"cabType":"57"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23614.765] [M: 24193.7] [ET: 0.772/23588.771] [MU: 0.74/24191.7] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"getNearestRoute_30804_30711_70","sql":"(INDEX getNearestRoute_30804_30711_70_index_rut_id (rut_id))\r\n\t\t\t\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id AS start, routeAlias.rut_to_city_id AS end,\r\n\t\t\t\t\t\t\t\trouteFrom.rut_name AS fromAlias, NULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance AS quotedDistance,\r\n\t\t\t\t\t\t\t\trouteAlias.rut_estm_distance AS rateDistance, \r\n\t\t\t\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance)\r\n\t\t\t\t\t\t\t\t\t - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance,\r\n\t\t\t\t\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance,\r\n\t\t\t\t\t\t\t\t0 AS rank, routeFrom.rut_estm_time AS startTime, 0 AS endTime, route.rut_estm_time, \r\n\t\t\t\t\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraTravelDistance\r\n\t\t\t\t\t\tFROM   route\r\n\t\t\t\t\t\tINNER JOIN route routeTo ON routeTo.rut_to_city_id=route.rut_from_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_from_city_id=30804 AND routeTo.rut_active=1\r\n\t\t\t\t\t\t\t\tAND routeTo.rut_estm_distance<70 AND route.rut_active=1\r\n\t\t\t\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_from_city_id=route.rut_to_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_active = 1\r\n\t\t\t\t\t\t\t\tAND routeFrom.rut_estm_distance<70 AND route.rut_active = 1\r\n\t\t\t\t\t\tINNER JOIN route routeAlias ON routeAlias.rut_to_city_id=routeFrom.rut_to_city_id\r\n\t\t\t\t\t\t\tAND routeAlias.rut_from_city_id=routeTo.rut_from_city_id AND routeAlias.rut_active = 1"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23617.179] [M: 24198.96] [ET: 2.293/23591.188] [MU: 2.42/24198.34] 
	SQL: SELECT *, (rte_vendor_amount + extradistance * 10.55 ) AS totalCost, 
						ABS(quotedDistance-rateDistance) AS extraChargeableDistance
					FROM getNearestRoute_30804_30711_70 a
					INNER JOIN rate ON a.rut_id=rate.rte_route_id AND rte_status=1 
						AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <> 0
					WHERE  1
					ORDER  BY rank DESC, extraStartDistance, extraChargeableDistance ASC, totalcost ASC
					LIMIT  0, 1 
	 [params: {"cabType":"57"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23620.817] [M: 24214.05] [ET: 0.625/23594.832] [MU: 3.41/24213.17] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"45","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23622.594] [M: 24230.66] [ET: 0.528/23596.62] [MU: 3.78/24229.79] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"16","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23624.567] [M: 24247.28] [ET: 0.728/23598.595] [MU: 3.78/24246.41] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23626.444] [M: 24259.24] [ET: 27.71/23600.468] [MU: 149.05/24259.09] 
	Quote::calculateOneWay  for CAB 57 Date: 2024-10-31 18:00:00
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23627.237] [M: 24262.74] [ET: 0.661/23601.266] [MU: 0.89/24262.49] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23628.391] [M: 24275.45] [ET: 0.507/23602.425] [MU: 3.34/24275.02] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23629.151] [M: 24304.63] [ET: 0.659/23603.185] [MU: 22.53/24303.88] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp178)) OR (apr_area_type = 5 AND apr_area_id IN (:gp176)) OR (apr_area_type = 2 AND apr_area_id IN (:gp179)) OR (apr_area_type = 4 AND apr_area_id IN (:gp180)) OR (apr_area_type = 1 AND apr_area_id IN (:gp177))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp176":"3699",":gp177":"31",":gp178":"30804",":gp179":"105",":gp180":"1","cab":"57"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23630.786] [M: 24291.64] [ET: 0.648/23604.813] [MU: 3.34/24291.2] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23633.046] [M: 24302.19] [ET: 2.132/23607.061] [MU: 3.54/24301.31] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp183)) OR (scr_area_type = 5 AND scr_area_id IN (:gp181)) OR (scr_area_type = 2 AND scr_area_id IN (:gp184)) OR (scr_area_type = 4 AND scr_area_id IN (:gp185)) OR (scr_area_type = 1 AND scr_area_id IN (:gp182)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp181":"3699",":gp182":"31",":gp183":"3699",":gp184":"105",":gp185":"1","scv_id":"57"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23633.746] [M: 24303.36] [ET: 0.394/23607.759] [MU: 2.97/24303.25] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23635.376] [M: 24313.56] [ET: 0.518/23609.398] [MU: 2.79/24312.94] 
	SQL: SELECT 
						fc.cty_id as c2id, 
						fc.cty_name as c2name, 
						fc.cty_garage_address as c2address,
						tc.cty_id as c4id,
						tc.cty_name as c4name, tc.cty_garage_address as c4address,
						0 as totalExtraDistance FROM route
						INNER JOIN cities fc ON rut_from_city_id=fc.cty_id
						INNER JOIN cities tc ON rut_to_city_id=tc.cty_id
						INNER JOIN rate on  rate.rte_route_id=route.rut_id  AND rate.rte_vehicletype_id IN (3)
						WHERE route.rut_from_city_id=30804 AND route.rut_to_city_id=30711 AND route.rut_active=1 
	 [params: []]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23635.844] [M: 24327.45] [ET: 0.388/23609.874] [MU: 6.53/24325.45] 
	SQL: 
				SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address, tc.cty_id as c4id, 
				tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
					FROM
					 (
						(
							SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id,  
								r3.rut_to_city_id, route.rut_name , route.rut_id,
								(route.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, 
								r3.rut_estm_distance
							FROM route
							INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_from_city_id=30804  
									AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=route.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) 
									AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
						UNION
						(
							SELECT r3.rut_id, r3.rut_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,(route.rut_estm_distance + r1.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
							FROM route
							INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND  route.rut_to_city_id=30711 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND route.rut_to_city_id=r3.rut_to_city_id))	AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
                     ) a
					INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
					INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1 
	 [params: []]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23636.264] [M: 24337.95] [ET: 0.349/23610.295] [MU: 5.04/24336.45] 
	SQL: SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
                              tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
                        FROM (SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,
                                    (route.rut_estm_distance + r1.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
                                FROM route
								INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
								INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
								INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) AND r3.rut_active=1 
								INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3) LIMIT 1
							)a
                        INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
                        INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1
                         
	 [params: []]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23636.795] [M: 24344.33] [ET: 0.46/23610.827] [MU: 0.75/24343.45] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"GarageRoute_30804_30711","sql":" (INDEX GarageRoute_30804_30711_index_rut_id (rut_id), INDEX GarageRoute_30804_30711_index_rut_from_city_id (rut_from_city_id), INDEX GarageRoute_30804_30711_index_rut_to_city_id (rut_to_city_id))\r\n\t\t\t\t\t\t\tSELECT route.rut_id, route.rut_from_city_id, route.rut_to_city_id, route.rut_name, rut_estm_distance FROM route \r\n\t\t\t\t\t\t\tINNER JOIN cities_stats   ON cities_stats.cts_cty_id = route.rut_from_city_id\r\n\t\t\t\t\t\t\tAND rut_estm_distance < 300\r\n\t\t\t\t\t\t\tAND rut_active = 1\r\n\t\t\t\t\t\t\tAND route.rut_to_city_id=30804\r\n\t\t\t\t\t\t\tAND cities_stats.cts_vnd_cnt >= 3\r\n\t\t\t\t\t\t\tORDER BY rut_estm_distance LIMIT 10"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23637.303] [M: 24356.25] [ET: 0.427/23611.333] [MU: 6.68/24354.5] 
	SQL: SELECT a.*, fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
								tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address 
						FROM ((SELECT xyz.rut_from_city_id as startCity, r1.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r3.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_from_city_id
							INNER JOIN rate ON rate.rte_route_id=r1.rut_id  AND rate.rte_vehicletype_id IN (3)
							INNER JOIN route r2 ON r2.rut_to_city_id=r1.rut_to_city_id AND r2.rut_from_city_id=:dropCity AND r2.rut_active=1
							INNER JOIN route r3 ON r3.rut_from_city_id=xyz.rut_to_city_id AND r3.rut_to_city_id=r2.rut_from_city_id AND r3.rut_active=1
							ORDER BY ExtraDistance LIMIT 1
							)
							UNION
							(
							SELECT xyz.rut_from_city_id as startCity, r2.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r2.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_to_city_id AND r1.rut_to_city_id=:dropCity
							INNER JOIN route r2 ON r2.rut_to_city_id=xyz.rut_from_city_id AND r2.rut_from_city_id=r1.rut_to_city_id
							ORDER BY ExtraDistance ASC LIMIT 1
							)) a
						INNER JOIN cities fc ON startCity=fc.cty_id
						INNER JOIN cities tc ON endCity=tc.cty_id 
						ORDER BY ExtraDistance 
	 [params: {"pickupCity":"30804","dropCity":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23640.259] [M: 24367.59] [ET: 1.312/23614.291] [MU: 7.89/24367.48] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23641.312] [M: 24373.16] [ET: 0.943/23615.327] [MU: 8.27/24373.05] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23642.448] [M: 24380.79] [ET: 0.373/23616.46] [MU: 1/24380.41] 
	SQL: SELECT cts_airport_pickup_entry_fee
               FROM   cities
               INNER JOIN cities_stats
               ON cities.cty_id = cities_stats.cts_cty_id
               WHERE  cty_id = :cityId
               AND cty_is_airport = 1 AND cty_active = 1 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23644.212] [M: 24394.7] [ET: 0.988/23618.231] [MU: 8.14/24394.59] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23645.346] [M: 24402.45] [ET: 0.993/23619.38] [MU: 8.08/24402.34] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23645.771] [M: 24401.78] [ET: 0.325/23619.789] [MU: 0.89/24401.53] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23647.067] [M: 24414.49] [ET: 0.577/23621.099] [MU: 3.34/24414.05] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23647.678] [M: 24443.66] [ET: 0.507/23621.71] [MU: 22.53/24442.91] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp188)) OR (apr_area_type = 5 AND apr_area_id IN (:gp186)) OR (apr_area_type = 2 AND apr_area_id IN (:gp189)) OR (apr_area_type = 4 AND apr_area_id IN (:gp190)) OR (apr_area_type = 1 AND apr_area_id IN (:gp187))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp186":"3699",":gp187":"31",":gp188":"30804",":gp189":"105",":gp190":"1","cab":"57"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23649.17] [M: 24430.68] [ET: 0.52/23623.19] [MU: 3.33/24430.24] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23651.564] [M: 24441.23] [ET: 2.247/23625.571] [MU: 3.53/24440.35] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp193)) OR (scr_area_type = 5 AND scr_area_id IN (:gp191)) OR (scr_area_type = 2 AND scr_area_id IN (:gp194)) OR (scr_area_type = 4 AND scr_area_id IN (:gp195)) OR (scr_area_type = 1 AND scr_area_id IN (:gp192)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp191":"3699",":gp192":"31",":gp193":"3699",":gp194":"105",":gp195":"1","scv_id":"57"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23652.166] [M: 24444.44] [ET: 0.233/23626.203] [MU: 2.98/24444.33] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23653.786] [M: 24457.55] [ET: 0.378/23627.807] [MU: 2.98/24457.44] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23654.224] [M: 24461.72] [ET: 0.328/23628.247] [MU: 2.97/24461.61] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23658.778] [M: 24495.77] [ET: 0.999/23632.775] [MU: 6.29/24493.77] 
	SQL: 
                SELECT cities.cty_id as c2id, cities.cty_name as c2name, cities.cty_garage_address as c2address,
                    cities.cty_id as c4id, cities.cty_name as c4name, cities.cty_garage_address as c4address,
                        (distance * 2) as totalExtraDistance
                 FROM (SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<40
                     INNER JOIN route r1 ON route.rut_to_city_id=r1.rut_from_city_id AND r1.rut_active=1
                     INNER JOIN rate ON r1.rut_id=rate.rte_route_id AND rate.rte_status=1  AND rate.rte_vehicletype_id IN (3) GROUP BY route.rut_id HAVING count(*) >30
                   UNION
                     SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<600
                     INNER JOIN cities tc ON tc.cty_id=route.rut_to_city_id AND tc.cty_service_active=1 AND CalcDistance(cities.cty_lat, cities.cty_long, tc.cty_lat, tc.cty_long)<=route.rut_estm_distance						 
                     INNER JOIN cities_stats ON cities_stats.cts_cty_id = route.rut_to_city_id AND cities_stats.cts_vnd_cnt >= 2
                   UNION
                    SELECT cts_cty_id AS city, 0 AS distance
					FROM cities_stats WHERE 1 AND cities_stats.cts_cty_id= 30817 and cities_stats.cts_vnd_cnt>1) a
                    INNER JOIN cities ON cities.cty_id=a.city
                    ORDER BY totalExtraDistance LIMIT 1 
	 [params: []]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23662.84] [M: 24510.59] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"3","tripDistance":"","tripDuration":"","multiCityData":"","bookingType":"1","pickupAddress":"","pickupDate":"31\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","sccId":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=3&tripDistance=&tripDuration=&multiCityData=&bookingType=1&pickupAddress=&pickupDate=31%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&sccId=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23663.627] [M: 24527.43] [ET: 1.469/23637.645] [MU: 18.04/24527.32] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23663.682] [M: 24529.11] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23665.182] [M: 24542.57] [ET: 1.282/23639.186] [MU: 2.99/24540.07] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+10013),(IF((cpm_value_type=2),(10013+(10013*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30937 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30937) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-31 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=57 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23667.525] [M: 24584.8] [ET: 5.466/23641.544] [MU: 75.87/24584.64] 
	RouteRates::calculate for CAB 57 2024-10-31 18:00:00 - Trip Type: 1 169268329
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23667.793] [M: 24562.48] [ET: 41.254/23641.811] [MU: 301.78/24562.33] 
	Quote::calculateRules for CAB 57, From City Id: 30804, To city Id: 30711
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23668.355] [M: 24533.99] [ET: 0.419/23642.361] [MU: 0.89/24533.74] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"57"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23668.483] [M: 24535.24] [ET: 75.506/23642.506] [MU: 472.64/24535.15] 
	Quote For CabType: 57
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23670.153] [M: 24545.59] [ET: 0.638/23644.168] [MU: 3.33/24545.15] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23671.011] [M: 24551.4] [ET: 0.733/23645.028] [MU: 3.33/24550.96] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23671.765] [M: 24554.34] [ET: 0.642/23645.766] [MU: 0.9/24554.09] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23672.788] [M: 24586.7] [ET: 0.841/23646.793] [MU: 24.22/24585.2] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (100) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30711) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp196)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp199,:gp200)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp197,:gp198)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp201,:gp202))
			OR (scr_area_type = 5 AND scr_area_id IN (3699))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (69)
		ORDER BY rank DESC
		 
	 [params: {":gp196":"31",":gp197":"30804",":gp198":"30711",":gp199":"105",":gp200":"100",":gp201":"1",":gp202":"1","tripType":"1"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23673.988] [M: 24566.88] [ET: 0.409/23647.999] [MU: 0.84/24566.69] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23674.705] [M: 24569.75] [ET: 0.587/23648.716] [MU: 0.96/24569.44] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"4"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23677.442] [M: 24582.72] [ET: 0.792/23651.449] [MU: 2.05/24582.22] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"69"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23681.884] [M: 24592.1] [ET: 4.08/23655.877] [MU: 3.53/24591.23] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"69","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23683.131] [M: 24595.35] [ET: 0.812/23657.135] [MU: 0.87/24595.13] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":0}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23684.34] [M: 24602.63] [ET: 0.903/23658.353] [MU: 2.97/24602.2] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23685.306] [M: 24630.8] [ET: 0.793/23659.316] [MU: 22.04/24630.18] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp204)) OR (apr_area_type = 2 AND apr_area_id IN (:gp205)) OR (apr_area_type = 4 AND apr_area_id IN (:gp206)) OR (apr_area_type = 1 AND apr_area_id IN (:gp203))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp203":"31",":gp204":"30804",":gp205":"105",":gp206":"1","cab":"69"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23687.092] [M: 24617.52] [ET: 0.784/23661.102] [MU: 3.34/24617.09] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23690.373] [M: 24627.8] [ET: 3.091/23664.367] [MU: 3.4/24626.93] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp208)) OR (scr_area_type = 2 AND scr_area_id IN (:gp209)) OR (scr_area_type = 4 AND scr_area_id IN (:gp210)) OR (scr_area_type = 1 AND scr_area_id IN (:gp207)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp207":"31",":gp208":"30804",":gp209":"105",":gp210":"1","scv_id":"69"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23695.185] [M: 24655.54] [ET: 3.666/23669.164] [MU: 0.74/24647.54] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"nearest_route_30804_30711","sql":"(INDEX indx_nearest_rt_rutid (rut_id)) \r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, routeFrom.rut_name as fromAlias, \r\n\t\t\t\tNULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, \r\n\t\t\t\t0 as rank, routeFrom.rut_estm_time as startTime, 0 as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 \r\n\t\t\t\tAND routeFrom.rut_from_city_id<>routeFrom.rut_to_city_id AND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\t\tAND (routeAlias.rut_to_city_id=route.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, NULL, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) \r\n\t\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\t0 AS extraStartDistance, 0, 0 as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND route.rut_from_city_id = 30804 AND route.rut_to_city_id=30711 \r\n\t\t\t\tAND routeTo.rut_from_city_id=30711\r\n\t\t\t\tAND route.rut_active = 1 AND routeTo.rut_active = 1 AND routeTo.rut_estm_distance < 50 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = route.rut_from_city_id) \r\n\t\t\t   AND (routeAlias.rut_to_city_id = routeTo.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, \r\n\t\t\t\trouteFrom.rut_name, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t+ IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) \r\n\t\t\t\tAS extraDistance, IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, 0, \r\n\t\t\t\trouteFrom.rut_estm_time as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 AND routeFrom.rut_from_city_id <> routeFrom.rut_to_city_id\r\n\t\t\t\t\tAND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND routeTo.rut_estm_distance < 50 \r\n\t\t\t\t\tAND routeTo.rut_from_city_id=30711 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\tAND (routeAlias.rut_to_city_id=routeTo.rut_to_city_id) AND routeAlias.rut_active = 1 AND routeAlias.rut_from_city_id=30804  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23698.859] [M: 24659.62] [ET: 3.53/23672.867] [MU: 2.16/24659.18] 
	SQL: SELECT *, (rte_vendor_amount + extraDistance * 10.55) as totalCost FROM (SELECT * FROM nearest_route_30804_30711) a
					INNER JOIN rate ON a.rut_id = rate.rte_route_id AND rte_status=1 AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <>0
					WHERE 1 ORDER BY rank DESC, totalCost ASC LIMIT 0,1 
	 [params: {"cabType":"69"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23699.869] [M: 24667.64] [ET: 0.856/23673.868] [MU: 0.74/24665.64] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"getNearestRoute_30804_30711_70","sql":"(INDEX getNearestRoute_30804_30711_70_index_rut_id (rut_id))\r\n\t\t\t\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id AS start, routeAlias.rut_to_city_id AS end,\r\n\t\t\t\t\t\t\t\trouteFrom.rut_name AS fromAlias, NULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance AS quotedDistance,\r\n\t\t\t\t\t\t\t\trouteAlias.rut_estm_distance AS rateDistance, \r\n\t\t\t\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance)\r\n\t\t\t\t\t\t\t\t\t - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance,\r\n\t\t\t\t\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance,\r\n\t\t\t\t\t\t\t\t0 AS rank, routeFrom.rut_estm_time AS startTime, 0 AS endTime, route.rut_estm_time, \r\n\t\t\t\t\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraTravelDistance\r\n\t\t\t\t\t\tFROM   route\r\n\t\t\t\t\t\tINNER JOIN route routeTo ON routeTo.rut_to_city_id=route.rut_from_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_from_city_id=30804 AND routeTo.rut_active=1\r\n\t\t\t\t\t\t\t\tAND routeTo.rut_estm_distance<70 AND route.rut_active=1\r\n\t\t\t\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_from_city_id=route.rut_to_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_active = 1\r\n\t\t\t\t\t\t\t\tAND routeFrom.rut_estm_distance<70 AND route.rut_active = 1\r\n\t\t\t\t\t\tINNER JOIN route routeAlias ON routeAlias.rut_to_city_id=routeFrom.rut_to_city_id\r\n\t\t\t\t\t\t\tAND routeAlias.rut_from_city_id=routeTo.rut_from_city_id AND routeAlias.rut_active = 1"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23702.85] [M: 24672.91] [ET: 2.839/23676.855] [MU: 2.41/24672.28] 
	SQL: SELECT *, (rte_vendor_amount + extradistance * 10.55 ) AS totalCost, 
						ABS(quotedDistance-rateDistance) AS extraChargeableDistance
					FROM getNearestRoute_30804_30711_70 a
					INNER JOIN rate ON a.rut_id=rate.rte_route_id AND rte_status=1 
						AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <> 0
					WHERE  1
					ORDER  BY rank DESC, extraStartDistance, extraChargeableDistance ASC, totalcost ASC
					LIMIT  0, 1 
	 [params: {"cabType":"69"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23707.168] [M: 24687.99] [ET: 0.727/23681.172] [MU: 3.41/24687.12] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"45","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23709.95] [M: 24704.61] [ET: 0.925/23683.962] [MU: 3.78/24703.73] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"16","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23712.586] [M: 24721.23] [ET: 0.817/23686.593] [MU: 3.78/24720.35] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23714.563] [M: 24733.19] [ET: 36.999/23688.579] [MU: 149.04/24733.03] 
	Quote::calculateOneWay  for CAB 69 Date: 2024-10-31 18:00:00
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23715.32] [M: 24736.78] [ET: 0.605/23689.33] [MU: 0.89/24736.53] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23716.822] [M: 24749.49] [ET: 0.596/23690.85] [MU: 3.34/24749.05] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23717.536] [M: 24778.66] [ET: 0.605/23691.567] [MU: 22.53/24777.91] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp213)) OR (apr_area_type = 5 AND apr_area_id IN (:gp211)) OR (apr_area_type = 2 AND apr_area_id IN (:gp214)) OR (apr_area_type = 4 AND apr_area_id IN (:gp215)) OR (apr_area_type = 1 AND apr_area_id IN (:gp212))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp211":"3699",":gp212":"31",":gp213":"30804",":gp214":"105",":gp215":"1","cab":"69"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23719.149] [M: 24765.68] [ET: 0.601/23693.166] [MU: 3.33/24765.24] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23721.287] [M: 24776.23] [ET: 1.979/23695.309] [MU: 3.53/24775.35] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp218)) OR (scr_area_type = 5 AND scr_area_id IN (:gp216)) OR (scr_area_type = 2 AND scr_area_id IN (:gp219)) OR (scr_area_type = 4 AND scr_area_id IN (:gp220)) OR (scr_area_type = 1 AND scr_area_id IN (:gp217)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp216":"3699",":gp217":"31",":gp218":"3699",":gp219":"105",":gp220":"1","scv_id":"69"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23721.914] [M: 24777.4] [ET: 0.329/23695.936] [MU: 2.97/24777.29] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23723.542] [M: 24787.51] [ET: 0.635/23697.556] [MU: 2.79/24786.88] 
	SQL: SELECT 
						fc.cty_id as c2id, 
						fc.cty_name as c2name, 
						fc.cty_garage_address as c2address,
						tc.cty_id as c4id,
						tc.cty_name as c4name, tc.cty_garage_address as c4address,
						0 as totalExtraDistance FROM route
						INNER JOIN cities fc ON rut_from_city_id=fc.cty_id
						INNER JOIN cities tc ON rut_to_city_id=tc.cty_id
						INNER JOIN rate on  rate.rte_route_id=route.rut_id  AND rate.rte_vehicletype_id IN (3)
						WHERE route.rut_from_city_id=30804 AND route.rut_to_city_id=30711 AND route.rut_active=1 
	 [params: []]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23724.126] [M: 24801.39] [ET: 0.472/23698.138] [MU: 6.53/24799.39] 
	SQL: 
				SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address, tc.cty_id as c4id, 
				tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
					FROM
					 (
						(
							SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id,  
								r3.rut_to_city_id, route.rut_name , route.rut_id,
								(route.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, 
								r3.rut_estm_distance
							FROM route
							INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_from_city_id=30804  
									AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=route.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) 
									AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
						UNION
						(
							SELECT r3.rut_id, r3.rut_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,(route.rut_estm_distance + r1.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
							FROM route
							INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND  route.rut_to_city_id=30711 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND route.rut_to_city_id=r3.rut_to_city_id))	AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
                     ) a
					INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
					INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1 
	 [params: []]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23724.694] [M: 24811.9] [ET: 0.476/23698.724] [MU: 5.03/24810.4] 
	SQL: SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
                              tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
                        FROM (SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,
                                    (route.rut_estm_distance + r1.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
                                FROM route
								INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
								INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
								INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) AND r3.rut_active=1 
								INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3) LIMIT 1
							)a
                        INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
                        INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1
                         
	 [params: []]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23725.214] [M: 24818.27] [ET: 0.44/23699.243] [MU: 0.74/24817.4] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"GarageRoute_30804_30711","sql":" (INDEX GarageRoute_30804_30711_index_rut_id (rut_id), INDEX GarageRoute_30804_30711_index_rut_from_city_id (rut_from_city_id), INDEX GarageRoute_30804_30711_index_rut_to_city_id (rut_to_city_id))\r\n\t\t\t\t\t\t\tSELECT route.rut_id, route.rut_from_city_id, route.rut_to_city_id, route.rut_name, rut_estm_distance FROM route \r\n\t\t\t\t\t\t\tINNER JOIN cities_stats   ON cities_stats.cts_cty_id = route.rut_from_city_id\r\n\t\t\t\t\t\t\tAND rut_estm_distance < 300\r\n\t\t\t\t\t\t\tAND rut_active = 1\r\n\t\t\t\t\t\t\tAND route.rut_to_city_id=30804\r\n\t\t\t\t\t\t\tAND cities_stats.cts_vnd_cnt >= 3\r\n\t\t\t\t\t\t\tORDER BY rut_estm_distance LIMIT 10"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23725.762] [M: 24830.2] [ET: 0.458/23699.776] [MU: 6.69/24828.45] 
	SQL: SELECT a.*, fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
								tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address 
						FROM ((SELECT xyz.rut_from_city_id as startCity, r1.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r3.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_from_city_id
							INNER JOIN rate ON rate.rte_route_id=r1.rut_id  AND rate.rte_vehicletype_id IN (3)
							INNER JOIN route r2 ON r2.rut_to_city_id=r1.rut_to_city_id AND r2.rut_from_city_id=:dropCity AND r2.rut_active=1
							INNER JOIN route r3 ON r3.rut_from_city_id=xyz.rut_to_city_id AND r3.rut_to_city_id=r2.rut_from_city_id AND r3.rut_active=1
							ORDER BY ExtraDistance LIMIT 1
							)
							UNION
							(
							SELECT xyz.rut_from_city_id as startCity, r2.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r2.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_to_city_id AND r1.rut_to_city_id=:dropCity
							INNER JOIN route r2 ON r2.rut_to_city_id=xyz.rut_from_city_id AND r2.rut_from_city_id=r1.rut_to_city_id
							ORDER BY ExtraDistance ASC LIMIT 1
							)) a
						INNER JOIN cities fc ON startCity=fc.cty_id
						INNER JOIN cities tc ON endCity=tc.cty_id 
						ORDER BY ExtraDistance 
	 [params: {"pickupCity":"30804","dropCity":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23728.606] [M: 24841.54] [ET: 1.02/23702.638] [MU: 7.88/24841.43] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23729.561] [M: 24847.02] [ET: 0.865/23703.596] [MU: 8.27/24846.91] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23730.336] [M: 24854.64] [ET: 0.293/23704.371] [MU: 0.99/24854.27] 
	SQL: SELECT cts_airport_pickup_entry_fee
               FROM   cities
               INNER JOIN cities_stats
               ON cities.cty_id = cities_stats.cts_cty_id
               WHERE  cty_id = :cityId
               AND cty_is_airport = 1 AND cty_active = 1 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23731.781] [M: 24868.55] [ET: 0.883/23705.813] [MU: 8.13/24868.45] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23732.645] [M: 24876.39] [ET: 0.747/23706.683] [MU: 8.07/24876.28] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23733.074] [M: 24875.82] [ET: 0.352/23707.112] [MU: 0.9/24875.57] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23734.059] [M: 24888.53] [ET: 0.485/23708.093] [MU: 3.34/24888.09] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23734.642] [M: 24917.7] [ET: 0.473/23708.675] [MU: 22.54/24916.95] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp223)) OR (apr_area_type = 5 AND apr_area_id IN (:gp221)) OR (apr_area_type = 2 AND apr_area_id IN (:gp224)) OR (apr_area_type = 4 AND apr_area_id IN (:gp225)) OR (apr_area_type = 1 AND apr_area_id IN (:gp222))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp221":"3699",":gp222":"31",":gp223":"30804",":gp224":"105",":gp225":"1","cab":"69"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23735.992] [M: 24904.72] [ET: 0.44/23710.026] [MU: 3.33/24904.28] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23738.111] [M: 24915.27] [ET: 2.005/23712.135] [MU: 3.53/24914.39] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp228)) OR (scr_area_type = 5 AND scr_area_id IN (:gp226)) OR (scr_area_type = 2 AND scr_area_id IN (:gp229)) OR (scr_area_type = 4 AND scr_area_id IN (:gp230)) OR (scr_area_type = 1 AND scr_area_id IN (:gp227)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp226":"3699",":gp227":"31",":gp228":"3699",":gp229":"105",":gp230":"1","scv_id":"69"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23738.889] [M: 24918.48] [ET: 0.365/23712.916] [MU: 2.98/24918.37] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23740.293] [M: 24931.59] [ET: 0.291/23714.331] [MU: 2.98/24931.48] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23740.559] [M: 24935.76] [ET: 0.197/23714.6] [MU: 2.98/24935.65] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23745.174] [M: 24969.72] [ET: 0.698/23719.161] [MU: 6.28/24967.72] 
	SQL: 
                SELECT cities.cty_id as c2id, cities.cty_name as c2name, cities.cty_garage_address as c2address,
                    cities.cty_id as c4id, cities.cty_name as c4name, cities.cty_garage_address as c4address,
                        (distance * 2) as totalExtraDistance
                 FROM (SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<40
                     INNER JOIN route r1 ON route.rut_to_city_id=r1.rut_from_city_id AND r1.rut_active=1
                     INNER JOIN rate ON r1.rut_id=rate.rte_route_id AND rate.rte_status=1  AND rate.rte_vehicletype_id IN (3) GROUP BY route.rut_id HAVING count(*) >30
                   UNION
                     SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<600
                     INNER JOIN cities tc ON tc.cty_id=route.rut_to_city_id AND tc.cty_service_active=1 AND CalcDistance(cities.cty_lat, cities.cty_long, tc.cty_lat, tc.cty_long)<=route.rut_estm_distance						 
                     INNER JOIN cities_stats ON cities_stats.cts_cty_id = route.rut_to_city_id AND cities_stats.cts_vnd_cnt >= 2
                   UNION
                    SELECT cts_cty_id AS city, 0 AS distance
					FROM cities_stats WHERE 1 AND cities_stats.cts_cty_id= 30817 and cities_stats.cts_vnd_cnt>1) a
                    INNER JOIN cities ON cities.cty_id=a.city
                    ORDER BY totalExtraDistance LIMIT 1 
	 [params: []]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23748.414] [M: 24984.53] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"3","tripDistance":"","tripDuration":"","multiCityData":"","bookingType":"1","pickupAddress":"","pickupDate":"31\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","sccId":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=3&tripDistance=&tripDuration=&multiCityData=&bookingType=1&pickupAddress=&pickupDate=31%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&sccId=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23748.833] [M: 25001.38] [ET: 0.868/23722.873] [MU: 18.05/25001.27] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23748.865] [M: 25003.05] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23749.953] [M: 25016.52] [ET: 0.966/23723.977] [MU: 2.99/25014.02] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+10013),(IF((cpm_value_type=2),(10013+(10013*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30937 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30937) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-31 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=69 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23751.4] [M: 25058.74] [ET: 3.531/23725.437] [MU: 75.88/25058.59] 
	RouteRates::calculate for CAB 69 2024-10-31 18:00:00 - Trip Type: 1 31703861
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23751.541] [M: 25036.43] [ET: 36.893/23725.581] [MU: 301.69/25036.27] 
	Quote::calculateRules for CAB 69, From City Id: 30804, To city Id: 30711
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23751.84] [M: 25007.94] [ET: 0.205/23725.856] [MU: 0.9/25007.69] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"69"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23751.954] [M: 25009.19] [ET: 83.386/23725.977] [MU: 472.64/25009.09] 
	Quote For CabType: 69
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23753.381] [M: 25019.53] [ET: 0.46/23727.396] [MU: 3.34/25019.09] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23753.908] [M: 25025.34] [ET: 0.422/23727.925] [MU: 3.34/25024.91] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23754.499] [M: 25028.28] [ET: 0.498/23728.531] [MU: 0.89/25028.03] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23755.109] [M: 25060.64] [ET: 0.49/23729.124] [MU: 24.22/25059.14] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (100) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30711) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp231)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp234,:gp235)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp232,:gp233)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp236,:gp237))
			OR (scr_area_type = 5 AND scr_area_id IN (3699))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (70)
		ORDER BY rank DESC
		 
	 [params: {":gp231":"31",":gp232":"30804",":gp233":"30711",":gp234":"105",":gp235":"100",":gp236":"1",":gp237":"1","tripType":"1"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23755.918] [M: 25040.82] [ET: 0.214/23729.955] [MU: 0.84/25040.63] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23756.262] [M: 25043.7] [ET: 0.271/23730.298] [MU: 0.97/25043.38] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"4"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23757.42] [M: 25056.66] [ET: 0.334/23731.435] [MU: 2.05/25056.16] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"70"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23761.041] [M: 25066.05] [ET: 3.31/23735.041] [MU: 3.53/25065.17] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"70","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23761.978] [M: 25069.3] [ET: 0.609/23736.006] [MU: 0.87/25069.08] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":0}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23762.692] [M: 25076.58] [ET: 0.539/23736.725] [MU: 2.97/25076.14] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23763.306] [M: 25104.75] [ET: 0.499/23737.335] [MU: 22.05/25104.13] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp239)) OR (apr_area_type = 2 AND apr_area_id IN (:gp240)) OR (apr_area_type = 4 AND apr_area_id IN (:gp241)) OR (apr_area_type = 1 AND apr_area_id IN (:gp238))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp238":"31",":gp239":"30804",":gp240":"105",":gp241":"1","cab":"70"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23764.36] [M: 25091.47] [ET: 0.479/23738.394] [MU: 3.33/25091.03] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23766.872] [M: 25101.75] [ET: 2.388/23740.878] [MU: 3.41/25100.88] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp243)) OR (scr_area_type = 2 AND scr_area_id IN (:gp244)) OR (scr_area_type = 4 AND scr_area_id IN (:gp245)) OR (scr_area_type = 1 AND scr_area_id IN (:gp242)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp242":"31",":gp243":"30804",":gp244":"105",":gp245":"1","scv_id":"70"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23769.993] [M: 25129.48] [ET: 2.133/23743.98] [MU: 0.75/25121.48] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"nearest_route_30804_30711","sql":"(INDEX indx_nearest_rt_rutid (rut_id)) \r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, routeFrom.rut_name as fromAlias, \r\n\t\t\t\tNULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, \r\n\t\t\t\t0 as rank, routeFrom.rut_estm_time as startTime, 0 as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 \r\n\t\t\t\tAND routeFrom.rut_from_city_id<>routeFrom.rut_to_city_id AND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\t\tAND (routeAlias.rut_to_city_id=route.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, NULL, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) \r\n\t\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\t0 AS extraStartDistance, 0, 0 as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND route.rut_from_city_id = 30804 AND route.rut_to_city_id=30711 \r\n\t\t\t\tAND routeTo.rut_from_city_id=30711\r\n\t\t\t\tAND route.rut_active = 1 AND routeTo.rut_active = 1 AND routeTo.rut_estm_distance < 50 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = route.rut_from_city_id) \r\n\t\t\t   AND (routeAlias.rut_to_city_id = routeTo.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, \r\n\t\t\t\trouteFrom.rut_name, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t+ IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) \r\n\t\t\t\tAS extraDistance, IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, 0, \r\n\t\t\t\trouteFrom.rut_estm_time as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 AND routeFrom.rut_from_city_id <> routeFrom.rut_to_city_id\r\n\t\t\t\t\tAND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND routeTo.rut_estm_distance < 50 \r\n\t\t\t\t\tAND routeTo.rut_from_city_id=30711 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\tAND (routeAlias.rut_to_city_id=routeTo.rut_to_city_id) AND routeAlias.rut_active = 1 AND routeAlias.rut_from_city_id=30804  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23772.548] [M: 25133.56] [ET: 2.436/23746.576] [MU: 2.17/25133.13] 
	SQL: SELECT *, (rte_vendor_amount + extraDistance * 10.55) as totalCost FROM (SELECT * FROM nearest_route_30804_30711) a
					INNER JOIN rate ON a.rut_id = rate.rte_route_id AND rte_status=1 AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <>0
					WHERE 1 ORDER BY rank DESC, totalCost ASC LIMIT 0,1 
	 [params: {"cabType":"70"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23773.341] [M: 25141.59] [ET: 0.663/23747.344] [MU: 0.74/25139.59] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"getNearestRoute_30804_30711_70","sql":"(INDEX getNearestRoute_30804_30711_70_index_rut_id (rut_id))\r\n\t\t\t\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id AS start, routeAlias.rut_to_city_id AS end,\r\n\t\t\t\t\t\t\t\trouteFrom.rut_name AS fromAlias, NULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance AS quotedDistance,\r\n\t\t\t\t\t\t\t\trouteAlias.rut_estm_distance AS rateDistance, \r\n\t\t\t\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance)\r\n\t\t\t\t\t\t\t\t\t - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance,\r\n\t\t\t\t\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance,\r\n\t\t\t\t\t\t\t\t0 AS rank, routeFrom.rut_estm_time AS startTime, 0 AS endTime, route.rut_estm_time, \r\n\t\t\t\t\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraTravelDistance\r\n\t\t\t\t\t\tFROM   route\r\n\t\t\t\t\t\tINNER JOIN route routeTo ON routeTo.rut_to_city_id=route.rut_from_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_from_city_id=30804 AND routeTo.rut_active=1\r\n\t\t\t\t\t\t\t\tAND routeTo.rut_estm_distance<70 AND route.rut_active=1\r\n\t\t\t\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_from_city_id=route.rut_to_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_active = 1\r\n\t\t\t\t\t\t\t\tAND routeFrom.rut_estm_distance<70 AND route.rut_active = 1\r\n\t\t\t\t\t\tINNER JOIN route routeAlias ON routeAlias.rut_to_city_id=routeFrom.rut_to_city_id\r\n\t\t\t\t\t\t\tAND routeAlias.rut_from_city_id=routeTo.rut_from_city_id AND routeAlias.rut_active = 1"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23775.841] [M: 25146.85] [ET: 2.339/23749.819] [MU: 2.41/25146.23] 
	SQL: SELECT *, (rte_vendor_amount + extradistance * 10.55 ) AS totalCost, 
						ABS(quotedDistance-rateDistance) AS extraChargeableDistance
					FROM getNearestRoute_30804_30711_70 a
					INNER JOIN rate ON a.rut_id=rate.rte_route_id AND rte_status=1 
						AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <> 0
					WHERE  1
					ORDER  BY rank DESC, extraStartDistance, extraChargeableDistance ASC, totalcost ASC
					LIMIT  0, 1 
	 [params: {"cabType":"70"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23779.191] [M: 25161.94] [ET: 0.507/23753.223] [MU: 3.42/25161.06] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"45","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23780.617] [M: 25178.55] [ET: 0.427/23754.65] [MU: 3.78/25177.68] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"16","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23781.993] [M: 25195.17] [ET: 0.423/23756.026] [MU: 3.78/25194.3] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23783.1] [M: 25207.13] [ET: 25.592/23757.139] [MU: 149.05/25206.98] 
	Quote::calculateOneWay  for CAB 70 Date: 2024-10-31 18:00:00
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23783.634] [M: 25210.63] [ET: 0.444/23757.669] [MU: 0.9/25210.38] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23784.745] [M: 25223.34] [ET: 0.542/23758.778] [MU: 3.34/25222.91] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23785.487] [M: 25252.52] [ET: 0.637/23759.518] [MU: 22.53/25251.77] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp248)) OR (apr_area_type = 5 AND apr_area_id IN (:gp246)) OR (apr_area_type = 2 AND apr_area_id IN (:gp249)) OR (apr_area_type = 4 AND apr_area_id IN (:gp250)) OR (apr_area_type = 1 AND apr_area_id IN (:gp247))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp246":"3699",":gp247":"31",":gp248":"30804",":gp249":"105",":gp250":"1","cab":"70"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23787.091] [M: 25239.53] [ET: 0.537/23761.122] [MU: 3.34/25239.09] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23789.502] [M: 25250.08] [ET: 2.273/23763.509] [MU: 3.54/25249.2] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp253)) OR (scr_area_type = 5 AND scr_area_id IN (:gp251)) OR (scr_area_type = 2 AND scr_area_id IN (:gp254)) OR (scr_area_type = 4 AND scr_area_id IN (:gp255)) OR (scr_area_type = 1 AND scr_area_id IN (:gp252)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp251":"3699",":gp252":"31",":gp253":"3699",":gp254":"105",":gp255":"1","scv_id":"70"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23790.14] [M: 25251.25] [ET: 0.252/23764.178] [MU: 2.97/25251.14] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23791.755] [M: 25261.36] [ET: 0.643/23765.769] [MU: 2.79/25260.73] 
	SQL: SELECT 
						fc.cty_id as c2id, 
						fc.cty_name as c2name, 
						fc.cty_garage_address as c2address,
						tc.cty_id as c4id,
						tc.cty_name as c4name, tc.cty_garage_address as c4address,
						0 as totalExtraDistance FROM route
						INNER JOIN cities fc ON rut_from_city_id=fc.cty_id
						INNER JOIN cities tc ON rut_to_city_id=tc.cty_id
						INNER JOIN rate on  rate.rte_route_id=route.rut_id  AND rate.rte_vehicletype_id IN (3)
						WHERE route.rut_from_city_id=30804 AND route.rut_to_city_id=30711 AND route.rut_active=1 
	 [params: []]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23792.347] [M: 25275.24] [ET: 0.447/23766.36] [MU: 6.53/25273.24] 
	SQL: 
				SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address, tc.cty_id as c4id, 
				tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
					FROM
					 (
						(
							SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id,  
								r3.rut_to_city_id, route.rut_name , route.rut_id,
								(route.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, 
								r3.rut_estm_distance
							FROM route
							INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_from_city_id=30804  
									AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=route.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) 
									AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
						UNION
						(
							SELECT r3.rut_id, r3.rut_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,(route.rut_estm_distance + r1.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
							FROM route
							INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND  route.rut_to_city_id=30711 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND route.rut_to_city_id=r3.rut_to_city_id))	AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
                     ) a
					INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
					INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1 
	 [params: []]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23793.196] [M: 25285.75] [ET: 0.713/23767.208] [MU: 5.03/25284.25] 
	SQL: SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
                              tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
                        FROM (SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,
                                    (route.rut_estm_distance + r1.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
                                FROM route
								INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
								INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
								INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) AND r3.rut_active=1 
								INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3) LIMIT 1
							)a
                        INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
                        INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1
                         
	 [params: []]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23793.768] [M: 25292.13] [ET: 0.488/23767.8] [MU: 0.74/25291.25] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"GarageRoute_30804_30711","sql":" (INDEX GarageRoute_30804_30711_index_rut_id (rut_id), INDEX GarageRoute_30804_30711_index_rut_from_city_id (rut_from_city_id), INDEX GarageRoute_30804_30711_index_rut_to_city_id (rut_to_city_id))\r\n\t\t\t\t\t\t\tSELECT route.rut_id, route.rut_from_city_id, route.rut_to_city_id, route.rut_name, rut_estm_distance FROM route \r\n\t\t\t\t\t\t\tINNER JOIN cities_stats   ON cities_stats.cts_cty_id = route.rut_from_city_id\r\n\t\t\t\t\t\t\tAND rut_estm_distance < 300\r\n\t\t\t\t\t\t\tAND rut_active = 1\r\n\t\t\t\t\t\t\tAND route.rut_to_city_id=30804\r\n\t\t\t\t\t\t\tAND cities_stats.cts_vnd_cnt >= 3\r\n\t\t\t\t\t\t\tORDER BY rut_estm_distance LIMIT 10"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23794.318] [M: 25304.05] [ET: 0.475/23768.348] [MU: 6.69/25302.3] 
	SQL: SELECT a.*, fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
								tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address 
						FROM ((SELECT xyz.rut_from_city_id as startCity, r1.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r3.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_from_city_id
							INNER JOIN rate ON rate.rte_route_id=r1.rut_id  AND rate.rte_vehicletype_id IN (3)
							INNER JOIN route r2 ON r2.rut_to_city_id=r1.rut_to_city_id AND r2.rut_from_city_id=:dropCity AND r2.rut_active=1
							INNER JOIN route r3 ON r3.rut_from_city_id=xyz.rut_to_city_id AND r3.rut_to_city_id=r2.rut_from_city_id AND r3.rut_active=1
							ORDER BY ExtraDistance LIMIT 1
							)
							UNION
							(
							SELECT xyz.rut_from_city_id as startCity, r2.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r2.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_to_city_id AND r1.rut_to_city_id=:dropCity
							INNER JOIN route r2 ON r2.rut_to_city_id=xyz.rut_from_city_id AND r2.rut_from_city_id=r1.rut_to_city_id
							ORDER BY ExtraDistance ASC LIMIT 1
							)) a
						INNER JOIN cities fc ON startCity=fc.cty_id
						INNER JOIN cities tc ON endCity=tc.cty_id 
						ORDER BY ExtraDistance 
	 [params: {"pickupCity":"30804","dropCity":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23796.981] [M: 25315.39] [ET: 1.018/23771.014] [MU: 7.88/25315.28] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23797.96] [M: 25320.96] [ET: 0.89/23771.997] [MU: 8.26/25320.85] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23798.712] [M: 25328.49] [ET: 0.285/23772.747] [MU: 0.99/25328.12] 
	SQL: SELECT cts_airport_pickup_entry_fee
               FROM   cities
               INNER JOIN cities_stats
               ON cities.cty_id = cities_stats.cts_cty_id
               WHERE  cty_id = :cityId
               AND cty_is_airport = 1 AND cty_active = 1 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23800.179] [M: 25342.41] [ET: 0.908/23774.216] [MU: 8.13/25342.3] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23801.017] [M: 25350.15] [ET: 0.744/23775.054] [MU: 8.08/25350.04] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23801.416] [M: 25349.58] [ET: 0.323/23775.453] [MU: 0.9/25349.33] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23802.495] [M: 25362.29] [ET: 0.533/23776.528] [MU: 3.33/25361.85] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23803.198] [M: 25391.46] [ET: 0.593/23777.231] [MU: 22.53/25390.71] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp258)) OR (apr_area_type = 5 AND apr_area_id IN (:gp256)) OR (apr_area_type = 2 AND apr_area_id IN (:gp259)) OR (apr_area_type = 4 AND apr_area_id IN (:gp260)) OR (apr_area_type = 1 AND apr_area_id IN (:gp257))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp256":"3699",":gp257":"31",":gp258":"30804",":gp259":"105",":gp260":"1","cab":"70"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23804.607] [M: 25378.48] [ET: 0.487/23778.64] [MU: 3.33/25378.04] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23807.27] [M: 25389.02] [ET: 2.539/23781.274] [MU: 3.53/25388.15] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp263)) OR (scr_area_type = 5 AND scr_area_id IN (:gp261)) OR (scr_area_type = 2 AND scr_area_id IN (:gp264)) OR (scr_area_type = 4 AND scr_area_id IN (:gp265)) OR (scr_area_type = 1 AND scr_area_id IN (:gp262)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp261":"3699",":gp262":"31",":gp263":"3699",":gp264":"105",":gp265":"1","scv_id":"70"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23807.924] [M: 25392.23] [ET: 0.237/23781.953] [MU: 2.98/25392.13] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23809.777] [M: 25405.34] [ET: 0.371/23783.8] [MU: 2.98/25405.23] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23810.097] [M: 25409.42] [ET: 0.215/23784.137] [MU: 2.98/25409.31] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23813.375] [M: 25443.48] [ET: 0.482/23787.402] [MU: 6.28/25441.48] 
	SQL: 
                SELECT cities.cty_id as c2id, cities.cty_name as c2name, cities.cty_garage_address as c2address,
                    cities.cty_id as c4id, cities.cty_name as c4name, cities.cty_garage_address as c4address,
                        (distance * 2) as totalExtraDistance
                 FROM (SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<40
                     INNER JOIN route r1 ON route.rut_to_city_id=r1.rut_from_city_id AND r1.rut_active=1
                     INNER JOIN rate ON r1.rut_id=rate.rte_route_id AND rate.rte_status=1  AND rate.rte_vehicletype_id IN (3) GROUP BY route.rut_id HAVING count(*) >30
                   UNION
                     SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<600
                     INNER JOIN cities tc ON tc.cty_id=route.rut_to_city_id AND tc.cty_service_active=1 AND CalcDistance(cities.cty_lat, cities.cty_long, tc.cty_lat, tc.cty_long)<=route.rut_estm_distance						 
                     INNER JOIN cities_stats ON cities_stats.cts_cty_id = route.rut_to_city_id AND cities_stats.cts_vnd_cnt >= 2
                   UNION
                    SELECT cts_cty_id AS city, 0 AS distance
					FROM cities_stats WHERE 1 AND cities_stats.cts_cty_id= 30817 and cities_stats.cts_vnd_cnt>1) a
                    INNER JOIN cities ON cities.cty_id=a.city
                    ORDER BY totalExtraDistance LIMIT 1 
	 [params: []]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23815.816] [M: 25458.29] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"3","tripDistance":"","tripDuration":"","multiCityData":"","bookingType":"1","pickupAddress":"","pickupDate":"31\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","sccId":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=3&tripDistance=&tripDuration=&multiCityData=&bookingType=1&pickupAddress=&pickupDate=31%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&sccId=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23816.236] [M: 25475.13] [ET: 0.931/23790.275] [MU: 18.05/25475.02] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23816.271] [M: 25476.81] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23817.188] [M: 25490.27] [ET: 0.793/23791.208] [MU: 3/25487.77] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+10013),(IF((cpm_value_type=2),(10013+(10013*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30937 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30937) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-31 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=70 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23818.893] [M: 25532.5] [ET: 3.668/23792.929] [MU: 75.88/25532.34] 
	RouteRates::calculate for CAB 70 2024-10-31 18:00:00 - Trip Type: 1 2319536
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23819.032] [M: 25510.19] [ET: 35.876/23793.073] [MU: 301.59/25510.03] 
	Quote::calculateRules for CAB 70, From City Id: 30804, To city Id: 30711
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23819.311] [M: 25481.7] [ET: 0.191/23793.329] [MU: 0.9/25481.45] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"70"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23819.427] [M: 25482.95] [ET: 67.389/23793.451] [MU: 472.45/25482.85] 
	Quote For CabType: 70
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23820.788] [M: 25493.29] [ET: 0.473/23794.805] [MU: 3.33/25492.85] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23821.312] [M: 25499.1] [ET: 0.422/23795.333] [MU: 3.34/25498.66] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23821.891] [M: 25502.04] [ET: 0.49/23795.926] [MU: 0.9/25501.79] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23822.474] [M: 25534.4] [ET: 0.452/23796.483] [MU: 24.22/25532.9] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (100) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30711) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp266)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp269,:gp270)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp267,:gp268)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp271,:gp272))
			OR (scr_area_type = 5 AND scr_area_id IN (3699))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (73)
		ORDER BY rank DESC
		 
	 [params: {":gp266":"31",":gp267":"30804",":gp268":"30711",":gp269":"105",":gp270":"100",":gp271":"1",":gp272":"1","tripType":"1"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23823.277] [M: 25514.57] [ET: 0.206/23797.313] [MU: 0.84/25514.38] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23823.627] [M: 25517.41] [ET: 0.258/23797.646] [MU: 0.93/25517.1] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"6"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23832.039] [M: 25535.11] [ET: 6.898/23806.063] [MU: 3.53/25534.23] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"73","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23832.936] [M: 25538.36] [ET: 0.664/23806.965] [MU: 0.86/25538.14] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":0}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23833.626] [M: 25545.64] [ET: 0.52/23807.659] [MU: 2.97/25545.2] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23834.382] [M: 25573.81] [ET: 0.651/23808.414] [MU: 22.05/25573.19] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp274)) OR (apr_area_type = 2 AND apr_area_id IN (:gp275)) OR (apr_area_type = 4 AND apr_area_id IN (:gp276)) OR (apr_area_type = 1 AND apr_area_id IN (:gp273))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp273":"31",":gp274":"30804",":gp275":"105",":gp276":"1","cab":"73"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23835.553] [M: 25560.52] [ET: 0.569/23809.58] [MU: 3.34/25560.09] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23838.74] [M: 25570.8] [ET: 3.021/23812.735] [MU: 3.4/25569.93] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp278)) OR (scr_area_type = 2 AND scr_area_id IN (:gp279)) OR (scr_area_type = 4 AND scr_area_id IN (:gp280)) OR (scr_area_type = 1 AND scr_area_id IN (:gp277)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp277":"31",":gp278":"30804",":gp279":"105",":gp280":"1","scv_id":"73"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23841.88] [M: 25598.55] [ET: 2.321/23815.864] [MU: 0.74/25590.55] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"nearest_route_30804_30711","sql":"(INDEX indx_nearest_rt_rutid (rut_id)) \r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, routeFrom.rut_name as fromAlias, \r\n\t\t\t\tNULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, \r\n\t\t\t\t0 as rank, routeFrom.rut_estm_time as startTime, 0 as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 \r\n\t\t\t\tAND routeFrom.rut_from_city_id<>routeFrom.rut_to_city_id AND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\t\tAND (routeAlias.rut_to_city_id=route.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, NULL, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) \r\n\t\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\t0 AS extraStartDistance, 0, 0 as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND route.rut_from_city_id = 30804 AND route.rut_to_city_id=30711 \r\n\t\t\t\tAND routeTo.rut_from_city_id=30711\r\n\t\t\t\tAND route.rut_active = 1 AND routeTo.rut_active = 1 AND routeTo.rut_estm_distance < 50 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = route.rut_from_city_id) \r\n\t\t\t   AND (routeAlias.rut_to_city_id = routeTo.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, \r\n\t\t\t\trouteFrom.rut_name, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t+ IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) \r\n\t\t\t\tAS extraDistance, IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, 0, \r\n\t\t\t\trouteFrom.rut_estm_time as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 AND routeFrom.rut_from_city_id <> routeFrom.rut_to_city_id\r\n\t\t\t\t\tAND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND routeTo.rut_estm_distance < 50 \r\n\t\t\t\t\tAND routeTo.rut_from_city_id=30711 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\tAND (routeAlias.rut_to_city_id=routeTo.rut_to_city_id) AND routeAlias.rut_active = 1 AND routeAlias.rut_from_city_id=30804  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23846.229] [M: 25602.63] [ET: 4.203/23820.214] [MU: 2.16/25602.19] 
	SQL: SELECT *, (rte_vendor_amount + extraDistance * 10.55) as totalCost FROM (SELECT * FROM nearest_route_30804_30711) a
					INNER JOIN rate ON a.rut_id = rate.rte_route_id AND rte_status=1 AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <>0
					WHERE 1 ORDER BY rank DESC, totalCost ASC LIMIT 0,1 
	 [params: {"cabType":"73"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23847.111] [M: 25610.65] [ET: 0.7/23821.131] [MU: 0.74/25608.65] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"getNearestRoute_30804_30711_70","sql":"(INDEX getNearestRoute_30804_30711_70_index_rut_id (rut_id))\r\n\t\t\t\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id AS start, routeAlias.rut_to_city_id AS end,\r\n\t\t\t\t\t\t\t\trouteFrom.rut_name AS fromAlias, NULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance AS quotedDistance,\r\n\t\t\t\t\t\t\t\trouteAlias.rut_estm_distance AS rateDistance, \r\n\t\t\t\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance)\r\n\t\t\t\t\t\t\t\t\t - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance,\r\n\t\t\t\t\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance,\r\n\t\t\t\t\t\t\t\t0 AS rank, routeFrom.rut_estm_time AS startTime, 0 AS endTime, route.rut_estm_time, \r\n\t\t\t\t\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraTravelDistance\r\n\t\t\t\t\t\tFROM   route\r\n\t\t\t\t\t\tINNER JOIN route routeTo ON routeTo.rut_to_city_id=route.rut_from_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_from_city_id=30804 AND routeTo.rut_active=1\r\n\t\t\t\t\t\t\t\tAND routeTo.rut_estm_distance<70 AND route.rut_active=1\r\n\t\t\t\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_from_city_id=route.rut_to_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_active = 1\r\n\t\t\t\t\t\t\t\tAND routeFrom.rut_estm_distance<70 AND route.rut_active = 1\r\n\t\t\t\t\t\tINNER JOIN route routeAlias ON routeAlias.rut_to_city_id=routeFrom.rut_to_city_id\r\n\t\t\t\t\t\t\tAND routeAlias.rut_from_city_id=routeTo.rut_from_city_id AND routeAlias.rut_active = 1"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23850.43] [M: 25615.91] [ET: 3.228/23824.45] [MU: 2.41/25615.29] 
	SQL: SELECT *, (rte_vendor_amount + extradistance * 10.55 ) AS totalCost, 
						ABS(quotedDistance-rateDistance) AS extraChargeableDistance
					FROM getNearestRoute_30804_30711_70 a
					INNER JOIN rate ON a.rut_id=rate.rte_route_id AND rte_status=1 
						AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <> 0
					WHERE  1
					ORDER  BY rank DESC, extraStartDistance, extraChargeableDistance ASC, totalcost ASC
					LIMIT  0, 1 
	 [params: {"cabType":"73"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23853.381] [M: 25630.99] [ET: 0.5/23827.412] [MU: 3.41/25630.12] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23854.517] [M: 25641.24] [ET: 29.61/23828.55] [MU: 114.1/25641.09] 
	Quote::calculateOneWay  for CAB 73 Date: 2024-10-31 18:00:00
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23854.994] [M: 25644.74] [ET: 0.387/23829.03] [MU: 0.89/25644.49] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23856.162] [M: 25657.45] [ET: 0.492/23830.194] [MU: 3.34/25657.02] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23856.856] [M: 25686.63] [ET: 0.581/23830.875] [MU: 22.53/25685.88] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp283)) OR (apr_area_type = 5 AND apr_area_id IN (:gp281)) OR (apr_area_type = 2 AND apr_area_id IN (:gp284)) OR (apr_area_type = 4 AND apr_area_id IN (:gp285)) OR (apr_area_type = 1 AND apr_area_id IN (:gp282))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp281":"3699",":gp282":"31",":gp283":"30804",":gp284":"105",":gp285":"1","cab":"73"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23858.586] [M: 25673.63] [ET: 0.582/23832.613] [MU: 3.34/25673.2] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23861.548] [M: 25684.18] [ET: 2.793/23835.546] [MU: 3.53/25683.3] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp288)) OR (scr_area_type = 5 AND scr_area_id IN (:gp286)) OR (scr_area_type = 2 AND scr_area_id IN (:gp289)) OR (scr_area_type = 4 AND scr_area_id IN (:gp290)) OR (scr_area_type = 1 AND scr_area_id IN (:gp287)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp286":"3699",":gp287":"31",":gp288":"3699",":gp289":"105",":gp290":"1","scv_id":"73"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23862.318] [M: 25685.36] [ET: 0.376/23836.337] [MU: 2.97/25685.25] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23864.066] [M: 25695.56] [ET: 0.628/23838.087] [MU: 2.79/25694.94] 
	SQL: SELECT 
						fc.cty_id as c2id, 
						fc.cty_name as c2name, 
						fc.cty_garage_address as c2address,
						tc.cty_id as c4id,
						tc.cty_name as c4name, tc.cty_garage_address as c4address,
						0 as totalExtraDistance FROM route
						INNER JOIN cities fc ON rut_from_city_id=fc.cty_id
						INNER JOIN cities tc ON rut_to_city_id=tc.cty_id
						INNER JOIN rate on  rate.rte_route_id=route.rut_id  AND rate.rte_vehicletype_id IN (3)
						WHERE route.rut_from_city_id=30804 AND route.rut_to_city_id=30711 AND route.rut_active=1 
	 [params: []]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23864.653] [M: 25709.45] [ET: 0.478/23838.669] [MU: 6.53/25707.45] 
	SQL: 
				SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address, tc.cty_id as c4id, 
				tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
					FROM
					 (
						(
							SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id,  
								r3.rut_to_city_id, route.rut_name , route.rut_id,
								(route.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, 
								r3.rut_estm_distance
							FROM route
							INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_from_city_id=30804  
									AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=route.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) 
									AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
						UNION
						(
							SELECT r3.rut_id, r3.rut_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,(route.rut_estm_distance + r1.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
							FROM route
							INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND  route.rut_to_city_id=30711 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND route.rut_to_city_id=r3.rut_to_city_id))	AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
                     ) a
					INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
					INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1 
	 [params: []]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23865.192] [M: 25719.95] [ET: 0.446/23839.212] [MU: 5.04/25718.45] 
	SQL: SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
                              tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
                        FROM (SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,
                                    (route.rut_estm_distance + r1.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
                                FROM route
								INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
								INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
								INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) AND r3.rut_active=1 
								INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3) LIMIT 1
							)a
                        INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
                        INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1
                         
	 [params: []]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23865.794] [M: 25726.33] [ET: 0.499/23839.805] [MU: 0.75/25725.45] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"GarageRoute_30804_30711","sql":" (INDEX GarageRoute_30804_30711_index_rut_id (rut_id), INDEX GarageRoute_30804_30711_index_rut_from_city_id (rut_from_city_id), INDEX GarageRoute_30804_30711_index_rut_to_city_id (rut_to_city_id))\r\n\t\t\t\t\t\t\tSELECT route.rut_id, route.rut_from_city_id, route.rut_to_city_id, route.rut_name, rut_estm_distance FROM route \r\n\t\t\t\t\t\t\tINNER JOIN cities_stats   ON cities_stats.cts_cty_id = route.rut_from_city_id\r\n\t\t\t\t\t\t\tAND rut_estm_distance < 300\r\n\t\t\t\t\t\t\tAND rut_active = 1\r\n\t\t\t\t\t\t\tAND route.rut_to_city_id=30804\r\n\t\t\t\t\t\t\tAND cities_stats.cts_vnd_cnt >= 3\r\n\t\t\t\t\t\t\tORDER BY rut_estm_distance LIMIT 10"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23866.556] [M: 25738.25] [ET: 0.651/23840.571] [MU: 6.68/25736.5] 
	SQL: SELECT a.*, fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
								tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address 
						FROM ((SELECT xyz.rut_from_city_id as startCity, r1.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r3.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_from_city_id
							INNER JOIN rate ON rate.rte_route_id=r1.rut_id  AND rate.rte_vehicletype_id IN (3)
							INNER JOIN route r2 ON r2.rut_to_city_id=r1.rut_to_city_id AND r2.rut_from_city_id=:dropCity AND r2.rut_active=1
							INNER JOIN route r3 ON r3.rut_from_city_id=xyz.rut_to_city_id AND r3.rut_to_city_id=r2.rut_from_city_id AND r3.rut_active=1
							ORDER BY ExtraDistance LIMIT 1
							)
							UNION
							(
							SELECT xyz.rut_from_city_id as startCity, r2.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r2.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_to_city_id AND r1.rut_to_city_id=:dropCity
							INNER JOIN route r2 ON r2.rut_to_city_id=xyz.rut_from_city_id AND r2.rut_from_city_id=r1.rut_to_city_id
							ORDER BY ExtraDistance ASC LIMIT 1
							)) a
						INNER JOIN cities fc ON startCity=fc.cty_id
						INNER JOIN cities tc ON endCity=tc.cty_id 
						ORDER BY ExtraDistance 
	 [params: {"pickupCity":"30804","dropCity":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23869.693] [M: 25749.59] [ET: 1.274/23843.703] [MU: 7.89/25749.48] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23870.966] [M: 25755.16] [ET: 1.132/23844.985] [MU: 8.27/25755.05] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23872.028] [M: 25762.79] [ET: 0.346/23846.05] [MU: 1/25762.41] 
	SQL: SELECT cts_airport_pickup_entry_fee
               FROM   cities
               INNER JOIN cities_stats
               ON cities.cty_id = cities_stats.cts_cty_id
               WHERE  cty_id = :cityId
               AND cty_is_airport = 1 AND cty_active = 1 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23873.843] [M: 25776.7] [ET: 1.127/23847.87] [MU: 8.14/25776.59] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23875.014] [M: 25784.45] [ET: 1.033/23849.036] [MU: 8.08/25784.34] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23875.621] [M: 25783.88] [ET: 0.481/23849.567] [MU: 0.9/25783.63] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23877.427] [M: 25796.59] [ET: 0.741/23851.446] [MU: 3.33/25796.15] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23878.308] [M: 25825.76] [ET: 0.738/23852.328] [MU: 22.53/25825.01] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp293)) OR (apr_area_type = 5 AND apr_area_id IN (:gp291)) OR (apr_area_type = 2 AND apr_area_id IN (:gp294)) OR (apr_area_type = 4 AND apr_area_id IN (:gp295)) OR (apr_area_type = 1 AND apr_area_id IN (:gp292))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp291":"3699",":gp292":"31",":gp293":"30804",":gp294":"105",":gp295":"1","cab":"73"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23879.968] [M: 25812.77] [ET: 0.556/23853.99] [MU: 3.34/25812.33] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23882.388] [M: 25823.31] [ET: 2.28/23856.401] [MU: 3.53/25822.44] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp298)) OR (scr_area_type = 5 AND scr_area_id IN (:gp296)) OR (scr_area_type = 2 AND scr_area_id IN (:gp299)) OR (scr_area_type = 4 AND scr_area_id IN (:gp300)) OR (scr_area_type = 1 AND scr_area_id IN (:gp297)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp296":"3699",":gp297":"31",":gp298":"3699",":gp299":"105",":gp300":"1","scv_id":"73"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23883.416] [M: 25826.53] [ET: 0.413/23857.447] [MU: 2.97/25826.42] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23885.108] [M: 25839.64] [ET: 0.249/23859.148] [MU: 2.97/25839.53] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23885.381] [M: 25843.81] [ET: 0.201/23859.418] [MU: 2.98/25843.7] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23889.053] [M: 25877.77] [ET: 0.678/23863.068] [MU: 6.29/25875.77] 
	SQL: 
                SELECT cities.cty_id as c2id, cities.cty_name as c2name, cities.cty_garage_address as c2address,
                    cities.cty_id as c4id, cities.cty_name as c4name, cities.cty_garage_address as c4address,
                        (distance * 2) as totalExtraDistance
                 FROM (SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<40
                     INNER JOIN route r1 ON route.rut_to_city_id=r1.rut_from_city_id AND r1.rut_active=1
                     INNER JOIN rate ON r1.rut_id=rate.rte_route_id AND rate.rte_status=1  AND rate.rte_vehicletype_id IN (3) GROUP BY route.rut_id HAVING count(*) >30
                   UNION
                     SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<600
                     INNER JOIN cities tc ON tc.cty_id=route.rut_to_city_id AND tc.cty_service_active=1 AND CalcDistance(cities.cty_lat, cities.cty_long, tc.cty_lat, tc.cty_long)<=route.rut_estm_distance						 
                     INNER JOIN cities_stats ON cities_stats.cts_cty_id = route.rut_to_city_id AND cities_stats.cts_vnd_cnt >= 2
                   UNION
                    SELECT cts_cty_id AS city, 0 AS distance
					FROM cities_stats WHERE 1 AND cities_stats.cts_cty_id= 30817 and cities_stats.cts_vnd_cnt>1) a
                    INNER JOIN cities ON cities.cty_id=a.city
                    ORDER BY totalExtraDistance LIMIT 1 
	 [params: []]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23892.697] [M: 25892.59] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"3","tripDistance":"","tripDuration":"","multiCityData":"","bookingType":"1","pickupAddress":"","pickupDate":"31\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","sccId":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=3&tripDistance=&tripDuration=&multiCityData=&bookingType=1&pickupAddress=&pickupDate=31%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&sccId=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23893.316] [M: 25909.43] [ET: 1.336/23867.346] [MU: 18.04/25909.32] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23893.358] [M: 25911.11] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23894.511] [M: 25924.57] [ET: 0.979/23868.513] [MU: 2.99/25922.07] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+10013),(IF((cpm_value_type=2),(10013+(10013*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30937 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30937) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-31 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=73 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23896.294] [M: 25966.8] [ET: 4.384/23870.313] [MU: 75.87/25966.64] 
	RouteRates::calculate for CAB 73 2024-10-31 18:00:00 - Trip Type: 1 924560851
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23896.543] [M: 26072.48] [ET: 41.955/23870.566] [MU: 429.78/26072.33] 
	Quote::calculateRules for CAB 73, From City Id: 30804, To city Id: 30711
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23896.909] [M: 26045] [ET: 0.251/23870.929] [MU: 0.9/26044.75] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"73"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23897.017] [M: 26046.56] [ET: 77.51/23871.042] [MU: 562.31/26046.47] 
	Quote For CabType: 73
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23898.41] [M: 26056.91] [ET: 0.463/23872.428] [MU: 3.33/26056.47] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23898.939] [M: 26062.72] [ET: 0.428/23872.959] [MU: 3.33/26062.28] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23899.563] [M: 26065.66] [ET: 0.526/23873.589] [MU: 0.9/26065.41] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23900.271] [M: 26098.02] [ET: 0.581/23874.294] [MU: 24.22/26096.52] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (100) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30711) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp301)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp304,:gp305)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp302,:gp303)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp306,:gp307))
			OR (scr_area_type = 5 AND scr_area_id IN (3699))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (78)
		ORDER BY rank DESC
		 
	 [params: {":gp301":"31",":gp302":"30804",":gp303":"30711",":gp304":"105",":gp305":"100",":gp306":"1",":gp307":"1","tripType":"1"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23900.971] [M: 26078.2] [ET: 0.196/23875.001] [MU: 0.84/26078.02] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23901.361] [M: 26081.08] [ET: 0.299/23875.391] [MU: 0.96/26080.77] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"1"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23902.689] [M: 26093.84] [ET: 0.392/23876.711] [MU: 2.05/26093.34] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"78"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23906.753] [M: 26103.23] [ET: 3.791/23880.762] [MU: 3.53/26102.35] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"78","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23907.599] [M: 26106.48] [ET: 0.542/23881.616] [MU: 0.87/26106.26] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":0}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23908.507] [M: 26113.76] [ET: 0.649/23882.527] [MU: 2.97/26113.32] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23909.604] [M: 26141.93] [ET: 0.924/23883.613] [MU: 22.05/26141.3] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp309)) OR (apr_area_type = 2 AND apr_area_id IN (:gp310)) OR (apr_area_type = 4 AND apr_area_id IN (:gp311)) OR (apr_area_type = 1 AND apr_area_id IN (:gp308))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp308":"31",":gp309":"30804",":gp310":"105",":gp311":"1","cab":"78"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23911.011] [M: 26128.66] [ET: 0.621/23885.031] [MU: 3.33/26128.22] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23913.959] [M: 26138.94] [ET: 2.768/23887.944] [MU: 3.41/26138.06] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp313)) OR (scr_area_type = 2 AND scr_area_id IN (:gp314)) OR (scr_area_type = 4 AND scr_area_id IN (:gp315)) OR (scr_area_type = 1 AND scr_area_id IN (:gp312)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp312":"31",":gp313":"30804",":gp314":"105",":gp315":"1","scv_id":"78"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23917.415] [M: 26166.66] [ET: 2.478/23891.409] [MU: 0.75/26158.66] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"nearest_route_30804_30711","sql":"(INDEX indx_nearest_rt_rutid (rut_id)) \r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, routeFrom.rut_name as fromAlias, \r\n\t\t\t\tNULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, \r\n\t\t\t\t0 as rank, routeFrom.rut_estm_time as startTime, 0 as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 \r\n\t\t\t\tAND routeFrom.rut_from_city_id<>routeFrom.rut_to_city_id AND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\t\tAND (routeAlias.rut_to_city_id=route.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, NULL, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) \r\n\t\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\t0 AS extraStartDistance, 0, 0 as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND route.rut_from_city_id = 30804 AND route.rut_to_city_id=30711 \r\n\t\t\t\tAND routeTo.rut_from_city_id=30711\r\n\t\t\t\tAND route.rut_active = 1 AND routeTo.rut_active = 1 AND routeTo.rut_estm_distance < 50 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = route.rut_from_city_id) \r\n\t\t\t   AND (routeAlias.rut_to_city_id = routeTo.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, \r\n\t\t\t\trouteFrom.rut_name, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t+ IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) \r\n\t\t\t\tAS extraDistance, IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, 0, \r\n\t\t\t\trouteFrom.rut_estm_time as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 AND routeFrom.rut_from_city_id <> routeFrom.rut_to_city_id\r\n\t\t\t\t\tAND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND routeTo.rut_estm_distance < 50 \r\n\t\t\t\t\tAND routeTo.rut_from_city_id=30711 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\tAND (routeAlias.rut_to_city_id=routeTo.rut_to_city_id) AND routeAlias.rut_active = 1 AND routeAlias.rut_from_city_id=30804  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23919.861] [M: 26170.74] [ET: 2.322/23893.869] [MU: 2.17/26170.3] 
	SQL: SELECT *, (rte_vendor_amount + extraDistance * 10.55) as totalCost FROM (SELECT * FROM nearest_route_30804_30711) a
					INNER JOIN rate ON a.rut_id = rate.rte_route_id AND rte_status=1 AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <>0
					WHERE 1 ORDER BY rank DESC, totalCost ASC LIMIT 0,1 
	 [params: {"cabType":"78"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23920.783] [M: 26178.77] [ET: 0.734/23894.748] [MU: 0.74/26176.77] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"getNearestRoute_30804_30711_70","sql":"(INDEX getNearestRoute_30804_30711_70_index_rut_id (rut_id))\r\n\t\t\t\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id AS start, routeAlias.rut_to_city_id AS end,\r\n\t\t\t\t\t\t\t\trouteFrom.rut_name AS fromAlias, NULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance AS quotedDistance,\r\n\t\t\t\t\t\t\t\trouteAlias.rut_estm_distance AS rateDistance, \r\n\t\t\t\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance)\r\n\t\t\t\t\t\t\t\t\t - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance,\r\n\t\t\t\t\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance,\r\n\t\t\t\t\t\t\t\t0 AS rank, routeFrom.rut_estm_time AS startTime, 0 AS endTime, route.rut_estm_time, \r\n\t\t\t\t\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraTravelDistance\r\n\t\t\t\t\t\tFROM   route\r\n\t\t\t\t\t\tINNER JOIN route routeTo ON routeTo.rut_to_city_id=route.rut_from_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_from_city_id=30804 AND routeTo.rut_active=1\r\n\t\t\t\t\t\t\t\tAND routeTo.rut_estm_distance<70 AND route.rut_active=1\r\n\t\t\t\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_from_city_id=route.rut_to_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_active = 1\r\n\t\t\t\t\t\t\t\tAND routeFrom.rut_estm_distance<70 AND route.rut_active = 1\r\n\t\t\t\t\t\tINNER JOIN route routeAlias ON routeAlias.rut_to_city_id=routeFrom.rut_to_city_id\r\n\t\t\t\t\t\t\tAND routeAlias.rut_from_city_id=routeTo.rut_from_city_id AND routeAlias.rut_active = 1"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23923.276] [M: 26184.03] [ET: 2.351/23897.278] [MU: 2.42/26183.41] 
	SQL: SELECT *, (rte_vendor_amount + extradistance * 10.55 ) AS totalCost, 
						ABS(quotedDistance-rateDistance) AS extraChargeableDistance
					FROM getNearestRoute_30804_30711_70 a
					INNER JOIN rate ON a.rut_id=rate.rte_route_id AND rte_status=1 
						AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <> 0
					WHERE  1
					ORDER  BY rank DESC, extraStartDistance, extraChargeableDistance ASC, totalcost ASC
					LIMIT  0, 1 
	 [params: {"cabType":"78"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23927.134] [M: 26199.13] [ET: 0.648/23901.154] [MU: 3.41/26198.25] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23928.484] [M: 26209.36] [ET: 25.705/23902.512] [MU: 114.1/26209.2] 
	Quote::calculateOneWay  for CAB 78 Date: 2024-10-31 18:00:00
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23928.996] [M: 26212.86] [ET: 0.393/23903.021] [MU: 0.9/26212.61] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23930.774] [M: 26225.57] [ET: 0.741/23904.78] [MU: 3.34/26225.13] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23931.508] [M: 26254.74] [ET: 0.527/23905.536] [MU: 22.53/26253.99] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp318)) OR (apr_area_type = 5 AND apr_area_id IN (:gp316)) OR (apr_area_type = 2 AND apr_area_id IN (:gp319)) OR (apr_area_type = 4 AND apr_area_id IN (:gp320)) OR (apr_area_type = 1 AND apr_area_id IN (:gp317))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp316":"3699",":gp317":"31",":gp318":"30804",":gp319":"105",":gp320":"1","cab":"78"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23933.238] [M: 26241.77] [ET: 0.708/23907.246] [MU: 3.34/26241.33] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23935.744] [M: 26252.31] [ET: 2.311/23909.75] [MU: 3.53/26251.44] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp323)) OR (scr_area_type = 5 AND scr_area_id IN (:gp321)) OR (scr_area_type = 2 AND scr_area_id IN (:gp324)) OR (scr_area_type = 4 AND scr_area_id IN (:gp325)) OR (scr_area_type = 1 AND scr_area_id IN (:gp322)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp321":"3699",":gp322":"31",":gp323":"3699",":gp324":"105",":gp325":"1","scv_id":"78"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23936.512] [M: 26253.48] [ET: 0.372/23910.533] [MU: 2.98/26253.37] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23938.364] [M: 26263.68] [ET: 0.657/23912.379] [MU: 2.79/26263.05] 
	SQL: SELECT 
						fc.cty_id as c2id, 
						fc.cty_name as c2name, 
						fc.cty_garage_address as c2address,
						tc.cty_id as c4id,
						tc.cty_name as c4name, tc.cty_garage_address as c4address,
						0 as totalExtraDistance FROM route
						INNER JOIN cities fc ON rut_from_city_id=fc.cty_id
						INNER JOIN cities tc ON rut_to_city_id=tc.cty_id
						INNER JOIN rate on  rate.rte_route_id=route.rut_id  AND rate.rte_vehicletype_id IN (3)
						WHERE route.rut_from_city_id=30804 AND route.rut_to_city_id=30711 AND route.rut_active=1 
	 [params: []]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23938.884] [M: 26277.56] [ET: 0.423/23912.914] [MU: 6.54/26275.56] 
	SQL: 
				SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address, tc.cty_id as c4id, 
				tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
					FROM
					 (
						(
							SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id,  
								r3.rut_to_city_id, route.rut_name , route.rut_id,
								(route.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, 
								r3.rut_estm_distance
							FROM route
							INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_from_city_id=30804  
									AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=route.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) 
									AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
						UNION
						(
							SELECT r3.rut_id, r3.rut_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,(route.rut_estm_distance + r1.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
							FROM route
							INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND  route.rut_to_city_id=30711 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND route.rut_to_city_id=r3.rut_to_city_id))	AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
                     ) a
					INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
					INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1 
	 [params: []]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23939.288] [M: 26288.07] [ET: 0.333/23913.317] [MU: 5.03/26286.57] 
	SQL: SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
                              tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
                        FROM (SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,
                                    (route.rut_estm_distance + r1.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
                                FROM route
								INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
								INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
								INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) AND r3.rut_active=1 
								INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3) LIMIT 1
							)a
                        INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
                        INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1
                         
	 [params: []]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23939.778] [M: 26294.45] [ET: 0.404/23913.79] [MU: 0.74/26293.57] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"GarageRoute_30804_30711","sql":" (INDEX GarageRoute_30804_30711_index_rut_id (rut_id), INDEX GarageRoute_30804_30711_index_rut_from_city_id (rut_from_city_id), INDEX GarageRoute_30804_30711_index_rut_to_city_id (rut_to_city_id))\r\n\t\t\t\t\t\t\tSELECT route.rut_id, route.rut_from_city_id, route.rut_to_city_id, route.rut_name, rut_estm_distance FROM route \r\n\t\t\t\t\t\t\tINNER JOIN cities_stats   ON cities_stats.cts_cty_id = route.rut_from_city_id\r\n\t\t\t\t\t\t\tAND rut_estm_distance < 300\r\n\t\t\t\t\t\t\tAND rut_active = 1\r\n\t\t\t\t\t\t\tAND route.rut_to_city_id=30804\r\n\t\t\t\t\t\t\tAND cities_stats.cts_vnd_cnt >= 3\r\n\t\t\t\t\t\t\tORDER BY rut_estm_distance LIMIT 10"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23940.555] [M: 26306.37] [ET: 0.65/23914.566] [MU: 6.69/26304.62] 
	SQL: SELECT a.*, fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
								tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address 
						FROM ((SELECT xyz.rut_from_city_id as startCity, r1.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r3.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_from_city_id
							INNER JOIN rate ON rate.rte_route_id=r1.rut_id  AND rate.rte_vehicletype_id IN (3)
							INNER JOIN route r2 ON r2.rut_to_city_id=r1.rut_to_city_id AND r2.rut_from_city_id=:dropCity AND r2.rut_active=1
							INNER JOIN route r3 ON r3.rut_from_city_id=xyz.rut_to_city_id AND r3.rut_to_city_id=r2.rut_from_city_id AND r3.rut_active=1
							ORDER BY ExtraDistance LIMIT 1
							)
							UNION
							(
							SELECT xyz.rut_from_city_id as startCity, r2.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r2.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_to_city_id AND r1.rut_to_city_id=:dropCity
							INNER JOIN route r2 ON r2.rut_to_city_id=xyz.rut_from_city_id AND r2.rut_from_city_id=r1.rut_to_city_id
							ORDER BY ExtraDistance ASC LIMIT 1
							)) a
						INNER JOIN cities fc ON startCity=fc.cty_id
						INNER JOIN cities tc ON endCity=tc.cty_id 
						ORDER BY ExtraDistance 
	 [params: {"pickupCity":"30804","dropCity":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23943.926] [M: 26317.71] [ET: 1.312/23917.941] [MU: 7.88/26317.6] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23945.072] [M: 26323.19] [ET: 1.022/23919.107] [MU: 8.26/26323.08] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23945.85] [M: 26330.81] [ET: 0.301/23919.884] [MU: 0.99/26330.44] 
	SQL: SELECT cts_airport_pickup_entry_fee
               FROM   cities
               INNER JOIN cities_stats
               ON cities.cty_id = cities_stats.cts_cty_id
               WHERE  cty_id = :cityId
               AND cty_is_airport = 1 AND cty_active = 1 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23947.368] [M: 26344.73] [ET: 0.925/23921.387] [MU: 8.13/26344.62] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23948.497] [M: 26352.56] [ET: 0.991/23922.533] [MU: 8.08/26352.45] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23948.95] [M: 26351.99] [ET: 0.337/23922.967] [MU: 0.89/26351.74] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23950.416] [M: 26364.7] [ET: 0.721/23924.428] [MU: 3.34/26364.27] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23951.15] [M: 26393.88] [ET: 0.581/23925.174] [MU: 22.53/26393.13] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp328)) OR (apr_area_type = 5 AND apr_area_id IN (:gp326)) OR (apr_area_type = 2 AND apr_area_id IN (:gp329)) OR (apr_area_type = 4 AND apr_area_id IN (:gp330)) OR (apr_area_type = 1 AND apr_area_id IN (:gp327))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp326":"3699",":gp327":"31",":gp328":"30804",":gp329":"105",":gp330":"1","cab":"78"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23952.804] [M: 26380.9] [ET: 0.573/23926.832] [MU: 3.33/26380.46] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23955.628] [M: 26391.45] [ET: 2.683/23929.627] [MU: 3.53/26390.57] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp333)) OR (scr_area_type = 5 AND scr_area_id IN (:gp331)) OR (scr_area_type = 2 AND scr_area_id IN (:gp334)) OR (scr_area_type = 4 AND scr_area_id IN (:gp335)) OR (scr_area_type = 1 AND scr_area_id IN (:gp332)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp331":"3699",":gp332":"31",":gp333":"3699",":gp334":"105",":gp335":"1","scv_id":"78"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23956.284] [M: 26394.65] [ET: 0.273/23930.318] [MU: 2.97/26394.54] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23957.837] [M: 26407.76] [ET: 0.269/23931.873] [MU: 2.98/26407.65] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23958.167] [M: 26411.93] [ET: 0.239/23932.204] [MU: 2.97/26411.82] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23962.289] [M: 26445.98] [ET: 0.584/23936.315] [MU: 6.28/26443.98] 
	SQL: 
                SELECT cities.cty_id as c2id, cities.cty_name as c2name, cities.cty_garage_address as c2address,
                    cities.cty_id as c4id, cities.cty_name as c4name, cities.cty_garage_address as c4address,
                        (distance * 2) as totalExtraDistance
                 FROM (SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<40
                     INNER JOIN route r1 ON route.rut_to_city_id=r1.rut_from_city_id AND r1.rut_active=1
                     INNER JOIN rate ON r1.rut_id=rate.rte_route_id AND rate.rte_status=1  AND rate.rte_vehicletype_id IN (3) GROUP BY route.rut_id HAVING count(*) >30
                   UNION
                     SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<600
                     INNER JOIN cities tc ON tc.cty_id=route.rut_to_city_id AND tc.cty_service_active=1 AND CalcDistance(cities.cty_lat, cities.cty_long, tc.cty_lat, tc.cty_long)<=route.rut_estm_distance						 
                     INNER JOIN cities_stats ON cities_stats.cts_cty_id = route.rut_to_city_id AND cities_stats.cts_vnd_cnt >= 2
                   UNION
                    SELECT cts_cty_id AS city, 0 AS distance
					FROM cities_stats WHERE 1 AND cities_stats.cts_cty_id= 30817 and cities_stats.cts_vnd_cnt>1) a
                    INNER JOIN cities ON cities.cty_id=a.city
                    ORDER BY totalExtraDistance LIMIT 1 
	 [params: []]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23965.08] [M: 26460.8] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"3","tripDistance":"","tripDuration":"","multiCityData":"","bookingType":"1","pickupAddress":"","pickupDate":"31\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","sccId":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=3&tripDistance=&tripDuration=&multiCityData=&bookingType=1&pickupAddress=&pickupDate=31%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&sccId=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23965.549] [M: 26477.64] [ET: 0.925/23939.589] [MU: 18.04/26477.53] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23965.584] [M: 26479.32] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23966.663] [M: 26492.78] [ET: 0.954/23940.686] [MU: 2.99/26490.28] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+10013),(IF((cpm_value_type=2),(10013+(10013*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30937 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30937) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-31 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=78 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23968.062] [M: 26535.01] [ET: 3.503/23942.099] [MU: 75.87/26534.85] 
	RouteRates::calculate for CAB 78 2024-10-31 18:00:00 - Trip Type: 1 768390674
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23968.203] [M: 26512.7] [ET: 39.649/23942.243] [MU: 301.87/26512.54] 
	Quote::calculateRules for CAB 78, From City Id: 30804, To city Id: 30711
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23968.448] [M: 26484.4] [ET: 0.171/23942.486] [MU: 0.9/26484.15] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"78"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23968.516] [M: 26485.96] [ET: 71.432/23942.558] [MU: 438.09/26485.87] 
	Quote For CabType: 78
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23969.951] [M: 26496.3] [ET: 0.552/23943.963] [MU: 3.34/26495.87] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23970.479] [M: 26502.12] [ET: 0.45/23944.513] [MU: 3.33/26501.68] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23971.093] [M: 26505.05] [ET: 0.527/23945.106] [MU: 0.9/26504.8] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23971.803] [M: 26537.41] [ET: 0.547/23945.815] [MU: 24.22/26535.91] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (100) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30711) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp336)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp339,:gp340)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp337,:gp338)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp341,:gp342))
			OR (scr_area_type = 5 AND scr_area_id IN (3699))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (81)
		ORDER BY rank DESC
		 
	 [params: {":gp336":"31",":gp337":"30804",":gp338":"30711",":gp339":"105",":gp340":"100",":gp341":"1",":gp342":"1","tripType":"1"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23972.566] [M: 26517.59] [ET: 0.203/23946.585] [MU: 0.84/26517.41] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23972.973] [M: 26520.47] [ET: 0.299/23946.992] [MU: 0.96/26520.16] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"1"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23974.415] [M: 26533.23] [ET: 0.373/23948.434] [MU: 2.05/26532.73] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"81"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23977.914] [M: 26542.62] [ET: 3.202/23951.919] [MU: 3.53/26541.74] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"81","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23979.453] [M: 26545.87] [ET: 1.051/23953.458] [MU: 0.87/26545.65] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":0}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23980.164] [M: 26553.15] [ET: 0.528/23954.196] [MU: 2.97/26552.71] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23980.763] [M: 26581.32] [ET: 0.494/23954.794] [MU: 22.05/26580.7] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp344)) OR (apr_area_type = 2 AND apr_area_id IN (:gp345)) OR (apr_area_type = 4 AND apr_area_id IN (:gp346)) OR (apr_area_type = 1 AND apr_area_id IN (:gp343))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp343":"31",":gp344":"30804",":gp345":"105",":gp346":"1","cab":"81"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23981.759] [M: 26568.04] [ET: 0.458/23955.792] [MU: 3.33/26567.6] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23984.093] [M: 26578.32] [ET: 2.202/23958.084] [MU: 3.41/26577.45] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp348)) OR (scr_area_type = 2 AND scr_area_id IN (:gp349)) OR (scr_area_type = 4 AND scr_area_id IN (:gp350)) OR (scr_area_type = 1 AND scr_area_id IN (:gp347)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp347":"31",":gp348":"30804",":gp349":"105",":gp350":"1","scv_id":"81"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23987.262] [M: 26606.05] [ET: 2.181/23961.248] [MU: 0.74/26598.05] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"nearest_route_30804_30711","sql":"(INDEX indx_nearest_rt_rutid (rut_id)) \r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, routeFrom.rut_name as fromAlias, \r\n\t\t\t\tNULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, \r\n\t\t\t\t0 as rank, routeFrom.rut_estm_time as startTime, 0 as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 \r\n\t\t\t\tAND routeFrom.rut_from_city_id<>routeFrom.rut_to_city_id AND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\t\tAND (routeAlias.rut_to_city_id=route.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, NULL, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) \r\n\t\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\t0 AS extraStartDistance, 0, 0 as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND route.rut_from_city_id = 30804 AND route.rut_to_city_id=30711 \r\n\t\t\t\tAND routeTo.rut_from_city_id=30711\r\n\t\t\t\tAND route.rut_active = 1 AND routeTo.rut_active = 1 AND routeTo.rut_estm_distance < 50 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = route.rut_from_city_id) \r\n\t\t\t   AND (routeAlias.rut_to_city_id = routeTo.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, \r\n\t\t\t\trouteFrom.rut_name, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t+ IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) \r\n\t\t\t\tAS extraDistance, IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, 0, \r\n\t\t\t\trouteFrom.rut_estm_time as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 AND routeFrom.rut_from_city_id <> routeFrom.rut_to_city_id\r\n\t\t\t\t\tAND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND routeTo.rut_estm_distance < 50 \r\n\t\t\t\t\tAND routeTo.rut_from_city_id=30711 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\tAND (routeAlias.rut_to_city_id=routeTo.rut_to_city_id) AND routeAlias.rut_active = 1 AND routeAlias.rut_from_city_id=30804  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23989.818] [M: 26610.13] [ET: 2.41/23963.819] [MU: 2.17/26609.7] 
	SQL: SELECT *, (rte_vendor_amount + extraDistance * 10.55) as totalCost FROM (SELECT * FROM nearest_route_30804_30711) a
					INNER JOIN rate ON a.rut_id = rate.rte_route_id AND rte_status=1 AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <>0
					WHERE 1 ORDER BY rank DESC, totalCost ASC LIMIT 0,1 
	 [params: {"cabType":"81"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23990.561] [M: 26618.16] [ET: 0.596/23964.583] [MU: 0.74/26616.16] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"getNearestRoute_30804_30711_70","sql":"(INDEX getNearestRoute_30804_30711_70_index_rut_id (rut_id))\r\n\t\t\t\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id AS start, routeAlias.rut_to_city_id AS end,\r\n\t\t\t\t\t\t\t\trouteFrom.rut_name AS fromAlias, NULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance AS quotedDistance,\r\n\t\t\t\t\t\t\t\trouteAlias.rut_estm_distance AS rateDistance, \r\n\t\t\t\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance)\r\n\t\t\t\t\t\t\t\t\t - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance,\r\n\t\t\t\t\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance,\r\n\t\t\t\t\t\t\t\t0 AS rank, routeFrom.rut_estm_time AS startTime, 0 AS endTime, route.rut_estm_time, \r\n\t\t\t\t\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraTravelDistance\r\n\t\t\t\t\t\tFROM   route\r\n\t\t\t\t\t\tINNER JOIN route routeTo ON routeTo.rut_to_city_id=route.rut_from_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_from_city_id=30804 AND routeTo.rut_active=1\r\n\t\t\t\t\t\t\t\tAND routeTo.rut_estm_distance<70 AND route.rut_active=1\r\n\t\t\t\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_from_city_id=route.rut_to_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_active = 1\r\n\t\t\t\t\t\t\t\tAND routeFrom.rut_estm_distance<70 AND route.rut_active = 1\r\n\t\t\t\t\t\tINNER JOIN route routeAlias ON routeAlias.rut_to_city_id=routeFrom.rut_to_city_id\r\n\t\t\t\t\t\t\tAND routeAlias.rut_from_city_id=routeTo.rut_from_city_id AND routeAlias.rut_active = 1"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23993.162] [M: 26623.42] [ET: 2.485/23967.173] [MU: 2.41/26622.8] 
	SQL: SELECT *, (rte_vendor_amount + extradistance * 10.55 ) AS totalCost, 
						ABS(quotedDistance-rateDistance) AS extraChargeableDistance
					FROM getNearestRoute_30804_30711_70 a
					INNER JOIN rate ON a.rut_id=rate.rte_route_id AND rte_status=1 
						AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <> 0
					WHERE  1
					ORDER  BY rank DESC, extraStartDistance, extraChargeableDistance ASC, totalcost ASC
					LIMIT  0, 1 
	 [params: {"cabType":"81"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23996.393] [M: 26638.51] [ET: 0.477/23970.425] [MU: 3.42/26637.63] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23997.571] [M: 26648.75] [ET: 23.053/23971.593] [MU: 114.1/26648.59] 
	Quote::calculateOneWay  for CAB 81 Date: 2024-10-31 18:00:00
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23998.117] [M: 26652.22] [ET: 0.411/23972.15] [MU: 0.9/26652] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23999.165] [M: 26664.96] [ET: 0.491/23973.198] [MU: 3.34/26664.52] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 23999.738] [M: 26694.13] [ET: 0.457/23973.753] [MU: 22.54/26693.38] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp353)) OR (apr_area_type = 5 AND apr_area_id IN (:gp351)) OR (apr_area_type = 2 AND apr_area_id IN (:gp354)) OR (apr_area_type = 4 AND apr_area_id IN (:gp355)) OR (apr_area_type = 1 AND apr_area_id IN (:gp352))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp351":"3699",":gp352":"31",":gp353":"30804",":gp354":"105",":gp355":"1","cab":"81"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24001.307] [M: 26681.15] [ET: 0.504/23975.34] [MU: 3.33/26680.71] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24003.645] [M: 26691.7] [ET: 2.216/23977.653] [MU: 3.53/26690.82] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp358)) OR (scr_area_type = 5 AND scr_area_id IN (:gp356)) OR (scr_area_type = 2 AND scr_area_id IN (:gp359)) OR (scr_area_type = 4 AND scr_area_id IN (:gp360)) OR (scr_area_type = 1 AND scr_area_id IN (:gp357)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp356":"3699",":gp357":"31",":gp358":"3699",":gp359":"105",":gp360":"1","scv_id":"81"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24004.406] [M: 26692.87] [ET: 0.358/23978.429] [MU: 2.98/26692.76] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24005.946] [M: 26703.07] [ET: 0.513/23979.971] [MU: 2.79/26702.45] 
	SQL: SELECT 
						fc.cty_id as c2id, 
						fc.cty_name as c2name, 
						fc.cty_garage_address as c2address,
						tc.cty_id as c4id,
						tc.cty_name as c4name, tc.cty_garage_address as c4address,
						0 as totalExtraDistance FROM route
						INNER JOIN cities fc ON rut_from_city_id=fc.cty_id
						INNER JOIN cities tc ON rut_to_city_id=tc.cty_id
						INNER JOIN rate on  rate.rte_route_id=route.rut_id  AND rate.rte_vehicletype_id IN (3)
						WHERE route.rut_from_city_id=30804 AND route.rut_to_city_id=30711 AND route.rut_active=1 
	 [params: []]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24006.396] [M: 26716.95] [ET: 0.373/23980.425] [MU: 6.54/26714.95] 
	SQL: 
				SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address, tc.cty_id as c4id, 
				tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
					FROM
					 (
						(
							SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id,  
								r3.rut_to_city_id, route.rut_name , route.rut_id,
								(route.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, 
								r3.rut_estm_distance
							FROM route
							INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_from_city_id=30804  
									AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=route.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) 
									AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
						UNION
						(
							SELECT r3.rut_id, r3.rut_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,(route.rut_estm_distance + r1.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
							FROM route
							INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND  route.rut_to_city_id=30711 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND route.rut_to_city_id=r3.rut_to_city_id))	AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
                     ) a
					INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
					INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1 
	 [params: []]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24006.809] [M: 26727.46] [ET: 0.338/23980.835] [MU: 5.03/26725.96] 
	SQL: SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
                              tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
                        FROM (SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,
                                    (route.rut_estm_distance + r1.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
                                FROM route
								INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
								INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
								INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) AND r3.rut_active=1 
								INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3) LIMIT 1
							)a
                        INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
                        INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1
                         
	 [params: []]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24007.323] [M: 26733.84] [ET: 0.441/23981.352] [MU: 0.74/26732.96] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"GarageRoute_30804_30711","sql":" (INDEX GarageRoute_30804_30711_index_rut_id (rut_id), INDEX GarageRoute_30804_30711_index_rut_from_city_id (rut_from_city_id), INDEX GarageRoute_30804_30711_index_rut_to_city_id (rut_to_city_id))\r\n\t\t\t\t\t\t\tSELECT route.rut_id, route.rut_from_city_id, route.rut_to_city_id, route.rut_name, rut_estm_distance FROM route \r\n\t\t\t\t\t\t\tINNER JOIN cities_stats   ON cities_stats.cts_cty_id = route.rut_from_city_id\r\n\t\t\t\t\t\t\tAND rut_estm_distance < 300\r\n\t\t\t\t\t\t\tAND rut_active = 1\r\n\t\t\t\t\t\t\tAND route.rut_to_city_id=30804\r\n\t\t\t\t\t\t\tAND cities_stats.cts_vnd_cnt >= 3\r\n\t\t\t\t\t\t\tORDER BY rut_estm_distance LIMIT 10"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24008.169] [M: 26745.76] [ET: 0.749/23982.179] [MU: 6.69/26744.01] 
	SQL: SELECT a.*, fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
								tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address 
						FROM ((SELECT xyz.rut_from_city_id as startCity, r1.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r3.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_from_city_id
							INNER JOIN rate ON rate.rte_route_id=r1.rut_id  AND rate.rte_vehicletype_id IN (3)
							INNER JOIN route r2 ON r2.rut_to_city_id=r1.rut_to_city_id AND r2.rut_from_city_id=:dropCity AND r2.rut_active=1
							INNER JOIN route r3 ON r3.rut_from_city_id=xyz.rut_to_city_id AND r3.rut_to_city_id=r2.rut_from_city_id AND r3.rut_active=1
							ORDER BY ExtraDistance LIMIT 1
							)
							UNION
							(
							SELECT xyz.rut_from_city_id as startCity, r2.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r2.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_to_city_id AND r1.rut_to_city_id=:dropCity
							INNER JOIN route r2 ON r2.rut_to_city_id=xyz.rut_from_city_id AND r2.rut_from_city_id=r1.rut_to_city_id
							ORDER BY ExtraDistance ASC LIMIT 1
							)) a
						INNER JOIN cities fc ON startCity=fc.cty_id
						INNER JOIN cities tc ON endCity=tc.cty_id 
						ORDER BY ExtraDistance 
	 [params: {"pickupCity":"30804","dropCity":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24011.681] [M: 26757.1] [ET: 1.25/23985.715] [MU: 7.88/26756.99] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24012.637] [M: 26762.58] [ET: 0.869/23986.673] [MU: 8.26/26762.47] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24013.379] [M: 26770.2] [ET: 0.274/23987.415] [MU: 0.99/26769.83] 
	SQL: SELECT cts_airport_pickup_entry_fee
               FROM   cities
               INNER JOIN cities_stats
               ON cities.cty_id = cities_stats.cts_cty_id
               WHERE  cty_id = :cityId
               AND cty_is_airport = 1 AND cty_active = 1 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24014.842] [M: 26784.12] [ET: 0.9/23988.879] [MU: 8.13/26784.01] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24015.719] [M: 26791.86] [ET: 0.777/23989.75] [MU: 8.08/26791.75] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24016.144] [M: 26791.2] [ET: 0.347/23990.18] [MU: 0.9/26790.95] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24017.218] [M: 26803.91] [ET: 0.534/23991.252] [MU: 3.33/26803.47] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24017.911] [M: 26833.08] [ET: 0.589/23991.944] [MU: 22.53/26832.33] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp363)) OR (apr_area_type = 5 AND apr_area_id IN (:gp361)) OR (apr_area_type = 2 AND apr_area_id IN (:gp364)) OR (apr_area_type = 4 AND apr_area_id IN (:gp365)) OR (apr_area_type = 1 AND apr_area_id IN (:gp362))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp361":"3699",":gp362":"31",":gp363":"30804",":gp364":"105",":gp365":"1","cab":"81"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24019.313] [M: 26820.09] [ET: 0.481/23993.339] [MU: 3.34/26819.66] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24021.765] [M: 26830.64] [ET: 2.343/23995.79] [MU: 3.53/26829.77] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp368)) OR (scr_area_type = 5 AND scr_area_id IN (:gp366)) OR (scr_area_type = 2 AND scr_area_id IN (:gp369)) OR (scr_area_type = 4 AND scr_area_id IN (:gp370)) OR (scr_area_type = 1 AND scr_area_id IN (:gp367)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp366":"3699",":gp367":"31",":gp368":"3699",":gp369":"105",":gp370":"1","scv_id":"81"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24022.513] [M: 26833.85] [ET: 0.354/23996.537] [MU: 2.97/26833.74] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24023.938] [M: 26846.96] [ET: 0.227/23997.977] [MU: 2.97/26846.85] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24024.244] [M: 26851.13] [ET: 0.227/23998.269] [MU: 2.98/26851.02] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24028.494] [M: 26885.19] [ET: 0.638/24002.498] [MU: 6.28/26883.19] 
	SQL: 
                SELECT cities.cty_id as c2id, cities.cty_name as c2name, cities.cty_garage_address as c2address,
                    cities.cty_id as c4id, cities.cty_name as c4name, cities.cty_garage_address as c4address,
                        (distance * 2) as totalExtraDistance
                 FROM (SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<40
                     INNER JOIN route r1 ON route.rut_to_city_id=r1.rut_from_city_id AND r1.rut_active=1
                     INNER JOIN rate ON r1.rut_id=rate.rte_route_id AND rate.rte_status=1  AND rate.rte_vehicletype_id IN (3) GROUP BY route.rut_id HAVING count(*) >30
                   UNION
                     SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<600
                     INNER JOIN cities tc ON tc.cty_id=route.rut_to_city_id AND tc.cty_service_active=1 AND CalcDistance(cities.cty_lat, cities.cty_long, tc.cty_lat, tc.cty_long)<=route.rut_estm_distance						 
                     INNER JOIN cities_stats ON cities_stats.cts_cty_id = route.rut_to_city_id AND cities_stats.cts_vnd_cnt >= 2
                   UNION
                    SELECT cts_cty_id AS city, 0 AS distance
					FROM cities_stats WHERE 1 AND cities_stats.cts_cty_id= 30817 and cities_stats.cts_vnd_cnt>1) a
                    INNER JOIN cities ON cities.cty_id=a.city
                    ORDER BY totalExtraDistance LIMIT 1 
	 [params: []]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24031.204] [M: 26900] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"3","tripDistance":"","tripDuration":"","multiCityData":"","bookingType":"1","pickupAddress":"","pickupDate":"31\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","sccId":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=3&tripDistance=&tripDuration=&multiCityData=&bookingType=1&pickupAddress=&pickupDate=31%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&sccId=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24031.614] [M: 26916.84] [ET: 0.852/24005.654] [MU: 18.05/26916.73] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24031.653] [M: 26918.52] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24032.738] [M: 26931.98] [ET: 0.961/24006.761] [MU: 3/26929.48] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+10013),(IF((cpm_value_type=2),(10013+(10013*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30937 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30937) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-31 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=81 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24034.121] [M: 26974.21] [ET: 3.409/24008.153] [MU: 75.88/26974.05] 
	RouteRates::calculate for CAB 81 2024-10-31 18:00:00 - Trip Type: 1 516157661
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24034.257] [M: 26951.9] [ET: 36.604/24008.298] [MU: 301.68/26951.74] 
	Quote::calculateRules for CAB 81, From City Id: 30804, To city Id: 30711
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24034.497] [M: 26923.61] [ET: 0.167/24008.536] [MU: 0.9/26923.36] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"81"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24034.569] [M: 26925.17] [ET: 66.004/24008.61] [MU: 437.91/26925.08] 
	Quote For CabType: 81
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24035.711] [M: 26935.52] [ET: 0.367/24009.745] [MU: 3.34/26935.08] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24036.116] [M: 26941.33] [ET: 0.338/24010.151] [MU: 3.33/26940.89] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24036.695] [M: 26944.27] [ET: 0.494/24010.707] [MU: 0.9/26944.02] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24037.397] [M: 26976.63] [ET: 0.548/24011.426] [MU: 24.22/26975.13] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (100) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30711) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp371)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp374,:gp375)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp372,:gp373)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp376,:gp377))
			OR (scr_area_type = 5 AND scr_area_id IN (3699))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (82)
		ORDER BY rank DESC
		 
	 [params: {":gp371":"31",":gp372":"30804",":gp373":"30711",":gp374":"105",":gp375":"100",":gp376":"1",":gp377":"1","tripType":"1"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24038.052] [M: 26956.8] [ET: 0.176/24012.089] [MU: 0.84/26956.62] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24038.381] [M: 26959.68] [ET: 0.259/24012.418] [MU: 0.96/26959.37] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"1"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24039.49] [M: 26972.45] [ET: 0.323/24013.525] [MU: 2.05/26971.95] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"82"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24042.256] [M: 26981.83] [ET: 2.403/24016.121] [MU: 3.54/26980.95] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"82","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24043.235] [M: 26985.08] [ET: 0.555/24017.258] [MU: 0.87/26984.86] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":0}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24043.958] [M: 26992.36] [ET: 0.548/24017.99] [MU: 2.96/26991.92] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24044.568] [M: 27020.53] [ET: 0.502/24018.6] [MU: 22.05/27019.91] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp379)) OR (apr_area_type = 2 AND apr_area_id IN (:gp380)) OR (apr_area_type = 4 AND apr_area_id IN (:gp381)) OR (apr_area_type = 1 AND apr_area_id IN (:gp378))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp378":"31",":gp379":"30804",":gp380":"105",":gp381":"1","cab":"82"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24045.649] [M: 27007.25] [ET: 0.474/24019.681] [MU: 3.34/27006.81] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24048.059] [M: 27017.53] [ET: 2.286/24022.064] [MU: 3.41/27016.66] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp383)) OR (scr_area_type = 2 AND scr_area_id IN (:gp384)) OR (scr_area_type = 4 AND scr_area_id IN (:gp385)) OR (scr_area_type = 1 AND scr_area_id IN (:gp382)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp382":"31",":gp383":"30804",":gp384":"105",":gp385":"1","scv_id":"82"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24050.978] [M: 27045.27] [ET: 2.134/24024.965] [MU: 0.74/27037.27] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"nearest_route_30804_30711","sql":"(INDEX indx_nearest_rt_rutid (rut_id)) \r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, routeFrom.rut_name as fromAlias, \r\n\t\t\t\tNULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, \r\n\t\t\t\t0 as rank, routeFrom.rut_estm_time as startTime, 0 as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 \r\n\t\t\t\tAND routeFrom.rut_from_city_id<>routeFrom.rut_to_city_id AND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\t\tAND (routeAlias.rut_to_city_id=route.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, NULL, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) \r\n\t\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\t0 AS extraStartDistance, 0, 0 as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND route.rut_from_city_id = 30804 AND route.rut_to_city_id=30711 \r\n\t\t\t\tAND routeTo.rut_from_city_id=30711\r\n\t\t\t\tAND route.rut_active = 1 AND routeTo.rut_active = 1 AND routeTo.rut_estm_distance < 50 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = route.rut_from_city_id) \r\n\t\t\t   AND (routeAlias.rut_to_city_id = routeTo.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, \r\n\t\t\t\trouteFrom.rut_name, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t+ IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) \r\n\t\t\t\tAS extraDistance, IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, 0, \r\n\t\t\t\trouteFrom.rut_estm_time as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 AND routeFrom.rut_from_city_id <> routeFrom.rut_to_city_id\r\n\t\t\t\t\tAND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND routeTo.rut_estm_distance < 50 \r\n\t\t\t\t\tAND routeTo.rut_from_city_id=30711 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\tAND (routeAlias.rut_to_city_id=routeTo.rut_to_city_id) AND routeAlias.rut_active = 1 AND routeAlias.rut_from_city_id=30804  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24053.68] [M: 27049.34] [ET: 2.572/24027.682] [MU: 2.17/27048.91] 
	SQL: SELECT *, (rte_vendor_amount + extraDistance * 10.55) as totalCost FROM (SELECT * FROM nearest_route_30804_30711) a
					INNER JOIN rate ON a.rut_id = rate.rte_route_id AND rte_status=1 AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <>0
					WHERE 1 ORDER BY rank DESC, totalCost ASC LIMIT 0,1 
	 [params: {"cabType":"82"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24054.656] [M: 27057.37] [ET: 0.829/24028.654] [MU: 0.74/27055.37] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"getNearestRoute_30804_30711_70","sql":"(INDEX getNearestRoute_30804_30711_70_index_rut_id (rut_id))\r\n\t\t\t\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id AS start, routeAlias.rut_to_city_id AS end,\r\n\t\t\t\t\t\t\t\trouteFrom.rut_name AS fromAlias, NULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance AS quotedDistance,\r\n\t\t\t\t\t\t\t\trouteAlias.rut_estm_distance AS rateDistance, \r\n\t\t\t\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance)\r\n\t\t\t\t\t\t\t\t\t - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance,\r\n\t\t\t\t\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance,\r\n\t\t\t\t\t\t\t\t0 AS rank, routeFrom.rut_estm_time AS startTime, 0 AS endTime, route.rut_estm_time, \r\n\t\t\t\t\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraTravelDistance\r\n\t\t\t\t\t\tFROM   route\r\n\t\t\t\t\t\tINNER JOIN route routeTo ON routeTo.rut_to_city_id=route.rut_from_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_from_city_id=30804 AND routeTo.rut_active=1\r\n\t\t\t\t\t\t\t\tAND routeTo.rut_estm_distance<70 AND route.rut_active=1\r\n\t\t\t\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_from_city_id=route.rut_to_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_active = 1\r\n\t\t\t\t\t\t\t\tAND routeFrom.rut_estm_distance<70 AND route.rut_active = 1\r\n\t\t\t\t\t\tINNER JOIN route routeAlias ON routeAlias.rut_to_city_id=routeFrom.rut_to_city_id\r\n\t\t\t\t\t\t\tAND routeAlias.rut_from_city_id=routeTo.rut_from_city_id AND routeAlias.rut_active = 1"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24057.02] [M: 27062.63] [ET: 2.264/24031.026] [MU: 2.41/27062.01] 
	SQL: SELECT *, (rte_vendor_amount + extradistance * 10.55 ) AS totalCost, 
						ABS(quotedDistance-rateDistance) AS extraChargeableDistance
					FROM getNearestRoute_30804_30711_70 a
					INNER JOIN rate ON a.rut_id=rate.rte_route_id AND rte_status=1 
						AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <> 0
					WHERE  1
					ORDER  BY rank DESC, extraStartDistance, extraChargeableDistance ASC, totalcost ASC
					LIMIT  0, 1 
	 [params: {"cabType":"82"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24060.913] [M: 27077.72] [ET: 0.52/24034.944] [MU: 3.42/27076.84] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24061.979] [M: 27087.96] [ET: 22.421/24036.018] [MU: 114.1/27087.8] 
	Quote::calculateOneWay  for CAB 82 Date: 2024-10-31 18:00:00
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24062.465] [M: 27091.46] [ET: 0.38/24036.479] [MU: 0.89/27091.21] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24063.908] [M: 27104.17] [ET: 0.662/24037.921] [MU: 3.34/27103.73] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24064.572] [M: 27133.34] [ET: 0.513/24038.597] [MU: 22.53/27132.59] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp388)) OR (apr_area_type = 5 AND apr_area_id IN (:gp386)) OR (apr_area_type = 2 AND apr_area_id IN (:gp389)) OR (apr_area_type = 4 AND apr_area_id IN (:gp390)) OR (apr_area_type = 1 AND apr_area_id IN (:gp387))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp386":"3699",":gp387":"31",":gp388":"30804",":gp389":"105",":gp390":"1","cab":"82"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24066.371] [M: 27120.36] [ET: 0.614/24040.388] [MU: 3.33/27119.92] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24068.833] [M: 27130.91] [ET: 2.29/24042.837] [MU: 3.53/27130.03] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp393)) OR (scr_area_type = 5 AND scr_area_id IN (:gp391)) OR (scr_area_type = 2 AND scr_area_id IN (:gp394)) OR (scr_area_type = 4 AND scr_area_id IN (:gp395)) OR (scr_area_type = 1 AND scr_area_id IN (:gp392)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp391":"3699",":gp392":"31",":gp393":"3699",":gp394":"105",":gp395":"1","scv_id":"82"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24069.623] [M: 27132.08] [ET: 0.381/24043.645] [MU: 2.98/27131.97] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24071.229] [M: 27142.28] [ET: 0.548/24045.252] [MU: 2.79/27141.66] 
	SQL: SELECT 
						fc.cty_id as c2id, 
						fc.cty_name as c2name, 
						fc.cty_garage_address as c2address,
						tc.cty_id as c4id,
						tc.cty_name as c4name, tc.cty_garage_address as c4address,
						0 as totalExtraDistance FROM route
						INNER JOIN cities fc ON rut_from_city_id=fc.cty_id
						INNER JOIN cities tc ON rut_to_city_id=tc.cty_id
						INNER JOIN rate on  rate.rte_route_id=route.rut_id  AND rate.rte_vehicletype_id IN (3)
						WHERE route.rut_from_city_id=30804 AND route.rut_to_city_id=30711 AND route.rut_active=1 
	 [params: []]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24071.763] [M: 27156.16] [ET: 0.45/24045.789] [MU: 6.53/27154.16] 
	SQL: 
				SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address, tc.cty_id as c4id, 
				tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
					FROM
					 (
						(
							SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id,  
								r3.rut_to_city_id, route.rut_name , route.rut_id,
								(route.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, 
								r3.rut_estm_distance
							FROM route
							INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_from_city_id=30804  
									AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=route.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) 
									AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
						UNION
						(
							SELECT r3.rut_id, r3.rut_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,(route.rut_estm_distance + r1.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
							FROM route
							INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND  route.rut_to_city_id=30711 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND route.rut_to_city_id=r3.rut_to_city_id))	AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
                     ) a
					INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
					INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1 
	 [params: []]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24072.247] [M: 27166.67] [ET: 0.405/24046.274] [MU: 5.03/27165.17] 
	SQL: SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
                              tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
                        FROM (SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,
                                    (route.rut_estm_distance + r1.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
                                FROM route
								INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
								INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
								INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) AND r3.rut_active=1 
								INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3) LIMIT 1
							)a
                        INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
                        INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1
                         
	 [params: []]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24072.757] [M: 27173.05] [ET: 0.42/24046.772] [MU: 0.74/27172.17] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"GarageRoute_30804_30711","sql":" (INDEX GarageRoute_30804_30711_index_rut_id (rut_id), INDEX GarageRoute_30804_30711_index_rut_from_city_id (rut_from_city_id), INDEX GarageRoute_30804_30711_index_rut_to_city_id (rut_to_city_id))\r\n\t\t\t\t\t\t\tSELECT route.rut_id, route.rut_from_city_id, route.rut_to_city_id, route.rut_name, rut_estm_distance FROM route \r\n\t\t\t\t\t\t\tINNER JOIN cities_stats   ON cities_stats.cts_cty_id = route.rut_from_city_id\r\n\t\t\t\t\t\t\tAND rut_estm_distance < 300\r\n\t\t\t\t\t\t\tAND rut_active = 1\r\n\t\t\t\t\t\t\tAND route.rut_to_city_id=30804\r\n\t\t\t\t\t\t\tAND cities_stats.cts_vnd_cnt >= 3\r\n\t\t\t\t\t\t\tORDER BY rut_estm_distance LIMIT 10"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24073.47] [M: 27184.97] [ET: 0.601/24047.482] [MU: 6.69/27183.22] 
	SQL: SELECT a.*, fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
								tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address 
						FROM ((SELECT xyz.rut_from_city_id as startCity, r1.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r3.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_from_city_id
							INNER JOIN rate ON rate.rte_route_id=r1.rut_id  AND rate.rte_vehicletype_id IN (3)
							INNER JOIN route r2 ON r2.rut_to_city_id=r1.rut_to_city_id AND r2.rut_from_city_id=:dropCity AND r2.rut_active=1
							INNER JOIN route r3 ON r3.rut_from_city_id=xyz.rut_to_city_id AND r3.rut_to_city_id=r2.rut_from_city_id AND r3.rut_active=1
							ORDER BY ExtraDistance LIMIT 1
							)
							UNION
							(
							SELECT xyz.rut_from_city_id as startCity, r2.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r2.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_to_city_id AND r1.rut_to_city_id=:dropCity
							INNER JOIN route r2 ON r2.rut_to_city_id=xyz.rut_from_city_id AND r2.rut_from_city_id=r1.rut_to_city_id
							ORDER BY ExtraDistance ASC LIMIT 1
							)) a
						INNER JOIN cities fc ON startCity=fc.cty_id
						INNER JOIN cities tc ON endCity=tc.cty_id 
						ORDER BY ExtraDistance 
	 [params: {"pickupCity":"30804","dropCity":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24076.692] [M: 27196.31] [ET: 1.593/24050.72] [MU: 7.89/27196.2] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24077.751] [M: 27201.79] [ET: 0.957/24051.785] [MU: 8.26/27201.68] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24078.556] [M: 27209.41] [ET: 0.291/24052.588] [MU: 0.99/27209.04] 
	SQL: SELECT cts_airport_pickup_entry_fee
               FROM   cities
               INNER JOIN cities_stats
               ON cities.cty_id = cities_stats.cts_cty_id
               WHERE  cty_id = :cityId
               AND cty_is_airport = 1 AND cty_active = 1 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24080.105] [M: 27223.33] [ET: 0.955/24054.139] [MU: 8.13/27223.22] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24080.995] [M: 27231.16] [ET: 0.789/24055.03] [MU: 8.08/27231.05] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24081.404] [M: 27230.5] [ET: 0.321/24055.432] [MU: 0.9/27230.25] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24082.558] [M: 27243.21] [ET: 0.571/24056.588] [MU: 3.34/27242.77] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24083.29] [M: 27272.38] [ET: 0.617/24057.314] [MU: 22.54/27271.63] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp398)) OR (apr_area_type = 5 AND apr_area_id IN (:gp396)) OR (apr_area_type = 2 AND apr_area_id IN (:gp399)) OR (apr_area_type = 4 AND apr_area_id IN (:gp400)) OR (apr_area_type = 1 AND apr_area_id IN (:gp397))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp396":"3699",":gp397":"31",":gp398":"30804",":gp399":"105",":gp400":"1","cab":"82"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24084.846] [M: 27259.4] [ET: 0.583/24058.873] [MU: 3.33/27258.96] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24087.499] [M: 27269.95] [ET: 2.492/24061.504] [MU: 3.53/27269.07] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp403)) OR (scr_area_type = 5 AND scr_area_id IN (:gp401)) OR (scr_area_type = 2 AND scr_area_id IN (:gp404)) OR (scr_area_type = 4 AND scr_area_id IN (:gp405)) OR (scr_area_type = 1 AND scr_area_id IN (:gp402)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp401":"3699",":gp402":"31",":gp403":"3699",":gp404":"105",":gp405":"1","scv_id":"82"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24088.346] [M: 27273.16] [ET: 0.353/24062.368] [MU: 2.98/27273.05] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24090.128] [M: 27286.27] [ET: 0.265/24064.163] [MU: 2.98/27286.16] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24090.513] [M: 27290.44] [ET: 0.294/24064.527] [MU: 2.98/27290.33] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24095.466] [M: 27324.49] [ET: 0.545/24069.492] [MU: 6.28/27322.49] 
	SQL: 
                SELECT cities.cty_id as c2id, cities.cty_name as c2name, cities.cty_garage_address as c2address,
                    cities.cty_id as c4id, cities.cty_name as c4name, cities.cty_garage_address as c4address,
                        (distance * 2) as totalExtraDistance
                 FROM (SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<40
                     INNER JOIN route r1 ON route.rut_to_city_id=r1.rut_from_city_id AND r1.rut_active=1
                     INNER JOIN rate ON r1.rut_id=rate.rte_route_id AND rate.rte_status=1  AND rate.rte_vehicletype_id IN (3) GROUP BY route.rut_id HAVING count(*) >30
                   UNION
                     SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<600
                     INNER JOIN cities tc ON tc.cty_id=route.rut_to_city_id AND tc.cty_service_active=1 AND CalcDistance(cities.cty_lat, cities.cty_long, tc.cty_lat, tc.cty_long)<=route.rut_estm_distance						 
                     INNER JOIN cities_stats ON cities_stats.cts_cty_id = route.rut_to_city_id AND cities_stats.cts_vnd_cnt >= 2
                   UNION
                    SELECT cts_cty_id AS city, 0 AS distance
					FROM cities_stats WHERE 1 AND cities_stats.cts_cty_id= 30817 and cities_stats.cts_vnd_cnt>1) a
                    INNER JOIN cities ON cities.cty_id=a.city
                    ORDER BY totalExtraDistance LIMIT 1 
	 [params: []]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24098.297] [M: 27339.3] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"3","tripDistance":"","tripDuration":"","multiCityData":"","bookingType":"1","pickupAddress":"","pickupDate":"31\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","sccId":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=3&tripDistance=&tripDuration=&multiCityData=&bookingType=1&pickupAddress=&pickupDate=31%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&sccId=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24098.702] [M: 27356.15] [ET: 0.839/24072.741] [MU: 18.05/27356.04] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24098.733] [M: 27357.83] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24099.829] [M: 27371.29] [ET: 0.974/24073.852] [MU: 2.99/27368.79] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+10013),(IF((cpm_value_type=2),(10013+(10013*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30937 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30937) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-31 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=82 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24101.537] [M: 27413.52] [ET: 3.756/24075.556] [MU: 75.87/27413.36] 
	RouteRates::calculate for CAB 82 2024-10-31 18:00:00 - Trip Type: 1 918022478
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24101.77] [M: 27391.2] [ET: 39.721/24075.793] [MU: 301.78/27391.05] 
	Quote::calculateRules for CAB 82, From City Id: 30804, To city Id: 30711
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24102.112] [M: 27362.91] [ET: 0.239/24076.149] [MU: 0.9/27362.66] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"82"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24102.184] [M: 27364.48] [ET: 67.566/24076.225] [MU: 438/27364.38] 
	Quote For CabType: 82
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24103.313] [M: 27374.82] [ET: 0.366/24077.346] [MU: 3.34/27374.38] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24103.714] [M: 27380.63] [ET: 0.334/24077.751] [MU: 3.34/27380.2] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24104.272] [M: 27383.57] [ET: 0.477/24078.288] [MU: 0.9/27383.32] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24104.955] [M: 27415.93] [ET: 0.528/24078.969] [MU: 24.22/27414.43] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (100) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30711) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp406)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp409,:gp410)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp407,:gp408)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp411,:gp412))
			OR (scr_area_type = 5 AND scr_area_id IN (3699))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (83)
		ORDER BY rank DESC
		 
	 [params: {":gp406":"31",":gp407":"30804",":gp408":"30711",":gp409":"105",":gp410":"100",":gp411":"1",":gp412":"1","tripType":"1"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24105.757] [M: 27396.11] [ET: 0.23/24079.779] [MU: 0.83/27395.92] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24106.175] [M: 27398.98] [ET: 0.326/24080.21] [MU: 0.96/27398.67] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"1"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24107.446] [M: 27411.75] [ET: 0.417/24081.479] [MU: 2.04/27411.25] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"83"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24110.556] [M: 27421.13] [ET: 2.882/24084.557] [MU: 3.53/27420.26] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"83","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24111.482] [M: 27424.38] [ET: 0.616/24085.51] [MU: 0.87/27424.16] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":0}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24112.212] [M: 27431.66] [ET: 0.552/24086.246] [MU: 2.97/27431.23] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24112.896] [M: 27459.84] [ET: 0.577/24086.929] [MU: 22.04/27459.21] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp414)) OR (apr_area_type = 2 AND apr_area_id IN (:gp415)) OR (apr_area_type = 4 AND apr_area_id IN (:gp416)) OR (apr_area_type = 1 AND apr_area_id IN (:gp413))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp413":"31",":gp414":"30804",":gp415":"105",":gp416":"1","cab":"83"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24113.883] [M: 27446.55] [ET: 0.446/24087.916] [MU: 3.34/27446.12] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24116.176] [M: 27456.84] [ET: 2.182/24090.198] [MU: 3.4/27455.96] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp418)) OR (scr_area_type = 2 AND scr_area_id IN (:gp419)) OR (scr_area_type = 4 AND scr_area_id IN (:gp420)) OR (scr_area_type = 1 AND scr_area_id IN (:gp417)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp417":"31",":gp418":"30804",":gp419":"105",":gp420":"1","scv_id":"83"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24119.063] [M: 27484.57] [ET: 2.003/24093.069] [MU: 0.74/27476.57] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"nearest_route_30804_30711","sql":"(INDEX indx_nearest_rt_rutid (rut_id)) \r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, routeFrom.rut_name as fromAlias, \r\n\t\t\t\tNULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, \r\n\t\t\t\t0 as rank, routeFrom.rut_estm_time as startTime, 0 as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 \r\n\t\t\t\tAND routeFrom.rut_from_city_id<>routeFrom.rut_to_city_id AND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\t\tAND (routeAlias.rut_to_city_id=route.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, NULL, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) \r\n\t\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\t0 AS extraStartDistance, 0, 0 as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND route.rut_from_city_id = 30804 AND route.rut_to_city_id=30711 \r\n\t\t\t\tAND routeTo.rut_from_city_id=30711\r\n\t\t\t\tAND route.rut_active = 1 AND routeTo.rut_active = 1 AND routeTo.rut_estm_distance < 50 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = route.rut_from_city_id) \r\n\t\t\t   AND (routeAlias.rut_to_city_id = routeTo.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, \r\n\t\t\t\trouteFrom.rut_name, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t+ IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) \r\n\t\t\t\tAS extraDistance, IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, 0, \r\n\t\t\t\trouteFrom.rut_estm_time as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 AND routeFrom.rut_from_city_id <> routeFrom.rut_to_city_id\r\n\t\t\t\t\tAND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND routeTo.rut_estm_distance < 50 \r\n\t\t\t\t\tAND routeTo.rut_from_city_id=30711 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\tAND (routeAlias.rut_to_city_id=routeTo.rut_to_city_id) AND routeAlias.rut_active = 1 AND routeAlias.rut_from_city_id=30804  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24121.419] [M: 27488.65] [ET: 2.262/24095.444] [MU: 2.16/27488.21] 
	SQL: SELECT *, (rte_vendor_amount + extraDistance * 10.55) as totalCost FROM (SELECT * FROM nearest_route_30804_30711) a
					INNER JOIN rate ON a.rut_id = rate.rte_route_id AND rte_status=1 AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <>0
					WHERE 1 ORDER BY rank DESC, totalCost ASC LIMIT 0,1 
	 [params: {"cabType":"83"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24122.212] [M: 27496.67] [ET: 0.669/24096.212] [MU: 0.74/27494.67] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"getNearestRoute_30804_30711_70","sql":"(INDEX getNearestRoute_30804_30711_70_index_rut_id (rut_id))\r\n\t\t\t\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id AS start, routeAlias.rut_to_city_id AS end,\r\n\t\t\t\t\t\t\t\trouteFrom.rut_name AS fromAlias, NULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance AS quotedDistance,\r\n\t\t\t\t\t\t\t\trouteAlias.rut_estm_distance AS rateDistance, \r\n\t\t\t\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance)\r\n\t\t\t\t\t\t\t\t\t - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance,\r\n\t\t\t\t\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance,\r\n\t\t\t\t\t\t\t\t0 AS rank, routeFrom.rut_estm_time AS startTime, 0 AS endTime, route.rut_estm_time, \r\n\t\t\t\t\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraTravelDistance\r\n\t\t\t\t\t\tFROM   route\r\n\t\t\t\t\t\tINNER JOIN route routeTo ON routeTo.rut_to_city_id=route.rut_from_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_from_city_id=30804 AND routeTo.rut_active=1\r\n\t\t\t\t\t\t\t\tAND routeTo.rut_estm_distance<70 AND route.rut_active=1\r\n\t\t\t\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_from_city_id=route.rut_to_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_active = 1\r\n\t\t\t\t\t\t\t\tAND routeFrom.rut_estm_distance<70 AND route.rut_active = 1\r\n\t\t\t\t\t\tINNER JOIN route routeAlias ON routeAlias.rut_to_city_id=routeFrom.rut_to_city_id\r\n\t\t\t\t\t\t\tAND routeAlias.rut_from_city_id=routeTo.rut_from_city_id AND routeAlias.rut_active = 1"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24124.721] [M: 27501.94] [ET: 2.38/24098.731] [MU: 2.42/27501.31] 
	SQL: SELECT *, (rte_vendor_amount + extradistance * 10.55 ) AS totalCost, 
						ABS(quotedDistance-rateDistance) AS extraChargeableDistance
					FROM getNearestRoute_30804_30711_70 a
					INNER JOIN rate ON a.rut_id=rate.rte_route_id AND rte_status=1 
						AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <> 0
					WHERE  1
					ORDER  BY rank DESC, extraStartDistance, extraChargeableDistance ASC, totalcost ASC
					LIMIT  0, 1 
	 [params: {"cabType":"83"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24128.271] [M: 27517.02] [ET: 0.498/24102.302] [MU: 3.41/27516.15] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24129.422] [M: 27527.27] [ET: 21.893/24103.443] [MU: 114.09/27527.11] 
	Quote::calculateOneWay  for CAB 83 Date: 2024-10-31 18:00:00
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24129.954] [M: 27530.86] [ET: 0.399/24103.987] [MU: 0.9/27530.61] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24130.997] [M: 27543.57] [ET: 0.495/24105.03] [MU: 3.34/27543.13] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24131.588] [M: 27572.74] [ET: 0.473/24105.601] [MU: 22.53/27571.99] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp423)) OR (apr_area_type = 5 AND apr_area_id IN (:gp421)) OR (apr_area_type = 2 AND apr_area_id IN (:gp424)) OR (apr_area_type = 4 AND apr_area_id IN (:gp425)) OR (apr_area_type = 1 AND apr_area_id IN (:gp422))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp421":"3699",":gp422":"31",":gp423":"30804",":gp424":"105",":gp425":"1","cab":"83"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24133.109] [M: 27559.76] [ET: 0.489/24107.143] [MU: 3.33/27559.32] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24135.431] [M: 27570.3] [ET: 2.208/24109.442] [MU: 3.53/27569.43] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp428)) OR (scr_area_type = 5 AND scr_area_id IN (:gp426)) OR (scr_area_type = 2 AND scr_area_id IN (:gp429)) OR (scr_area_type = 4 AND scr_area_id IN (:gp430)) OR (scr_area_type = 1 AND scr_area_id IN (:gp427)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp426":"3699",":gp427":"31",":gp428":"3699",":gp429":"105",":gp430":"1","scv_id":"83"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24136.137] [M: 27571.48] [ET: 0.386/24110.154] [MU: 2.98/27571.37] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24137.567] [M: 27581.68] [ET: 0.473/24111.6] [MU: 2.79/27581.05] 
	SQL: SELECT 
						fc.cty_id as c2id, 
						fc.cty_name as c2name, 
						fc.cty_garage_address as c2address,
						tc.cty_id as c4id,
						tc.cty_name as c4name, tc.cty_garage_address as c4address,
						0 as totalExtraDistance FROM route
						INNER JOIN cities fc ON rut_from_city_id=fc.cty_id
						INNER JOIN cities tc ON rut_to_city_id=tc.cty_id
						INNER JOIN rate on  rate.rte_route_id=route.rut_id  AND rate.rte_vehicletype_id IN (3)
						WHERE route.rut_from_city_id=30804 AND route.rut_to_city_id=30711 AND route.rut_active=1 
	 [params: []]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24138.001] [M: 27595.56] [ET: 0.354/24112.032] [MU: 6.54/27593.56] 
	SQL: 
				SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address, tc.cty_id as c4id, 
				tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
					FROM
					 (
						(
							SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id,  
								r3.rut_to_city_id, route.rut_name , route.rut_id,
								(route.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, 
								r3.rut_estm_distance
							FROM route
							INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_from_city_id=30804  
									AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=route.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) 
									AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
						UNION
						(
							SELECT r3.rut_id, r3.rut_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,(route.rut_estm_distance + r1.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
							FROM route
							INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND  route.rut_to_city_id=30711 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND route.rut_to_city_id=r3.rut_to_city_id))	AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
                     ) a
					INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
					INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1 
	 [params: []]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24138.407] [M: 27606.07] [ET: 0.335/24112.437] [MU: 5.03/27604.57] 
	SQL: SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
                              tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
                        FROM (SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,
                                    (route.rut_estm_distance + r1.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
                                FROM route
								INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
								INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
								INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) AND r3.rut_active=1 
								INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3) LIMIT 1
							)a
                        INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
                        INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1
                         
	 [params: []]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24138.95] [M: 27612.45] [ET: 0.462/24112.974] [MU: 0.74/27611.57] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"GarageRoute_30804_30711","sql":" (INDEX GarageRoute_30804_30711_index_rut_id (rut_id), INDEX GarageRoute_30804_30711_index_rut_from_city_id (rut_from_city_id), INDEX GarageRoute_30804_30711_index_rut_to_city_id (rut_to_city_id))\r\n\t\t\t\t\t\t\tSELECT route.rut_id, route.rut_from_city_id, route.rut_to_city_id, route.rut_name, rut_estm_distance FROM route \r\n\t\t\t\t\t\t\tINNER JOIN cities_stats   ON cities_stats.cts_cty_id = route.rut_from_city_id\r\n\t\t\t\t\t\t\tAND rut_estm_distance < 300\r\n\t\t\t\t\t\t\tAND rut_active = 1\r\n\t\t\t\t\t\t\tAND route.rut_to_city_id=30804\r\n\t\t\t\t\t\t\tAND cities_stats.cts_vnd_cnt >= 3\r\n\t\t\t\t\t\t\tORDER BY rut_estm_distance LIMIT 10"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24139.561] [M: 27624.37] [ET: 0.506/24113.57] [MU: 6.69/27622.62] 
	SQL: SELECT a.*, fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
								tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address 
						FROM ((SELECT xyz.rut_from_city_id as startCity, r1.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r3.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_from_city_id
							INNER JOIN rate ON rate.rte_route_id=r1.rut_id  AND rate.rte_vehicletype_id IN (3)
							INNER JOIN route r2 ON r2.rut_to_city_id=r1.rut_to_city_id AND r2.rut_from_city_id=:dropCity AND r2.rut_active=1
							INNER JOIN route r3 ON r3.rut_from_city_id=xyz.rut_to_city_id AND r3.rut_to_city_id=r2.rut_from_city_id AND r3.rut_active=1
							ORDER BY ExtraDistance LIMIT 1
							)
							UNION
							(
							SELECT xyz.rut_from_city_id as startCity, r2.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r2.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_to_city_id AND r1.rut_to_city_id=:dropCity
							INNER JOIN route r2 ON r2.rut_to_city_id=xyz.rut_from_city_id AND r2.rut_from_city_id=r1.rut_to_city_id
							ORDER BY ExtraDistance ASC LIMIT 1
							)) a
						INNER JOIN cities fc ON startCity=fc.cty_id
						INNER JOIN cities tc ON endCity=tc.cty_id 
						ORDER BY ExtraDistance 
	 [params: {"pickupCity":"30804","dropCity":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24142.628] [M: 27635.71] [ET: 1.395/24116.64] [MU: 7.88/27635.6] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24143.808] [M: 27641.19] [ET: 1.05/24117.844] [MU: 8.26/27641.08] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24144.595] [M: 27648.72] [ET: 0.293/24118.63] [MU: 1/27648.34] 
	SQL: SELECT cts_airport_pickup_entry_fee
               FROM   cities
               INNER JOIN cities_stats
               ON cities.cty_id = cities_stats.cts_cty_id
               WHERE  cty_id = :cityId
               AND cty_is_airport = 1 AND cty_active = 1 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24146.084] [M: 27662.63] [ET: 0.92/24120.121] [MU: 8.14/27662.52] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24146.936] [M: 27670.38] [ET: 0.76/24120.974] [MU: 8.08/27670.27] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24147.335] [M: 27669.71] [ET: 0.323/24121.372] [MU: 0.89/27669.46] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24148.356] [M: 27682.42] [ET: 0.508/24122.39] [MU: 3.34/27681.98] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24149.084] [M: 27711.59] [ET: 0.623/24123.116] [MU: 22.53/27710.84] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp433)) OR (apr_area_type = 5 AND apr_area_id IN (:gp431)) OR (apr_area_type = 2 AND apr_area_id IN (:gp434)) OR (apr_area_type = 4 AND apr_area_id IN (:gp435)) OR (apr_area_type = 1 AND apr_area_id IN (:gp432))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp431":"3699",":gp432":"31",":gp433":"30804",":gp434":"105",":gp435":"1","cab":"83"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24150.513] [M: 27698.61] [ET: 0.496/24124.548] [MU: 3.33/27698.17] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24152.746] [M: 27709.16] [ET: 2.122/24126.767] [MU: 3.53/27708.28] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp438)) OR (scr_area_type = 5 AND scr_area_id IN (:gp436)) OR (scr_area_type = 2 AND scr_area_id IN (:gp439)) OR (scr_area_type = 4 AND scr_area_id IN (:gp440)) OR (scr_area_type = 1 AND scr_area_id IN (:gp437)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp436":"3699",":gp437":"31",":gp438":"3699",":gp439":"105",":gp440":"1","scv_id":"83"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24153.469] [M: 27712.37] [ET: 0.36/24127.49] [MU: 2.98/27712.26] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24155.154] [M: 27725.38] [ET: 0.374/24129.176] [MU: 2.98/27725.27] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24155.584] [M: 27729.55] [ET: 0.325/24129.608] [MU: 2.98/27729.45] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24160.213] [M: 27763.61] [ET: 0.794/24134.221] [MU: 6.28/27761.61] 
	SQL: 
                SELECT cities.cty_id as c2id, cities.cty_name as c2name, cities.cty_garage_address as c2address,
                    cities.cty_id as c4id, cities.cty_name as c4name, cities.cty_garage_address as c4address,
                        (distance * 2) as totalExtraDistance
                 FROM (SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<40
                     INNER JOIN route r1 ON route.rut_to_city_id=r1.rut_from_city_id AND r1.rut_active=1
                     INNER JOIN rate ON r1.rut_id=rate.rte_route_id AND rate.rte_status=1  AND rate.rte_vehicletype_id IN (3) GROUP BY route.rut_id HAVING count(*) >30
                   UNION
                     SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<600
                     INNER JOIN cities tc ON tc.cty_id=route.rut_to_city_id AND tc.cty_service_active=1 AND CalcDistance(cities.cty_lat, cities.cty_long, tc.cty_lat, tc.cty_long)<=route.rut_estm_distance						 
                     INNER JOIN cities_stats ON cities_stats.cts_cty_id = route.rut_to_city_id AND cities_stats.cts_vnd_cnt >= 2
                   UNION
                    SELECT cts_cty_id AS city, 0 AS distance
					FROM cities_stats WHERE 1 AND cities_stats.cts_cty_id= 30817 and cities_stats.cts_vnd_cnt>1) a
                    INNER JOIN cities ON cities.cty_id=a.city
                    ORDER BY totalExtraDistance LIMIT 1 
	 [params: []]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24163.447] [M: 27778.42] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"3","tripDistance":"","tripDuration":"","multiCityData":"","bookingType":"1","pickupAddress":"","pickupDate":"31\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","sccId":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=3&tripDistance=&tripDuration=&multiCityData=&bookingType=1&pickupAddress=&pickupDate=31%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&sccId=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24164.083] [M: 27795.27] [ET: 1.196/24138.106] [MU: 18.05/27795.16] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24164.133] [M: 27796.95] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24165.17] [M: 27810.41] [ET: 0.867/24139.189] [MU: 2.99/27807.91] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+10013),(IF((cpm_value_type=2),(10013+(10013*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30937 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30937) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-31 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=83 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24166.904] [M: 27852.63] [ET: 4.113/24140.939] [MU: 75.88/27852.48] 
	RouteRates::calculate for CAB 83 2024-10-31 18:00:00 - Trip Type: 1 870124444
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24167.067] [M: 27830.32] [ET: 37.563/24141.108] [MU: 301.5/27830.16] 
	Quote::calculateRules for CAB 83, From City Id: 30804, To city Id: 30711
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24167.344] [M: 27802.03] [ET: 0.19/24141.365] [MU: 0.89/27801.78] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"83"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24167.454] [M: 27803.59] [ET: 65.207/24141.478] [MU: 437.81/27803.5] 
	Quote For CabType: 83
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24168.881] [M: 27813.94] [ET: 0.453/24142.899] [MU: 3.33/27813.5] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24169.404] [M: 27819.75] [ET: 0.42/24143.425] [MU: 3.34/27819.31] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24169.977] [M: 27822.69] [ET: 0.481/24144.012] [MU: 0.9/27822.44] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24170.554] [M: 27855.05] [ET: 0.452/24144.568] [MU: 24.22/27853.55] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (100) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30711) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp441)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp444,:gp445)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp442,:gp443)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp446,:gp447))
			OR (scr_area_type = 5 AND scr_area_id IN (3699))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (84)
		ORDER BY rank DESC
		 
	 [params: {":gp441":"31",":gp442":"30804",":gp443":"30711",":gp444":"105",":gp445":"100",":gp446":"1",":gp447":"1","tripType":"1"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24171.397] [M: 27835.23] [ET: 0.242/24145.417] [MU: 0.83/27835.04] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24171.779] [M: 27838.1] [ET: 0.275/24145.8] [MU: 0.96/27837.79] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"1"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24173.21] [M: 27850.87] [ET: 0.437/24147.245] [MU: 2.05/27850.37] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"84"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24176.52] [M: 27860.25] [ET: 3.093/24150.523] [MU: 3.53/27859.38] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"84","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24177.295] [M: 27863.5] [ET: 0.482/24151.326] [MU: 0.86/27863.28] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":0}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24177.955] [M: 27870.78] [ET: 0.492/24151.988] [MU: 2.97/27870.34] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24178.733] [M: 27898.95] [ET: 0.675/24152.766] [MU: 22.05/27898.33] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp449)) OR (apr_area_type = 2 AND apr_area_id IN (:gp450)) OR (apr_area_type = 4 AND apr_area_id IN (:gp451)) OR (apr_area_type = 1 AND apr_area_id IN (:gp448))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp448":"31",":gp449":"30804",":gp450":"105",":gp451":"1","cab":"84"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24179.992] [M: 27885.67] [ET: 0.629/24154.011] [MU: 3.34/27885.23] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24182.532] [M: 27895.95] [ET: 2.368/24156.539] [MU: 3.41/27895.08] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp453)) OR (scr_area_type = 2 AND scr_area_id IN (:gp454)) OR (scr_area_type = 4 AND scr_area_id IN (:gp455)) OR (scr_area_type = 1 AND scr_area_id IN (:gp452)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp452":"31",":gp453":"30804",":gp454":"105",":gp455":"1","scv_id":"84"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24185.339] [M: 27923.69] [ET: 1.972/24159.339] [MU: 0.74/27915.69] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"nearest_route_30804_30711","sql":"(INDEX indx_nearest_rt_rutid (rut_id)) \r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, routeFrom.rut_name as fromAlias, \r\n\t\t\t\tNULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, \r\n\t\t\t\t0 as rank, routeFrom.rut_estm_time as startTime, 0 as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 \r\n\t\t\t\tAND routeFrom.rut_from_city_id<>routeFrom.rut_to_city_id AND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\t\tAND (routeAlias.rut_to_city_id=route.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, NULL, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) \r\n\t\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\t0 AS extraStartDistance, 0, 0 as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND route.rut_from_city_id = 30804 AND route.rut_to_city_id=30711 \r\n\t\t\t\tAND routeTo.rut_from_city_id=30711\r\n\t\t\t\tAND route.rut_active = 1 AND routeTo.rut_active = 1 AND routeTo.rut_estm_distance < 50 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = route.rut_from_city_id) \r\n\t\t\t   AND (routeAlias.rut_to_city_id = routeTo.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, \r\n\t\t\t\trouteFrom.rut_name, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t+ IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) \r\n\t\t\t\tAS extraDistance, IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, 0, \r\n\t\t\t\trouteFrom.rut_estm_time as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 AND routeFrom.rut_from_city_id <> routeFrom.rut_to_city_id\r\n\t\t\t\t\tAND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND routeTo.rut_estm_distance < 50 \r\n\t\t\t\t\tAND routeTo.rut_from_city_id=30711 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\tAND (routeAlias.rut_to_city_id=routeTo.rut_to_city_id) AND routeAlias.rut_active = 1 AND routeAlias.rut_from_city_id=30804  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24187.906] [M: 27927.77] [ET: 2.461/24161.929] [MU: 2.16/27927.33] 
	SQL: SELECT *, (rte_vendor_amount + extraDistance * 10.55) as totalCost FROM (SELECT * FROM nearest_route_30804_30711) a
					INNER JOIN rate ON a.rut_id = rate.rte_route_id AND rte_status=1 AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <>0
					WHERE 1 ORDER BY rank DESC, totalCost ASC LIMIT 0,1 
	 [params: {"cabType":"84"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24188.667] [M: 27935.79] [ET: 0.639/24162.68] [MU: 0.74/27933.79] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"getNearestRoute_30804_30711_70","sql":"(INDEX getNearestRoute_30804_30711_70_index_rut_id (rut_id))\r\n\t\t\t\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id AS start, routeAlias.rut_to_city_id AS end,\r\n\t\t\t\t\t\t\t\trouteFrom.rut_name AS fromAlias, NULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance AS quotedDistance,\r\n\t\t\t\t\t\t\t\trouteAlias.rut_estm_distance AS rateDistance, \r\n\t\t\t\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance)\r\n\t\t\t\t\t\t\t\t\t - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance,\r\n\t\t\t\t\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance,\r\n\t\t\t\t\t\t\t\t0 AS rank, routeFrom.rut_estm_time AS startTime, 0 AS endTime, route.rut_estm_time, \r\n\t\t\t\t\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraTravelDistance\r\n\t\t\t\t\t\tFROM   route\r\n\t\t\t\t\t\tINNER JOIN route routeTo ON routeTo.rut_to_city_id=route.rut_from_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_from_city_id=30804 AND routeTo.rut_active=1\r\n\t\t\t\t\t\t\t\tAND routeTo.rut_estm_distance<70 AND route.rut_active=1\r\n\t\t\t\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_from_city_id=route.rut_to_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_active = 1\r\n\t\t\t\t\t\t\t\tAND routeFrom.rut_estm_distance<70 AND route.rut_active = 1\r\n\t\t\t\t\t\tINNER JOIN route routeAlias ON routeAlias.rut_to_city_id=routeFrom.rut_to_city_id\r\n\t\t\t\t\t\t\tAND routeAlias.rut_from_city_id=routeTo.rut_from_city_id AND routeAlias.rut_active = 1"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24191.096] [M: 27941.05] [ET: 2.321/24165.103] [MU: 2.41/27940.43] 
	SQL: SELECT *, (rte_vendor_amount + extradistance * 10.55 ) AS totalCost, 
						ABS(quotedDistance-rateDistance) AS extraChargeableDistance
					FROM getNearestRoute_30804_30711_70 a
					INNER JOIN rate ON a.rut_id=rate.rte_route_id AND rte_status=1 
						AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <> 0
					WHERE  1
					ORDER  BY rank DESC, extraStartDistance, extraChargeableDistance ASC, totalcost ASC
					LIMIT  0, 1 
	 [params: {"cabType":"84"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24194.776] [M: 27956.14] [ET: 0.627/24168.79] [MU: 3.42/27955.27] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24196.134] [M: 27966.38] [ET: 22.851/24170.165] [MU: 114.09/27966.23] 
	Quote::calculateOneWay  for CAB 84 Date: 2024-10-31 18:00:00
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24196.703] [M: 27969.98] [ET: 0.456/24170.731] [MU: 0.9/27969.73] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24197.947] [M: 27982.69] [ET: 0.593/24171.971] [MU: 3.33/27982.25] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24198.714] [M: 28011.86] [ET: 0.641/24172.739] [MU: 22.53/28011.11] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp458)) OR (apr_area_type = 5 AND apr_area_id IN (:gp456)) OR (apr_area_type = 2 AND apr_area_id IN (:gp459)) OR (apr_area_type = 4 AND apr_area_id IN (:gp460)) OR (apr_area_type = 1 AND apr_area_id IN (:gp457))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp456":"3699",":gp457":"31",":gp458":"30804",":gp459":"105",":gp460":"1","cab":"84"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24200.325] [M: 27998.88] [ET: 0.552/24174.352] [MU: 3.34/27998.44] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24203.048] [M: 28009.42] [ET: 2.578/24177.049] [MU: 3.53/28008.55] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp463)) OR (scr_area_type = 5 AND scr_area_id IN (:gp461)) OR (scr_area_type = 2 AND scr_area_id IN (:gp464)) OR (scr_area_type = 4 AND scr_area_id IN (:gp465)) OR (scr_area_type = 1 AND scr_area_id IN (:gp462)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp461":"3699",":gp462":"31",":gp463":"3699",":gp464":"105",":gp465":"1","scv_id":"84"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24203.854] [M: 28014.59] [ET: 0.378/24177.873] [MU: 2.98/28014.48] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24205.648] [M: 28024.8] [ET: 0.68/24179.669] [MU: 2.78/28024.17] 
	SQL: SELECT 
						fc.cty_id as c2id, 
						fc.cty_name as c2name, 
						fc.cty_garage_address as c2address,
						tc.cty_id as c4id,
						tc.cty_name as c4name, tc.cty_garage_address as c4address,
						0 as totalExtraDistance FROM route
						INNER JOIN cities fc ON rut_from_city_id=fc.cty_id
						INNER JOIN cities tc ON rut_to_city_id=tc.cty_id
						INNER JOIN rate on  rate.rte_route_id=route.rut_id  AND rate.rte_vehicletype_id IN (3)
						WHERE route.rut_from_city_id=30804 AND route.rut_to_city_id=30711 AND route.rut_active=1 
	 [params: []]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24206.219] [M: 28038.68] [ET: 0.474/24180.238] [MU: 6.53/28036.68] 
	SQL: 
				SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address, tc.cty_id as c4id, 
				tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
					FROM
					 (
						(
							SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id,  
								r3.rut_to_city_id, route.rut_name , route.rut_id,
								(route.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, 
								r3.rut_estm_distance
							FROM route
							INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_from_city_id=30804  
									AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=route.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) 
									AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
						UNION
						(
							SELECT r3.rut_id, r3.rut_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,(route.rut_estm_distance + r1.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
							FROM route
							INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND  route.rut_to_city_id=30711 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND route.rut_to_city_id=r3.rut_to_city_id))	AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
                     ) a
					INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
					INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1 
	 [params: []]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24206.736] [M: 28049.19] [ET: 0.429/24180.76] [MU: 5.03/28047.69] 
	SQL: SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
                              tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
                        FROM (SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,
                                    (route.rut_estm_distance + r1.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
                                FROM route
								INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
								INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
								INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) AND r3.rut_active=1 
								INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3) LIMIT 1
							)a
                        INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
                        INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1
                         
	 [params: []]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24207.296] [M: 28055.56] [ET: 0.46/24181.309] [MU: 0.74/28054.69] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"GarageRoute_30804_30711","sql":" (INDEX GarageRoute_30804_30711_index_rut_id (rut_id), INDEX GarageRoute_30804_30711_index_rut_from_city_id (rut_from_city_id), INDEX GarageRoute_30804_30711_index_rut_to_city_id (rut_to_city_id))\r\n\t\t\t\t\t\t\tSELECT route.rut_id, route.rut_from_city_id, route.rut_to_city_id, route.rut_name, rut_estm_distance FROM route \r\n\t\t\t\t\t\t\tINNER JOIN cities_stats   ON cities_stats.cts_cty_id = route.rut_from_city_id\r\n\t\t\t\t\t\t\tAND rut_estm_distance < 300\r\n\t\t\t\t\t\t\tAND rut_active = 1\r\n\t\t\t\t\t\t\tAND route.rut_to_city_id=30804\r\n\t\t\t\t\t\t\tAND cities_stats.cts_vnd_cnt >= 3\r\n\t\t\t\t\t\t\tORDER BY rut_estm_distance LIMIT 10"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24208.027] [M: 28067.48] [ET: 0.613/24182.039] [MU: 6.69/28065.73] 
	SQL: SELECT a.*, fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
								tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address 
						FROM ((SELECT xyz.rut_from_city_id as startCity, r1.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r3.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_from_city_id
							INNER JOIN rate ON rate.rte_route_id=r1.rut_id  AND rate.rte_vehicletype_id IN (3)
							INNER JOIN route r2 ON r2.rut_to_city_id=r1.rut_to_city_id AND r2.rut_from_city_id=:dropCity AND r2.rut_active=1
							INNER JOIN route r3 ON r3.rut_from_city_id=xyz.rut_to_city_id AND r3.rut_to_city_id=r2.rut_from_city_id AND r3.rut_active=1
							ORDER BY ExtraDistance LIMIT 1
							)
							UNION
							(
							SELECT xyz.rut_from_city_id as startCity, r2.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r2.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_to_city_id AND r1.rut_to_city_id=:dropCity
							INNER JOIN route r2 ON r2.rut_to_city_id=xyz.rut_from_city_id AND r2.rut_from_city_id=r1.rut_to_city_id
							ORDER BY ExtraDistance ASC LIMIT 1
							)) a
						INNER JOIN cities fc ON startCity=fc.cty_id
						INNER JOIN cities tc ON endCity=tc.cty_id 
						ORDER BY ExtraDistance 
	 [params: {"pickupCity":"30804","dropCity":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24211.784] [M: 28078.83] [ET: 1.705/24185.787] [MU: 7.88/28078.72] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24212.966] [M: 28084.4] [ET: 1.033/24186.992] [MU: 8.26/28084.29] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24213.921] [M: 28091.93] [ET: 0.363/24187.947] [MU: 0.99/28091.55] 
	SQL: SELECT cts_airport_pickup_entry_fee
               FROM   cities
               INNER JOIN cities_stats
               ON cities.cty_id = cities_stats.cts_cty_id
               WHERE  cty_id = :cityId
               AND cty_is_airport = 1 AND cty_active = 1 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24215.988] [M: 28105.84] [ET: 1.259/24190.006] [MU: 8.14/28105.73] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24217.249] [M: 28113.68] [ET: 1.12/24191.276] [MU: 8.08/28113.57] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24217.727] [M: 28113.02] [ET: 0.371/24191.744] [MU: 0.9/28112.77] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24219.213] [M: 28125.73] [ET: 0.708/24193.228] [MU: 3.33/28125.29] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24219.94] [M: 28154.9] [ET: 0.577/24193.964] [MU: 22.53/28154.15] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp468)) OR (apr_area_type = 5 AND apr_area_id IN (:gp466)) OR (apr_area_type = 2 AND apr_area_id IN (:gp469)) OR (apr_area_type = 4 AND apr_area_id IN (:gp470)) OR (apr_area_type = 1 AND apr_area_id IN (:gp467))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp466":"3699",":gp467":"31",":gp468":"30804",":gp469":"105",":gp470":"1","cab":"84"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24221.754] [M: 28141.91] [ET: 0.624/24195.772] [MU: 3.34/28141.48] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24224.464] [M: 28152.46] [ET: 2.521/24198.447] [MU: 3.53/28151.59] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp473)) OR (scr_area_type = 5 AND scr_area_id IN (:gp471)) OR (scr_area_type = 2 AND scr_area_id IN (:gp474)) OR (scr_area_type = 4 AND scr_area_id IN (:gp475)) OR (scr_area_type = 1 AND scr_area_id IN (:gp472)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp471":"3699",":gp472":"31",":gp473":"3699",":gp474":"105",":gp475":"1","scv_id":"84"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24225.689] [M: 28155.67] [ET: 0.576/24199.725] [MU: 2.98/28155.56] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24227.374] [M: 28168.78] [ET: 0.303/24201.402] [MU: 2.97/28168.67] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24227.675] [M: 28172.95] [ET: 0.23/24201.714] [MU: 2.98/28172.84] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24231.965] [M: 28206.91] [ET: 0.526/24205.991] [MU: 6.28/28204.91] 
	SQL: 
                SELECT cities.cty_id as c2id, cities.cty_name as c2name, cities.cty_garage_address as c2address,
                    cities.cty_id as c4id, cities.cty_name as c4name, cities.cty_garage_address as c4address,
                        (distance * 2) as totalExtraDistance
                 FROM (SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<40
                     INNER JOIN route r1 ON route.rut_to_city_id=r1.rut_from_city_id AND r1.rut_active=1
                     INNER JOIN rate ON r1.rut_id=rate.rte_route_id AND rate.rte_status=1  AND rate.rte_vehicletype_id IN (3) GROUP BY route.rut_id HAVING count(*) >30
                   UNION
                     SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<600
                     INNER JOIN cities tc ON tc.cty_id=route.rut_to_city_id AND tc.cty_service_active=1 AND CalcDistance(cities.cty_lat, cities.cty_long, tc.cty_lat, tc.cty_long)<=route.rut_estm_distance						 
                     INNER JOIN cities_stats ON cities_stats.cts_cty_id = route.rut_to_city_id AND cities_stats.cts_vnd_cnt >= 2
                   UNION
                    SELECT cts_cty_id AS city, 0 AS distance
					FROM cities_stats WHERE 1 AND cities_stats.cts_cty_id= 30817 and cities_stats.cts_vnd_cnt>1) a
                    INNER JOIN cities ON cities.cty_id=a.city
                    ORDER BY totalExtraDistance LIMIT 1 
	 [params: []]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24235.119] [M: 28221.73] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"3","tripDistance":"","tripDuration":"","multiCityData":"","bookingType":"1","pickupAddress":"","pickupDate":"31\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","sccId":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=3&tripDistance=&tripDuration=&multiCityData=&bookingType=1&pickupAddress=&pickupDate=31%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&sccId=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24235.761] [M: 28238.57] [ET: 1.185/24209.784] [MU: 18.04/28238.46] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24235.819] [M: 28240.25] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24236.922] [M: 28253.71] [ET: 0.924/24210.916] [MU: 2.99/28251.21] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+10013),(IF((cpm_value_type=2),(10013+(10013*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30937 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30937) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-31 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=84 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24238.711] [M: 28295.94] [ET: 4.224/24212.739] [MU: 75.87/28295.78] 
	RouteRates::calculate for CAB 84 2024-10-31 18:00:00 - Trip Type: 1 884309225
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24238.889] [M: 28273.63] [ET: 42.682/24212.922] [MU: 305.69/28273.47] 
	Quote::calculateRules for CAB 84, From City Id: 30804, To city Id: 30711
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24239.205] [M: 28245.34] [ET: 0.217/24213.225] [MU: 0.9/28245.09] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"84"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24239.316] [M: 28246.9] [ET: 71.782/24213.339] [MU: 442/28246.8] 
	Quote For CabType: 84
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24240.736] [M: 28257.24] [ET: 0.455/24214.768] [MU: 3.34/28256.8] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24241.165] [M: 28263.05] [ET: 0.358/24215.2] [MU: 3.34/28262.62] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24241.805] [M: 28265.99] [ET: 0.549/24215.808] [MU: 0.89/28265.74] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24242.983] [M: 28298.35] [ET: 0.901/24216.989] [MU: 24.21/28296.85] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (100) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30711) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp476)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp479,:gp480)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp477,:gp478)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp481,:gp482))
			OR (scr_area_type = 5 AND scr_area_id IN (3699))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (93)
		ORDER BY rank DESC
		 
	 [params: {":gp476":"31",":gp477":"30804",":gp478":"30711",":gp479":"105",":gp480":"100",":gp481":"1",":gp482":"1","tripType":"1"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24243.714] [M: 28278.54] [ET: 0.21/24217.75] [MU: 0.83/28278.35] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24244.092] [M: 28281.41] [ET: 0.307/24218.131] [MU: 0.96/28281.1] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"2"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24245.245] [M: 28294.16] [ET: 0.363/24219.249] [MU: 2.05/28293.66] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"93"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24248.453] [M: 28303.55] [ET: 2.816/24222.439] [MU: 3.53/28302.67] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"93","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24249.372] [M: 28306.8] [ET: 0.559/24223.382] [MU: 0.87/28306.58] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":0}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24250.283] [M: 28314.08] [ET: 0.657/24224.299] [MU: 2.97/28313.64] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24251.011] [M: 28342.25] [ET: 0.576/24225.033] [MU: 22.05/28341.63] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp484)) OR (apr_area_type = 2 AND apr_area_id IN (:gp485)) OR (apr_area_type = 4 AND apr_area_id IN (:gp486)) OR (apr_area_type = 1 AND apr_area_id IN (:gp483))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp483":"31",":gp484":"30804",":gp485":"105",":gp486":"1","cab":"93"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24252.26] [M: 28328.98] [ET: 0.565/24226.277] [MU: 3.33/28328.54] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24254.624] [M: 28339.26] [ET: 2.212/24228.639] [MU: 3.41/28338.38] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp488)) OR (scr_area_type = 2 AND scr_area_id IN (:gp489)) OR (scr_area_type = 4 AND scr_area_id IN (:gp490)) OR (scr_area_type = 1 AND scr_area_id IN (:gp487)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp487":"31",":gp488":"30804",":gp489":"105",":gp490":"1","scv_id":"93"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24257.745] [M: 28366.98] [ET: 2.142/24231.752] [MU: 0.75/28358.98] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"nearest_route_30804_30711","sql":"(INDEX indx_nearest_rt_rutid (rut_id)) \r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, routeFrom.rut_name as fromAlias, \r\n\t\t\t\tNULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, \r\n\t\t\t\t0 as rank, routeFrom.rut_estm_time as startTime, 0 as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 \r\n\t\t\t\tAND routeFrom.rut_from_city_id<>routeFrom.rut_to_city_id AND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\t\tAND (routeAlias.rut_to_city_id=route.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, NULL, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) \r\n\t\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\t0 AS extraStartDistance, 0, 0 as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND route.rut_from_city_id = 30804 AND route.rut_to_city_id=30711 \r\n\t\t\t\tAND routeTo.rut_from_city_id=30711\r\n\t\t\t\tAND route.rut_active = 1 AND routeTo.rut_active = 1 AND routeTo.rut_estm_distance < 50 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = route.rut_from_city_id) \r\n\t\t\t   AND (routeAlias.rut_to_city_id = routeTo.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, \r\n\t\t\t\trouteFrom.rut_name, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t+ IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) \r\n\t\t\t\tAS extraDistance, IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, 0, \r\n\t\t\t\trouteFrom.rut_estm_time as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 AND routeFrom.rut_from_city_id <> routeFrom.rut_to_city_id\r\n\t\t\t\t\tAND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND routeTo.rut_estm_distance < 50 \r\n\t\t\t\t\tAND routeTo.rut_from_city_id=30711 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\tAND (routeAlias.rut_to_city_id=routeTo.rut_to_city_id) AND routeAlias.rut_active = 1 AND routeAlias.rut_from_city_id=30804  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24262.976] [M: 28371.06] [ET: 5.114/24236.975] [MU: 2.17/28370.63] 
	SQL: SELECT *, (rte_vendor_amount + extraDistance * 10.55) as totalCost FROM (SELECT * FROM nearest_route_30804_30711) a
					INNER JOIN rate ON a.rut_id = rate.rte_route_id AND rte_status=1 AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <>0
					WHERE 1 ORDER BY rank DESC, totalCost ASC LIMIT 0,1 
	 [params: {"cabType":"93"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24263.855] [M: 28379.09] [ET: 0.709/24237.876] [MU: 0.74/28377.09] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"getNearestRoute_30804_30711_70","sql":"(INDEX getNearestRoute_30804_30711_70_index_rut_id (rut_id))\r\n\t\t\t\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id AS start, routeAlias.rut_to_city_id AS end,\r\n\t\t\t\t\t\t\t\trouteFrom.rut_name AS fromAlias, NULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance AS quotedDistance,\r\n\t\t\t\t\t\t\t\trouteAlias.rut_estm_distance AS rateDistance, \r\n\t\t\t\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance)\r\n\t\t\t\t\t\t\t\t\t - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance,\r\n\t\t\t\t\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance,\r\n\t\t\t\t\t\t\t\t0 AS rank, routeFrom.rut_estm_time AS startTime, 0 AS endTime, route.rut_estm_time, \r\n\t\t\t\t\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraTravelDistance\r\n\t\t\t\t\t\tFROM   route\r\n\t\t\t\t\t\tINNER JOIN route routeTo ON routeTo.rut_to_city_id=route.rut_from_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_from_city_id=30804 AND routeTo.rut_active=1\r\n\t\t\t\t\t\t\t\tAND routeTo.rut_estm_distance<70 AND route.rut_active=1\r\n\t\t\t\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_from_city_id=route.rut_to_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_active = 1\r\n\t\t\t\t\t\t\t\tAND routeFrom.rut_estm_distance<70 AND route.rut_active = 1\r\n\t\t\t\t\t\tINNER JOIN route routeAlias ON routeAlias.rut_to_city_id=routeFrom.rut_to_city_id\r\n\t\t\t\t\t\t\tAND routeAlias.rut_from_city_id=routeTo.rut_from_city_id AND routeAlias.rut_active = 1"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24266.395] [M: 28384.35] [ET: 2.439/24240.403] [MU: 2.41/28383.73] 
	SQL: SELECT *, (rte_vendor_amount + extradistance * 10.55 ) AS totalCost, 
						ABS(quotedDistance-rateDistance) AS extraChargeableDistance
					FROM getNearestRoute_30804_30711_70 a
					INNER JOIN rate ON a.rut_id=rate.rte_route_id AND rte_status=1 
						AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <> 0
					WHERE  1
					ORDER  BY rank DESC, extraStartDistance, extraChargeableDistance ASC, totalcost ASC
					LIMIT  0, 1 
	 [params: {"cabType":"93"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24269.393] [M: 28399.45] [ET: 0.496/24243.424] [MU: 3.41/28398.57] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"16","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24270.822] [M: 28416.06] [ET: 0.421/24244.845] [MU: 3.78/28415.19] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24272.089] [M: 28427.13] [ET: 26.72/24246.109] [MU: 131.57/28427] 
	Quote::calculateOneWay  for CAB 93 Date: 2024-10-31 18:00:00
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24272.648] [M: 28430.66] [ET: 0.427/24246.681] [MU: 0.9/28430.41] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24273.744] [M: 28443.37] [ET: 0.529/24247.77] [MU: 3.33/28442.93] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24274.456] [M: 28472.54] [ET: 0.606/24248.488] [MU: 22.53/28471.79] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp493)) OR (apr_area_type = 5 AND apr_area_id IN (:gp491)) OR (apr_area_type = 2 AND apr_area_id IN (:gp494)) OR (apr_area_type = 4 AND apr_area_id IN (:gp495)) OR (apr_area_type = 1 AND apr_area_id IN (:gp492))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp491":"3699",":gp492":"31",":gp493":"30804",":gp494":"105",":gp495":"1","cab":"93"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24276.584] [M: 28459.56] [ET: 0.615/24250.614] [MU: 3.34/28459.13] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24278.988] [M: 28470.11] [ET: 2.268/24253.01] [MU: 3.53/28469.23] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp498)) OR (scr_area_type = 5 AND scr_area_id IN (:gp496)) OR (scr_area_type = 2 AND scr_area_id IN (:gp499)) OR (scr_area_type = 4 AND scr_area_id IN (:gp500)) OR (scr_area_type = 1 AND scr_area_id IN (:gp497)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp496":"3699",":gp497":"31",":gp498":"3699",":gp499":"105",":gp500":"1","scv_id":"93"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24279.717] [M: 28471.27] [ET: 0.369/24253.755] [MU: 2.98/28471.16] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24281.143] [M: 28481.48] [ET: 0.464/24255.176] [MU: 2.78/28480.85] 
	SQL: SELECT 
						fc.cty_id as c2id, 
						fc.cty_name as c2name, 
						fc.cty_garage_address as c2address,
						tc.cty_id as c4id,
						tc.cty_name as c4name, tc.cty_garage_address as c4address,
						0 as totalExtraDistance FROM route
						INNER JOIN cities fc ON rut_from_city_id=fc.cty_id
						INNER JOIN cities tc ON rut_to_city_id=tc.cty_id
						INNER JOIN rate on  rate.rte_route_id=route.rut_id  AND rate.rte_vehicletype_id IN (3)
						WHERE route.rut_from_city_id=30804 AND route.rut_to_city_id=30711 AND route.rut_active=1 
	 [params: []]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24281.574] [M: 28495.36] [ET: 0.351/24255.6] [MU: 6.53/28493.36] 
	SQL: 
				SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address, tc.cty_id as c4id, 
				tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
					FROM
					 (
						(
							SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id,  
								r3.rut_to_city_id, route.rut_name , route.rut_id,
								(route.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, 
								r3.rut_estm_distance
							FROM route
							INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_from_city_id=30804  
									AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=route.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) 
									AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
						UNION
						(
							SELECT r3.rut_id, r3.rut_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,(route.rut_estm_distance + r1.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
							FROM route
							INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND  route.rut_to_city_id=30711 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND route.rut_to_city_id=r3.rut_to_city_id))	AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
                     ) a
					INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
					INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1 
	 [params: []]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24281.987] [M: 28505.87] [ET: 0.338/24256.018] [MU: 5.03/28504.37] 
	SQL: SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
                              tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
                        FROM (SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,
                                    (route.rut_estm_distance + r1.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
                                FROM route
								INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
								INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
								INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) AND r3.rut_active=1 
								INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3) LIMIT 1
							)a
                        INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
                        INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1
                         
	 [params: []]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24282.479] [M: 28512.24] [ET: 0.406/24256.491] [MU: 0.74/28511.37] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"GarageRoute_30804_30711","sql":" (INDEX GarageRoute_30804_30711_index_rut_id (rut_id), INDEX GarageRoute_30804_30711_index_rut_from_city_id (rut_from_city_id), INDEX GarageRoute_30804_30711_index_rut_to_city_id (rut_to_city_id))\r\n\t\t\t\t\t\t\tSELECT route.rut_id, route.rut_from_city_id, route.rut_to_city_id, route.rut_name, rut_estm_distance FROM route \r\n\t\t\t\t\t\t\tINNER JOIN cities_stats   ON cities_stats.cts_cty_id = route.rut_from_city_id\r\n\t\t\t\t\t\t\tAND rut_estm_distance < 300\r\n\t\t\t\t\t\t\tAND rut_active = 1\r\n\t\t\t\t\t\t\tAND route.rut_to_city_id=30804\r\n\t\t\t\t\t\t\tAND cities_stats.cts_vnd_cnt >= 3\r\n\t\t\t\t\t\t\tORDER BY rut_estm_distance LIMIT 10"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24283.243] [M: 28524.16] [ET: 0.641/24257.255] [MU: 6.69/28522.41] 
	SQL: SELECT a.*, fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
								tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address 
						FROM ((SELECT xyz.rut_from_city_id as startCity, r1.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r3.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_from_city_id
							INNER JOIN rate ON rate.rte_route_id=r1.rut_id  AND rate.rte_vehicletype_id IN (3)
							INNER JOIN route r2 ON r2.rut_to_city_id=r1.rut_to_city_id AND r2.rut_from_city_id=:dropCity AND r2.rut_active=1
							INNER JOIN route r3 ON r3.rut_from_city_id=xyz.rut_to_city_id AND r3.rut_to_city_id=r2.rut_from_city_id AND r3.rut_active=1
							ORDER BY ExtraDistance LIMIT 1
							)
							UNION
							(
							SELECT xyz.rut_from_city_id as startCity, r2.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r2.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_to_city_id AND r1.rut_to_city_id=:dropCity
							INNER JOIN route r2 ON r2.rut_to_city_id=xyz.rut_from_city_id AND r2.rut_from_city_id=r1.rut_to_city_id
							ORDER BY ExtraDistance ASC LIMIT 1
							)) a
						INNER JOIN cities fc ON startCity=fc.cty_id
						INNER JOIN cities tc ON endCity=tc.cty_id 
						ORDER BY ExtraDistance 
	 [params: {"pickupCity":"30804","dropCity":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24286.193] [M: 28535.51] [ET: 1.131/24260.224] [MU: 7.88/28535.4] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24287.194] [M: 28540.98] [ET: 0.898/24261.212] [MU: 8.27/28540.88] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24288.245] [M: 28548.61] [ET: 0.322/24262.278] [MU: 1/28548.23] 
	SQL: SELECT cts_airport_pickup_entry_fee
               FROM   cities
               INNER JOIN cities_stats
               ON cities.cty_id = cities_stats.cts_cty_id
               WHERE  cty_id = :cityId
               AND cty_is_airport = 1 AND cty_active = 1 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24289.782] [M: 28562.52] [ET: 0.955/24263.817] [MU: 8.14/28562.41] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24290.82] [M: 28570.36] [ET: 0.921/24264.837] [MU: 8.08/28570.25] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24291.352] [M: 28569.7] [ET: 0.393/24265.37] [MU: 0.9/28569.45] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24293.239] [M: 28582.41] [ET: 0.777/24267.251] [MU: 3.33/28581.97] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24294.021] [M: 28611.58] [ET: 0.621/24268.043] [MU: 22.53/28610.83] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp503)) OR (apr_area_type = 5 AND apr_area_id IN (:gp501)) OR (apr_area_type = 2 AND apr_area_id IN (:gp504)) OR (apr_area_type = 4 AND apr_area_id IN (:gp505)) OR (apr_area_type = 1 AND apr_area_id IN (:gp502))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp501":"3699",":gp502":"31",":gp503":"30804",":gp504":"105",":gp505":"1","cab":"93"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24295.517] [M: 28598.6] [ET: 0.469/24269.551] [MU: 3.34/28598.16] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24297.986] [M: 28609.15] [ET: 2.347/24271.992] [MU: 3.54/28608.27] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp508)) OR (scr_area_type = 5 AND scr_area_id IN (:gp506)) OR (scr_area_type = 2 AND scr_area_id IN (:gp509)) OR (scr_area_type = 4 AND scr_area_id IN (:gp510)) OR (scr_area_type = 1 AND scr_area_id IN (:gp507)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp506":"3699",":gp507":"31",":gp508":"3699",":gp509":"105",":gp510":"1","scv_id":"93"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24298.838] [M: 28612.35] [ET: 0.352/24272.855] [MU: 2.97/28612.24] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24300.726] [M: 28625.46] [ET: 0.364/24274.744] [MU: 2.97/28625.35] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24301.146] [M: 28629.63] [ET: 0.315/24275.17] [MU: 2.98/28629.52] 
	BookingRoute::calculateDistance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24305.088] [M: 28663.59] [ET: 0.525/24279.113] [MU: 6.28/28661.59] 
	SQL: 
                SELECT cities.cty_id as c2id, cities.cty_name as c2name, cities.cty_garage_address as c2address,
                    cities.cty_id as c4id, cities.cty_name as c4name, cities.cty_garage_address as c4address,
                        (distance * 2) as totalExtraDistance
                 FROM (SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<40
                     INNER JOIN route r1 ON route.rut_to_city_id=r1.rut_from_city_id AND r1.rut_active=1
                     INNER JOIN rate ON r1.rut_id=rate.rte_route_id AND rate.rte_status=1  AND rate.rte_vehicletype_id IN (3) GROUP BY route.rut_id HAVING count(*) >30
                   UNION
                     SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<600
                     INNER JOIN cities tc ON tc.cty_id=route.rut_to_city_id AND tc.cty_service_active=1 AND CalcDistance(cities.cty_lat, cities.cty_long, tc.cty_lat, tc.cty_long)<=route.rut_estm_distance						 
                     INNER JOIN cities_stats ON cities_stats.cts_cty_id = route.rut_to_city_id AND cities_stats.cts_vnd_cnt >= 2
                   UNION
                    SELECT cts_cty_id AS city, 0 AS distance
					FROM cities_stats WHERE 1 AND cities_stats.cts_cty_id= 30817 and cities_stats.cts_vnd_cnt>1) a
                    INNER JOIN cities ON cities.cty_id=a.city
                    ORDER BY totalExtraDistance LIMIT 1 
	 [params: []]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24308.222] [M: 28678.41] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"3","tripDistance":"","tripDuration":"","multiCityData":"","bookingType":"1","pickupAddress":"","pickupDate":"31\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","sccId":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=3&tripDistance=&tripDuration=&multiCityData=&bookingType=1&pickupAddress=&pickupDate=31%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&sccId=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24309.027] [M: 28695.25] [ET: 1.38/24283.048] [MU: 18.04/28695.14] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24309.075] [M: 28696.93] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24310.118] [M: 28710.39] [ET: 0.855/24284.123] [MU: 2.99/28707.89] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+10013),(IF((cpm_value_type=2),(10013+(10013*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30937 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30937) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-31 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=93 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24311.737] [M: 28752.62] [ET: 4.167/24285.756] [MU: 75.87/28752.46] 
	RouteRates::calculate for CAB 93 2024-10-31 18:00:00 - Trip Type: 1 16930882
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24311.956] [M: 28730.3] [ET: 39.773/24285.979] [MU: 301.69/28730.15] 
	Quote::calculateRules for CAB 93, From City Id: 30804, To city Id: 30711
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24312.318] [M: 28702.02] [ET: 0.245/24286.339] [MU: 0.9/28701.77] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"93"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24312.426] [M: 28703.59] [ET: 73.029/24286.45] [MU: 455.38/28703.49] 
	Quote For CabType: 93
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24313.718] [M: 28713.93] [ET: 0.416/24287.754] [MU: 3.33/28713.49] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24314.123] [M: 28719.74] [ET: 0.337/24288.16] [MU: 3.34/28719.3] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24314.649] [M: 28722.68] [ET: 0.445/24288.648] [MU: 0.9/28722.43] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24315.316] [M: 28755.04] [ET: 0.511/24289.33] [MU: 24.22/28753.54] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (100) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30711) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp511)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp514,:gp515)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp512,:gp513)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp516,:gp517))
			OR (scr_area_type = 5 AND scr_area_id IN (3699))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (96)
		ORDER BY rank DESC
		 
	 [params: {":gp511":"31",":gp512":"30804",":gp513":"30711",":gp514":"105",":gp515":"100",":gp516":"1",":gp517":"1","tripType":"1"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24316.134] [M: 28735.22] [ET: 0.232/24290.168] [MU: 0.83/28735.03] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24316.489] [M: 28738.09] [ET: 0.279/24290.524] [MU: 0.96/28737.78] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"2"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24317.639] [M: 28750.84] [ET: 0.386/24291.673] [MU: 2.05/28750.34] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"96"}]
2024/10/17 13:53:39 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24320.226] [M: 28760.23] [ET: 2.381/24294.25] [MU: 3.53/28759.35] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"96","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24320.995] [M: 28763.48] [ET: 0.526/24295.025] [MU: 0.87/28763.26] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":0}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24321.681] [M: 28770.76] [ET: 0.518/24295.716] [MU: 2.97/28770.32] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24322.278] [M: 28798.93] [ET: 0.491/24296.311] [MU: 22.05/28798.3] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp519)) OR (apr_area_type = 2 AND apr_area_id IN (:gp520)) OR (apr_area_type = 4 AND apr_area_id IN (:gp521)) OR (apr_area_type = 1 AND apr_area_id IN (:gp518))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp518":"31",":gp519":"30804",":gp520":"105",":gp521":"1","cab":"96"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24323.271] [M: 28785.65] [ET: 0.439/24297.301] [MU: 3.33/28785.21] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24325.764] [M: 28795.93] [ET: 2.371/24299.767] [MU: 3.41/28795.05] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp523)) OR (scr_area_type = 2 AND scr_area_id IN (:gp524)) OR (scr_area_type = 4 AND scr_area_id IN (:gp525)) OR (scr_area_type = 1 AND scr_area_id IN (:gp522)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp522":"31",":gp523":"30804",":gp524":"105",":gp525":"1","scv_id":"96"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24328.585] [M: 28823.66] [ET: 1.813/24302.592] [MU: 0.75/28815.66] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"nearest_route_30804_30711","sql":"(INDEX indx_nearest_rt_rutid (rut_id)) \r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, routeFrom.rut_name as fromAlias, \r\n\t\t\t\tNULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, \r\n\t\t\t\t0 as rank, routeFrom.rut_estm_time as startTime, 0 as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 \r\n\t\t\t\tAND routeFrom.rut_from_city_id<>routeFrom.rut_to_city_id AND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\t\tAND (routeAlias.rut_to_city_id=route.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, NULL, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) \r\n\t\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\t0 AS extraStartDistance, 0, 0 as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND route.rut_from_city_id = 30804 AND route.rut_to_city_id=30711 \r\n\t\t\t\tAND routeTo.rut_from_city_id=30711\r\n\t\t\t\tAND route.rut_active = 1 AND routeTo.rut_active = 1 AND routeTo.rut_estm_distance < 50 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = route.rut_from_city_id) \r\n\t\t\t   AND (routeAlias.rut_to_city_id = routeTo.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, \r\n\t\t\t\trouteFrom.rut_name, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t+ IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) \r\n\t\t\t\tAS extraDistance, IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, 0, \r\n\t\t\t\trouteFrom.rut_estm_time as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 AND routeFrom.rut_from_city_id <> routeFrom.rut_to_city_id\r\n\t\t\t\t\tAND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND routeTo.rut_estm_distance < 50 \r\n\t\t\t\t\tAND routeTo.rut_from_city_id=30711 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\tAND (routeAlias.rut_to_city_id=routeTo.rut_to_city_id) AND routeAlias.rut_active = 1 AND routeAlias.rut_from_city_id=30804  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24330.928] [M: 28827.74] [ET: 2.243/24304.954] [MU: 2.17/28827.3] 
	SQL: SELECT *, (rte_vendor_amount + extraDistance * 10.55) as totalCost FROM (SELECT * FROM nearest_route_30804_30711) a
					INNER JOIN rate ON a.rut_id = rate.rte_route_id AND rte_status=1 AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <>0
					WHERE 1 ORDER BY rank DESC, totalCost ASC LIMIT 0,1 
	 [params: {"cabType":"96"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24331.73] [M: 28835.77] [ET: 0.694/24305.752] [MU: 0.74/28833.77] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"getNearestRoute_30804_30711_70","sql":"(INDEX getNearestRoute_30804_30711_70_index_rut_id (rut_id))\r\n\t\t\t\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id AS start, routeAlias.rut_to_city_id AS end,\r\n\t\t\t\t\t\t\t\trouteFrom.rut_name AS fromAlias, NULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance AS quotedDistance,\r\n\t\t\t\t\t\t\t\trouteAlias.rut_estm_distance AS rateDistance, \r\n\t\t\t\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance)\r\n\t\t\t\t\t\t\t\t\t - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance,\r\n\t\t\t\t\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance,\r\n\t\t\t\t\t\t\t\t0 AS rank, routeFrom.rut_estm_time AS startTime, 0 AS endTime, route.rut_estm_time, \r\n\t\t\t\t\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraTravelDistance\r\n\t\t\t\t\t\tFROM   route\r\n\t\t\t\t\t\tINNER JOIN route routeTo ON routeTo.rut_to_city_id=route.rut_from_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_from_city_id=30804 AND routeTo.rut_active=1\r\n\t\t\t\t\t\t\t\tAND routeTo.rut_estm_distance<70 AND route.rut_active=1\r\n\t\t\t\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_from_city_id=route.rut_to_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_active = 1\r\n\t\t\t\t\t\t\t\tAND routeFrom.rut_estm_distance<70 AND route.rut_active = 1\r\n\t\t\t\t\t\tINNER JOIN route routeAlias ON routeAlias.rut_to_city_id=routeFrom.rut_to_city_id\r\n\t\t\t\t\t\t\tAND routeAlias.rut_from_city_id=routeTo.rut_from_city_id AND routeAlias.rut_active = 1"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24333.973] [M: 28841.03] [ET: 2.131/24307.969] [MU: 2.42/28840.41] 
	SQL: SELECT *, (rte_vendor_amount + extradistance * 10.55 ) AS totalCost, 
						ABS(quotedDistance-rateDistance) AS extraChargeableDistance
					FROM getNearestRoute_30804_30711_70 a
					INNER JOIN rate ON a.rut_id=rate.rte_route_id AND rte_status=1 
						AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <> 0
					WHERE  1
					ORDER  BY rank DESC, extraStartDistance, extraChargeableDistance ASC, totalcost ASC
					LIMIT  0, 1 
	 [params: {"cabType":"96"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24337.559] [M: 28856.12] [ET: 0.649/24311.573] [MU: 3.41/28855.24] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"16","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24339.229] [M: 28872.73] [ET: 0.46/24313.257] [MU: 3.78/28871.86] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24340.345] [M: 28883.84] [ET: 22.636/24314.38] [MU: 131.57/28883.68] 
	Quote::calculateOneWay  for CAB 96 Date: 2024-10-31 18:00:00
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24340.825] [M: 28887.34] [ET: 0.388/24314.86] [MU: 0.9/28887.09] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24342.293] [M: 28900.05] [ET: 0.905/24316.302] [MU: 3.33/28899.61] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24343.433] [M: 28929.22] [ET: 0.946/24317.434] [MU: 22.53/28928.47] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp528)) OR (apr_area_type = 5 AND apr_area_id IN (:gp526)) OR (apr_area_type = 2 AND apr_area_id IN (:gp529)) OR (apr_area_type = 4 AND apr_area_id IN (:gp530)) OR (apr_area_type = 1 AND apr_area_id IN (:gp527))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp526":"3699",":gp527":"31",":gp528":"30804",":gp529":"105",":gp530":"1","cab":"96"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24345.577] [M: 28916.23] [ET: 0.61/24319.608] [MU: 3.34/28915.8] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24348.126] [M: 28926.78] [ET: 2.406/24322.116] [MU: 3.53/28925.91] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp533)) OR (scr_area_type = 5 AND scr_area_id IN (:gp531)) OR (scr_area_type = 2 AND scr_area_id IN (:gp534)) OR (scr_area_type = 4 AND scr_area_id IN (:gp535)) OR (scr_area_type = 1 AND scr_area_id IN (:gp532)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp531":"3699",":gp532":"31",":gp533":"3699",":gp534":"105",":gp535":"1","scv_id":"96"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24348.909] [M: 28927.95] [ET: 0.361/24322.931] [MU: 2.98/28927.84] 
	BookingRoute::calculateDistance
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24350.416] [M: 28938.16] [ET: 0.487/24324.449] [MU: 2.79/28937.53] 
	SQL: SELECT 
						fc.cty_id as c2id, 
						fc.cty_name as c2name, 
						fc.cty_garage_address as c2address,
						tc.cty_id as c4id,
						tc.cty_name as c4name, tc.cty_garage_address as c4address,
						0 as totalExtraDistance FROM route
						INNER JOIN cities fc ON rut_from_city_id=fc.cty_id
						INNER JOIN cities tc ON rut_to_city_id=tc.cty_id
						INNER JOIN rate on  rate.rte_route_id=route.rut_id  AND rate.rte_vehicletype_id IN (3)
						WHERE route.rut_from_city_id=30804 AND route.rut_to_city_id=30711 AND route.rut_active=1 
	 [params: []]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24350.858] [M: 28952.04] [ET: 0.364/24324.883] [MU: 6.53/28950.04] 
	SQL: 
				SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address, tc.cty_id as c4id, 
				tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
					FROM
					 (
						(
							SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id,  
								r3.rut_to_city_id, route.rut_name , route.rut_id,
								(route.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, 
								r3.rut_estm_distance
							FROM route
							INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_from_city_id=30804  
									AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=route.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) 
									AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
						UNION
						(
							SELECT r3.rut_id, r3.rut_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,(route.rut_estm_distance + r1.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
							FROM route
							INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND  route.rut_to_city_id=30711 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND route.rut_to_city_id=r3.rut_to_city_id))	AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
                     ) a
					INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
					INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1 
	 [params: []]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24351.267] [M: 28962.55] [ET: 0.339/24325.299] [MU: 5.03/28961.05] 
	SQL: SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
                              tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
                        FROM (SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,
                                    (route.rut_estm_distance + r1.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
                                FROM route
								INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
								INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
								INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) AND r3.rut_active=1 
								INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3) LIMIT 1
							)a
                        INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
                        INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1
                         
	 [params: []]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24351.816] [M: 28968.92] [ET: 0.479/24325.85] [MU: 0.74/28968.05] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"GarageRoute_30804_30711","sql":" (INDEX GarageRoute_30804_30711_index_rut_id (rut_id), INDEX GarageRoute_30804_30711_index_rut_from_city_id (rut_from_city_id), INDEX GarageRoute_30804_30711_index_rut_to_city_id (rut_to_city_id))\r\n\t\t\t\t\t\t\tSELECT route.rut_id, route.rut_from_city_id, route.rut_to_city_id, route.rut_name, rut_estm_distance FROM route \r\n\t\t\t\t\t\t\tINNER JOIN cities_stats   ON cities_stats.cts_cty_id = route.rut_from_city_id\r\n\t\t\t\t\t\t\tAND rut_estm_distance < 300\r\n\t\t\t\t\t\t\tAND rut_active = 1\r\n\t\t\t\t\t\t\tAND route.rut_to_city_id=30804\r\n\t\t\t\t\t\t\tAND cities_stats.cts_vnd_cnt >= 3\r\n\t\t\t\t\t\t\tORDER BY rut_estm_distance LIMIT 10"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24352.34] [M: 28980.84] [ET: 0.448/24326.365] [MU: 6.69/28979.09] 
	SQL: SELECT a.*, fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
								tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address 
						FROM ((SELECT xyz.rut_from_city_id as startCity, r1.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r3.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_from_city_id
							INNER JOIN rate ON rate.rte_route_id=r1.rut_id  AND rate.rte_vehicletype_id IN (3)
							INNER JOIN route r2 ON r2.rut_to_city_id=r1.rut_to_city_id AND r2.rut_from_city_id=:dropCity AND r2.rut_active=1
							INNER JOIN route r3 ON r3.rut_from_city_id=xyz.rut_to_city_id AND r3.rut_to_city_id=r2.rut_from_city_id AND r3.rut_active=1
							ORDER BY ExtraDistance LIMIT 1
							)
							UNION
							(
							SELECT xyz.rut_from_city_id as startCity, r2.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r2.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_to_city_id AND r1.rut_to_city_id=:dropCity
							INNER JOIN route r2 ON r2.rut_to_city_id=xyz.rut_from_city_id AND r2.rut_from_city_id=r1.rut_to_city_id
							ORDER BY ExtraDistance ASC LIMIT 1
							)) a
						INNER JOIN cities fc ON startCity=fc.cty_id
						INNER JOIN cities tc ON endCity=tc.cty_id 
						ORDER BY ExtraDistance 
	 [params: {"pickupCity":"30804","dropCity":"30711"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24357.291] [M: 28992.19] [ET: 2.57/24331.276] [MU: 7.88/28992.08] 
	BookingRoute::calculateDistance
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24360.041] [M: 28997.66] [ET: 2.506/24334.041] [MU: 8.27/28997.55] 
	BookingRoute::calculateDistance
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24361.542] [M: 29005.29] [ET: 0.587/24335.551] [MU: 1/29004.91] 
	SQL: SELECT cts_airport_pickup_entry_fee
               FROM   cities
               INNER JOIN cities_stats
               ON cities.cty_id = cities_stats.cts_cty_id
               WHERE  cty_id = :cityId
               AND cty_is_airport = 1 AND cty_active = 1 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24363.971] [M: 29019.2] [ET: 1.289/24338.002] [MU: 8.14/29019.09] 
	BookingRoute::calculateDistance
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24365.249] [M: 29026.95] [ET: 1.149/24339.256] [MU: 8.08/29026.84] 
	BookingRoute::calculateDistance
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24366.254] [M: 29026.38] [ET: 0.832/24340.232] [MU: 0.9/29026.13] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24368.44] [M: 29039.09] [ET: 0.971/24342.44] [MU: 3.33/29038.65] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24369.784] [M: 29068.26] [ET: 1.116/24343.789] [MU: 22.53/29067.51] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp538)) OR (apr_area_type = 5 AND apr_area_id IN (:gp536)) OR (apr_area_type = 2 AND apr_area_id IN (:gp539)) OR (apr_area_type = 4 AND apr_area_id IN (:gp540)) OR (apr_area_type = 1 AND apr_area_id IN (:gp537))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp536":"3699",":gp537":"31",":gp538":"30804",":gp539":"105",":gp540":"1","cab":"96"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24372.91] [M: 29055.27] [ET: 0.827/24346.92] [MU: 3.34/29054.84] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24376.747] [M: 29065.82] [ET: 3.651/24350.744] [MU: 3.53/29064.95] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp543)) OR (scr_area_type = 5 AND scr_area_id IN (:gp541)) OR (scr_area_type = 2 AND scr_area_id IN (:gp544)) OR (scr_area_type = 4 AND scr_area_id IN (:gp545)) OR (scr_area_type = 1 AND scr_area_id IN (:gp542)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp541":"3699",":gp542":"31",":gp543":"3699",":gp544":"105",":gp545":"1","scv_id":"96"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24378.075] [M: 29069.03] [ET: 0.608/24352.087] [MU: 2.97/29068.92] 
	BookingRoute::calculateDistance
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24381.27] [M: 29082.14] [ET: 0.919/24355.284] [MU: 2.97/29082.03] 
	BookingRoute::calculateDistance
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24382.272] [M: 29086.22] [ET: 0.862/24356.28] [MU: 2.97/29086.11] 
	BookingRoute::calculateDistance
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24386.953] [M: 29120.18] [ET: 0.752/24360.955] [MU: 6.28/29118.18] 
	SQL: 
                SELECT cities.cty_id as c2id, cities.cty_name as c2name, cities.cty_garage_address as c2address,
                    cities.cty_id as c4id, cities.cty_name as c4name, cities.cty_garage_address as c4address,
                        (distance * 2) as totalExtraDistance
                 FROM (SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<40
                     INNER JOIN route r1 ON route.rut_to_city_id=r1.rut_from_city_id AND r1.rut_active=1
                     INNER JOIN rate ON r1.rut_id=rate.rte_route_id AND rate.rte_status=1  AND rate.rte_vehicletype_id IN (3) GROUP BY route.rut_id HAVING count(*) >30
                   UNION
                     SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<600
                     INNER JOIN cities tc ON tc.cty_id=route.rut_to_city_id AND tc.cty_service_active=1 AND CalcDistance(cities.cty_lat, cities.cty_long, tc.cty_lat, tc.cty_long)<=route.rut_estm_distance						 
                     INNER JOIN cities_stats ON cities_stats.cts_cty_id = route.rut_to_city_id AND cities_stats.cts_vnd_cnt >= 2
                   UNION
                    SELECT cts_cty_id AS city, 0 AS distance
					FROM cities_stats WHERE 1 AND cities_stats.cts_cty_id= 30817 and cities_stats.cts_vnd_cnt>1) a
                    INNER JOIN cities ON cities.cty_id=a.city
                    ORDER BY totalExtraDistance LIMIT 1 
	 [params: []]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24390.204] [M: 29134.99] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"3","tripDistance":"","tripDuration":"","multiCityData":"","bookingType":"1","pickupAddress":"","pickupDate":"31\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","sccId":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=3&tripDistance=&tripDuration=&multiCityData=&bookingType=1&pickupAddress=&pickupDate=31%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&sccId=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24390.633] [M: 29151.84] [ET: 0.906/24364.672] [MU: 18.05/29151.73] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24390.665] [M: 29153.52] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24391.939] [M: 29166.98] [ET: 1.039/24365.847] [MU: 2.99/29164.48] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+10013),(IF((cpm_value_type=2),(10013+(10013*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30937 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30937) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-31 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=96 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24394.456] [M: 29209.2] [ET: 4.813/24368.484] [MU: 75.88/29209.05] 
	RouteRates::calculate for CAB 96 2024-10-31 18:00:00 - Trip Type: 1 83288191
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24394.624] [M: 29186.89] [ET: 54.219/24368.662] [MU: 301.6/29186.73] 
	Quote::calculateRules for CAB 96, From City Id: 30804, To city Id: 30711
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24395.118] [M: 29158.62] [ET: 0.381/24369.123] [MU: 0.9/29158.37] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"96"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24395.253] [M: 29160.18] [ET: 82.742/24369.27] [MU: 455.29/29160.09] 
	Quote For CabType: 96
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24396.675] [M: 29170.52] [ET: 0.406/24370.708] [MU: 3.34/29170.09] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24397.08] [M: 29176.34] [ET: 0.336/24371.116] [MU: 3.33/29175.9] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30711"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24397.624] [M: 29179.27] [ET: 0.471/24371.658] [MU: 0.9/29179.02] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24398.171] [M: 29211.63] [ET: 0.442/24372.202] [MU: 24.22/29210.13] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (100) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30711) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp546)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp549,:gp550)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp547,:gp548)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp551,:gp552))
			OR (scr_area_type = 5 AND scr_area_id IN (3699))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (97)
		ORDER BY rank DESC
		 
	 [params: {":gp546":"31",":gp547":"30804",":gp548":"30711",":gp549":"105",":gp550":"100",":gp551":"1",":gp552":"1","tripType":"1"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24398.784] [M: 29191.81] [ET: 0.183/24372.821] [MU: 0.84/29191.63] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24399.081] [M: 29194.69] [ET: 0.228/24373.119] [MU: 0.96/29194.38] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"2"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24400.142] [M: 29207.44] [ET: 0.307/24374.177] [MU: 2.05/29206.94] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"97"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24402.603] [M: 29216.82] [ET: 2.248/24376.606] [MU: 3.53/29215.95] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"97","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24403.519] [M: 29220.07] [ET: 0.594/24377.532] [MU: 0.86/29219.85] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":0}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24404.363] [M: 29227.35] [ET: 0.606/24378.396] [MU: 2.97/29226.91] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24405.045] [M: 29255.52] [ET: 0.573/24379.077] [MU: 22.05/29254.9] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp554)) OR (apr_area_type = 2 AND apr_area_id IN (:gp555)) OR (apr_area_type = 4 AND apr_area_id IN (:gp556)) OR (apr_area_type = 1 AND apr_area_id IN (:gp553))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp553":"31",":gp554":"30804",":gp555":"105",":gp556":"1","cab":"97"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24406.309] [M: 29242.24] [ET: 0.6/24380.322] [MU: 3.34/29241.8] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24408.949] [M: 29252.52] [ET: 2.473/24382.953] [MU: 3.41/29251.65] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp558)) OR (scr_area_type = 2 AND scr_area_id IN (:gp559)) OR (scr_area_type = 4 AND scr_area_id IN (:gp560)) OR (scr_area_type = 1 AND scr_area_id IN (:gp557)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp557":"31",":gp558":"30804",":gp559":"105",":gp560":"1","scv_id":"97"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24412.438] [M: 29280.26] [ET: 2.528/24386.439] [MU: 0.74/29272.26] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"nearest_route_30804_30711","sql":"(INDEX indx_nearest_rt_rutid (rut_id)) \r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, routeFrom.rut_name as fromAlias, \r\n\t\t\t\tNULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, \r\n\t\t\t\t0 as rank, routeFrom.rut_estm_time as startTime, 0 as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 \r\n\t\t\t\tAND routeFrom.rut_from_city_id<>routeFrom.rut_to_city_id AND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\t\tAND (routeAlias.rut_to_city_id=route.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, NULL, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) \r\n\t\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\t0 AS extraStartDistance, 0, 0 as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND route.rut_from_city_id = 30804 AND route.rut_to_city_id=30711 \r\n\t\t\t\tAND routeTo.rut_from_city_id=30711\r\n\t\t\t\tAND route.rut_active = 1 AND routeTo.rut_active = 1 AND routeTo.rut_estm_distance < 50 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = route.rut_from_city_id) \r\n\t\t\t   AND (routeAlias.rut_to_city_id = routeTo.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, \r\n\t\t\t\trouteFrom.rut_name, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t+ IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) \r\n\t\t\t\tAS extraDistance, IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, 0, \r\n\t\t\t\trouteFrom.rut_estm_time as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 AND routeFrom.rut_from_city_id <> routeFrom.rut_to_city_id\r\n\t\t\t\t\tAND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND routeTo.rut_estm_distance < 50 \r\n\t\t\t\t\tAND routeTo.rut_from_city_id=30711 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\tAND (routeAlias.rut_to_city_id=routeTo.rut_to_city_id) AND routeAlias.rut_active = 1 AND routeAlias.rut_from_city_id=30804  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24414.751] [M: 29284.34] [ET: 2.212/24388.776] [MU: 2.16/29283.9] 
	SQL: SELECT *, (rte_vendor_amount + extraDistance * 10.55) as totalCost FROM (SELECT * FROM nearest_route_30804_30711) a
					INNER JOIN rate ON a.rut_id = rate.rte_route_id AND rte_status=1 AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <>0
					WHERE 1 ORDER BY rank DESC, totalCost ASC LIMIT 0,1 
	 [params: {"cabType":"97"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24415.586] [M: 29292.36] [ET: 0.703/24389.606] [MU: 0.74/29290.36] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"getNearestRoute_30804_30711_70","sql":"(INDEX getNearestRoute_30804_30711_70_index_rut_id (rut_id))\r\n\t\t\t\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id AS start, routeAlias.rut_to_city_id AS end,\r\n\t\t\t\t\t\t\t\trouteFrom.rut_name AS fromAlias, NULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance AS quotedDistance,\r\n\t\t\t\t\t\t\t\trouteAlias.rut_estm_distance AS rateDistance, \r\n\t\t\t\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance)\r\n\t\t\t\t\t\t\t\t\t - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance,\r\n\t\t\t\t\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance,\r\n\t\t\t\t\t\t\t\t0 AS rank, routeFrom.rut_estm_time AS startTime, 0 AS endTime, route.rut_estm_time, \r\n\t\t\t\t\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraTravelDistance\r\n\t\t\t\t\t\tFROM   route\r\n\t\t\t\t\t\tINNER JOIN route routeTo ON routeTo.rut_to_city_id=route.rut_from_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_from_city_id=30804 AND routeTo.rut_active=1\r\n\t\t\t\t\t\t\t\tAND routeTo.rut_estm_distance<70 AND route.rut_active=1\r\n\t\t\t\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_from_city_id=route.rut_to_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_active = 1\r\n\t\t\t\t\t\t\t\tAND routeFrom.rut_estm_distance<70 AND route.rut_active = 1\r\n\t\t\t\t\t\tINNER JOIN route routeAlias ON routeAlias.rut_to_city_id=routeFrom.rut_to_city_id\r\n\t\t\t\t\t\t\tAND routeAlias.rut_from_city_id=routeTo.rut_from_city_id AND routeAlias.rut_active = 1"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24417.993] [M: 29297.63] [ET: 2.294/24391.987] [MU: 2.41/29297] 
	SQL: SELECT *, (rte_vendor_amount + extradistance * 10.55 ) AS totalCost, 
						ABS(quotedDistance-rateDistance) AS extraChargeableDistance
					FROM getNearestRoute_30804_30711_70 a
					INNER JOIN rate ON a.rut_id=rate.rte_route_id AND rte_status=1 
						AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <> 0
					WHERE  1
					ORDER  BY rank DESC, extraStartDistance, extraChargeableDistance ASC, totalcost ASC
					LIMIT  0, 1 
	 [params: {"cabType":"97"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24421.337] [M: 29312.71] [ET: 0.629/24395.352] [MU: 3.42/29311.84] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"16","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24422.999] [M: 29329.33] [ET: 0.463/24397.031] [MU: 3.79/29328.45] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24424.143] [M: 29340.43] [ET: 23.936/24398.182] [MU: 131.57/29340.27] 
	Quote::calculateOneWay  for CAB 97 Date: 2024-10-31 18:00:00
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24424.616] [M: 29344.02] [ET: 0.38/24398.651] [MU: 0.9/29343.77] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24426.042] [M: 29356.73] [ET: 0.738/24400.075] [MU: 3.34/29356.3] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24426.685] [M: 29385.91] [ET: 0.521/24400.7] [MU: 22.53/29385.16] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp563)) OR (apr_area_type = 5 AND apr_area_id IN (:gp561)) OR (apr_area_type = 2 AND apr_area_id IN (:gp564)) OR (apr_area_type = 4 AND apr_area_id IN (:gp565)) OR (apr_area_type = 1 AND apr_area_id IN (:gp562))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp561":"3699",":gp562":"31",":gp563":"30804",":gp564":"105",":gp565":"1","cab":"97"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24428.361] [M: 29372.92] [ET: 0.59/24402.378] [MU: 3.34/29372.48] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24430.859] [M: 29383.47] [ET: 2.328/24404.863] [MU: 3.53/29382.59] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp568)) OR (scr_area_type = 5 AND scr_area_id IN (:gp566)) OR (scr_area_type = 2 AND scr_area_id IN (:gp569)) OR (scr_area_type = 4 AND scr_area_id IN (:gp570)) OR (scr_area_type = 1 AND scr_area_id IN (:gp567)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp566":"3699",":gp567":"31",":gp568":"3699",":gp569":"105",":gp570":"1","scv_id":"97"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24431.405] [M: 29384.64] [ET: 0.237/24405.437] [MU: 2.97/29384.53] 
	BookingRoute::calculateDistance
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24432.92] [M: 29394.84] [ET: 0.528/24406.935] [MU: 2.79/29394.22] 
	SQL: SELECT 
						fc.cty_id as c2id, 
						fc.cty_name as c2name, 
						fc.cty_garage_address as c2address,
						tc.cty_id as c4id,
						tc.cty_name as c4name, tc.cty_garage_address as c4address,
						0 as totalExtraDistance FROM route
						INNER JOIN cities fc ON rut_from_city_id=fc.cty_id
						INNER JOIN cities tc ON rut_to_city_id=tc.cty_id
						INNER JOIN rate on  rate.rte_route_id=route.rut_id  AND rate.rte_vehicletype_id IN (3)
						WHERE route.rut_from_city_id=30804 AND route.rut_to_city_id=30711 AND route.rut_active=1 
	 [params: []]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24433.481] [M: 29408.73] [ET: 0.453/24407.495] [MU: 6.53/29406.73] 
	SQL: 
				SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address, tc.cty_id as c4id, 
				tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
					FROM
					 (
						(
							SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id,  
								r3.rut_to_city_id, route.rut_name , route.rut_id,
								(route.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, 
								r3.rut_estm_distance
							FROM route
							INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_from_city_id=30804  
									AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=route.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) 
									AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
						UNION
						(
							SELECT r3.rut_id, r3.rut_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,(route.rut_estm_distance + r1.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
							FROM route
							INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND  route.rut_to_city_id=30711 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND route.rut_to_city_id=r3.rut_to_city_id))	AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
                     ) a
					INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
					INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1 
	 [params: []]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24433.999] [M: 29419.23] [ET: 0.416/24408.016] [MU: 5.03/29417.73] 
	SQL: SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
                              tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
                        FROM (SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,
                                    (route.rut_estm_distance + r1.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
                                FROM route
								INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
								INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
								INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) AND r3.rut_active=1 
								INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3) LIMIT 1
							)a
                        INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
                        INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1
                         
	 [params: []]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24434.532] [M: 29425.61] [ET: 0.436/24408.555] [MU: 0.75/29424.73] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"GarageRoute_30804_30711","sql":" (INDEX GarageRoute_30804_30711_index_rut_id (rut_id), INDEX GarageRoute_30804_30711_index_rut_from_city_id (rut_from_city_id), INDEX GarageRoute_30804_30711_index_rut_to_city_id (rut_to_city_id))\r\n\t\t\t\t\t\t\tSELECT route.rut_id, route.rut_from_city_id, route.rut_to_city_id, route.rut_name, rut_estm_distance FROM route \r\n\t\t\t\t\t\t\tINNER JOIN cities_stats   ON cities_stats.cts_cty_id = route.rut_from_city_id\r\n\t\t\t\t\t\t\tAND rut_estm_distance < 300\r\n\t\t\t\t\t\t\tAND rut_active = 1\r\n\t\t\t\t\t\t\tAND route.rut_to_city_id=30804\r\n\t\t\t\t\t\t\tAND cities_stats.cts_vnd_cnt >= 3\r\n\t\t\t\t\t\t\tORDER BY rut_estm_distance LIMIT 10"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24435.087] [M: 29437.53] [ET: 0.475/24409.116] [MU: 6.68/29435.78] 
	SQL: SELECT a.*, fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
								tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address 
						FROM ((SELECT xyz.rut_from_city_id as startCity, r1.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r3.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_from_city_id
							INNER JOIN rate ON rate.rte_route_id=r1.rut_id  AND rate.rte_vehicletype_id IN (3)
							INNER JOIN route r2 ON r2.rut_to_city_id=r1.rut_to_city_id AND r2.rut_from_city_id=:dropCity AND r2.rut_active=1
							INNER JOIN route r3 ON r3.rut_from_city_id=xyz.rut_to_city_id AND r3.rut_to_city_id=r2.rut_from_city_id AND r3.rut_active=1
							ORDER BY ExtraDistance LIMIT 1
							)
							UNION
							(
							SELECT xyz.rut_from_city_id as startCity, r2.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r2.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_to_city_id AND r1.rut_to_city_id=:dropCity
							INNER JOIN route r2 ON r2.rut_to_city_id=xyz.rut_from_city_id AND r2.rut_from_city_id=r1.rut_to_city_id
							ORDER BY ExtraDistance ASC LIMIT 1
							)) a
						INNER JOIN cities fc ON startCity=fc.cty_id
						INNER JOIN cities tc ON endCity=tc.cty_id 
						ORDER BY ExtraDistance 
	 [params: {"pickupCity":"30804","dropCity":"30711"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24438.034] [M: 29448.88] [ET: 1.197/24412.067] [MU: 7.88/29448.77] 
	BookingRoute::calculateDistance
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24439.011] [M: 29454.45] [ET: 0.885/24413.046] [MU: 8.27/29454.34] 
	BookingRoute::calculateDistance
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24439.765] [M: 29462.07] [ET: 0.278/24413.794] [MU: 0.99/29461.7] 
	SQL: SELECT cts_airport_pickup_entry_fee
               FROM   cities
               INNER JOIN cities_stats
               ON cities.cty_id = cities_stats.cts_cty_id
               WHERE  cty_id = :cityId
               AND cty_is_airport = 1 AND cty_active = 1 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24441.351] [M: 29475.98] [ET: 1.008/24415.373] [MU: 8.14/29475.88] 
	BookingRoute::calculateDistance
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24442.78] [M: 29483.82] [ET: 1.304/24416.791] [MU: 8.07/29483.71] 
	BookingRoute::calculateDistance
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24443.411] [M: 29483.16] [ET: 0.509/24417.441] [MU: 0.9/29482.91] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24444.552] [M: 29495.87] [ET: 0.534/24418.585] [MU: 3.33/29495.43] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24445.157] [M: 29525.04] [ET: 0.485/24419.171] [MU: 22.53/29524.29] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp573)) OR (apr_area_type = 5 AND apr_area_id IN (:gp571)) OR (apr_area_type = 2 AND apr_area_id IN (:gp574)) OR (apr_area_type = 4 AND apr_area_id IN (:gp575)) OR (apr_area_type = 1 AND apr_area_id IN (:gp572))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp571":"3699",":gp572":"31",":gp573":"30804",":gp574":"105",":gp575":"1","cab":"97"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24446.622] [M: 29512.05] [ET: 0.447/24420.651] [MU: 3.34/29511.62] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24449.078] [M: 29522.6] [ET: 2.331/24423.082] [MU: 3.53/29521.73] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp578)) OR (scr_area_type = 5 AND scr_area_id IN (:gp576)) OR (scr_area_type = 2 AND scr_area_id IN (:gp579)) OR (scr_area_type = 4 AND scr_area_id IN (:gp580)) OR (scr_area_type = 1 AND scr_area_id IN (:gp577)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp576":"3699",":gp577":"31",":gp578":"3699",":gp579":"105",":gp580":"1","scv_id":"97"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24449.955] [M: 29525.81] [ET: 0.364/24423.974] [MU: 2.98/29525.7] 
	BookingRoute::calculateDistance
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24451.66] [M: 29538.83] [ET: 0.246/24425.698] [MU: 2.98/29538.72] 
	BookingRoute::calculateDistance
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24451.931] [M: 29542.91] [ET: 0.203/24425.971] [MU: 2.98/29542.8] 
	BookingRoute::calculateDistance
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24455.413] [M: 29576.87] [ET: 0.542/24429.439] [MU: 6.28/29574.87] 
	SQL: 
                SELECT cities.cty_id as c2id, cities.cty_name as c2name, cities.cty_garage_address as c2address,
                    cities.cty_id as c4id, cities.cty_name as c4name, cities.cty_garage_address as c4address,
                        (distance * 2) as totalExtraDistance
                 FROM (SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<40
                     INNER JOIN route r1 ON route.rut_to_city_id=r1.rut_from_city_id AND r1.rut_active=1
                     INNER JOIN rate ON r1.rut_id=rate.rte_route_id AND rate.rte_status=1  AND rate.rte_vehicletype_id IN (3) GROUP BY route.rut_id HAVING count(*) >30
                   UNION
                     SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<600
                     INNER JOIN cities tc ON tc.cty_id=route.rut_to_city_id AND tc.cty_service_active=1 AND CalcDistance(cities.cty_lat, cities.cty_long, tc.cty_lat, tc.cty_long)<=route.rut_estm_distance						 
                     INNER JOIN cities_stats ON cities_stats.cts_cty_id = route.rut_to_city_id AND cities_stats.cts_vnd_cnt >= 2
                   UNION
                    SELECT cts_cty_id AS city, 0 AS distance
					FROM cities_stats WHERE 1 AND cities_stats.cts_cty_id= 30817 and cities_stats.cts_vnd_cnt>1) a
                    INNER JOIN cities ON cities.cty_id=a.city
                    ORDER BY totalExtraDistance LIMIT 1 
	 [params: []]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24458.428] [M: 29591.68] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"3","tripDistance":"","tripDuration":"","multiCityData":"","bookingType":"1","pickupAddress":"","pickupDate":"31\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","sccId":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=3&tripDistance=&tripDuration=&multiCityData=&bookingType=1&pickupAddress=&pickupDate=31%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&sccId=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24458.94] [M: 29608.52] [ET: 1.003/24432.979] [MU: 18.05/29608.41] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24458.972] [M: 29610.2] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24460.008] [M: 29623.66] [ET: 0.898/24434.019] [MU: 3/29621.16] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+10013),(IF((cpm_value_type=2),(10013+(10013*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30937 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30937) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-31 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=97 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24461.479] [M: 29665.89] [ET: 3.606/24435.513] [MU: 75.88/29665.73] 
	RouteRates::calculate for CAB 97 2024-10-31 18:00:00 - Trip Type: 1 528121311
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24461.623] [M: 29643.58] [ET: 37.423/24435.664] [MU: 301.59/29643.42] 
	Quote::calculateRules for CAB 97, From City Id: 30804, To city Id: 30711
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24461.922] [M: 29615.3] [ET: 0.218/24435.957] [MU: 0.9/29615.05] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"97"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24461.997] [M: 29617.49] [ET: 66.674/24436.037] [MU: 456.01/29617.4] 
	Quote For CabType: 97
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24463.062] [M: 29627.84] [ET: 0.36/24437.096] [MU: 3.33/29627.4] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24463.453] [M: 29633.65] [ET: 0.324/24437.49] [MU: 3.33/29633.21] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30711"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24463.941] [M: 29636.59] [ET: 0.417/24437.975] [MU: 0.9/29636.34] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24464.509] [M: 29668.95] [ET: 0.458/24438.534] [MU: 24.22/29667.45] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (100) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30711) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp581)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp584,:gp585)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp582,:gp583)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp586,:gp587))
			OR (scr_area_type = 5 AND scr_area_id IN (3699))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (98)
		ORDER BY rank DESC
		 
	 [params: {":gp581":"31",":gp582":"30804",":gp583":"30711",":gp584":"105",":gp585":"100",":gp586":"1",":gp587":"1","tripType":"1"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24465.137] [M: 29649.13] [ET: 0.191/24439.173] [MU: 0.84/29648.94] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24465.475] [M: 29652] [ET: 0.266/24439.512] [MU: 0.96/29651.69] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"2"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24466.579] [M: 29664.75] [ET: 0.341/24440.614] [MU: 2.04/29664.25] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"98"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24469.193] [M: 29674.13] [ET: 2.412/24443.216] [MU: 3.53/29673.26] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"98","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24470.022] [M: 29677.38] [ET: 0.607/24444.052] [MU: 0.87/29677.16] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":0}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24470.682] [M: 29684.66] [ET: 0.492/24444.716] [MU: 2.97/29684.23] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24471.349] [M: 29712.84] [ET: 0.563/24445.382] [MU: 22.04/29712.21] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp589)) OR (apr_area_type = 2 AND apr_area_id IN (:gp590)) OR (apr_area_type = 4 AND apr_area_id IN (:gp591)) OR (apr_area_type = 1 AND apr_area_id IN (:gp588))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp588":"31",":gp589":"30804",":gp590":"105",":gp591":"1","cab":"98"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24472.303] [M: 29699.55] [ET: 0.426/24446.337] [MU: 3.34/29699.12] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24474.454] [M: 29709.84] [ET: 2.037/24448.477] [MU: 3.4/29708.96] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp593)) OR (scr_area_type = 2 AND scr_area_id IN (:gp594)) OR (scr_area_type = 4 AND scr_area_id IN (:gp595)) OR (scr_area_type = 1 AND scr_area_id IN (:gp592)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp592":"31",":gp593":"30804",":gp594":"105",":gp595":"1","scv_id":"98"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24477.627] [M: 29737.57] [ET: 2.051/24451.615] [MU: 0.74/29729.57] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"nearest_route_30804_30711","sql":"(INDEX indx_nearest_rt_rutid (rut_id)) \r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, routeFrom.rut_name as fromAlias, \r\n\t\t\t\tNULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, \r\n\t\t\t\t0 as rank, routeFrom.rut_estm_time as startTime, 0 as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 \r\n\t\t\t\tAND routeFrom.rut_from_city_id<>routeFrom.rut_to_city_id AND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\t\tAND (routeAlias.rut_to_city_id=route.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, NULL, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) \r\n\t\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\t0 AS extraStartDistance, 0, 0 as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND route.rut_from_city_id = 30804 AND route.rut_to_city_id=30711 \r\n\t\t\t\tAND routeTo.rut_from_city_id=30711\r\n\t\t\t\tAND route.rut_active = 1 AND routeTo.rut_active = 1 AND routeTo.rut_estm_distance < 50 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = route.rut_from_city_id) \r\n\t\t\t   AND (routeAlias.rut_to_city_id = routeTo.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, \r\n\t\t\t\trouteFrom.rut_name, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t+ IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) \r\n\t\t\t\tAS extraDistance, IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, 0, \r\n\t\t\t\trouteFrom.rut_estm_time as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 AND routeFrom.rut_from_city_id <> routeFrom.rut_to_city_id\r\n\t\t\t\t\tAND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND routeTo.rut_estm_distance < 50 \r\n\t\t\t\t\tAND routeTo.rut_from_city_id=30711 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\tAND (routeAlias.rut_to_city_id=routeTo.rut_to_city_id) AND routeAlias.rut_active = 1 AND routeAlias.rut_from_city_id=30804  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24480.26] [M: 29741.65] [ET: 2.493/24454.267] [MU: 2.16/29741.21] 
	SQL: SELECT *, (rte_vendor_amount + extraDistance * 10.55) as totalCost FROM (SELECT * FROM nearest_route_30804_30711) a
					INNER JOIN rate ON a.rut_id = rate.rte_route_id AND rte_status=1 AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <>0
					WHERE 1 ORDER BY rank DESC, totalCost ASC LIMIT 0,1 
	 [params: {"cabType":"98"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24481.018] [M: 29749.67] [ET: 0.612/24455.038] [MU: 0.74/29747.67] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"getNearestRoute_30804_30711_70","sql":"(INDEX getNearestRoute_30804_30711_70_index_rut_id (rut_id))\r\n\t\t\t\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id AS start, routeAlias.rut_to_city_id AS end,\r\n\t\t\t\t\t\t\t\trouteFrom.rut_name AS fromAlias, NULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance AS quotedDistance,\r\n\t\t\t\t\t\t\t\trouteAlias.rut_estm_distance AS rateDistance, \r\n\t\t\t\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance)\r\n\t\t\t\t\t\t\t\t\t - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance,\r\n\t\t\t\t\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance,\r\n\t\t\t\t\t\t\t\t0 AS rank, routeFrom.rut_estm_time AS startTime, 0 AS endTime, route.rut_estm_time, \r\n\t\t\t\t\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraTravelDistance\r\n\t\t\t\t\t\tFROM   route\r\n\t\t\t\t\t\tINNER JOIN route routeTo ON routeTo.rut_to_city_id=route.rut_from_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_from_city_id=30804 AND routeTo.rut_active=1\r\n\t\t\t\t\t\t\t\tAND routeTo.rut_estm_distance<70 AND route.rut_active=1\r\n\t\t\t\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_from_city_id=route.rut_to_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_active = 1\r\n\t\t\t\t\t\t\t\tAND routeFrom.rut_estm_distance<70 AND route.rut_active = 1\r\n\t\t\t\t\t\tINNER JOIN route routeAlias ON routeAlias.rut_to_city_id=routeFrom.rut_to_city_id\r\n\t\t\t\t\t\t\tAND routeAlias.rut_from_city_id=routeTo.rut_from_city_id AND routeAlias.rut_active = 1"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24483.344] [M: 29754.94] [ET: 2.236/24457.371] [MU: 2.42/29754.31] 
	SQL: SELECT *, (rte_vendor_amount + extradistance * 10.55 ) AS totalCost, 
						ABS(quotedDistance-rateDistance) AS extraChargeableDistance
					FROM getNearestRoute_30804_30711_70 a
					INNER JOIN rate ON a.rut_id=rate.rte_route_id AND rte_status=1 
						AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <> 0
					WHERE  1
					ORDER  BY rank DESC, extraStartDistance, extraChargeableDistance ASC, totalcost ASC
					LIMIT  0, 1 
	 [params: {"cabType":"98"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24488.22] [M: 29770.02] [ET: 0.495/24462.251] [MU: 3.41/29769.15] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"16","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24490.158] [M: 29786.64] [ET: 0.86/24464.182] [MU: 3.78/29785.77] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24492.177] [M: 29797.74] [ET: 25.516/24466.197] [MU: 131.57/29797.59] 
	Quote::calculateOneWay  for CAB 98 Date: 2024-10-31 18:00:00
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24493.166] [M: 29801.34] [ET: 0.827/24467.176] [MU: 0.9/29801.09] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24494.903] [M: 29814.05] [ET: 0.756/24468.914] [MU: 3.33/29813.61] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24495.774] [M: 29843.22] [ET: 0.704/24469.78] [MU: 22.53/29842.47] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp598)) OR (apr_area_type = 5 AND apr_area_id IN (:gp596)) OR (apr_area_type = 2 AND apr_area_id IN (:gp599)) OR (apr_area_type = 4 AND apr_area_id IN (:gp600)) OR (apr_area_type = 1 AND apr_area_id IN (:gp597))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp596":"3699",":gp597":"31",":gp598":"30804",":gp599":"105",":gp600":"1","cab":"98"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24499.683] [M: 29830.23] [ET: 1.483/24473.69] [MU: 3.34/29829.8] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24507.484] [M: 29840.78] [ET: 7.606/24481.476] [MU: 3.53/29839.91] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp603)) OR (scr_area_type = 5 AND scr_area_id IN (:gp601)) OR (scr_area_type = 2 AND scr_area_id IN (:gp604)) OR (scr_area_type = 4 AND scr_area_id IN (:gp605)) OR (scr_area_type = 1 AND scr_area_id IN (:gp602)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp601":"3699",":gp602":"31",":gp603":"3699",":gp604":"105",":gp605":"1","scv_id":"98"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24511.499] [M: 29841.95] [ET: 3.25/24485.488] [MU: 2.98/29841.84] 
	BookingRoute::calculateDistance
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24514.915] [M: 29852.06] [ET: 0.925/24488.939] [MU: 2.79/29851.44] 
	SQL: SELECT 
						fc.cty_id as c2id, 
						fc.cty_name as c2name, 
						fc.cty_garage_address as c2address,
						tc.cty_id as c4id,
						tc.cty_name as c4name, tc.cty_garage_address as c4address,
						0 as totalExtraDistance FROM route
						INNER JOIN cities fc ON rut_from_city_id=fc.cty_id
						INNER JOIN cities tc ON rut_to_city_id=tc.cty_id
						INNER JOIN rate on  rate.rte_route_id=route.rut_id  AND rate.rte_vehicletype_id IN (3)
						WHERE route.rut_from_city_id=30804 AND route.rut_to_city_id=30711 AND route.rut_active=1 
	 [params: []]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24515.894] [M: 29865.95] [ET: 0.828/24489.887] [MU: 6.53/29863.95] 
	SQL: 
				SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address, tc.cty_id as c4id, 
				tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
					FROM
					 (
						(
							SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id,  
								r3.rut_to_city_id, route.rut_name , route.rut_id,
								(route.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, 
								r3.rut_estm_distance
							FROM route
							INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_from_city_id=30804  
									AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=route.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) 
									AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
						UNION
						(
							SELECT r3.rut_id, r3.rut_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,(route.rut_estm_distance + r1.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
							FROM route
							INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND  route.rut_to_city_id=30711 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND route.rut_to_city_id=r3.rut_to_city_id))	AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
                     ) a
					INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
					INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1 
	 [params: []]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24516.996] [M: 29876.45] [ET: 0.97/24491.003] [MU: 5.04/29874.95] 
	SQL: SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
                              tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
                        FROM (SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,
                                    (route.rut_estm_distance + r1.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
                                FROM route
								INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
								INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
								INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) AND r3.rut_active=1 
								INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3) LIMIT 1
							)a
                        INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
                        INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1
                         
	 [params: []]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24517.922] [M: 29882.83] [ET: 0.808/24491.907] [MU: 0.75/29881.95] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"GarageRoute_30804_30711","sql":" (INDEX GarageRoute_30804_30711_index_rut_id (rut_id), INDEX GarageRoute_30804_30711_index_rut_from_city_id (rut_from_city_id), INDEX GarageRoute_30804_30711_index_rut_to_city_id (rut_to_city_id))\r\n\t\t\t\t\t\t\tSELECT route.rut_id, route.rut_from_city_id, route.rut_to_city_id, route.rut_name, rut_estm_distance FROM route \r\n\t\t\t\t\t\t\tINNER JOIN cities_stats   ON cities_stats.cts_cty_id = route.rut_from_city_id\r\n\t\t\t\t\t\t\tAND rut_estm_distance < 300\r\n\t\t\t\t\t\t\tAND rut_active = 1\r\n\t\t\t\t\t\t\tAND route.rut_to_city_id=30804\r\n\t\t\t\t\t\t\tAND cities_stats.cts_vnd_cnt >= 3\r\n\t\t\t\t\t\t\tORDER BY rut_estm_distance LIMIT 10"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24519.154] [M: 29894.75] [ET: 1.073/24493.138] [MU: 6.68/29893] 
	SQL: SELECT a.*, fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
								tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address 
						FROM ((SELECT xyz.rut_from_city_id as startCity, r1.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r3.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_from_city_id
							INNER JOIN rate ON rate.rte_route_id=r1.rut_id  AND rate.rte_vehicletype_id IN (3)
							INNER JOIN route r2 ON r2.rut_to_city_id=r1.rut_to_city_id AND r2.rut_from_city_id=:dropCity AND r2.rut_active=1
							INNER JOIN route r3 ON r3.rut_from_city_id=xyz.rut_to_city_id AND r3.rut_to_city_id=r2.rut_from_city_id AND r3.rut_active=1
							ORDER BY ExtraDistance LIMIT 1
							)
							UNION
							(
							SELECT xyz.rut_from_city_id as startCity, r2.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r2.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_to_city_id AND r1.rut_to_city_id=:dropCity
							INNER JOIN route r2 ON r2.rut_to_city_id=xyz.rut_from_city_id AND r2.rut_from_city_id=r1.rut_to_city_id
							ORDER BY ExtraDistance ASC LIMIT 1
							)) a
						INNER JOIN cities fc ON startCity=fc.cty_id
						INNER JOIN cities tc ON endCity=tc.cty_id 
						ORDER BY ExtraDistance 
	 [params: {"pickupCity":"30804","dropCity":"30711"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24533.083] [M: 29906.09] [ET: 9.423/24507.09] [MU: 7.89/29905.98] 
	BookingRoute::calculateDistance
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24536.179] [M: 29911.57] [ET: 2.878/24510.186] [MU: 8.26/29911.46] 
	BookingRoute::calculateDistance
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24540.576] [M: 29919.2] [ET: 1.507/24514.556] [MU: 0.99/29918.82] 
	SQL: SELECT cts_airport_pickup_entry_fee
               FROM   cities
               INNER JOIN cities_stats
               ON cities.cty_id = cities_stats.cts_cty_id
               WHERE  cty_id = :cityId
               AND cty_is_airport = 1 AND cty_active = 1 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24546.01] [M: 29933.11] [ET: 3.794/24519.998] [MU: 8.13/29933] 
	BookingRoute::calculateDistance
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24547.983] [M: 29940.85] [ET: 1.633/24521.892] [MU: 8.07/29940.74] 
	BookingRoute::calculateDistance
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24549.675] [M: 29940.28] [ET: 1.495/24523.662] [MU: 0.89/29940.03] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24552.574] [M: 29952.99] [ET: 1/24526.586] [MU: 3.34/29952.55] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24553.864] [M: 29982.16] [ET: 1.11/24527.866] [MU: 22.53/29981.41] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp608)) OR (apr_area_type = 5 AND apr_area_id IN (:gp606)) OR (apr_area_type = 2 AND apr_area_id IN (:gp609)) OR (apr_area_type = 4 AND apr_area_id IN (:gp610)) OR (apr_area_type = 1 AND apr_area_id IN (:gp607))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp606":"3699",":gp607":"31",":gp608":"30804",":gp609":"105",":gp610":"1","cab":"98"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24558.209] [M: 29969.18] [ET: 1.085/24532.197] [MU: 3.33/29968.74] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24580.562] [M: 29979.73] [ET: 21.196/24554.546] [MU: 3.53/29978.85] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp613)) OR (scr_area_type = 5 AND scr_area_id IN (:gp611)) OR (scr_area_type = 2 AND scr_area_id IN (:gp614)) OR (scr_area_type = 4 AND scr_area_id IN (:gp615)) OR (scr_area_type = 1 AND scr_area_id IN (:gp612)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp611":"3699",":gp612":"31",":gp613":"3699",":gp614":"105",":gp615":"1","scv_id":"98"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24582.119] [M: 29982.94] [ET: 0.636/24556.131] [MU: 2.98/29982.83] 
	BookingRoute::calculateDistance
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24587.365] [M: 29996.05] [ET: 0.738/24561.351] [MU: 2.98/29995.94] 
	BookingRoute::calculateDistance
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24588.047] [M: 30000.22] [ET: 0.516/24562.06] [MU: 2.97/30000.11] 
	BookingRoute::calculateDistance
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24606.857] [M: 30034.18] [ET: 1.568/24580.853] [MU: 6.28/30032.18] 
	SQL: 
                SELECT cities.cty_id as c2id, cities.cty_name as c2name, cities.cty_garage_address as c2address,
                    cities.cty_id as c4id, cities.cty_name as c4name, cities.cty_garage_address as c4address,
                        (distance * 2) as totalExtraDistance
                 FROM (SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<40
                     INNER JOIN route r1 ON route.rut_to_city_id=r1.rut_from_city_id AND r1.rut_active=1
                     INNER JOIN rate ON r1.rut_id=rate.rte_route_id AND rate.rte_status=1  AND rate.rte_vehicletype_id IN (3) GROUP BY route.rut_id HAVING count(*) >30
                   UNION
                     SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<600
                     INNER JOIN cities tc ON tc.cty_id=route.rut_to_city_id AND tc.cty_service_active=1 AND CalcDistance(cities.cty_lat, cities.cty_long, tc.cty_lat, tc.cty_long)<=route.rut_estm_distance						 
                     INNER JOIN cities_stats ON cities_stats.cts_cty_id = route.rut_to_city_id AND cities_stats.cts_vnd_cnt >= 2
                   UNION
                    SELECT cts_cty_id AS city, 0 AS distance
					FROM cities_stats WHERE 1 AND cities_stats.cts_cty_id= 30817 and cities_stats.cts_vnd_cnt>1) a
                    INNER JOIN cities ON cities.cty_id=a.city
                    ORDER BY totalExtraDistance LIMIT 1 
	 [params: []]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24628.427] [M: 30048.99] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"3","tripDistance":"","tripDuration":"","multiCityData":"","bookingType":"1","pickupAddress":"","pickupDate":"31\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","sccId":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=3&tripDistance=&tripDuration=&multiCityData=&bookingType=1&pickupAddress=&pickupDate=31%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&sccId=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24630.186] [M: 30065.84] [ET: 6.269/24604.196] [MU: 18.05/30065.73] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24630.249] [M: 30067.52] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24639.629] [M: 30080.98] [ET: 9.045/24613.624] [MU: 2.99/30078.48] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+10013),(IF((cpm_value_type=2),(10013+(10013*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30937 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30937) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-31 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=98 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24647.715] [M: 30123.2] [ET: 23.893/24621.721] [MU: 75.88/30123.05] 
	RouteRates::calculate for CAB 98 2024-10-31 18:00:00 - Trip Type: 1 398937716
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24648.138] [M: 30100.89] [ET: 155.854/24622.152] [MU: 301.6/30100.73] 
	Quote::calculateRules for CAB 98, From City Id: 30804, To city Id: 30711
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24650.84] [M: 30072.62] [ET: 2.55/24624.839] [MU: 0.9/30072.37] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"98"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24650.989] [M: 30074.8] [ET: 188.922/24625.004] [MU: 456/30074.71] 
	Quote For CabType: 98
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24653.938] [M: 30085.15] [ET: 1.191/24627.879] [MU: 3.33/30084.71] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24655.562] [M: 30090.96] [ET: 1.442/24629.566] [MU: 3.34/30090.52] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30711"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24659.475] [M: 30093.9] [ET: 3.358/24633.143] [MU: 0.9/30093.65] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24665.59] [M: 30126.26] [ET: 5.127/24639.458] [MU: 24.22/30124.76] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (100) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30711) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp616)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp619,:gp620)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp617,:gp618)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp621,:gp622))
			OR (scr_area_type = 5 AND scr_area_id IN (3699))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (99)
		ORDER BY rank DESC
		 
	 [params: {":gp616":"31",":gp617":"30804",":gp618":"30711",":gp619":"105",":gp620":"100",":gp621":"1",":gp622":"1","tripType":"1"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24669.664] [M: 30106.44] [ET: 1.338/24643.637] [MU: 0.83/30106.25] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24671.465] [M: 30109.31] [ET: 1.606/24645.464] [MU: 0.96/30109] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"2"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24677.611] [M: 30122.06] [ET: 3.289/24651.59] [MU: 2.05/30121.56] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"99"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24688.471] [M: 30131.45] [ET: 10.159/24662.46] [MU: 3.53/30130.57] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"99","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24691.265] [M: 30134.7] [ET: 2.149/24665.192] [MU: 0.87/30134.48] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":0}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24695.026] [M: 30141.98] [ET: 1.864/24669.03] [MU: 2.97/30141.54] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24706.983] [M: 30170.15] [ET: 11.606/24680.984] [MU: 22.05/30169.52] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp624)) OR (apr_area_type = 2 AND apr_area_id IN (:gp625)) OR (apr_area_type = 4 AND apr_area_id IN (:gp626)) OR (apr_area_type = 1 AND apr_area_id IN (:gp623))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp623":"31",":gp624":"30804",":gp625":"105",":gp626":"1","cab":"99"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24711.567] [M: 30156.87] [ET: 1.826/24685.461] [MU: 3.33/30156.43] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24723.214] [M: 30167.15] [ET: 10.834/24697.152] [MU: 3.41/30166.27] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp628)) OR (scr_area_type = 2 AND scr_area_id IN (:gp629)) OR (scr_area_type = 4 AND scr_area_id IN (:gp630)) OR (scr_area_type = 1 AND scr_area_id IN (:gp627)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp627":"31",":gp628":"30804",":gp629":"105",":gp630":"1","scv_id":"99"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24935.356] [M: 30194.88] [ET: 208.253/24909.333] [MU: 0.75/30186.88] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"nearest_route_30804_30711","sql":"(INDEX indx_nearest_rt_rutid (rut_id)) \r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, routeFrom.rut_name as fromAlias, \r\n\t\t\t\tNULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, \r\n\t\t\t\t0 as rank, routeFrom.rut_estm_time as startTime, 0 as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 \r\n\t\t\t\tAND routeFrom.rut_from_city_id<>routeFrom.rut_to_city_id AND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\t\tAND (routeAlias.rut_to_city_id=route.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, NULL, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) \r\n\t\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\t0 AS extraStartDistance, 0, 0 as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND route.rut_from_city_id = 30804 AND route.rut_to_city_id=30711 \r\n\t\t\t\tAND routeTo.rut_from_city_id=30711\r\n\t\t\t\tAND route.rut_active = 1 AND routeTo.rut_active = 1 AND routeTo.rut_estm_distance < 50 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = route.rut_from_city_id) \r\n\t\t\t   AND (routeAlias.rut_to_city_id = routeTo.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, \r\n\t\t\t\trouteFrom.rut_name, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t+ IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) \r\n\t\t\t\tAS extraDistance, IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, 0, \r\n\t\t\t\trouteFrom.rut_estm_time as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 AND routeFrom.rut_from_city_id <> routeFrom.rut_to_city_id\r\n\t\t\t\t\tAND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND routeTo.rut_estm_distance < 50 \r\n\t\t\t\t\tAND routeTo.rut_from_city_id=30711 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\tAND (routeAlias.rut_to_city_id=routeTo.rut_to_city_id) AND routeAlias.rut_active = 1 AND routeAlias.rut_from_city_id=30804  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24943.612] [M: 30198.96] [ET: 8.101/24917.611] [MU: 2.17/30198.52] 
	SQL: SELECT *, (rte_vendor_amount + extraDistance * 10.55) as totalCost FROM (SELECT * FROM nearest_route_30804_30711) a
					INNER JOIN rate ON a.rut_id = rate.rte_route_id AND rte_status=1 AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <>0
					WHERE 1 ORDER BY rank DESC, totalCost ASC LIMIT 0,1 
	 [params: {"cabType":"99"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24950.07] [M: 30206.98] [ET: 6.274/24924.064] [MU: 0.75/30204.98] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"getNearestRoute_30804_30711_70","sql":"(INDEX getNearestRoute_30804_30711_70_index_rut_id (rut_id))\r\n\t\t\t\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id AS start, routeAlias.rut_to_city_id AS end,\r\n\t\t\t\t\t\t\t\trouteFrom.rut_name AS fromAlias, NULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance AS quotedDistance,\r\n\t\t\t\t\t\t\t\trouteAlias.rut_estm_distance AS rateDistance, \r\n\t\t\t\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance)\r\n\t\t\t\t\t\t\t\t\t - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance,\r\n\t\t\t\t\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance,\r\n\t\t\t\t\t\t\t\t0 AS rank, routeFrom.rut_estm_time AS startTime, 0 AS endTime, route.rut_estm_time, \r\n\t\t\t\t\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraTravelDistance\r\n\t\t\t\t\t\tFROM   route\r\n\t\t\t\t\t\tINNER JOIN route routeTo ON routeTo.rut_to_city_id=route.rut_from_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_from_city_id=30804 AND routeTo.rut_active=1\r\n\t\t\t\t\t\t\t\tAND routeTo.rut_estm_distance<70 AND route.rut_active=1\r\n\t\t\t\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_from_city_id=route.rut_to_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_active = 1\r\n\t\t\t\t\t\t\t\tAND routeFrom.rut_estm_distance<70 AND route.rut_active = 1\r\n\t\t\t\t\t\tINNER JOIN route routeAlias ON routeAlias.rut_to_city_id=routeFrom.rut_to_city_id\r\n\t\t\t\t\t\t\tAND routeAlias.rut_from_city_id=routeTo.rut_from_city_id AND routeAlias.rut_active = 1"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24957.07] [M: 30212.25] [ET: 6.857/24931.07] [MU: 2.42/30211.63] 
	SQL: SELECT *, (rte_vendor_amount + extradistance * 10.55 ) AS totalCost, 
						ABS(quotedDistance-rateDistance) AS extraChargeableDistance
					FROM getNearestRoute_30804_30711_70 a
					INNER JOIN rate ON a.rut_id=rate.rte_route_id AND rte_status=1 
						AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <> 0
					WHERE  1
					ORDER  BY rank DESC, extraStartDistance, extraChargeableDistance ASC, totalcost ASC
					LIMIT  0, 1 
	 [params: {"cabType":"99"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24964.382] [M: 30227.34] [ET: 0.832/24938.386] [MU: 3.41/30226.46] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"16","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24967.193] [M: 30499.95] [ET: 0.78/24941.203] [MU: 259.78/30499.08] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24968.934] [M: 30511.05] [ET: 291.146/24942.973] [MU: 387.57/30510.9] 
	Quote::calculateOneWay  for CAB 99 Date: 2024-10-31 18:00:00
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24969.51] [M: 30514.62] [ET: 0.48/24943.543] [MU: 0.9/30514.4] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24970.618] [M: 30527.36] [ET: 0.513/24944.651] [MU: 3.33/30526.92] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24971.216] [M: 30556.53] [ET: 0.495/24945.249] [MU: 22.53/30555.78] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp633)) OR (apr_area_type = 5 AND apr_area_id IN (:gp631)) OR (apr_area_type = 2 AND apr_area_id IN (:gp634)) OR (apr_area_type = 4 AND apr_area_id IN (:gp635)) OR (apr_area_type = 1 AND apr_area_id IN (:gp632))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp631":"3699",":gp632":"31",":gp633":"30804",":gp634":"105",":gp635":"1","cab":"99"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24972.578] [M: 30543.55] [ET: 0.457/24946.613] [MU: 3.33/30543.11] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24975.108] [M: 30554.09] [ET: 2.408/24949.113] [MU: 3.53/30553.22] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp638)) OR (scr_area_type = 5 AND scr_area_id IN (:gp636)) OR (scr_area_type = 2 AND scr_area_id IN (:gp639)) OR (scr_area_type = 4 AND scr_area_id IN (:gp640)) OR (scr_area_type = 1 AND scr_area_id IN (:gp637)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp636":"3699",":gp637":"31",":gp638":"3699",":gp639":"105",":gp640":"1","scv_id":"99"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24976.365] [M: 30555.27] [ET: 0.448/24950.385] [MU: 2.98/30555.16] 
	BookingRoute::calculateDistance
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24977.951] [M: 30565.47] [ET: 0.502/24951.983] [MU: 2.79/30564.84] 
	SQL: SELECT 
						fc.cty_id as c2id, 
						fc.cty_name as c2name, 
						fc.cty_garage_address as c2address,
						tc.cty_id as c4id,
						tc.cty_name as c4name, tc.cty_garage_address as c4address,
						0 as totalExtraDistance FROM route
						INNER JOIN cities fc ON rut_from_city_id=fc.cty_id
						INNER JOIN cities tc ON rut_to_city_id=tc.cty_id
						INNER JOIN rate on  rate.rte_route_id=route.rut_id  AND rate.rte_vehicletype_id IN (3)
						WHERE route.rut_from_city_id=30804 AND route.rut_to_city_id=30711 AND route.rut_active=1 
	 [params: []]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24978.402] [M: 30579.35] [ET: 0.376/24952.432] [MU: 6.53/30577.35] 
	SQL: 
				SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address, tc.cty_id as c4id, 
				tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
					FROM
					 (
						(
							SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id,  
								r3.rut_to_city_id, route.rut_name , route.rut_id,
								(route.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, 
								r3.rut_estm_distance
							FROM route
							INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_from_city_id=30804  
									AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=route.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) 
									AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
						UNION
						(
							SELECT r3.rut_id, r3.rut_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,(route.rut_estm_distance + r1.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
							FROM route
							INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND  route.rut_to_city_id=30711 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND route.rut_to_city_id=r3.rut_to_city_id))	AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
                     ) a
					INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
					INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1 
	 [params: []]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24978.809] [M: 30589.86] [ET: 0.335/24952.841] [MU: 5.03/30588.36] 
	SQL: SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
                              tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
                        FROM (SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,
                                    (route.rut_estm_distance + r1.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
                                FROM route
								INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
								INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
								INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) AND r3.rut_active=1 
								INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3) LIMIT 1
							)a
                        INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
                        INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1
                         
	 [params: []]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24979.345] [M: 30596.23] [ET: 0.464/24953.376] [MU: 0.74/30595.36] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"GarageRoute_30804_30711","sql":" (INDEX GarageRoute_30804_30711_index_rut_id (rut_id), INDEX GarageRoute_30804_30711_index_rut_from_city_id (rut_from_city_id), INDEX GarageRoute_30804_30711_index_rut_to_city_id (rut_to_city_id))\r\n\t\t\t\t\t\t\tSELECT route.rut_id, route.rut_from_city_id, route.rut_to_city_id, route.rut_name, rut_estm_distance FROM route \r\n\t\t\t\t\t\t\tINNER JOIN cities_stats   ON cities_stats.cts_cty_id = route.rut_from_city_id\r\n\t\t\t\t\t\t\tAND rut_estm_distance < 300\r\n\t\t\t\t\t\t\tAND rut_active = 1\r\n\t\t\t\t\t\t\tAND route.rut_to_city_id=30804\r\n\t\t\t\t\t\t\tAND cities_stats.cts_vnd_cnt >= 3\r\n\t\t\t\t\t\t\tORDER BY rut_estm_distance LIMIT 10"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24979.862] [M: 30608.16] [ET: 0.444/24953.878] [MU: 6.69/30606.41] 
	SQL: SELECT a.*, fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
								tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address 
						FROM ((SELECT xyz.rut_from_city_id as startCity, r1.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r3.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_from_city_id
							INNER JOIN rate ON rate.rte_route_id=r1.rut_id  AND rate.rte_vehicletype_id IN (3)
							INNER JOIN route r2 ON r2.rut_to_city_id=r1.rut_to_city_id AND r2.rut_from_city_id=:dropCity AND r2.rut_active=1
							INNER JOIN route r3 ON r3.rut_from_city_id=xyz.rut_to_city_id AND r3.rut_to_city_id=r2.rut_from_city_id AND r3.rut_active=1
							ORDER BY ExtraDistance LIMIT 1
							)
							UNION
							(
							SELECT xyz.rut_from_city_id as startCity, r2.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r2.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_to_city_id AND r1.rut_to_city_id=:dropCity
							INNER JOIN route r2 ON r2.rut_to_city_id=xyz.rut_from_city_id AND r2.rut_from_city_id=r1.rut_to_city_id
							ORDER BY ExtraDistance ASC LIMIT 1
							)) a
						INNER JOIN cities fc ON startCity=fc.cty_id
						INNER JOIN cities tc ON endCity=tc.cty_id 
						ORDER BY ExtraDistance 
	 [params: {"pickupCity":"30804","dropCity":"30711"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24982.731] [M: 30619.5] [ET: 1.251/24956.747] [MU: 7.88/30619.39] 
	BookingRoute::calculateDistance
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24983.899] [M: 30624.98] [ET: 1.01/24957.917] [MU: 8.27/30624.87] 
	BookingRoute::calculateDistance
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24984.721] [M: 30632.51] [ET: 0.302/24958.737] [MU: 1/30632.13] 
	SQL: SELECT cts_airport_pickup_entry_fee
               FROM   cities
               INNER JOIN cities_stats
               ON cities.cty_id = cities_stats.cts_cty_id
               WHERE  cty_id = :cityId
               AND cty_is_airport = 1 AND cty_active = 1 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24986.604] [M: 30646.42] [ET: 1.14/24960.622] [MU: 8.14/30646.31] 
	BookingRoute::calculateDistance
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24987.774] [M: 30654.16] [ET: 1.022/24961.79] [MU: 8.08/30654.05] 
	BookingRoute::calculateDistance
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24988.262] [M: 30653.5] [ET: 0.356/24962.281] [MU: 0.9/30653.25] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24989.676] [M: 30666.21] [ET: 0.68/24963.692] [MU: 3.34/30665.77] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24990.378] [M: 30695.38] [ET: 0.535/24964.408] [MU: 22.54/30694.63] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp643)) OR (apr_area_type = 5 AND apr_area_id IN (:gp641)) OR (apr_area_type = 2 AND apr_area_id IN (:gp644)) OR (apr_area_type = 4 AND apr_area_id IN (:gp645)) OR (apr_area_type = 1 AND apr_area_id IN (:gp642))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp641":"3699",":gp642":"31",":gp643":"30804",":gp644":"105",":gp645":"1","cab":"99"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24992.861] [M: 30682.4] [ET: 0.718/24966.874] [MU: 3.33/30681.96] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24996.18] [M: 30692.95] [ET: 3.136/24970.18] [MU: 3.53/30692.07] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp648)) OR (scr_area_type = 5 AND scr_area_id IN (:gp646)) OR (scr_area_type = 2 AND scr_area_id IN (:gp649)) OR (scr_area_type = 4 AND scr_area_id IN (:gp650)) OR (scr_area_type = 1 AND scr_area_id IN (:gp647)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp646":"3699",":gp647":"31",":gp648":"3699",":gp649":"105",":gp650":"1","scv_id":"99"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24997.244] [M: 30696.16] [ET: 0.477/24971.257] [MU: 2.98/30696.05] 
	BookingRoute::calculateDistance
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 24999.619] [M: 30709.27] [ET: 0.455/24973.634] [MU: 2.98/30709.16] 
	BookingRoute::calculateDistance
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25000.154] [M: 30713.44] [ET: 0.404/24974.171] [MU: 2.98/30713.33] 
	BookingRoute::calculateDistance
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25005.507] [M: 30747.49] [ET: 0.798/24979.507] [MU: 6.28/30745.49] 
	SQL: 
                SELECT cities.cty_id as c2id, cities.cty_name as c2name, cities.cty_garage_address as c2address,
                    cities.cty_id as c4id, cities.cty_name as c4name, cities.cty_garage_address as c4address,
                        (distance * 2) as totalExtraDistance
                 FROM (SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<40
                     INNER JOIN route r1 ON route.rut_to_city_id=r1.rut_from_city_id AND r1.rut_active=1
                     INNER JOIN rate ON r1.rut_id=rate.rte_route_id AND rate.rte_status=1  AND rate.rte_vehicletype_id IN (3) GROUP BY route.rut_id HAVING count(*) >30
                   UNION
                     SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<600
                     INNER JOIN cities tc ON tc.cty_id=route.rut_to_city_id AND tc.cty_service_active=1 AND CalcDistance(cities.cty_lat, cities.cty_long, tc.cty_lat, tc.cty_long)<=route.rut_estm_distance						 
                     INNER JOIN cities_stats ON cities_stats.cts_cty_id = route.rut_to_city_id AND cities_stats.cts_vnd_cnt >= 2
                   UNION
                    SELECT cts_cty_id AS city, 0 AS distance
					FROM cities_stats WHERE 1 AND cities_stats.cts_cty_id= 30817 and cities_stats.cts_vnd_cnt>1) a
                    INNER JOIN cities ON cities.cty_id=a.city
                    ORDER BY totalExtraDistance LIMIT 1 
	 [params: []]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25009.795] [M: 30762.3] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"3","tripDistance":"","tripDuration":"","multiCityData":"","bookingType":"1","pickupAddress":"","pickupDate":"31\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","sccId":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=3&tripDistance=&tripDuration=&multiCityData=&bookingType=1&pickupAddress=&pickupDate=31%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&sccId=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25010.524] [M: 30779.15] [ET: 1.362/24984.536] [MU: 18.05/30779.04] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25010.58] [M: 30780.83] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25011.993] [M: 30794.29] [ET: 1.211/24985.995] [MU: 2.99/30791.79] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+10013),(IF((cpm_value_type=2),(10013+(10013*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30937 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30937) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-31 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=99 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25013.88] [M: 30836.52] [ET: 4.824/24987.899] [MU: 75.87/30836.36] 
	RouteRates::calculate for CAB 99 2024-10-31 18:00:00 - Trip Type: 1 221977967
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25014.11] [M: 30814.2] [ET: 45.104/24988.133] [MU: 301.59/30814.05] 
	Quote::calculateRules for CAB 99, From City Id: 30804, To city Id: 30711
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25014.484] [M: 30785.93] [ET: 0.271/24988.518] [MU: 0.9/30785.68] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"99"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25014.557] [M: 30788.12] [ET: 363.451/24988.598] [MU: 712.01/30788.02] 
	Quote For CabType: 99
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25015.682] [M: 30798.46] [ET: 0.383/24989.715] [MU: 3.34/30798.02] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25016.111] [M: 30804.27] [ET: 0.36/24990.146] [MU: 3.34/30803.84] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30711"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25016.639] [M: 30807.21] [ET: 0.443/24990.655] [MU: 0.89/30806.96] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25017.301] [M: 30839.57] [ET: 0.519/24991.331] [MU: 24.22/30838.07] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (100) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30711) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp651)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp654,:gp655)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp652,:gp653)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp656,:gp657))
			OR (scr_area_type = 5 AND scr_area_id IN (3699))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (108)
		ORDER BY rank DESC
		 
	 [params: {":gp651":"31",":gp652":"30804",":gp653":"30711",":gp654":"105",":gp655":"100",":gp656":"1",":gp657":"1","tripType":"1"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25017.952] [M: 30819.77] [ET: 0.209/24991.988] [MU: 0.84/30819.58] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25018.294] [M: 30822.61] [ET: 0.258/24992.313] [MU: 0.93/30822.3] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"6"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25019.712] [M: 30835.45] [ET: 0.337/24993.743] [MU: 2.05/30834.95] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"108"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25022.398] [M: 30844.83] [ET: 2.462/24996.413] [MU: 3.54/30843.95] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"108","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25023.174] [M: 30848.08] [ET: 0.541/24997.2] [MU: 0.87/30847.86] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":0}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25024.119] [M: 30855.36] [ET: 0.688/24998.133] [MU: 2.96/30854.92] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25025.316] [M: 30883.53] [ET: 1.012/24999.312] [MU: 22.05/30882.91] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp659)) OR (apr_area_type = 2 AND apr_area_id IN (:gp660)) OR (apr_area_type = 4 AND apr_area_id IN (:gp661)) OR (apr_area_type = 1 AND apr_area_id IN (:gp658))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp658":"31",":gp659":"30804",":gp660":"105",":gp661":"1","cab":"108"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25026.625] [M: 30870.27] [ET: 0.501/25000.658] [MU: 3.34/30869.83] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25028.978] [M: 30880.55] [ET: 2.221/25002.977] [MU: 3.4/30879.67] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp663)) OR (scr_area_type = 2 AND scr_area_id IN (:gp664)) OR (scr_area_type = 4 AND scr_area_id IN (:gp665)) OR (scr_area_type = 1 AND scr_area_id IN (:gp662)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp662":"31",":gp663":"30804",":gp664":"105",":gp665":"1","scv_id":"108"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25031.805] [M: 30908.27] [ET: 1.88/25005.796] [MU: 0.74/30900.27] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"nearest_route_30804_30711","sql":"(INDEX indx_nearest_rt_rutid (rut_id)) \r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, routeFrom.rut_name as fromAlias, \r\n\t\t\t\tNULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, \r\n\t\t\t\t0 as rank, routeFrom.rut_estm_time as startTime, 0 as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 \r\n\t\t\t\tAND routeFrom.rut_from_city_id<>routeFrom.rut_to_city_id AND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\t\tAND (routeAlias.rut_to_city_id=route.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, NULL, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) \r\n\t\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\t0 AS extraStartDistance, 0, 0 as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND route.rut_from_city_id = 30804 AND route.rut_to_city_id=30711 \r\n\t\t\t\tAND routeTo.rut_from_city_id=30711\r\n\t\t\t\tAND route.rut_active = 1 AND routeTo.rut_active = 1 AND routeTo.rut_estm_distance < 50 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = route.rut_from_city_id) \r\n\t\t\t   AND (routeAlias.rut_to_city_id = routeTo.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, \r\n\t\t\t\trouteFrom.rut_name, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t+ IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) \r\n\t\t\t\tAS extraDistance, IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, 0, \r\n\t\t\t\trouteFrom.rut_estm_time as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 AND routeFrom.rut_from_city_id <> routeFrom.rut_to_city_id\r\n\t\t\t\t\tAND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND routeTo.rut_estm_distance < 50 \r\n\t\t\t\t\tAND routeTo.rut_from_city_id=30711 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\tAND (routeAlias.rut_to_city_id=routeTo.rut_to_city_id) AND routeAlias.rut_active = 1 AND routeAlias.rut_from_city_id=30804  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25034.536] [M: 30912.34] [ET: 2.581/25008.545] [MU: 2.17/30911.91] 
	SQL: SELECT *, (rte_vendor_amount + extraDistance * 10.55) as totalCost FROM (SELECT * FROM nearest_route_30804_30711) a
					INNER JOIN rate ON a.rut_id = rate.rte_route_id AND rte_status=1 AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <>0
					WHERE 1 ORDER BY rank DESC, totalCost ASC LIMIT 0,1 
	 [params: {"cabType":"108"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25035.376] [M: 30920.37] [ET: 0.684/25009.383] [MU: 0.74/30918.37] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"getNearestRoute_30804_30711_70","sql":"(INDEX getNearestRoute_30804_30711_70_index_rut_id (rut_id))\r\n\t\t\t\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id AS start, routeAlias.rut_to_city_id AS end,\r\n\t\t\t\t\t\t\t\trouteFrom.rut_name AS fromAlias, NULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance AS quotedDistance,\r\n\t\t\t\t\t\t\t\trouteAlias.rut_estm_distance AS rateDistance, \r\n\t\t\t\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance)\r\n\t\t\t\t\t\t\t\t\t - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance,\r\n\t\t\t\t\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance,\r\n\t\t\t\t\t\t\t\t0 AS rank, routeFrom.rut_estm_time AS startTime, 0 AS endTime, route.rut_estm_time, \r\n\t\t\t\t\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraTravelDistance\r\n\t\t\t\t\t\tFROM   route\r\n\t\t\t\t\t\tINNER JOIN route routeTo ON routeTo.rut_to_city_id=route.rut_from_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_from_city_id=30804 AND routeTo.rut_active=1\r\n\t\t\t\t\t\t\t\tAND routeTo.rut_estm_distance<70 AND route.rut_active=1\r\n\t\t\t\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_from_city_id=route.rut_to_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_active = 1\r\n\t\t\t\t\t\t\t\tAND routeFrom.rut_estm_distance<70 AND route.rut_active = 1\r\n\t\t\t\t\t\tINNER JOIN route routeAlias ON routeAlias.rut_to_city_id=routeFrom.rut_to_city_id\r\n\t\t\t\t\t\t\tAND routeAlias.rut_from_city_id=routeTo.rut_from_city_id AND routeAlias.rut_active = 1"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25037.855] [M: 30925.63] [ET: 2.324/25011.826] [MU: 2.41/30925.01] 
	SQL: SELECT *, (rte_vendor_amount + extradistance * 10.55 ) AS totalCost, 
						ABS(quotedDistance-rateDistance) AS extraChargeableDistance
					FROM getNearestRoute_30804_30711_70 a
					INNER JOIN rate ON a.rut_id=rate.rte_route_id AND rte_status=1 
						AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <> 0
					WHERE  1
					ORDER  BY rank DESC, extraStartDistance, extraChargeableDistance ASC, totalcost ASC
					LIMIT  0, 1 
	 [params: {"cabType":"108"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25041.573] [M: 30940.73] [ET: 0.732/25015.586] [MU: 3.41/30939.86] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"73","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25043.682] [M: 30957.35] [ET: 0.6/25017.697] [MU: 3.78/30956.48] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25045.011] [M: 30968.44] [ET: 25.231/25019.05] [MU: 131.57/30968.28] 
	Quote::calculateOneWay  for CAB 108 Date: 2024-10-31 18:00:00
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25045.443] [M: 30972.03] [ET: 0.341/25019.479] [MU: 0.89/30971.78] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25046.647] [M: 30984.74] [ET: 0.596/25020.664] [MU: 3.34/30984.3] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25047.298] [M: 31013.91] [ET: 0.487/25021.33] [MU: 22.53/31013.16] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp668)) OR (apr_area_type = 5 AND apr_area_id IN (:gp666)) OR (apr_area_type = 2 AND apr_area_id IN (:gp669)) OR (apr_area_type = 4 AND apr_area_id IN (:gp670)) OR (apr_area_type = 1 AND apr_area_id IN (:gp667))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp666":"3699",":gp667":"31",":gp668":"30804",":gp669":"105",":gp670":"1","cab":"108"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25048.922] [M: 31000.95] [ET: 0.537/25022.955] [MU: 3.34/31000.51] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25051.541] [M: 31011.49] [ET: 2.492/25025.546] [MU: 3.53/31010.62] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp673)) OR (scr_area_type = 5 AND scr_area_id IN (:gp671)) OR (scr_area_type = 2 AND scr_area_id IN (:gp674)) OR (scr_area_type = 4 AND scr_area_id IN (:gp675)) OR (scr_area_type = 1 AND scr_area_id IN (:gp672)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp671":"3699",":gp672":"31",":gp673":"3699",":gp674":"105",":gp675":"1","scv_id":"108"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25052.317] [M: 31012.65] [ET: 0.372/25026.339] [MU: 2.97/31012.54] 
	BookingRoute::calculateDistance
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25053.849] [M: 31022.85] [ET: 0.505/25027.862] [MU: 2.79/31022.23] 
	SQL: SELECT 
						fc.cty_id as c2id, 
						fc.cty_name as c2name, 
						fc.cty_garage_address as c2address,
						tc.cty_id as c4id,
						tc.cty_name as c4name, tc.cty_garage_address as c4address,
						0 as totalExtraDistance FROM route
						INNER JOIN cities fc ON rut_from_city_id=fc.cty_id
						INNER JOIN cities tc ON rut_to_city_id=tc.cty_id
						INNER JOIN rate on  rate.rte_route_id=route.rut_id  AND rate.rte_vehicletype_id IN (3)
						WHERE route.rut_from_city_id=30804 AND route.rut_to_city_id=30711 AND route.rut_active=1 
	 [params: []]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25054.31] [M: 31036.73] [ET: 0.377/25028.34] [MU: 6.53/31034.73] 
	SQL: 
				SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address, tc.cty_id as c4id, 
				tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
					FROM
					 (
						(
							SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id,  
								r3.rut_to_city_id, route.rut_name , route.rut_id,
								(route.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, 
								r3.rut_estm_distance
							FROM route
							INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_from_city_id=30804  
									AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=route.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) 
									AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
						UNION
						(
							SELECT r3.rut_id, r3.rut_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,(route.rut_estm_distance + r1.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
							FROM route
							INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND  route.rut_to_city_id=30711 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND route.rut_to_city_id=r3.rut_to_city_id))	AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
                     ) a
					INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
					INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1 
	 [params: []]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25054.802] [M: 31047.24] [ET: 0.42/25028.833] [MU: 5.03/31045.74] 
	SQL: SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
                              tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
                        FROM (SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,
                                    (route.rut_estm_distance + r1.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
                                FROM route
								INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
								INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
								INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) AND r3.rut_active=1 
								INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3) LIMIT 1
							)a
                        INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
                        INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1
                         
	 [params: []]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25055.314] [M: 31053.62] [ET: 0.423/25029.326] [MU: 0.74/31052.74] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"GarageRoute_30804_30711","sql":" (INDEX GarageRoute_30804_30711_index_rut_id (rut_id), INDEX GarageRoute_30804_30711_index_rut_from_city_id (rut_from_city_id), INDEX GarageRoute_30804_30711_index_rut_to_city_id (rut_to_city_id))\r\n\t\t\t\t\t\t\tSELECT route.rut_id, route.rut_from_city_id, route.rut_to_city_id, route.rut_name, rut_estm_distance FROM route \r\n\t\t\t\t\t\t\tINNER JOIN cities_stats   ON cities_stats.cts_cty_id = route.rut_from_city_id\r\n\t\t\t\t\t\t\tAND rut_estm_distance < 300\r\n\t\t\t\t\t\t\tAND rut_active = 1\r\n\t\t\t\t\t\t\tAND route.rut_to_city_id=30804\r\n\t\t\t\t\t\t\tAND cities_stats.cts_vnd_cnt >= 3\r\n\t\t\t\t\t\t\tORDER BY rut_estm_distance LIMIT 10"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25056.065] [M: 31065.54] [ET: 0.639/25030.077] [MU: 6.69/31063.79] 
	SQL: SELECT a.*, fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
								tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address 
						FROM ((SELECT xyz.rut_from_city_id as startCity, r1.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r3.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_from_city_id
							INNER JOIN rate ON rate.rte_route_id=r1.rut_id  AND rate.rte_vehicletype_id IN (3)
							INNER JOIN route r2 ON r2.rut_to_city_id=r1.rut_to_city_id AND r2.rut_from_city_id=:dropCity AND r2.rut_active=1
							INNER JOIN route r3 ON r3.rut_from_city_id=xyz.rut_to_city_id AND r3.rut_to_city_id=r2.rut_from_city_id AND r3.rut_active=1
							ORDER BY ExtraDistance LIMIT 1
							)
							UNION
							(
							SELECT xyz.rut_from_city_id as startCity, r2.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r2.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_to_city_id AND r1.rut_to_city_id=:dropCity
							INNER JOIN route r2 ON r2.rut_to_city_id=xyz.rut_from_city_id AND r2.rut_from_city_id=r1.rut_to_city_id
							ORDER BY ExtraDistance ASC LIMIT 1
							)) a
						INNER JOIN cities fc ON startCity=fc.cty_id
						INNER JOIN cities tc ON endCity=tc.cty_id 
						ORDER BY ExtraDistance 
	 [params: {"pickupCity":"30804","dropCity":"30711"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25059.166] [M: 31076.88] [ET: 1.461/25033.198] [MU: 7.89/31076.77] 
	BookingRoute::calculateDistance
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25060.142] [M: 31082.45] [ET: 0.873/25034.16] [MU: 8.27/31082.34] 
	BookingRoute::calculateDistance
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25061.192] [M: 31089.98] [ET: 0.311/25035.225] [MU: 0.99/31089.61] 
	SQL: SELECT cts_airport_pickup_entry_fee
               FROM   cities
               INNER JOIN cities_stats
               ON cities.cty_id = cities_stats.cts_cty_id
               WHERE  cty_id = :cityId
               AND cty_is_airport = 1 AND cty_active = 1 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25062.687] [M: 31103.9] [ET: 0.914/25036.707] [MU: 8.13/31103.79] 
	BookingRoute::calculateDistance
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25063.784] [M: 31111.64] [ET: 0.963/25037.812] [MU: 8.07/31111.53] 
	BookingRoute::calculateDistance
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25064.21] [M: 31111.07] [ET: 0.332/25038.228] [MU: 0.9/31110.82] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25065.653] [M: 31123.78] [ET: 0.702/25039.669] [MU: 3.34/31123.34] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25066.364] [M: 31152.95] [ET: 0.541/25040.395] [MU: 22.54/31152.2] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp678)) OR (apr_area_type = 5 AND apr_area_id IN (:gp676)) OR (apr_area_type = 2 AND apr_area_id IN (:gp679)) OR (apr_area_type = 4 AND apr_area_id IN (:gp680)) OR (apr_area_type = 1 AND apr_area_id IN (:gp677))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp676":"3699",":gp677":"31",":gp678":"30804",":gp679":"105",":gp680":"1","cab":"108"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25068.17] [M: 31139.98] [ET: 0.63/25042.187] [MU: 3.34/31139.55] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25071.107] [M: 31150.53] [ET: 2.762/25045.104] [MU: 3.53/31149.66] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp683)) OR (scr_area_type = 5 AND scr_area_id IN (:gp681)) OR (scr_area_type = 2 AND scr_area_id IN (:gp684)) OR (scr_area_type = 4 AND scr_area_id IN (:gp685)) OR (scr_area_type = 1 AND scr_area_id IN (:gp682)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp681":"3699",":gp682":"31",":gp683":"3699",":gp684":"105",":gp685":"1","scv_id":"108"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25071.732] [M: 31153.73] [ET: 0.236/25045.77] [MU: 2.98/31153.62] 
	BookingRoute::calculateDistance
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25073.142] [M: 31166.74] [ET: 0.226/25047.181] [MU: 2.98/31166.63] 
	BookingRoute::calculateDistance
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25073.41] [M: 31170.91] [ET: 0.202/25047.45] [MU: 2.98/31170.8] 
	BookingRoute::calculateDistance
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25077.466] [M: 31204.88] [ET: 0.575/25051.492] [MU: 6.28/31202.88] 
	SQL: 
                SELECT cities.cty_id as c2id, cities.cty_name as c2name, cities.cty_garage_address as c2address,
                    cities.cty_id as c4id, cities.cty_name as c4name, cities.cty_garage_address as c4address,
                        (distance * 2) as totalExtraDistance
                 FROM (SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<40
                     INNER JOIN route r1 ON route.rut_to_city_id=r1.rut_from_city_id AND r1.rut_active=1
                     INNER JOIN rate ON r1.rut_id=rate.rte_route_id AND rate.rte_status=1  AND rate.rte_vehicletype_id IN (3) GROUP BY route.rut_id HAVING count(*) >30
                   UNION
                     SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<600
                     INNER JOIN cities tc ON tc.cty_id=route.rut_to_city_id AND tc.cty_service_active=1 AND CalcDistance(cities.cty_lat, cities.cty_long, tc.cty_lat, tc.cty_long)<=route.rut_estm_distance						 
                     INNER JOIN cities_stats ON cities_stats.cts_cty_id = route.rut_to_city_id AND cities_stats.cts_vnd_cnt >= 2
                   UNION
                    SELECT cts_cty_id AS city, 0 AS distance
					FROM cities_stats WHERE 1 AND cities_stats.cts_cty_id= 30817 and cities_stats.cts_vnd_cnt>1) a
                    INNER JOIN cities ON cities.cty_id=a.city
                    ORDER BY totalExtraDistance LIMIT 1 
	 [params: []]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25080.64] [M: 31219.69] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"3","tripDistance":"","tripDuration":"","multiCityData":"","bookingType":"1","pickupAddress":"","pickupDate":"31\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","sccId":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=3&tripDistance=&tripDuration=&multiCityData=&bookingType=1&pickupAddress=&pickupDate=31%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&sccId=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25081.287] [M: 31236.53] [ET: 1.288/25055.309] [MU: 18.04/31236.42] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25081.337] [M: 31238.21] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25082.434] [M: 31251.67] [ET: 0.93/25056.455] [MU: 2.99/31249.17] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+10013),(IF((cpm_value_type=2),(10013+(10013*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30937 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30937) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-31 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=108 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25084.211] [M: 31293.9] [ET: 4.369/25058.246] [MU: 75.87/31293.74] 
	RouteRates::calculate for CAB 108 2024-10-31 18:00:00 - Trip Type: 1 109697628
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25084.352] [M: 31271.59] [ET: 39.285/25058.393] [MU: 301.59/31271.43] 
	Quote::calculateRules for CAB 108, From City Id: 30804, To city Id: 30711
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25084.641] [M: 31243.21] [ET: 0.197/25058.657] [MU: 0.89/31242.96] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"108"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25084.752] [M: 31245.4] [ET: 70.131/25058.776] [MU: 455.98/31245.3] 
	Quote For CabType: 108
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25086.16] [M: 31255.74] [ET: 0.471/25060.177] [MU: 3.34/31255.3] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25086.686] [M: 31261.55] [ET: 0.422/25060.705] [MU: 3.34/31261.12] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30711"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25087.259] [M: 31264.49] [ET: 0.484/25061.293] [MU: 0.89/31264.24] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25087.825] [M: 31296.85] [ET: 0.447/25061.839] [MU: 24.21/31295.35] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (100) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30711) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp686)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp689,:gp690)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp687,:gp688)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp691,:gp692))
			OR (scr_area_type = 5 AND scr_area_id IN (3699))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (111)
		ORDER BY rank DESC
		 
	 [params: {":gp686":"31",":gp687":"30804",":gp688":"30711",":gp689":"105",":gp690":"100",":gp691":"1",":gp692":"1","tripType":"1"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25088.641] [M: 31277.04] [ET: 0.213/25062.676] [MU: 0.83/31276.85] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25088.996] [M: 31279.88] [ET: 0.27/25063.016] [MU: 0.93/31279.57] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"6"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25090.669] [M: 31292.72] [ET: 0.479/25064.698] [MU: 2.05/31292.22] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"111"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25096.903] [M: 31302.1] [ET: 5.993/25070.906] [MU: 3.53/31301.23] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"111","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25097.697] [M: 31305.35] [ET: 0.503/25071.726] [MU: 0.87/31305.13] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":0}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25098.394] [M: 31312.63] [ET: 0.526/25072.427] [MU: 2.97/31312.2] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25099.001] [M: 31340.8] [ET: 0.486/25073.013] [MU: 22.04/31340.18] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp694)) OR (apr_area_type = 2 AND apr_area_id IN (:gp695)) OR (apr_area_type = 4 AND apr_area_id IN (:gp696)) OR (apr_area_type = 1 AND apr_area_id IN (:gp693))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp693":"31",":gp694":"30804",":gp695":"105",":gp696":"1","cab":"111"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25100.136] [M: 31327.53] [ET: 0.454/25074.169] [MU: 3.34/31327.09] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25102.685] [M: 31337.81] [ET: 2.426/25076.691] [MU: 3.41/31336.94] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp698)) OR (scr_area_type = 2 AND scr_area_id IN (:gp699)) OR (scr_area_type = 4 AND scr_area_id IN (:gp700)) OR (scr_area_type = 1 AND scr_area_id IN (:gp697)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp697":"31",":gp698":"30804",":gp699":"105",":gp700":"1","scv_id":"111"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25105.842] [M: 31365.54] [ET: 2.167/25079.831] [MU: 0.74/31357.54] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"nearest_route_30804_30711","sql":"(INDEX indx_nearest_rt_rutid (rut_id)) \r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, routeFrom.rut_name as fromAlias, \r\n\t\t\t\tNULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, \r\n\t\t\t\t0 as rank, routeFrom.rut_estm_time as startTime, 0 as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 \r\n\t\t\t\tAND routeFrom.rut_from_city_id<>routeFrom.rut_to_city_id AND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\t\tAND (routeAlias.rut_to_city_id=route.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, NULL, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) \r\n\t\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\t0 AS extraStartDistance, 0, 0 as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND route.rut_from_city_id = 30804 AND route.rut_to_city_id=30711 \r\n\t\t\t\tAND routeTo.rut_from_city_id=30711\r\n\t\t\t\tAND route.rut_active = 1 AND routeTo.rut_active = 1 AND routeTo.rut_estm_distance < 50 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = route.rut_from_city_id) \r\n\t\t\t   AND (routeAlias.rut_to_city_id = routeTo.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, \r\n\t\t\t\trouteFrom.rut_name, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t+ IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) \r\n\t\t\t\tAS extraDistance, IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, 0, \r\n\t\t\t\trouteFrom.rut_estm_time as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 AND routeFrom.rut_from_city_id <> routeFrom.rut_to_city_id\r\n\t\t\t\t\tAND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND routeTo.rut_estm_distance < 50 \r\n\t\t\t\t\tAND routeTo.rut_from_city_id=30711 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\tAND (routeAlias.rut_to_city_id=routeTo.rut_to_city_id) AND routeAlias.rut_active = 1 AND routeAlias.rut_from_city_id=30804  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25110.383] [M: 31369.62] [ET: 4.392/25084.379] [MU: 2.16/31369.18] 
	SQL: SELECT *, (rte_vendor_amount + extraDistance * 10.55) as totalCost FROM (SELECT * FROM nearest_route_30804_30711) a
					INNER JOIN rate ON a.rut_id = rate.rte_route_id AND rte_status=1 AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <>0
					WHERE 1 ORDER BY rank DESC, totalCost ASC LIMIT 0,1 
	 [params: {"cabType":"111"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25111.471] [M: 31377.64] [ET: 0.856/25085.427] [MU: 0.74/31375.64] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"getNearestRoute_30804_30711_70","sql":"(INDEX getNearestRoute_30804_30711_70_index_rut_id (rut_id))\r\n\t\t\t\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id AS start, routeAlias.rut_to_city_id AS end,\r\n\t\t\t\t\t\t\t\trouteFrom.rut_name AS fromAlias, NULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance AS quotedDistance,\r\n\t\t\t\t\t\t\t\trouteAlias.rut_estm_distance AS rateDistance, \r\n\t\t\t\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance)\r\n\t\t\t\t\t\t\t\t\t - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance,\r\n\t\t\t\t\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance,\r\n\t\t\t\t\t\t\t\t0 AS rank, routeFrom.rut_estm_time AS startTime, 0 AS endTime, route.rut_estm_time, \r\n\t\t\t\t\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraTravelDistance\r\n\t\t\t\t\t\tFROM   route\r\n\t\t\t\t\t\tINNER JOIN route routeTo ON routeTo.rut_to_city_id=route.rut_from_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_from_city_id=30804 AND routeTo.rut_active=1\r\n\t\t\t\t\t\t\t\tAND routeTo.rut_estm_distance<70 AND route.rut_active=1\r\n\t\t\t\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_from_city_id=route.rut_to_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_active = 1\r\n\t\t\t\t\t\t\t\tAND routeFrom.rut_estm_distance<70 AND route.rut_active = 1\r\n\t\t\t\t\t\tINNER JOIN route routeAlias ON routeAlias.rut_to_city_id=routeFrom.rut_to_city_id\r\n\t\t\t\t\t\t\tAND routeAlias.rut_from_city_id=routeTo.rut_from_city_id AND routeAlias.rut_active = 1"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25114.151] [M: 31382.91] [ET: 2.545/25088.138] [MU: 2.41/31382.28] 
	SQL: SELECT *, (rte_vendor_amount + extradistance * 10.55 ) AS totalCost, 
						ABS(quotedDistance-rateDistance) AS extraChargeableDistance
					FROM getNearestRoute_30804_30711_70 a
					INNER JOIN rate ON a.rut_id=rate.rte_route_id AND rte_status=1 
						AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <> 0
					WHERE  1
					ORDER  BY rank DESC, extraStartDistance, extraChargeableDistance ASC, totalcost ASC
					LIMIT  0, 1 
	 [params: {"cabType":"111"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25117.539] [M: 31398] [ET: 0.518/25091.571] [MU: 3.42/31397.13] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"73","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25119.002] [M: 31414.62] [ET: 0.43/25093.034] [MU: 3.78/31413.74] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25120.261] [M: 31425.71] [ET: 29.502/25094.283] [MU: 131.57/31425.55] 
	Quote::calculateOneWay  for CAB 111 Date: 2024-10-31 18:00:00
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25120.803] [M: 31429.3] [ET: 0.404/25094.832] [MU: 0.9/31429.05] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25121.919] [M: 31442.02] [ET: 0.557/25095.952] [MU: 3.34/31441.58] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25122.665] [M: 31471.19] [ET: 0.617/25096.678] [MU: 22.53/31470.44] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp703)) OR (apr_area_type = 5 AND apr_area_id IN (:gp701)) OR (apr_area_type = 2 AND apr_area_id IN (:gp704)) OR (apr_area_type = 4 AND apr_area_id IN (:gp705)) OR (apr_area_type = 1 AND apr_area_id IN (:gp702))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp701":"3699",":gp702":"31",":gp703":"30804",":gp704":"105",":gp705":"1","cab":"111"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25124.195] [M: 31458.21] [ET: 0.503/25098.229] [MU: 3.34/31457.77] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25127.237] [M: 31468.76] [ET: 2.917/25101.241] [MU: 3.54/31467.88] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp708)) OR (scr_area_type = 5 AND scr_area_id IN (:gp706)) OR (scr_area_type = 2 AND scr_area_id IN (:gp709)) OR (scr_area_type = 4 AND scr_area_id IN (:gp710)) OR (scr_area_type = 1 AND scr_area_id IN (:gp707)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp706":"3699",":gp707":"31",":gp708":"3699",":gp709":"105",":gp710":"1","scv_id":"111"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25127.864] [M: 31469.92] [ET: 0.26/25101.897] [MU: 2.98/31469.81] 
	BookingRoute::calculateDistance
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25129.455] [M: 31480.03] [ET: 0.657/25103.468] [MU: 2.79/31479.41] 
	SQL: SELECT 
						fc.cty_id as c2id, 
						fc.cty_name as c2name, 
						fc.cty_garage_address as c2address,
						tc.cty_id as c4id,
						tc.cty_name as c4name, tc.cty_garage_address as c4address,
						0 as totalExtraDistance FROM route
						INNER JOIN cities fc ON rut_from_city_id=fc.cty_id
						INNER JOIN cities tc ON rut_to_city_id=tc.cty_id
						INNER JOIN rate on  rate.rte_route_id=route.rut_id  AND rate.rte_vehicletype_id IN (3)
						WHERE route.rut_from_city_id=30804 AND route.rut_to_city_id=30711 AND route.rut_active=1 
	 [params: []]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25130.043] [M: 31493.91] [ET: 0.469/25104.052] [MU: 6.53/31491.91] 
	SQL: 
				SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address, tc.cty_id as c4id, 
				tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
					FROM
					 (
						(
							SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id,  
								r3.rut_to_city_id, route.rut_name , route.rut_id,
								(route.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, 
								r3.rut_estm_distance
							FROM route
							INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_from_city_id=30804  
									AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=route.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) 
									AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
						UNION
						(
							SELECT r3.rut_id, r3.rut_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,(route.rut_estm_distance + r1.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
							FROM route
							INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND  route.rut_to_city_id=30711 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND route.rut_to_city_id=r3.rut_to_city_id))	AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
                     ) a
					INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
					INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1 
	 [params: []]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25130.582] [M: 31504.42] [ET: 0.437/25104.598] [MU: 5.03/31502.92] 
	SQL: SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
                              tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
                        FROM (SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,
                                    (route.rut_estm_distance + r1.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
                                FROM route
								INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
								INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
								INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) AND r3.rut_active=1 
								INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3) LIMIT 1
							)a
                        INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
                        INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1
                         
	 [params: []]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25131.125] [M: 31510.8] [ET: 0.447/25105.157] [MU: 0.74/31509.92] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"GarageRoute_30804_30711","sql":" (INDEX GarageRoute_30804_30711_index_rut_id (rut_id), INDEX GarageRoute_30804_30711_index_rut_from_city_id (rut_from_city_id), INDEX GarageRoute_30804_30711_index_rut_to_city_id (rut_to_city_id))\r\n\t\t\t\t\t\t\tSELECT route.rut_id, route.rut_from_city_id, route.rut_to_city_id, route.rut_name, rut_estm_distance FROM route \r\n\t\t\t\t\t\t\tINNER JOIN cities_stats   ON cities_stats.cts_cty_id = route.rut_from_city_id\r\n\t\t\t\t\t\t\tAND rut_estm_distance < 300\r\n\t\t\t\t\t\t\tAND rut_active = 1\r\n\t\t\t\t\t\t\tAND route.rut_to_city_id=30804\r\n\t\t\t\t\t\t\tAND cities_stats.cts_vnd_cnt >= 3\r\n\t\t\t\t\t\t\tORDER BY rut_estm_distance LIMIT 10"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25131.683] [M: 31522.72] [ET: 0.477/25105.707] [MU: 6.69/31520.97] 
	SQL: SELECT a.*, fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
								tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address 
						FROM ((SELECT xyz.rut_from_city_id as startCity, r1.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r3.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_from_city_id
							INNER JOIN rate ON rate.rte_route_id=r1.rut_id  AND rate.rte_vehicletype_id IN (3)
							INNER JOIN route r2 ON r2.rut_to_city_id=r1.rut_to_city_id AND r2.rut_from_city_id=:dropCity AND r2.rut_active=1
							INNER JOIN route r3 ON r3.rut_from_city_id=xyz.rut_to_city_id AND r3.rut_to_city_id=r2.rut_from_city_id AND r3.rut_active=1
							ORDER BY ExtraDistance LIMIT 1
							)
							UNION
							(
							SELECT xyz.rut_from_city_id as startCity, r2.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r2.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_to_city_id AND r1.rut_to_city_id=:dropCity
							INNER JOIN route r2 ON r2.rut_to_city_id=xyz.rut_from_city_id AND r2.rut_from_city_id=r1.rut_to_city_id
							ORDER BY ExtraDistance ASC LIMIT 1
							)) a
						INNER JOIN cities fc ON startCity=fc.cty_id
						INNER JOIN cities tc ON endCity=tc.cty_id 
						ORDER BY ExtraDistance 
	 [params: {"pickupCity":"30804","dropCity":"30711"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25134.397] [M: 31534.06] [ET: 1.221/25108.404] [MU: 7.89/31533.95] 
	BookingRoute::calculateDistance
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25135.687] [M: 31539.63] [ET: 1.154/25109.705] [MU: 8.27/31539.52] 
	BookingRoute::calculateDistance
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25136.736] [M: 31547.26] [ET: 0.312/25110.755] [MU: 1/31546.88] 
	SQL: SELECT cts_airport_pickup_entry_fee
               FROM   cities
               INNER JOIN cities_stats
               ON cities.cty_id = cities_stats.cts_cty_id
               WHERE  cty_id = :cityId
               AND cty_is_airport = 1 AND cty_active = 1 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25138.568] [M: 31561.17] [ET: 1.106/25112.587] [MU: 8.14/31561.06] 
	BookingRoute::calculateDistance
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25139.69] [M: 31569.01] [ET: 0.983/25113.72] [MU: 8.08/31568.9] 
	BookingRoute::calculateDistance
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25140.106] [M: 31568.34] [ET: 0.331/25114.141] [MU: 0.9/31568.09] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25141.569] [M: 31581.05] [ET: 0.837/25115.597] [MU: 3.34/31580.62] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25142.345] [M: 31610.23] [ET: 0.639/25116.357] [MU: 22.53/31609.48] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp713)) OR (apr_area_type = 5 AND apr_area_id IN (:gp711)) OR (apr_area_type = 2 AND apr_area_id IN (:gp714)) OR (apr_area_type = 4 AND apr_area_id IN (:gp715)) OR (apr_area_type = 1 AND apr_area_id IN (:gp712))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp711":"3699",":gp712":"31",":gp713":"30804",":gp714":"105",":gp715":"1","cab":"111"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25143.925] [M: 31597.25] [ET: 0.477/25117.937] [MU: 3.34/31596.81] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25146.378] [M: 31607.8] [ET: 2.343/25120.401] [MU: 3.53/31606.92] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp718)) OR (scr_area_type = 5 AND scr_area_id IN (:gp716)) OR (scr_area_type = 2 AND scr_area_id IN (:gp719)) OR (scr_area_type = 4 AND scr_area_id IN (:gp720)) OR (scr_area_type = 1 AND scr_area_id IN (:gp717)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp716":"3699",":gp717":"31",":gp718":"3699",":gp719":"105",":gp720":"1","scv_id":"111"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25147.19] [M: 31611] [ET: 0.347/25121.213] [MU: 2.97/31610.89] 
	BookingRoute::calculateDistance
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25148.888] [M: 31624.02] [ET: 0.241/25122.927] [MU: 2.98/31623.91] 
	BookingRoute::calculateDistance
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25149.153] [M: 31628.19] [ET: 0.196/25123.193] [MU: 2.98/31628.08] 
	BookingRoute::calculateDistance
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25152.396] [M: 31662.24] [ET: 0.538/25126.418] [MU: 6.28/31660.24] 
	SQL: 
                SELECT cities.cty_id as c2id, cities.cty_name as c2name, cities.cty_garage_address as c2address,
                    cities.cty_id as c4id, cities.cty_name as c4name, cities.cty_garage_address as c4address,
                        (distance * 2) as totalExtraDistance
                 FROM (SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<40
                     INNER JOIN route r1 ON route.rut_to_city_id=r1.rut_from_city_id AND r1.rut_active=1
                     INNER JOIN rate ON r1.rut_id=rate.rte_route_id AND rate.rte_status=1  AND rate.rte_vehicletype_id IN (3) GROUP BY route.rut_id HAVING count(*) >30
                   UNION
                     SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<600
                     INNER JOIN cities tc ON tc.cty_id=route.rut_to_city_id AND tc.cty_service_active=1 AND CalcDistance(cities.cty_lat, cities.cty_long, tc.cty_lat, tc.cty_long)<=route.rut_estm_distance						 
                     INNER JOIN cities_stats ON cities_stats.cts_cty_id = route.rut_to_city_id AND cities_stats.cts_vnd_cnt >= 2
                   UNION
                    SELECT cts_cty_id AS city, 0 AS distance
					FROM cities_stats WHERE 1 AND cities_stats.cts_cty_id= 30817 and cities_stats.cts_vnd_cnt>1) a
                    INNER JOIN cities ON cities.cty_id=a.city
                    ORDER BY totalExtraDistance LIMIT 1 
	 [params: []]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25155.06] [M: 31677.05] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"3","tripDistance":"","tripDuration":"","multiCityData":"","bookingType":"1","pickupAddress":"","pickupDate":"31\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","sccId":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=3&tripDistance=&tripDuration=&multiCityData=&bookingType=1&pickupAddress=&pickupDate=31%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&sccId=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25155.48] [M: 31693.9] [ET: 0.887/25129.52] [MU: 18.05/31693.79] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25155.511] [M: 31695.58] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25156.477] [M: 31709.04] [ET: 0.82/25130.475] [MU: 2.99/31706.54] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+10013),(IF((cpm_value_type=2),(10013+(10013*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30937 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30937) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-31 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=111 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25158.727] [M: 31751.27] [ET: 4.203/25132.748] [MU: 75.87/31751.11] 
	RouteRates::calculate for CAB 111 2024-10-31 18:00:00 - Trip Type: 1 304335409
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25158.883] [M: 31728.95] [ET: 38.544/25132.923] [MU: 301.69/31728.8] 
	Quote::calculateRules for CAB 111, From City Id: 30804, To city Id: 30711
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25159.232] [M: 31700.59] [ET: 0.257/25133.249] [MU: 0.9/31700.34] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"111"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25159.354] [M: 31702.77] [ET: 74.522/25133.377] [MU: 456.07/31702.68] 
	Quote For CabType: 111
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25160.729] [M: 31713.12] [ET: 0.461/25134.746] [MU: 3.33/31712.68] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25161.272] [M: 31718.93] [ET: 0.441/25135.292] [MU: 3.33/31718.49] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30711"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25161.828] [M: 31721.87] [ET: 0.467/25135.861] [MU: 0.9/31721.62] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25162.36] [M: 31754.23] [ET: 0.427/25136.391] [MU: 24.22/31752.73] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (100) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30711) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp721)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp724,:gp725)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp722,:gp723)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp726,:gp727))
			OR (scr_area_type = 5 AND scr_area_id IN (3699))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (112)
		ORDER BY rank DESC
		 
	 [params: {":gp721":"31",":gp722":"30804",":gp723":"30711",":gp724":"105",":gp725":"100",":gp726":"1",":gp727":"1","tripType":"1"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25163.021] [M: 31734.41] [ET: 0.191/25137.057] [MU: 0.84/31734.23] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25163.347] [M: 31737.26] [ET: 0.254/25137.382] [MU: 0.93/31736.95] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"6"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25164.456] [M: 31750.09] [ET: 0.327/25138.488] [MU: 2.05/31749.59] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"112"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25167.993] [M: 31759.48] [ET: 3.299/25141.997] [MU: 3.53/31758.6] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"112","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25168.811] [M: 31762.73] [ET: 0.519/25142.839] [MU: 0.87/31762.51] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":0}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25169.479] [M: 31770.01] [ET: 0.491/25143.512] [MU: 2.97/31769.57] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25170.099] [M: 31798.18] [ET: 0.496/25144.108] [MU: 22.05/31797.55] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp729)) OR (apr_area_type = 2 AND apr_area_id IN (:gp730)) OR (apr_area_type = 4 AND apr_area_id IN (:gp731)) OR (apr_area_type = 1 AND apr_area_id IN (:gp728))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp728":"31",":gp729":"30804",":gp730":"105",":gp731":"1","cab":"112"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25171.202] [M: 31784.91] [ET: 0.462/25145.237] [MU: 3.33/31784.47] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25173.666] [M: 31795.19] [ET: 2.352/25147.686] [MU: 3.41/31794.31] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp733)) OR (scr_area_type = 2 AND scr_area_id IN (:gp734)) OR (scr_area_type = 4 AND scr_area_id IN (:gp735)) OR (scr_area_type = 1 AND scr_area_id IN (:gp732)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp732":"31",":gp733":"30804",":gp734":"105",":gp735":"1","scv_id":"112"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25176.7] [M: 31822.91] [ET: 1.876/25150.687] [MU: 0.75/31814.91] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"nearest_route_30804_30711","sql":"(INDEX indx_nearest_rt_rutid (rut_id)) \r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, routeFrom.rut_name as fromAlias, \r\n\t\t\t\tNULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, \r\n\t\t\t\t0 as rank, routeFrom.rut_estm_time as startTime, 0 as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 \r\n\t\t\t\tAND routeFrom.rut_from_city_id<>routeFrom.rut_to_city_id AND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\t\tAND (routeAlias.rut_to_city_id=route.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, NULL, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) \r\n\t\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\t0 AS extraStartDistance, 0, 0 as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND route.rut_from_city_id = 30804 AND route.rut_to_city_id=30711 \r\n\t\t\t\tAND routeTo.rut_from_city_id=30711\r\n\t\t\t\tAND route.rut_active = 1 AND routeTo.rut_active = 1 AND routeTo.rut_estm_distance < 50 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = route.rut_from_city_id) \r\n\t\t\t   AND (routeAlias.rut_to_city_id = routeTo.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, \r\n\t\t\t\trouteFrom.rut_name, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t+ IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) \r\n\t\t\t\tAS extraDistance, IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, 0, \r\n\t\t\t\trouteFrom.rut_estm_time as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 AND routeFrom.rut_from_city_id <> routeFrom.rut_to_city_id\r\n\t\t\t\t\tAND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND routeTo.rut_estm_distance < 50 \r\n\t\t\t\t\tAND routeTo.rut_from_city_id=30711 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\tAND (routeAlias.rut_to_city_id=routeTo.rut_to_city_id) AND routeAlias.rut_active = 1 AND routeAlias.rut_from_city_id=30804  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25179.29] [M: 31826.99] [ET: 2.435/25153.297] [MU: 2.17/31826.55] 
	SQL: SELECT *, (rte_vendor_amount + extraDistance * 10.55) as totalCost FROM (SELECT * FROM nearest_route_30804_30711) a
					INNER JOIN rate ON a.rut_id = rate.rte_route_id AND rte_status=1 AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <>0
					WHERE 1 ORDER BY rank DESC, totalCost ASC LIMIT 0,1 
	 [params: {"cabType":"112"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25180.082] [M: 31835.02] [ET: 0.654/25154.104] [MU: 0.74/31833.02] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"getNearestRoute_30804_30711_70","sql":"(INDEX getNearestRoute_30804_30711_70_index_rut_id (rut_id))\r\n\t\t\t\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id AS start, routeAlias.rut_to_city_id AS end,\r\n\t\t\t\t\t\t\t\trouteFrom.rut_name AS fromAlias, NULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance AS quotedDistance,\r\n\t\t\t\t\t\t\t\trouteAlias.rut_estm_distance AS rateDistance, \r\n\t\t\t\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance)\r\n\t\t\t\t\t\t\t\t\t - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance,\r\n\t\t\t\t\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance,\r\n\t\t\t\t\t\t\t\t0 AS rank, routeFrom.rut_estm_time AS startTime, 0 AS endTime, route.rut_estm_time, \r\n\t\t\t\t\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraTravelDistance\r\n\t\t\t\t\t\tFROM   route\r\n\t\t\t\t\t\tINNER JOIN route routeTo ON routeTo.rut_to_city_id=route.rut_from_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_from_city_id=30804 AND routeTo.rut_active=1\r\n\t\t\t\t\t\t\t\tAND routeTo.rut_estm_distance<70 AND route.rut_active=1\r\n\t\t\t\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_from_city_id=route.rut_to_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_active = 1\r\n\t\t\t\t\t\t\t\tAND routeFrom.rut_estm_distance<70 AND route.rut_active = 1\r\n\t\t\t\t\t\tINNER JOIN route routeAlias ON routeAlias.rut_to_city_id=routeFrom.rut_to_city_id\r\n\t\t\t\t\t\t\tAND routeAlias.rut_from_city_id=routeTo.rut_from_city_id AND routeAlias.rut_active = 1"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25184.178] [M: 31840.28] [ET: 4.008/25158.204] [MU: 2.42/31839.66] 
	SQL: SELECT *, (rte_vendor_amount + extradistance * 10.55 ) AS totalCost, 
						ABS(quotedDistance-rateDistance) AS extraChargeableDistance
					FROM getNearestRoute_30804_30711_70 a
					INNER JOIN rate ON a.rut_id=rate.rte_route_id AND rte_status=1 
						AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <> 0
					WHERE  1
					ORDER  BY rank DESC, extraStartDistance, extraChargeableDistance ASC, totalcost ASC
					LIMIT  0, 1 
	 [params: {"cabType":"112"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25187.546] [M: 31855.38] [ET: 0.625/25161.561] [MU: 3.41/31854.5] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"73","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25189.284] [M: 31871.99] [ET: 0.559/25163.299] [MU: 3.78/31871.12] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25190.769] [M: 31883.09] [ET: 26.234/25164.792] [MU: 131.57/31882.93] 
	Quote::calculateOneWay  for CAB 112 Date: 2024-10-31 18:00:00
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25191.604] [M: 31886.68] [ET: 0.686/25165.607] [MU: 0.9/31886.43] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25193.104] [M: 31899.39] [ET: 0.642/25167.116] [MU: 3.34/31898.95] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25193.773] [M: 31928.56] [ET: 0.509/25167.787] [MU: 22.54/31927.81] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp738)) OR (apr_area_type = 5 AND apr_area_id IN (:gp736)) OR (apr_area_type = 2 AND apr_area_id IN (:gp739)) OR (apr_area_type = 4 AND apr_area_id IN (:gp740)) OR (apr_area_type = 1 AND apr_area_id IN (:gp737))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp736":"3699",":gp737":"31",":gp738":"30804",":gp739":"105",":gp740":"1","cab":"112"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25195.463] [M: 31915.59] [ET: 0.5/25169.496] [MU: 3.33/31915.15] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25197.807] [M: 31926.13] [ET: 2.212/25171.806] [MU: 3.53/31925.26] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp743)) OR (scr_area_type = 5 AND scr_area_id IN (:gp741)) OR (scr_area_type = 2 AND scr_area_id IN (:gp744)) OR (scr_area_type = 4 AND scr_area_id IN (:gp745)) OR (scr_area_type = 1 AND scr_area_id IN (:gp742)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp741":"3699",":gp742":"31",":gp743":"3699",":gp744":"105",":gp745":"1","scv_id":"112"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25198.568] [M: 31927.3] [ET: 0.376/25172.59] [MU: 2.98/31927.19] 
	BookingRoute::calculateDistance
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25200.146] [M: 31937.41] [ET: 0.523/25174.174] [MU: 2.79/31936.78] 
	SQL: SELECT 
						fc.cty_id as c2id, 
						fc.cty_name as c2name, 
						fc.cty_garage_address as c2address,
						tc.cty_id as c4id,
						tc.cty_name as c4name, tc.cty_garage_address as c4address,
						0 as totalExtraDistance FROM route
						INNER JOIN cities fc ON rut_from_city_id=fc.cty_id
						INNER JOIN cities tc ON rut_to_city_id=tc.cty_id
						INNER JOIN rate on  rate.rte_route_id=route.rut_id  AND rate.rte_vehicletype_id IN (3)
						WHERE route.rut_from_city_id=30804 AND route.rut_to_city_id=30711 AND route.rut_active=1 
	 [params: []]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25200.622] [M: 31951.29] [ET: 0.391/25174.648] [MU: 6.53/31949.29] 
	SQL: 
				SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address, tc.cty_id as c4id, 
				tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
					FROM
					 (
						(
							SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id,  
								r3.rut_to_city_id, route.rut_name , route.rut_id,
								(route.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, 
								r3.rut_estm_distance
							FROM route
							INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_from_city_id=30804  
									AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=route.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) 
									AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
						UNION
						(
							SELECT r3.rut_id, r3.rut_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,(route.rut_estm_distance + r1.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
							FROM route
							INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND  route.rut_to_city_id=30711 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND route.rut_to_city_id=r3.rut_to_city_id))	AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
                     ) a
					INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
					INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1 
	 [params: []]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25201.057] [M: 31961.8] [ET: 0.361/25175.086] [MU: 5.03/31960.3] 
	SQL: SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
                              tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
                        FROM (SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,
                                    (route.rut_estm_distance + r1.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
                                FROM route
								INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
								INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
								INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) AND r3.rut_active=1 
								INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3) LIMIT 1
							)a
                        INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
                        INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1
                         
	 [params: []]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25201.546] [M: 31968.17] [ET: 0.4/25175.56] [MU: 0.74/31967.3] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"GarageRoute_30804_30711","sql":" (INDEX GarageRoute_30804_30711_index_rut_id (rut_id), INDEX GarageRoute_30804_30711_index_rut_from_city_id (rut_from_city_id), INDEX GarageRoute_30804_30711_index_rut_to_city_id (rut_to_city_id))\r\n\t\t\t\t\t\t\tSELECT route.rut_id, route.rut_from_city_id, route.rut_to_city_id, route.rut_name, rut_estm_distance FROM route \r\n\t\t\t\t\t\t\tINNER JOIN cities_stats   ON cities_stats.cts_cty_id = route.rut_from_city_id\r\n\t\t\t\t\t\t\tAND rut_estm_distance < 300\r\n\t\t\t\t\t\t\tAND rut_active = 1\r\n\t\t\t\t\t\t\tAND route.rut_to_city_id=30804\r\n\t\t\t\t\t\t\tAND cities_stats.cts_vnd_cnt >= 3\r\n\t\t\t\t\t\t\tORDER BY rut_estm_distance LIMIT 10"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25202.281] [M: 31980.09] [ET: 0.621/25176.294] [MU: 6.69/31978.34] 
	SQL: SELECT a.*, fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
								tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address 
						FROM ((SELECT xyz.rut_from_city_id as startCity, r1.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r3.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_from_city_id
							INNER JOIN rate ON rate.rte_route_id=r1.rut_id  AND rate.rte_vehicletype_id IN (3)
							INNER JOIN route r2 ON r2.rut_to_city_id=r1.rut_to_city_id AND r2.rut_from_city_id=:dropCity AND r2.rut_active=1
							INNER JOIN route r3 ON r3.rut_from_city_id=xyz.rut_to_city_id AND r3.rut_to_city_id=r2.rut_from_city_id AND r3.rut_active=1
							ORDER BY ExtraDistance LIMIT 1
							)
							UNION
							(
							SELECT xyz.rut_from_city_id as startCity, r2.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r2.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_to_city_id AND r1.rut_to_city_id=:dropCity
							INNER JOIN route r2 ON r2.rut_to_city_id=xyz.rut_from_city_id AND r2.rut_from_city_id=r1.rut_to_city_id
							ORDER BY ExtraDistance ASC LIMIT 1
							)) a
						INNER JOIN cities fc ON startCity=fc.cty_id
						INNER JOIN cities tc ON endCity=tc.cty_id 
						ORDER BY ExtraDistance 
	 [params: {"pickupCity":"30804","dropCity":"30711"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25205.179] [M: 31991.44] [ET: 1.282/25179.206] [MU: 7.88/31991.33] 
	BookingRoute::calculateDistance
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25206.259] [M: 31997.01] [ET: 0.966/25180.276] [MU: 8.26/31996.9] 
	BookingRoute::calculateDistance
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25207.361] [M: 32004.54] [ET: 0.358/25181.391] [MU: 1/32004.16] 
	SQL: SELECT cts_airport_pickup_entry_fee
               FROM   cities
               INNER JOIN cities_stats
               ON cities.cty_id = cities_stats.cts_cty_id
               WHERE  cty_id = :cityId
               AND cty_is_airport = 1 AND cty_active = 1 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25209.75] [M: 32018.45] [ET: 1.477/25183.649] [MU: 8.14/32018.34] 
	BookingRoute::calculateDistance
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25211.443] [M: 32026.2] [ET: 1.513/25185.457] [MU: 8.08/32026.09] 
	BookingRoute::calculateDistance
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25212.143] [M: 32025.53] [ET: 0.563/25186.153] [MU: 0.89/32025.28] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25213.897] [M: 32038.24] [ET: 0.796/25187.905] [MU: 3.34/32037.8] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25214.794] [M: 32067.41] [ET: 0.716/25188.799] [MU: 22.53/32066.66] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp748)) OR (apr_area_type = 5 AND apr_area_id IN (:gp746)) OR (apr_area_type = 2 AND apr_area_id IN (:gp749)) OR (apr_area_type = 4 AND apr_area_id IN (:gp750)) OR (apr_area_type = 1 AND apr_area_id IN (:gp747))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp746":"3699",":gp747":"31",":gp748":"30804",":gp749":"105",":gp750":"1","cab":"112"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25217.052] [M: 32054.44] [ET: 0.682/25191.065] [MU: 3.33/32054] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25220.473] [M: 32064.98] [ET: 3.227/25194.478] [MU: 3.53/32064.11] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp753)) OR (scr_area_type = 5 AND scr_area_id IN (:gp751)) OR (scr_area_type = 2 AND scr_area_id IN (:gp754)) OR (scr_area_type = 4 AND scr_area_id IN (:gp755)) OR (scr_area_type = 1 AND scr_area_id IN (:gp752)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp751":"3699",":gp752":"31",":gp753":"3699",":gp754":"105",":gp755":"1","scv_id":"112"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25221.778] [M: 32068.19] [ET: 0.571/25195.782] [MU: 2.98/32068.08] 
	BookingRoute::calculateDistance
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25224.937] [M: 32081.3] [ET: 1.001/25198.949] [MU: 2.98/32081.19] 
	BookingRoute::calculateDistance
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25225.758] [M: 32085.38] [ET: 0.638/25199.61] [MU: 2.98/32085.27] 
	BookingRoute::calculateDistance
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25229.671] [M: 32119.34] [ET: 0.514/25203.697] [MU: 6.28/32117.34] 
	SQL: 
                SELECT cities.cty_id as c2id, cities.cty_name as c2name, cities.cty_garage_address as c2address,
                    cities.cty_id as c4id, cities.cty_name as c4name, cities.cty_garage_address as c4address,
                        (distance * 2) as totalExtraDistance
                 FROM (SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<40
                     INNER JOIN route r1 ON route.rut_to_city_id=r1.rut_from_city_id AND r1.rut_active=1
                     INNER JOIN rate ON r1.rut_id=rate.rte_route_id AND rate.rte_status=1  AND rate.rte_vehicletype_id IN (3) GROUP BY route.rut_id HAVING count(*) >30
                   UNION
                     SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<600
                     INNER JOIN cities tc ON tc.cty_id=route.rut_to_city_id AND tc.cty_service_active=1 AND CalcDistance(cities.cty_lat, cities.cty_long, tc.cty_lat, tc.cty_long)<=route.rut_estm_distance						 
                     INNER JOIN cities_stats ON cities_stats.cts_cty_id = route.rut_to_city_id AND cities_stats.cts_vnd_cnt >= 2
                   UNION
                    SELECT cts_cty_id AS city, 0 AS distance
					FROM cities_stats WHERE 1 AND cities_stats.cts_cty_id= 30817 and cities_stats.cts_vnd_cnt>1) a
                    INNER JOIN cities ON cities.cty_id=a.city
                    ORDER BY totalExtraDistance LIMIT 1 
	 [params: []]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25232.648] [M: 32134.15] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"3","tripDistance":"","tripDuration":"","multiCityData":"","bookingType":"1","pickupAddress":"","pickupDate":"31\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","sccId":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=3&tripDistance=&tripDuration=&multiCityData=&bookingType=1&pickupAddress=&pickupDate=31%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&sccId=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25233.318] [M: 32150.99] [ET: 1.248/25207.341] [MU: 18.05/32150.88] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25233.368] [M: 32152.67] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25234.427] [M: 32166.13] [ET: 0.875/25208.429] [MU: 3/32163.63] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+10013),(IF((cpm_value_type=2),(10013+(10013*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30937 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30937) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-31 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=112 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25236.303] [M: 32208.36] [ET: 4.312/25210.319] [MU: 75.88/32208.2] 
	RouteRates::calculate for CAB 112 2024-10-31 18:00:00 - Trip Type: 1 301539097
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25236.512] [M: 32186.05] [ET: 45.651/25210.535] [MU: 301.4/32185.89] 
	Quote::calculateRules for CAB 112, From City Id: 30804, To city Id: 30711
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25236.839] [M: 32157.68] [ET: 0.216/25210.86] [MU: 0.9/32157.43] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"112"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25236.95] [M: 32159.87] [ET: 77.516/25210.971] [MU: 455.79/32159.77] 
	Quote For CabType: 112
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25238.342] [M: 32170.21] [ET: 0.473/25212.359] [MU: 3.34/32169.77] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25238.882] [M: 32176.02] [ET: 0.422/25212.884] [MU: 3.34/32175.59] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30711"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25239.491] [M: 32178.96] [ET: 0.509/25213.511] [MU: 0.89/32178.71] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25240.163] [M: 32211.32] [ET: 0.518/25214.178] [MU: 24.22/32209.82] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (100) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30711) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp756)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp759,:gp760)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp757,:gp758)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp761,:gp762))
			OR (scr_area_type = 5 AND scr_area_id IN (3699))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (113)
		ORDER BY rank DESC
		 
	 [params: {":gp756":"31",":gp757":"30804",":gp758":"30711",":gp759":"105",":gp760":"100",":gp761":"1",":gp762":"1","tripType":"1"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25241.78] [M: 32191.51] [ET: 0.991/25215.342] [MU: 0.83/32191.32] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25242.468] [M: 32194.35] [ET: 0.532/25216.498] [MU: 0.93/32194.04] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"6"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25243.633] [M: 32207.19] [ET: 0.339/25217.641] [MU: 2.05/32206.69] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"113"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25246.414] [M: 32216.57] [ET: 2.43/25220.42] [MU: 3.53/32215.7] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"113","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25247.284] [M: 32219.82] [ET: 0.575/25221.309] [MU: 0.86/32219.6] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":0}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25248.052] [M: 32227.1] [ET: 0.58/25222.082] [MU: 2.97/32226.66] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25248.742] [M: 32255.27] [ET: 0.566/25222.765] [MU: 22.05/32254.65] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp764)) OR (apr_area_type = 2 AND apr_area_id IN (:gp765)) OR (apr_area_type = 4 AND apr_area_id IN (:gp766)) OR (apr_area_type = 1 AND apr_area_id IN (:gp763))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp763":"31",":gp764":"30804",":gp765":"105",":gp766":"1","cab":"113"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25249.804] [M: 32242] [ET: 0.474/25223.836] [MU: 3.34/32241.56] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25252.473] [M: 32252.28] [ET: 2.526/25226.451] [MU: 3.41/32251.41] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp768)) OR (scr_area_type = 2 AND scr_area_id IN (:gp769)) OR (scr_area_type = 4 AND scr_area_id IN (:gp770)) OR (scr_area_type = 1 AND scr_area_id IN (:gp767)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp767":"31",":gp768":"30804",":gp769":"105",":gp770":"1","scv_id":"113"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25255.501] [M: 32280.01] [ET: 1.958/25229.507] [MU: 0.74/32272.01] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"nearest_route_30804_30711","sql":"(INDEX indx_nearest_rt_rutid (rut_id)) \r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, routeFrom.rut_name as fromAlias, \r\n\t\t\t\tNULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, \r\n\t\t\t\t0 as rank, routeFrom.rut_estm_time as startTime, 0 as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 \r\n\t\t\t\tAND routeFrom.rut_from_city_id<>routeFrom.rut_to_city_id AND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\t\tAND (routeAlias.rut_to_city_id=route.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, NULL, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) \r\n\t\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\t0 AS extraStartDistance, 0, 0 as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND route.rut_from_city_id = 30804 AND route.rut_to_city_id=30711 \r\n\t\t\t\tAND routeTo.rut_from_city_id=30711\r\n\t\t\t\tAND route.rut_active = 1 AND routeTo.rut_active = 1 AND routeTo.rut_estm_distance < 50 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = route.rut_from_city_id) \r\n\t\t\t   AND (routeAlias.rut_to_city_id = routeTo.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, \r\n\t\t\t\trouteFrom.rut_name, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t+ IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) \r\n\t\t\t\tAS extraDistance, IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, 0, \r\n\t\t\t\trouteFrom.rut_estm_time as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 AND routeFrom.rut_from_city_id <> routeFrom.rut_to_city_id\r\n\t\t\t\t\tAND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND routeTo.rut_estm_distance < 50 \r\n\t\t\t\t\tAND routeTo.rut_from_city_id=30711 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\tAND (routeAlias.rut_to_city_id=routeTo.rut_to_city_id) AND routeAlias.rut_active = 1 AND routeAlias.rut_from_city_id=30804  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25258.145] [M: 32284.09] [ET: 2.538/25232.152] [MU: 2.16/32283.65] 
	SQL: SELECT *, (rte_vendor_amount + extraDistance * 10.55) as totalCost FROM (SELECT * FROM nearest_route_30804_30711) a
					INNER JOIN rate ON a.rut_id = rate.rte_route_id AND rte_status=1 AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <>0
					WHERE 1 ORDER BY rank DESC, totalCost ASC LIMIT 0,1 
	 [params: {"cabType":"113"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25259.113] [M: 32292.11] [ET: 0.808/25233.118] [MU: 0.74/32290.11] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"getNearestRoute_30804_30711_70","sql":"(INDEX getNearestRoute_30804_30711_70_index_rut_id (rut_id))\r\n\t\t\t\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id AS start, routeAlias.rut_to_city_id AS end,\r\n\t\t\t\t\t\t\t\trouteFrom.rut_name AS fromAlias, NULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance AS quotedDistance,\r\n\t\t\t\t\t\t\t\trouteAlias.rut_estm_distance AS rateDistance, \r\n\t\t\t\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance)\r\n\t\t\t\t\t\t\t\t\t - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance,\r\n\t\t\t\t\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance,\r\n\t\t\t\t\t\t\t\t0 AS rank, routeFrom.rut_estm_time AS startTime, 0 AS endTime, route.rut_estm_time, \r\n\t\t\t\t\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraTravelDistance\r\n\t\t\t\t\t\tFROM   route\r\n\t\t\t\t\t\tINNER JOIN route routeTo ON routeTo.rut_to_city_id=route.rut_from_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_from_city_id=30804 AND routeTo.rut_active=1\r\n\t\t\t\t\t\t\t\tAND routeTo.rut_estm_distance<70 AND route.rut_active=1\r\n\t\t\t\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_from_city_id=route.rut_to_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_active = 1\r\n\t\t\t\t\t\t\t\tAND routeFrom.rut_estm_distance<70 AND route.rut_active = 1\r\n\t\t\t\t\t\tINNER JOIN route routeAlias ON routeAlias.rut_to_city_id=routeFrom.rut_to_city_id\r\n\t\t\t\t\t\t\tAND routeAlias.rut_from_city_id=routeTo.rut_from_city_id AND routeAlias.rut_active = 1"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25262.018] [M: 32297.38] [ET: 2.779/25236.023] [MU: 2.41/32296.75] 
	SQL: SELECT *, (rte_vendor_amount + extradistance * 10.55 ) AS totalCost, 
						ABS(quotedDistance-rateDistance) AS extraChargeableDistance
					FROM getNearestRoute_30804_30711_70 a
					INNER JOIN rate ON a.rut_id=rate.rte_route_id AND rte_status=1 
						AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <> 0
					WHERE  1
					ORDER  BY rank DESC, extraStartDistance, extraChargeableDistance ASC, totalcost ASC
					LIMIT  0, 1 
	 [params: {"cabType":"113"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25265.105] [M: 32312.47] [ET: 0.486/25239.138] [MU: 3.42/32311.59] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"73","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:40 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 25266.855] [M: 32329.09] [ET: 0.605/25240.854] [MU: 3.78/32328.21] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28606.816] [M: 25436.16] [ET: 3363.073/28580.842] [MU: -6772.45/25436.01] 
	Quote::calculateOneWay  for CAB 113 Date: 2024-10-31 18:00:00
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28607.491] [M: 25440.38] [ET: 0.549/28581.525] [MU: 0.9/25440.13] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28609.115] [M: 25453.09] [ET: 0.656/28583.125] [MU: 3.34/25452.66] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28610.228] [M: 25483.52] [ET: 0.927/28584.223] [MU: 23.78/25482.77] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp773)) OR (apr_area_type = 5 AND apr_area_id IN (:gp771)) OR (apr_area_type = 2 AND apr_area_id IN (:gp774)) OR (apr_area_type = 4 AND apr_area_id IN (:gp775)) OR (apr_area_type = 1 AND apr_area_id IN (:gp772))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp771":"3699",":gp772":"31",":gp773":"30804",":gp774":"105",":gp775":"1","cab":"113"}]
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28612.425] [M: 25470.54] [ET: 0.469/28586.453] [MU: 3.33/25470.1] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28614.815] [M: 25481.09] [ET: 2.263/28588.81] [MU: 3.53/25480.21] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp778)) OR (scr_area_type = 5 AND scr_area_id IN (:gp776)) OR (scr_area_type = 2 AND scr_area_id IN (:gp779)) OR (scr_area_type = 4 AND scr_area_id IN (:gp780)) OR (scr_area_type = 1 AND scr_area_id IN (:gp777)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp776":"3699",":gp777":"31",":gp778":"3699",":gp779":"105",":gp780":"1","scv_id":"113"}]
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28615.391] [M: 25482.25] [ET: 0.253/28589.429] [MU: 2.97/25482.14] 
	BookingRoute::calculateDistance
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28616.838] [M: 25497.95] [ET: 0.466/28590.869] [MU: 2.79/25497.33] 
	SQL: SELECT 
						fc.cty_id as c2id, 
						fc.cty_name as c2name, 
						fc.cty_garage_address as c2address,
						tc.cty_id as c4id,
						tc.cty_name as c4name, tc.cty_garage_address as c4address,
						0 as totalExtraDistance FROM route
						INNER JOIN cities fc ON rut_from_city_id=fc.cty_id
						INNER JOIN cities tc ON rut_to_city_id=tc.cty_id
						INNER JOIN rate on  rate.rte_route_id=route.rut_id  AND rate.rte_vehicletype_id IN (3)
						WHERE route.rut_from_city_id=30804 AND route.rut_to_city_id=30711 AND route.rut_active=1 
	 [params: []]
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28617.275] [M: 25511.84] [ET: 0.362/28591.3] [MU: 6.53/25509.84] 
	SQL: 
				SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address, tc.cty_id as c4id, 
				tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
					FROM
					 (
						(
							SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id,  
								r3.rut_to_city_id, route.rut_name , route.rut_id,
								(route.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, 
								r3.rut_estm_distance
							FROM route
							INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_from_city_id=30804  
									AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=route.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) 
									AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
						UNION
						(
							SELECT r3.rut_id, r3.rut_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,(route.rut_estm_distance + r1.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
							FROM route
							INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND  route.rut_to_city_id=30711 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND route.rut_to_city_id=r3.rut_to_city_id))	AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
                     ) a
					INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
					INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1 
	 [params: []]
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28617.68] [M: 25522.34] [ET: 0.332/28591.708] [MU: 5.03/25520.84] 
	SQL: SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
                              tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
                        FROM (SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,
                                    (route.rut_estm_distance + r1.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
                                FROM route
								INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
								INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
								INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) AND r3.rut_active=1 
								INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3) LIMIT 1
							)a
                        INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
                        INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1
                         
	 [params: []]
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28618.213] [M: 25528.72] [ET: 0.462/28592.246] [MU: 0.75/25527.84] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"GarageRoute_30804_30711","sql":" (INDEX GarageRoute_30804_30711_index_rut_id (rut_id), INDEX GarageRoute_30804_30711_index_rut_from_city_id (rut_from_city_id), INDEX GarageRoute_30804_30711_index_rut_to_city_id (rut_to_city_id))\r\n\t\t\t\t\t\t\tSELECT route.rut_id, route.rut_from_city_id, route.rut_to_city_id, route.rut_name, rut_estm_distance FROM route \r\n\t\t\t\t\t\t\tINNER JOIN cities_stats   ON cities_stats.cts_cty_id = route.rut_from_city_id\r\n\t\t\t\t\t\t\tAND rut_estm_distance < 300\r\n\t\t\t\t\t\t\tAND rut_active = 1\r\n\t\t\t\t\t\t\tAND route.rut_to_city_id=30804\r\n\t\t\t\t\t\t\tAND cities_stats.cts_vnd_cnt >= 3\r\n\t\t\t\t\t\t\tORDER BY rut_estm_distance LIMIT 10"}]
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28618.778] [M: 25540.64] [ET: 0.477/28592.79] [MU: 6.68/25538.89] 
	SQL: SELECT a.*, fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
								tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address 
						FROM ((SELECT xyz.rut_from_city_id as startCity, r1.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r3.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_from_city_id
							INNER JOIN rate ON rate.rte_route_id=r1.rut_id  AND rate.rte_vehicletype_id IN (3)
							INNER JOIN route r2 ON r2.rut_to_city_id=r1.rut_to_city_id AND r2.rut_from_city_id=:dropCity AND r2.rut_active=1
							INNER JOIN route r3 ON r3.rut_from_city_id=xyz.rut_to_city_id AND r3.rut_to_city_id=r2.rut_from_city_id AND r3.rut_active=1
							ORDER BY ExtraDistance LIMIT 1
							)
							UNION
							(
							SELECT xyz.rut_from_city_id as startCity, r2.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r2.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_to_city_id AND r1.rut_to_city_id=:dropCity
							INNER JOIN route r2 ON r2.rut_to_city_id=xyz.rut_from_city_id AND r2.rut_from_city_id=r1.rut_to_city_id
							ORDER BY ExtraDistance ASC LIMIT 1
							)) a
						INNER JOIN cities fc ON startCity=fc.cty_id
						INNER JOIN cities tc ON endCity=tc.cty_id 
						ORDER BY ExtraDistance 
	 [params: {"pickupCity":"30804","dropCity":"30711"}]
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28622.571] [M: 25551.98] [ET: 1.888/28596.582] [MU: 7.89/25551.88] 
	BookingRoute::calculateDistance
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28623.973] [M: 25557.55] [ET: 1.219/28598.007] [MU: 8.27/25557.45] 
	BookingRoute::calculateDistance
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28624.924] [M: 25569.18] [ET: 0.353/28598.943] [MU: 0.99/25568.8] 
	SQL: SELECT cts_airport_pickup_entry_fee
               FROM   cities
               INNER JOIN cities_stats
               ON cities.cty_id = cities_stats.cts_cty_id
               WHERE  cty_id = :cityId
               AND cty_is_airport = 1 AND cty_active = 1 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28626.744] [M: 25583.09] [ET: 1.1/28600.779] [MU: 8.14/25582.98] 
	BookingRoute::calculateDistance
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28627.721] [M: 25590.84] [ET: 0.879/28601.758] [MU: 8.08/25590.73] 
	BookingRoute::calculateDistance
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28628.165] [M: 25590.27] [ET: 0.364/28602.202] [MU: 0.9/25590.02] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28629.283] [M: 25602.98] [ET: 0.57/28603.315] [MU: 3.33/25602.54] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28629.927] [M: 25632.15] [ET: 0.524/28603.94] [MU: 22.53/25631.4] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp783)) OR (apr_area_type = 5 AND apr_area_id IN (:gp781)) OR (apr_area_type = 2 AND apr_area_id IN (:gp784)) OR (apr_area_type = 4 AND apr_area_id IN (:gp785)) OR (apr_area_type = 1 AND apr_area_id IN (:gp782))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp781":"3699",":gp782":"31",":gp783":"30804",":gp784":"105",":gp785":"1","cab":"113"}]
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28631.51] [M: 25619.17] [ET: 0.498/28605.542] [MU: 3.34/25618.73] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28633.857] [M: 25629.72] [ET: 2.216/28607.862] [MU: 3.53/25628.84] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp788)) OR (scr_area_type = 5 AND scr_area_id IN (:gp786)) OR (scr_area_type = 2 AND scr_area_id IN (:gp789)) OR (scr_area_type = 4 AND scr_area_id IN (:gp790)) OR (scr_area_type = 1 AND scr_area_id IN (:gp787)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp786":"3699",":gp787":"31",":gp788":"3699",":gp789":"105",":gp790":"1","scv_id":"113"}]
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28634.758] [M: 25632.92] [ET: 0.376/28608.779] [MU: 2.98/25632.81] 
	BookingRoute::calculateDistance
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28636.474] [M: 25646.03] [ET: 0.243/28610.512] [MU: 2.97/25645.92] 
	BookingRoute::calculateDistance
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28636.744] [M: 25650.2] [ET: 0.198/28610.784] [MU: 2.98/25650.09] 
	BookingRoute::calculateDistance
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28641.434] [M: 25684.16] [ET: 0.527/28615.459] [MU: 6.28/25682.16] 
	SQL: 
                SELECT cities.cty_id as c2id, cities.cty_name as c2name, cities.cty_garage_address as c2address,
                    cities.cty_id as c4id, cities.cty_name as c4name, cities.cty_garage_address as c4address,
                        (distance * 2) as totalExtraDistance
                 FROM (SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<40
                     INNER JOIN route r1 ON route.rut_to_city_id=r1.rut_from_city_id AND r1.rut_active=1
                     INNER JOIN rate ON r1.rut_id=rate.rte_route_id AND rate.rte_status=1  AND rate.rte_vehicletype_id IN (3) GROUP BY route.rut_id HAVING count(*) >30
                   UNION
                     SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<600
                     INNER JOIN cities tc ON tc.cty_id=route.rut_to_city_id AND tc.cty_service_active=1 AND CalcDistance(cities.cty_lat, cities.cty_long, tc.cty_lat, tc.cty_long)<=route.rut_estm_distance						 
                     INNER JOIN cities_stats ON cities_stats.cts_cty_id = route.rut_to_city_id AND cities_stats.cts_vnd_cnt >= 2
                   UNION
                    SELECT cts_cty_id AS city, 0 AS distance
					FROM cities_stats WHERE 1 AND cities_stats.cts_cty_id= 30817 and cities_stats.cts_vnd_cnt>1) a
                    INNER JOIN cities ON cities.cty_id=a.city
                    ORDER BY totalExtraDistance LIMIT 1 
	 [params: []]
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28644.022] [M: 25698.98] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"3","tripDistance":"","tripDuration":"","multiCityData":"","bookingType":"1","pickupAddress":"","pickupDate":"31\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","sccId":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=3&tripDistance=&tripDuration=&multiCityData=&bookingType=1&pickupAddress=&pickupDate=31%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&sccId=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28644.457] [M: 25723.82] [ET: 0.937/28618.497] [MU: 26.04/25723.71] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28644.488] [M: 25725.5] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28645.618] [M: 25738.96] [ET: 1.002/28619.642] [MU: 2.99/25736.46] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+10013),(IF((cpm_value_type=2),(10013+(10013*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30937 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30937) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-31 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=113 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28646.996] [M: 25781.19] [ET: 3.55/28621.03] [MU: 83.87/25781.03] 
	RouteRates::calculate for CAB 113 2024-10-31 18:00:00 - Trip Type: 1 142757475
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28647.134] [M: 25758.88] [ET: 40.228/28621.175] [MU: 320.53/25758.72] 
	Quote::calculateRules for CAB 113, From City Id: 30804, To city Id: 30711
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28647.39] [M: 25730.51] [ET: 0.177/28621.428] [MU: 0.9/25730.26] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"113"}]
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28647.46] [M: 25732.71] [ET: 3410.444/28621.501] [MU: -6428.48/25732.6] 
	Quote For CabType: 113
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28648.592] [M: 25743.04] [ET: 0.381/28622.626] [MU: 3.33/25742.6] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28649.002] [M: 25748.85] [ET: 0.341/28623.038] [MU: 3.34/25748.41] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30711"}]
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28649.589] [M: 25751.79] [ET: 0.502/28623.601] [MU: 0.9/25751.54] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28650.268] [M: 25784.15] [ET: 0.511/28624.28] [MU: 24.22/25782.65] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (100) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30711) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp791)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp794,:gp795)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp792,:gp793)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp796,:gp797))
			OR (scr_area_type = 5 AND scr_area_id IN (3699))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (114)
		ORDER BY rank DESC
		 
	 [params: {":gp791":"31",":gp792":"30804",":gp793":"30711",":gp794":"105",":gp795":"100",":gp796":"1",":gp797":"1","tripType":"1"}]
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28651.071] [M: 25764.34] [ET: 0.219/28625.09] [MU: 0.83/25764.15] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28651.495] [M: 25767.18] [ET: 0.31/28625.516] [MU: 0.93/25766.87] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"6"}]
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28653.128] [M: 25780.02] [ET: 0.461/28627.159] [MU: 2.05/25779.52] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"114"}]
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28656.157] [M: 25789.4] [ET: 2.801/28630.16] [MU: 3.54/25788.52] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"114","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28657.248] [M: 25792.65] [ET: 0.723/28631.276] [MU: 0.86/25792.43] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":0}]
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28657.959] [M: 25799.93] [ET: 0.537/28631.991] [MU: 2.96/25799.49] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28658.645] [M: 25828.1] [ET: 0.58/28632.677] [MU: 22.05/25827.48] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp799)) OR (apr_area_type = 2 AND apr_area_id IN (:gp800)) OR (apr_area_type = 4 AND apr_area_id IN (:gp801)) OR (apr_area_type = 1 AND apr_area_id IN (:gp798))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp798":"31",":gp799":"30804",":gp800":"105",":gp801":"1","cab":"114"}]
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28659.639] [M: 25814.83] [ET: 0.443/28633.674] [MU: 3.33/25814.39] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28661.889] [M: 25825.11] [ET: 2.129/28635.895] [MU: 3.41/25824.23] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp803)) OR (scr_area_type = 2 AND scr_area_id IN (:gp804)) OR (scr_area_type = 4 AND scr_area_id IN (:gp805)) OR (scr_area_type = 1 AND scr_area_id IN (:gp802)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp802":"31",":gp803":"30804",":gp804":"105",":gp805":"1","scv_id":"114"}]
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28664.518] [M: 25852.84] [ET: 1.86/28638.524] [MU: 0.74/25844.84] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"nearest_route_30804_30711","sql":"(INDEX indx_nearest_rt_rutid (rut_id)) \r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, routeFrom.rut_name as fromAlias, \r\n\t\t\t\tNULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, \r\n\t\t\t\t0 as rank, routeFrom.rut_estm_time as startTime, 0 as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 \r\n\t\t\t\tAND routeFrom.rut_from_city_id<>routeFrom.rut_to_city_id AND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\t\tAND (routeAlias.rut_to_city_id=route.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, NULL, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) \r\n\t\t\t\t\t\t\t- IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance, \r\n\t\t\t\t0 AS extraStartDistance, 0, 0 as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND route.rut_from_city_id = 30804 AND route.rut_to_city_id=30711 \r\n\t\t\t\tAND routeTo.rut_from_city_id=30711\r\n\t\t\t\tAND route.rut_active = 1 AND routeTo.rut_active = 1 AND routeTo.rut_estm_distance < 50 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = route.rut_from_city_id) \r\n\t\t\t   AND (routeAlias.rut_to_city_id = routeTo.rut_to_city_id) AND routeAlias.rut_active = 1  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)\r\n\t\t\tUNION\r\n\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id start, routeAlias.rut_to_city_id end, \r\n\t\t\t\trouteFrom.rut_name, routeTo.rut_name, routeAlias.rut_name, \r\n\t\t\t\troute.rut_estm_distance as quotedDistance, routeAlias.rut_estm_distance as rateDistance, \r\n\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) \r\n\t\t\t\t\t+ IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) \r\n\t\t\t\tAS extraDistance, IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance, 0, \r\n\t\t\t\trouteFrom.rut_estm_time as startTime, routeTo.rut_estm_time as endTime, route.rut_estm_time, \r\n\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeTo.rut_actual_distance, routeTo.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) as extraTravelDistance\r\n\t\t\tFROM   route\r\n\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_to_city_id = route.rut_from_city_id AND route.rut_from_city_id=30804 \r\n\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_to_city_id=30804 AND routeFrom.rut_estm_distance < 50 AND routeFrom.rut_from_city_id <> routeFrom.rut_to_city_id\r\n\t\t\t\t\tAND route.rut_active=1 AND routeFrom.rut_active=1\r\n\t\t\tINNER JOIN route routeTo ON routeTo.rut_from_city_id = route.rut_to_city_id AND routeTo.rut_estm_distance < 50 \r\n\t\t\t\t\tAND routeTo.rut_from_city_id=30711 AND routeTo.rut_from_city_id<>routeTo.rut_to_city_id\r\n\t\t\tINNER JOIN route routeAlias ON (routeAlias.rut_from_city_id = routeFrom.rut_from_city_id) \r\n\t\t\t\t\tAND (routeAlias.rut_to_city_id=routeTo.rut_to_city_id) AND routeAlias.rut_active = 1 AND routeAlias.rut_from_city_id=30804  AND routeAlias.rut_id IN (2200,14202,2850013,2868147,3005932,3139684,4352899)"}]
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28666.678] [M: 25856.91] [ET: 2.07/28640.706] [MU: 2.16/25856.48] 
	SQL: SELECT *, (rte_vendor_amount + extraDistance * 10.55) as totalCost FROM (SELECT * FROM nearest_route_30804_30711) a
					INNER JOIN rate ON a.rut_id = rate.rte_route_id AND rte_status=1 AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <>0
					WHERE 1 ORDER BY rank DESC, totalCost ASC LIMIT 0,1 
	 [params: {"cabType":"114"}]
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28667.516] [M: 25864.94] [ET: 0.728/28641.529] [MU: 0.74/25862.94] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"getNearestRoute_30804_30711_70","sql":"(INDEX getNearestRoute_30804_30711_70_index_rut_id (rut_id))\r\n\t\t\t\t\t\tSELECT routeAlias.rut_id, routeAlias.rut_from_city_id AS start, routeAlias.rut_to_city_id AS end,\r\n\t\t\t\t\t\t\t\trouteFrom.rut_name AS fromAlias, NULL AS toAlias, routeAlias.rut_name, route.rut_estm_distance AS quotedDistance,\r\n\t\t\t\t\t\t\t\trouteAlias.rut_estm_distance AS rateDistance, \r\n\t\t\t\t\t\t\t\t(IFNULL(route.rut_actual_distance, route.rut_estm_distance) + IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance)\r\n\t\t\t\t\t\t\t\t\t - IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraDistance,\r\n\t\t\t\t\t\t\t\tIFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) AS extraStartDistance,\r\n\t\t\t\t\t\t\t\t0 AS rank, routeFrom.rut_estm_time AS startTime, 0 AS endTime, route.rut_estm_time, \r\n\t\t\t\t\t\t\t\t(IFNULL(routeFrom.rut_actual_distance, routeFrom.rut_estm_distance) + IFNULL(routeAlias.rut_actual_distance, routeAlias.rut_estm_distance)) AS extraTravelDistance\r\n\t\t\t\t\t\tFROM   route\r\n\t\t\t\t\t\tINNER JOIN route routeTo ON routeTo.rut_to_city_id=route.rut_from_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_from_city_id=30804 AND routeTo.rut_active=1\r\n\t\t\t\t\t\t\t\tAND routeTo.rut_estm_distance<70 AND route.rut_active=1\r\n\t\t\t\t\t\tINNER JOIN route routeFrom ON routeFrom.rut_from_city_id=route.rut_to_city_id\r\n\t\t\t\t\t\t\t\tAND route.rut_to_city_id=30711 AND routeFrom.rut_active = 1\r\n\t\t\t\t\t\t\t\tAND routeFrom.rut_estm_distance<70 AND route.rut_active = 1\r\n\t\t\t\t\t\tINNER JOIN route routeAlias ON routeAlias.rut_to_city_id=routeFrom.rut_to_city_id\r\n\t\t\t\t\t\t\tAND routeAlias.rut_from_city_id=routeTo.rut_from_city_id AND routeAlias.rut_active = 1"}]
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28670.298] [M: 25870.2] [ET: 2.678/28644.304] [MU: 2.41/25869.58] 
	SQL: SELECT *, (rte_vendor_amount + extradistance * 10.55 ) AS totalCost, 
						ABS(quotedDistance-rateDistance) AS extraChargeableDistance
					FROM getNearestRoute_30804_30711_70 a
					INNER JOIN rate ON a.rut_id=rate.rte_route_id AND rte_status=1 
						AND rate.rte_vehicletype_id=:cabType AND rate.rte_vendor_amount <> 0
					WHERE  1
					ORDER  BY rank DESC, extraStartDistance, extraChargeableDistance ASC, totalcost ASC
					LIMIT  0, 1 
	 [params: {"cabType":"114"}]
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28674.723] [M: 25885.3] [ET: 0.706/28648.736] [MU: 3.41/25884.42] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"73","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28676.728] [M: 25901.91] [ET: 0.595/28650.739] [MU: 3.78/25901.04] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28678.059] [M: 25913.01] [ET: 24.86/28652.099] [MU: 131.57/25912.85] 
	Quote::calculateOneWay  for CAB 114 Date: 2024-10-31 18:00:00
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28678.522] [M: 25916.6] [ET: 0.365/28652.557] [MU: 0.89/25916.35] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28679.798] [M: 25929.31] [ET: 0.653/28653.815] [MU: 3.34/25928.88] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28680.467] [M: 25958.48] [ET: 0.527/28654.499] [MU: 22.53/25957.73] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp808)) OR (apr_area_type = 5 AND apr_area_id IN (:gp806)) OR (apr_area_type = 2 AND apr_area_id IN (:gp809)) OR (apr_area_type = 4 AND apr_area_id IN (:gp810)) OR (apr_area_type = 1 AND apr_area_id IN (:gp807))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp806":"3699",":gp807":"31",":gp808":"30804",":gp809":"105",":gp810":"1","cab":"114"}]
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28682.103] [M: 25945.51] [ET: 0.529/28656.137] [MU: 3.33/25945.07] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28684.692] [M: 25956.05] [ET: 2.463/28658.697] [MU: 3.53/25955.18] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp813)) OR (scr_area_type = 5 AND scr_area_id IN (:gp811)) OR (scr_area_type = 2 AND scr_area_id IN (:gp814)) OR (scr_area_type = 4 AND scr_area_id IN (:gp815)) OR (scr_area_type = 1 AND scr_area_id IN (:gp812)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp811":"3699",":gp812":"31",":gp813":"3699",":gp814":"105",":gp815":"1","scv_id":"114"}]
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28685.464] [M: 25973.22] [ET: 0.37/28659.485] [MU: 18.97/25973.11] 
	BookingRoute::calculateDistance
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28687.046] [M: 25983.42] [ET: 0.538/28661.077] [MU: 2.79/25982.8] 
	SQL: SELECT 
						fc.cty_id as c2id, 
						fc.cty_name as c2name, 
						fc.cty_garage_address as c2address,
						tc.cty_id as c4id,
						tc.cty_name as c4name, tc.cty_garage_address as c4address,
						0 as totalExtraDistance FROM route
						INNER JOIN cities fc ON rut_from_city_id=fc.cty_id
						INNER JOIN cities tc ON rut_to_city_id=tc.cty_id
						INNER JOIN rate on  rate.rte_route_id=route.rut_id  AND rate.rte_vehicletype_id IN (3)
						WHERE route.rut_from_city_id=30804 AND route.rut_to_city_id=30711 AND route.rut_active=1 
	 [params: []]
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28687.55] [M: 25997.3] [ET: 0.42/28661.57] [MU: 6.53/25995.3] 
	SQL: 
				SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address, tc.cty_id as c4id, 
				tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
					FROM
					 (
						(
							SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id,  
								r3.rut_to_city_id, route.rut_name , route.rut_id,
								(route.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, 
								r3.rut_estm_distance
							FROM route
							INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_from_city_id=30804  
									AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=route.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) 
									AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
						UNION
						(
							SELECT r3.rut_id, r3.rut_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,(route.rut_estm_distance + r1.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
							FROM route
							INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND  route.rut_to_city_id=30711 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
							INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND route.rut_to_city_id=r3.rut_to_city_id))	AND r3.rut_active=1 
							INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3)
						)
                     ) a
					INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
					INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1 
	 [params: []]
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28688.505] [M: 26007.81] [ET: 0.862/28662.513] [MU: 5.04/26006.31] 
	SQL: SELECT fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
                              tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address, totalExtraDistance
                        FROM (SELECT r3.rut_id as new_route_id, r3.rut_name as new_route_name, r3.rut_from_city_id, r3.rut_to_city_id, route.rut_name , route.rut_id,
                                    (route.rut_estm_distance + r1.rut_estm_distance + r2.rut_estm_distance - r3.rut_estm_distance) as totalExtraDistance, r3.rut_estm_distance
                                FROM route
								INNER JOIN route r1 ON route.rut_from_city_id = r1.rut_to_city_id AND route.rut_from_city_id=30804 AND r1.rut_active=1 AND route.rut_active=1 AND r1.rut_estm_distance<=60
								INNER JOIN route r2 ON route.rut_to_city_id = r2.rut_from_city_id AND route.rut_to_city_id=30711 AND r2.rut_active=1 AND r2.rut_estm_distance<=60
								INNER JOIN route r3 ON ((r3.rut_from_city_id=r1.rut_from_city_id AND r2.rut_to_city_id=r3.rut_to_city_id)) AND r3.rut_active=1 
								INNER JOIN rate on  rate.rte_route_id=r3.rut_id  AND rate.rte_vehicletype_id IN (3) LIMIT 1
							)a
                        INNER JOIN cities fc ON a.rut_from_city_id=fc.cty_id
                        INNER JOIN cities tc ON a.rut_to_city_id=tc.cty_id ORDER BY totalExtraDistance ASC LIMIT 1
                         
	 [params: []]
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28689.265] [M: 26014.19] [ET: 0.633/28663.269] [MU: 0.75/26013.31] 
	SQL: CALL prcCreateTempTable(:tableName, :sql) 
	 [params: {"tableName":"GarageRoute_30804_30711","sql":" (INDEX GarageRoute_30804_30711_index_rut_id (rut_id), INDEX GarageRoute_30804_30711_index_rut_from_city_id (rut_from_city_id), INDEX GarageRoute_30804_30711_index_rut_to_city_id (rut_to_city_id))\r\n\t\t\t\t\t\t\tSELECT route.rut_id, route.rut_from_city_id, route.rut_to_city_id, route.rut_name, rut_estm_distance FROM route \r\n\t\t\t\t\t\t\tINNER JOIN cities_stats   ON cities_stats.cts_cty_id = route.rut_from_city_id\r\n\t\t\t\t\t\t\tAND rut_estm_distance < 300\r\n\t\t\t\t\t\t\tAND rut_active = 1\r\n\t\t\t\t\t\t\tAND route.rut_to_city_id=30804\r\n\t\t\t\t\t\t\tAND cities_stats.cts_vnd_cnt >= 3\r\n\t\t\t\t\t\t\tORDER BY rut_estm_distance LIMIT 10"}]
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28690.18] [M: 26026.11] [ET: 0.797/28664.206] [MU: 6.69/26024.36] 
	SQL: SELECT a.*, fc.cty_id as c2id, fc.cty_name as c2name, fc.cty_garage_address as c2address,
								tc.cty_id as c4id, tc.cty_name as c4name, tc.cty_garage_address as c4address 
						FROM ((SELECT xyz.rut_from_city_id as startCity, r1.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r3.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_from_city_id
							INNER JOIN rate ON rate.rte_route_id=r1.rut_id  AND rate.rte_vehicletype_id IN (3)
							INNER JOIN route r2 ON r2.rut_to_city_id=r1.rut_to_city_id AND r2.rut_from_city_id=:dropCity AND r2.rut_active=1
							INNER JOIN route r3 ON r3.rut_from_city_id=xyz.rut_to_city_id AND r3.rut_to_city_id=r2.rut_from_city_id AND r3.rut_active=1
							ORDER BY ExtraDistance LIMIT 1
							)
							UNION
							(
							SELECT xyz.rut_from_city_id as startCity, r2.rut_to_city_id as endCity,
								   xyz.rut_name as startRoute, r1.rut_name as servingRoute, r2.rut_name as endRoute,
								   (xyz.rut_estm_distance + r2.rut_estm_distance) as ExtraDistance
							FROM GarageRoute_30804_30711 as xyz
							INNER JOIN route r1 ON r1.rut_from_city_id=xyz.rut_to_city_id AND r1.rut_to_city_id=:dropCity
							INNER JOIN route r2 ON r2.rut_to_city_id=xyz.rut_from_city_id AND r2.rut_from_city_id=r1.rut_to_city_id
							ORDER BY ExtraDistance ASC LIMIT 1
							)) a
						INNER JOIN cities fc ON startCity=fc.cty_id
						INNER JOIN cities tc ON endCity=tc.cty_id 
						ORDER BY ExtraDistance 
	 [params: {"pickupCity":"30804","dropCity":"30711"}]
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28693.274] [M: 26037.45] [ET: 1.311/28667.287] [MU: 7.89/26037.34] 
	BookingRoute::calculateDistance
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28694.709] [M: 26043.02] [ET: 1.302/28668.741] [MU: 8.27/26042.91] 
	BookingRoute::calculateDistance
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28695.53] [M: 26050.65] [ET: 0.308/28669.543] [MU: 1/26050.27] 
	SQL: SELECT cts_airport_pickup_entry_fee
               FROM   cities
               INNER JOIN cities_stats
               ON cities.cty_id = cities_stats.cts_cty_id
               WHERE  cty_id = :cityId
               AND cty_is_airport = 1 AND cty_active = 1 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28697.293] [M: 26064.56] [ET: 1.07/28671.328] [MU: 8.14/26064.45] 
	BookingRoute::calculateDistance
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28698.248] [M: 26072.3] [ET: 0.855/28672.286] [MU: 8.08/26072.2] 
	BookingRoute::calculateDistance
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28698.704] [M: 26071.64] [ET: 0.364/28672.721] [MU: 0.9/26071.39] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28699.975] [M: 26084.35] [ET: 0.585/28674.008] [MU: 3.34/26083.91] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28700.622] [M: 26113.52] [ET: 0.527/28674.635] [MU: 22.54/26112.77] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp818)) OR (apr_area_type = 5 AND apr_area_id IN (:gp816)) OR (apr_area_type = 2 AND apr_area_id IN (:gp819)) OR (apr_area_type = 4 AND apr_area_id IN (:gp820)) OR (apr_area_type = 1 AND apr_area_id IN (:gp817))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp816":"3699",":gp817":"31",":gp818":"30804",":gp819":"105",":gp820":"1","cab":"114"}]
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28702.219] [M: 26100.55] [ET: 0.518/28676.252] [MU: 3.33/26100.11] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28705.465] [M: 26111.09] [ET: 3.123/28679.472] [MU: 3.53/26110.22] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp823)) OR (scr_area_type = 5 AND scr_area_id IN (:gp821)) OR (scr_area_type = 2 AND scr_area_id IN (:gp824)) OR (scr_area_type = 4 AND scr_area_id IN (:gp825)) OR (scr_area_type = 1 AND scr_area_id IN (:gp822)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp821":"3699",":gp822":"31",":gp823":"3699",":gp824":"105",":gp825":"1","scv_id":"114"}]
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28706.365] [M: 26114.3] [ET: 0.391/28680.384] [MU: 2.98/26114.19] 
	BookingRoute::calculateDistance
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28708.161] [M: 26127.31] [ET: 0.249/28682.2] [MU: 2.98/26127.2] 
	BookingRoute::calculateDistance
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28708.436] [M: 26131.39] [ET: 0.207/28682.476] [MU: 2.97/26131.28] 
	BookingRoute::calculateDistance
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28711.956] [M: 26165.45] [ET: 0.506/28685.982] [MU: 6.28/26163.45] 
	SQL: 
                SELECT cities.cty_id as c2id, cities.cty_name as c2name, cities.cty_garage_address as c2address,
                    cities.cty_id as c4id, cities.cty_name as c4name, cities.cty_garage_address as c4address,
                        (distance * 2) as totalExtraDistance
                 FROM (SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<40
                     INNER JOIN route r1 ON route.rut_to_city_id=r1.rut_from_city_id AND r1.rut_active=1
                     INNER JOIN rate ON r1.rut_id=rate.rte_route_id AND rate.rte_status=1  AND rate.rte_vehicletype_id IN (3) GROUP BY route.rut_id HAVING count(*) >30
                   UNION
                     SELECT route.rut_to_city_id as city, route.rut_estm_distance as distance FROM cities
                     INNER JOIN route ON cities.cty_id=route.rut_from_city_id AND rut_active=1 AND cities.cty_id=30817 AND route.rut_estm_distance<600
                     INNER JOIN cities tc ON tc.cty_id=route.rut_to_city_id AND tc.cty_service_active=1 AND CalcDistance(cities.cty_lat, cities.cty_long, tc.cty_lat, tc.cty_long)<=route.rut_estm_distance						 
                     INNER JOIN cities_stats ON cities_stats.cts_cty_id = route.rut_to_city_id AND cities_stats.cts_vnd_cnt >= 2
                   UNION
                    SELECT cts_cty_id AS city, 0 AS distance
					FROM cities_stats WHERE 1 AND cities_stats.cts_cty_id= 30817 and cities_stats.cts_vnd_cnt>1) a
                    INNER JOIN cities ON cities.cty_id=a.city
                    ORDER BY totalExtraDistance LIMIT 1 
	 [params: []]
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28717.035] [M: 26180.26] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"3","tripDistance":"","tripDuration":"","multiCityData":"","bookingType":"1","pickupAddress":"","pickupDate":"31\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","sccId":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=3&tripDistance=&tripDuration=&multiCityData=&bookingType=1&pickupAddress=&pickupDate=31%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&sccId=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28717.678] [M: 26197.1] [ET: 1.21/28691.7] [MU: 18.04/26196.99] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28717.728] [M: 26198.78] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28718.788] [M: 26212.24] [ET: 0.893/28692.806] [MU: 2.99/26209.74] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+10013),(IF((cpm_value_type=2),(10013+(10013*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30937 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30937) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-31 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=114 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28720.731] [M: 26254.47] [ET: 4.346/28694.749] [MU: 75.88/26254.31] 
	RouteRates::calculate for CAB 114 2024-10-31 18:00:00 - Trip Type: 1 272536332
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28720.959] [M: 26232.16] [ET: 42.824/28694.978] [MU: 317.59/26232] 
	Quote::calculateRules for CAB 114, From City Id: 30804, To city Id: 30711
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28721.725] [M: 26203.79] [ET: 0.625/28695.752] [MU: 0.9/26203.54] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"114"}]
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28721.817] [M: 26205.98] [ET: 74.307/28695.856] [MU: 471.98/26205.88] 
	Quote For CabType: 114
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28742.035] [M: 26248.03] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.QuotesDataCreated.setData START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"3","tripDistance":"","tripDuration":"","multiCityData":"","bookingType":"1","pickupAddress":"","pickupDate":"31\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","sccId":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=3&tripDistance=&tripDuration=&multiCityData=&bookingType=1&pickupAddress=&pickupDate=31%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&sccId=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28824.981] [M: 26329.39] [ET: 28.825/28799.011] [MU: 15.61/26329.28] 
	QuotesDataPickup::setData for CAB Array
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28825.061] [M: 26324.97] [ET: 83.46/28799.102] [MU: 78.14/26324.86] 
	models.QuotesDataCreated.setData
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28825.093] [M: 26326.65] 
============================================================Profile models.QuotesDataCreated.setData DONE==================================================
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28825.182] [M: 26323.06] [ET: 28313.377/28799.223] [MU: 7513.02/26322.95] 
	models.Quote.getQuote
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28825.292] [M: 26326.54] 
============================================================Profile models.Quote.getQuote DONE==================================================
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28905.646] [M: 26718.93] [ET: 0.762/28879.672] [MU: 1.03/26718.55] 
	SQL: SELECT GROUP_CONCAT(zones.zon_id) as zones FROM cities c1
					INNER JOIN zone_cities ON zone_cities.zct_cty_id = c1.cty_id AND zct_active=1
					INNER JOIN zones ON zone_cities.zct_zon_id = zones.zon_id AND zon_active=1
					WHERE c1.cty_id = 30804 
	 [params: []]
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28908.239] [M: 26721.98] [ET: 0.847/28882.266] [MU: 1.02/26721.61] 
	SQL: SELECT GROUP_CONCAT(zones.zon_id) as zones FROM cities c1
					INNER JOIN zone_cities ON zone_cities.zct_cty_id = c1.cty_id AND zct_active=1
					INNER JOIN zones ON zone_cities.zct_zon_id = zones.zon_id AND zon_active=1
					WHERE c1.cty_id = 30711 
	 [params: []]
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28914.421] [M: 26727.65] [ET: 4.565/28888.423] [MU: 2.35/26727.27] 
	SQL: SELECT dzs_zone_type FROM dynamic_zone_surge WHERE dzs_fromzoneid IN (:gp826) AND dzs_tozoneid IN (:gp827,:gp828) AND dzs_scv_id=:cab AND dzs_booking_type=:tripType  ORDER BY  dzs_zone_type ASC 
	 [params: {":gp827":"238",":gp828":"79",":gp826":"31","cab":3,"tripType":"1"}]
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28938.035] [M: 26730.55] [ET: 22.978/28912.048] [MU: 1.24/26729.93] 
	SQL: SELECT prc_cancel_rule_id FROM `partner_cancel_rule` 
			WHERE (prc_zone_category = :zoneType OR prc_zone_category IS NULL)
		AND (prc_scc_id = :sccId OR prc_scc_id IS NULL)
		AND (prc_partner_id = :partnerId OR prc_partner_id IS NULL) 
		AND (prc_bkg_type = :tripType OR prc_bkg_type IS NULL) 
		 AND (prc_is_gozonow IS NULL) 
		AND prc_active=1  
		ORDER BY prc_partner_id DESC, prc_bkg_type DESC  
	 [params: {"zoneType":1,"sccId":"1","partnerId":null,"tripType":"1"}]
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28960.606] [M: 26788.83] [ET: 0.419/28934.639] [MU: 2.97/26788.39] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28962.961] [M: 26795.41] [ET: 1.734/28936.981] [MU: 2.34/26795.03] 
	SQL: SELECT dzs_zone_type FROM dynamic_zone_surge WHERE dzs_fromzoneid IN (:gp829) AND dzs_tozoneid IN (:gp830,:gp831) AND dzs_scv_id=:cab AND dzs_booking_type=:tripType  ORDER BY  dzs_zone_type ASC 
	 [params: {":gp830":"238",":gp831":"79",":gp829":"31","cab":3,"tripType":"1"}]
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 28981.247] [M: 26825.46] [ET: 18.148/28955.249] [MU: 25.26/26824.21] 
	SQL: SELECT addon_cancellation_policy.*,
								CASE
											WHEN acp_area_type=1 AND acp_area_id IN (31) THEN 5
											WHEN acp_area_type=2 AND acp_area_id IN (105) THEN 15
											WHEN acp_area_type=3 AND acp_area_id IN (30804) THEN 20
											WHEN acp_area_type=4 AND acp_area_id IN (1) THEN 1
											WHEN acp_area_type=5 AND acp_area_id IN (-1) THEN 10
											ELSE 0
											END AS rank FROM addon_cancellation_policy
						WHERE (
								(acp_area_type = 1 AND acp_area_id IN (:gp832))
								OR (acp_area_type = 2 AND acp_area_id IN (:gp834))
								OR (acp_area_type = 3 AND acp_area_id IN (:gp833))
								OR (acp_area_type = 4 AND acp_area_id IN (:gp835))
								OR (acp_area_type = 5 AND acp_area_id IN (-1))
								OR acp_area_type IS NULL)
							AND acp_cr_from = :defCanRuleId AND acp_active=1 AND acp_is_allowed = 1
						ORDER BY rank DESC 
	 [params: {":gp832":"31",":gp833":"30804",":gp834":"105",":gp835":"1","defCanRuleId":"4"}]
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 29000.534] [M: 26822.23] [ET: 2.232/28974.553] [MU: 2.65/26822.04] 
	SQL: SELECT acp_cr_to,acp_margin_data FROM `addon_cancellation_policy` WHERE `acp_id` = :id 
	 [params: {"id":"8"}]
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 29047.276] [M: 26861.54] [ET: 0.326/29021.286] [MU: 1.42/26861.35] 
	SQL: SELECT acp_cr_to,acp_margin_data FROM `addon_cancellation_policy` WHERE `acp_id` = :id 
	 [params: {"id":"9"}]
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 29072.405] [M: 26941.3] [ET: 0.446/29046.438] [MU: 2.96/26940.86] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 29074.891] [M: 26947.75] [ET: 1.849/29048.9] [MU: 2.35/26947.38] 
	SQL: SELECT dzs_zone_type FROM dynamic_zone_surge WHERE dzs_fromzoneid IN (:gp836) AND dzs_tozoneid IN (:gp837,:gp838) AND dzs_scv_id=:cab AND dzs_booking_type=:tripType  ORDER BY  dzs_zone_type ASC 
	 [params: {":gp837":"238",":gp838":"79",":gp836":"31","cab":3,"tripType":"1"}]
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 29088.187] [M: 26976.41] [ET: 13.121/29062.187] [MU: 24.25/26975.41] 
	SQL: SELECT addon_cab_models.*,
								CASE
											WHEN acm_area_type=1 AND acm_area_id IN (31) THEN 5
											WHEN acm_area_type=2 AND acm_area_id IN (105) THEN 15
											WHEN acm_area_type=3 AND acm_area_id IN (30804) THEN 20
											WHEN acm_area_type=4 AND acm_area_id IN (1) THEN 1
											WHEN acm_area_type=5 AND acm_area_id IN (-1) THEN 10
											ELSE 0
											END AS rank FROM addon_cab_models
						WHERE (
								(acm_area_type = 1 AND acm_area_id IN (:gp839))
								OR (acm_area_type = 2 AND acm_area_id IN (:gp841))
								OR (acm_area_type = 3 AND acm_area_id IN (:gp840))
								OR (acm_area_type = 4 AND acm_area_id IN (:gp842))
								OR (acm_area_type = 5 AND acm_area_id IN (-1))
								OR acm_area_type IS NULL)
							AND acm_scv_id_from = :svcId AND acm_active=1
						ORDER BY rank DESC 
	 [params: {":gp839":"31",":gp840":"30804",":gp841":"105",":gp842":"1","svcId":3}]
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 29090.95] [M: 26953.98] [ET: 0.515/29064.948] [MU: 1.34/26953.8] 
	SQL: SELECT acm_svc_id_to,acm_margin_data FROM `addon_cab_models` WHERE `acm_id` = :id 
	 [params: {"id":"1"}]
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 29092.128] [M: 26957.8] [ET: 0.401/29066.139] [MU: 1.34/26957.61] 
	SQL: SELECT acm_svc_id_to,acm_margin_data FROM `addon_cab_models` WHERE `acm_id` = :id 
	 [params: {"id":"2"}]
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 29093.317] [M: 26961.23] [ET: 0.442/29067.316] [MU: 1.34/26961.05] 
	SQL: SELECT acm_svc_id_to,acm_margin_data FROM `addon_cab_models` WHERE `acm_id` = :id 
	 [params: {"id":"3"}]
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 29094.246] [M: 26964.67] [ET: 0.242/29068.278] [MU: 1.35/26964.48] 
	SQL: SELECT acm_svc_id_to,acm_margin_data FROM `addon_cab_models` WHERE `acm_id` = :id 
	 [params: {"id":"4"}]
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 29161.14] [M: 27365.02] [ET: 17.418/29135.159] [MU: 48.95/27363.77] 
	SQL:  SELECT scv_id,scc_id, vct_id, scc_cancel_rule, scc_label,scc_rank, scv_label, scv_code, scc_model_year, 
								CONCAT(vct_label, ' (', scc_label , ')') label,
									vct_label,vct_rank, vct_desc, CONCAT(vct_label, ' ', vct_desc) vhcName, 
									vct_capacity, IF(vct_image IS NULL, 'images/cabs/no-image.png', vct_image) as vct_image, vct_big_bag_capacity, vct_small_bag_capacity, vcsc_small_bag, FLOOR(vcsc_small_bag/2) AS big_bag,
									scc_is_cng, scc_is_petrol_diesel, scc_id, scc_desc, IF( vct_id IN(5, 6), '1', '0' ) AS is_assured, scv_vct_id,scv_parent_id,scv_vct_id,scv_model,scv_scc_id
						FROM svc_class_vhc_cat
						INNER JOIN service_class ON scc_id = scv_scc_id
						INNER JOIN vehicle_category ON vct_id = scv_vct_id
						INNER JOIN vehicle_cat_svc_class on vcsc_ssc_id = scv_scc_id AND vcsc_vct_id = scv_vct_id
						WHERE scv_active = 1 
							AND scc_active = 1 
						AND vct_active = 1
		 AND scv_vct_id = 3 
	 [params: []]
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 29188.263] [M: 27307.32] [ET: 29087.635/29162.294] [MU: 17259.42/27307.2] 
	module.admin.controller.booking.getamountbyvehicle
2024/10/17 13:53:44 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 29188.297] [M: 27307.97] 
*******************************************************module.admin.controller.booking.getamountbyvehicle ACTION DONE****************************************************************
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 86.022] [M: 10054.5] 
------------------------------------------------------module.admin.controller.booking.getamountbyvehicle ACTION START------------------------------------------------------
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"3","tripDistance":"664","tripDuration":"690","multiCityData":"[{\"pickup_city\":\"30804\",\"drop_city\":\"30711\",\"pickup_address\":\"\",\"drop_address\":null,\"date\":\"2024-10-31 18:00:00\",\"distance\":\"664\",\"duration\":\"680\"}]","bookingType":"1","pickupAddress":"","dropupAddress":"","routeDataArr":[{"locLatVal":"","locLonVal":"","brtLocationVal":""},{"locLatVal":"","locLonVal":"","brtLocationVal":""}],"pickupDate":"31\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=3&tripDistance=664&tripDuration=690&multiCityData=%5B%7B%22pickup_city%22%3A%2230804%22%2C%22drop_city%22%3A%2230711%22%2C%22pickup_address%22%3A%22%22%2C%22drop_address%22%3Anull%2C%22date%22%3A%222024-10-31+18%3A00%3A00%22%2C%22distance%22%3A%22664%22%2C%22duration%22%3A%22680%22%7D%5D&bookingType=1&pickupAddress=&dropupAddress=&routeDataArr%5B0%5D%5BlocLatVal%5D=&routeDataArr%5B0%5D%5BlocLonVal%5D=&routeDataArr%5B0%5D%5BbrtLocationVal%5D=&routeDataArr%5B1%5D%5BlocLatVal%5D=&routeDataArr%5B1%5D%5BlocLonVal%5D=&routeDataArr%5B1%5D%5BbrtLocationVal%5D=&pickupDate=31%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 133.165] [M: 11290.7] setLocationRequest start
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 216.005] [M: 11291.21] setLocationRequest ends
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 299.017] [M: 18116.59] [ET: 0.723/277.151] [MU: 0.84/18116.41] 
	SQL: SELECT COUNT(1) as cnt FROM cities WHERE cty_active=1 AND cty_service_active=1 AND cty_id=30804 
	 [params: []]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 299.551] [M: 18117.89] [ET: 0.419/277.694] [MU: 0.84/18117.7] 
	SQL: SELECT COUNT(1) as cnt FROM cities WHERE cty_active=1 AND cty_service_active=1 AND cty_id=30711 
	 [params: []]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 319.475] [M: 18604.77] [ET: 19.805/297.58] [MU: 486.78/18604.66] 
	BookingRoute::calculateDistance
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 320.216] [M: 18602.19] [ET: 0.374/298.357] [MU: 5.12/18602.08] 
	BookingRoute::calculateDistance
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 320.311] [M: 18598.23] [ET: 54.218/298.455] [MU: 5974.33/18598.14] 
	validateRoutes
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 323.594] [M: 18831.35] [ET: 0.721/301.726] [MU: 27.08/18831.13] 
	SQL: SELECT scv_id FROM svc_class_vhc_cat WHERE scv_active = 1 AND scv_scc_id IN (1,2,4,6) ORDER BY scv_vct_id ASC,scv_scc_id ASC 
	 [params: []]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 325.599] [M: 18821.74] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.Quote.getQuote START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"3","tripDistance":"664","tripDuration":"690","multiCityData":"[{\"pickup_city\":\"30804\",\"drop_city\":\"30711\",\"pickup_address\":\"\",\"drop_address\":null,\"date\":\"2024-10-31 18:00:00\",\"distance\":\"664\",\"duration\":\"680\"}]","bookingType":"1","pickupAddress":"","dropupAddress":"","routeDataArr":[{"locLatVal":"","locLonVal":"","brtLocationVal":""},{"locLatVal":"","locLonVal":"","brtLocationVal":""}],"pickupDate":"31\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=3&tripDistance=664&tripDuration=690&multiCityData=%5B%7B%22pickup_city%22%3A%2230804%22%2C%22drop_city%22%3A%2230711%22%2C%22pickup_address%22%3A%22%22%2C%22drop_address%22%3Anull%2C%22date%22%3A%222024-10-31+18%3A00%3A00%22%2C%22distance%22%3A%22664%22%2C%22duration%22%3A%22680%22%7D%5D&bookingType=1&pickupAddress=&dropupAddress=&routeDataArr%5B0%5D%5BlocLatVal%5D=&routeDataArr%5B0%5D%5BlocLonVal%5D=&routeDataArr%5B0%5D%5BbrtLocationVal%5D=&routeDataArr%5B1%5D%5BlocLatVal%5D=&routeDataArr%5B1%5D%5BlocLonVal%5D=&routeDataArr%5B1%5D%5BbrtLocationVal%5D=&pickupDate=31%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 328.41] [M: 18951.13] [ET: 0.435/306.568] [MU: 8.84/18950.69] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 328.846] [M: 18956.07] [ET: 0.371/307.007] [MU: 3.34/18955.63] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30711"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 329.433] [M: 18958.11] [ET: 0.505/307.571] [MU: 0.9/18957.89] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 330.53] [M: 19009.27] [ET: 0.916/308.631] [MU: 43.61/19007.77] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (100) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30711) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp0)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp3,:gp4)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp1,:gp2)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp5,:gp6))
			OR (scr_area_type = 5 AND scr_area_id IN (3699))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (3)
		ORDER BY rank DESC
		 
	 [params: {":gp0":"31",":gp1":"30804",":gp2":"30711",":gp3":"105",":gp4":"100",":gp5":"1",":gp6":"1","tripType":"1"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 344.545] [M: 19059.63] [ET: 0.471/322.673] [MU: 0.84/19059.45] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 345.154] [M: 19061.92] [ET: 0.483/323.287] [MU: 0.96/19061.61] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"1"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 363.859] [M: 19512.4] [ET: 0.695/341.983] [MU: 3.79/19511.52] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 366.141] [M: 19521.76] [ET: 3.211/344.287] [MU: 17.61/19521.63] 
	Quote::calculateOneWay  for CAB 3 Date: 2024-10-31 18:00:00
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 369.259] [M: 19686.95] [ET: 0.646/347.411] [MU: 0.9/19686.73] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 371.911] [M: 19818.54] [ET: 0.497/350.067] [MU: 7.33/19818.1] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 372.592] [M: 19850.4] [ET: 0.57/350.745] [MU: 25.34/19849.65] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp9)) OR (apr_area_type = 5 AND apr_area_id IN (:gp7)) OR (apr_area_type = 2 AND apr_area_id IN (:gp10)) OR (apr_area_type = 4 AND apr_area_id IN (:gp11)) OR (apr_area_type = 1 AND apr_area_id IN (:gp8))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp7":"3699",":gp8":"31",":gp9":"30804",":gp10":"105",":gp11":"1","cab":"3"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 386.041] [M: 19853.25] [ET: 0.418/364.184] [MU: 7.1/19853.14] 
	BookingRoute::calculateDistance
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 405.689] [M: 19916.02] [ET: 1.334/383.829] [MU: 7.88/19915.91] 
	BookingRoute::calculateDistance
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 407.039] [M: 19921.49] [ET: 1.211/385.179] [MU: 8.27/19921.38] 
	BookingRoute::calculateDistance
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 410.827] [M: 19930.39] [ET: 2.977/388.956] [MU: 2.36/19930.02] 
	SQL: SELECT cts_airport_pickup_entry_fee
               FROM   cities
               INNER JOIN cities_stats
               ON cities.cty_id = cities_stats.cts_cty_id
               WHERE  cty_id = :cityId
               AND cty_is_airport = 1 AND cty_active = 1 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 412.797] [M: 19944.35] [ET: 1.19/390.957] [MU: 8.13/19944.24] 
	BookingRoute::calculateDistance
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 413.7] [M: 19952.09] [ET: 0.807/391.862] [MU: 8.08/19951.98] 
	BookingRoute::calculateDistance
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 414.726] [M: 19951.4] [ET: 0.789/392.776] [MU: 0.9/19951.18] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 416.592] [M: 19963.77] [ET: 0.7/394.75] [MU: 2.97/19963.34] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 417.278] [M: 19995.55] [ET: 0.582/395.436] [MU: 25.27/19994.8] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp14)) OR (apr_area_type = 5 AND apr_area_id IN (:gp12)) OR (apr_area_type = 2 AND apr_area_id IN (:gp15)) OR (apr_area_type = 4 AND apr_area_id IN (:gp16)) OR (apr_area_type = 1 AND apr_area_id IN (:gp13))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp12":"3699",":gp13":"31",":gp14":"30804",":gp15":"105",":gp16":"1","cab":"3"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 418.19] [M: 19979.45] [ET: 0.215/396.355] [MU: 2.98/19979.34] 
	BookingRoute::calculateDistance
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 419.382] [M: 20004.59] [ET: 0.22/397.547] [MU: 15.11/20004.48] 
	BookingRoute::calculateDistance
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 419.654] [M: 20004.92] [ET: 0.207/397.82] [MU: 2.98/20004.81] 
	BookingRoute::calculateDistance
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 423.067] [M: 20040.86] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"3","tripDistance":"664","tripDuration":"690","multiCityData":"[{\"pickup_city\":\"30804\",\"drop_city\":\"30711\",\"pickup_address\":\"\",\"drop_address\":null,\"date\":\"2024-10-31 18:00:00\",\"distance\":\"664\",\"duration\":\"680\"}]","bookingType":"1","pickupAddress":"","dropupAddress":"","routeDataArr":[{"locLatVal":"","locLonVal":"","brtLocationVal":""},{"locLatVal":"","locLonVal":"","brtLocationVal":""}],"pickupDate":"31\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=3&tripDistance=664&tripDuration=690&multiCityData=%5B%7B%22pickup_city%22%3A%2230804%22%2C%22drop_city%22%3A%2230711%22%2C%22pickup_address%22%3A%22%22%2C%22drop_address%22%3Anull%2C%22date%22%3A%222024-10-31+18%3A00%3A00%22%2C%22distance%22%3A%22664%22%2C%22duration%22%3A%22680%22%7D%5D&bookingType=1&pickupAddress=&dropupAddress=&routeDataArr%5B0%5D%5BlocLatVal%5D=&routeDataArr%5B0%5D%5BlocLonVal%5D=&routeDataArr%5B0%5D%5BbrtLocationVal%5D=&routeDataArr%5B1%5D%5BlocLatVal%5D=&routeDataArr%5B1%5D%5BlocLonVal%5D=&routeDataArr%5B1%5D%5BbrtLocationVal%5D=&pickupDate=31%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 423.492] [M: 20059.95] [ET: 0.869/401.657] [MU: 21.05/20059.84] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 423.525] [M: 20061.63] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 425.637] [M: 20144.91] [ET: 0.841/403.784] [MU: 3.2/20142.41] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+10013),(IF((cpm_value_type=2),(10013+(10013*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30937 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30937) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-31 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=3 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 458.815] [M: 21501.01] [ET: 36.231/436.946] [MU: 1462.56/21500.85] 
	RouteRates::calculate for CAB 3 2024-10-31 18:00:00 - Trip Type: 1 718214604
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 459.087] [M: 21478.68] [ET: 92.847/437.233] [MU: 1955.45/21478.52] 
	Quote::calculateRules for CAB 3, From City Id: 30804, To city Id: 30711
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 459.616] [M: 21451.3] [ET: 0.412/437.77] [MU: 0.9/21451.05] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"3"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 459.701] [M: 21452.58] [ET: 134.005/437.865] [MU: 2627.6/21452.48] 
	Quote For CabType: 3
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 460.888] [M: 21466.52] [ET: 0.43/439.047] [MU: 2.97/21466.08] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 461.341] [M: 21472.33] [ET: 0.385/439.502] [MU: 3.33/21471.89] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30711"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 461.894] [M: 21475.23] [ET: 0.484/440.052] [MU: 0.9/21475.02] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 462.477] [M: 21507.63] [ET: 0.476/440.632] [MU: 24.22/21506.13] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (100) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30711) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp17)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp20,:gp21)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp18,:gp19)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp22,:gp23))
			OR (scr_area_type = 5 AND scr_area_id IN (3699))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (16)
		ORDER BY rank DESC
		 
	 [params: {":gp17":"31",":gp18":"30804",":gp19":"30711",":gp20":"105",":gp21":"100",":gp22":"1",":gp23":"1","tripType":"1"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 463.322] [M: 21487.8] [ET: 0.236/441.48] [MU: 0.83/21487.61] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 463.662] [M: 21490.67] [ET: 0.265/441.822] [MU: 0.96/21490.36] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"2"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 465.769] [M: 21508.53] [ET: 0.685/443.926] [MU: 3.78/21507.66] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"16","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 467.353] [M: 21525.15] [ET: 0.474/445.51] [MU: 3.79/21524.27] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 468.451] [M: 21535.37] [ET: 3.558/446.615] [MU: 35.07/21535.24] 
	Quote::calculateOneWay  for CAB 16 Date: 2024-10-31 18:00:00
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 468.974] [M: 21538.87] [ET: 0.417/447.115] [MU: 0.9/21538.65] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 470.192] [M: 21551.61] [ET: 0.478/448.351] [MU: 3.33/21551.17] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 470.906] [M: 21580.53] [ET: 0.608/449.06] [MU: 22.4/21579.78] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp26)) OR (apr_area_type = 5 AND apr_area_id IN (:gp24)) OR (apr_area_type = 2 AND apr_area_id IN (:gp27)) OR (apr_area_type = 4 AND apr_area_id IN (:gp28)) OR (apr_area_type = 1 AND apr_area_id IN (:gp25))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp24":"3699",":gp25":"31",":gp26":"30804",":gp27":"105",":gp28":"1","cab":"16"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 472.309] [M: 21567.79] [ET: 0.438/450.47] [MU: 3.33/21567.35] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 474.931] [M: 21578.5] [ET: 2.503/453.064] [MU: 3.7/21577.63] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp31)) OR (scr_area_type = 5 AND scr_area_id IN (:gp29)) OR (scr_area_type = 2 AND scr_area_id IN (:gp32)) OR (scr_area_type = 4 AND scr_area_id IN (:gp33)) OR (scr_area_type = 1 AND scr_area_id IN (:gp30)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp29":"3699",":gp30":"31",":gp31":"3699",":gp32":"105",":gp33":"1","scv_id":"16"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 475.641] [M: 21583.79] [ET: 0.322/453.795] [MU: 7.1/21583.7] 
	BookingRoute::calculateDistance
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 477.823] [M: 21596.32] [ET: 1.199/455.982] [MU: 7.88/21596.21] 
	BookingRoute::calculateDistance
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 478.971] [M: 21601.8] [ET: 1.059/457.132] [MU: 8.27/21601.69] 
	BookingRoute::calculateDistance
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 479.819] [M: 21625.14] [ET: 0.367/457.98] [MU: 0.99/21624.77] 
	SQL: SELECT cts_airport_pickup_entry_fee
               FROM   cities
               INNER JOIN cities_stats
               ON cities.cty_id = cities_stats.cts_cty_id
               WHERE  cty_id = :cityId
               AND cty_is_airport = 1 AND cty_active = 1 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 481.755] [M: 21639.05] [ET: 1.264/459.909] [MU: 8.13/21638.95] 
	BookingRoute::calculateDistance
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 482.785] [M: 21646.8] [ET: 0.933/460.947] [MU: 8.08/21646.69] 
	BookingRoute::calculateDistance
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 483.215] [M: 21646.1] [ET: 0.348/461.376] [MU: 0.9/21645.88] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 484.248] [M: 21658.48] [ET: 0.507/462.407] [MU: 2.97/21658.04] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 484.991] [M: 21687.4] [ET: 0.64/463.15] [MU: 22.41/21686.65] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp36)) OR (apr_area_type = 5 AND apr_area_id IN (:gp34)) OR (apr_area_type = 2 AND apr_area_id IN (:gp37)) OR (apr_area_type = 4 AND apr_area_id IN (:gp38)) OR (apr_area_type = 1 AND apr_area_id IN (:gp35))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp34":"3699",":gp35":"31",":gp36":"30804",":gp37":"105",":gp38":"1","cab":"16"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 486.364] [M: 21674.66] [ET: 0.451/464.523] [MU: 3.33/21674.22] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 488.479] [M: 21685.2] [ET: 2.007/466.628] [MU: 3.53/21684.33] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp41)) OR (scr_area_type = 5 AND scr_area_id IN (:gp39)) OR (scr_area_type = 2 AND scr_area_id IN (:gp42)) OR (scr_area_type = 4 AND scr_area_id IN (:gp43)) OR (scr_area_type = 1 AND scr_area_id IN (:gp40)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp39":"3699",":gp40":"31",":gp41":"3699",":gp42":"105",":gp43":"1","scv_id":"16"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 489.068] [M: 21688.42] [ET: 0.255/467.231] [MU: 2.98/21688.31] 
	BookingRoute::calculateDistance
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 490.573] [M: 21705.56] [ET: 0.232/468.735] [MU: 7.11/21705.45] 
	BookingRoute::calculateDistance
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 490.845] [M: 21705.89] [ET: 0.205/469.01] [MU: 2.97/21705.78] 
	BookingRoute::calculateDistance
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 494.554] [M: 21741.78] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"3","tripDistance":"664","tripDuration":"690","multiCityData":"[{\"pickup_city\":\"30804\",\"drop_city\":\"30711\",\"pickup_address\":\"\",\"drop_address\":null,\"date\":\"2024-10-31 18:00:00\",\"distance\":\"664\",\"duration\":\"680\"}]","bookingType":"1","pickupAddress":"","dropupAddress":"","routeDataArr":[{"locLatVal":"","locLonVal":"","brtLocationVal":""},{"locLatVal":"","locLonVal":"","brtLocationVal":""}],"pickupDate":"31\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=3&tripDistance=664&tripDuration=690&multiCityData=%5B%7B%22pickup_city%22%3A%2230804%22%2C%22drop_city%22%3A%2230711%22%2C%22pickup_address%22%3A%22%22%2C%22drop_address%22%3Anull%2C%22date%22%3A%222024-10-31+18%3A00%3A00%22%2C%22distance%22%3A%22664%22%2C%22duration%22%3A%22680%22%7D%5D&bookingType=1&pickupAddress=&dropupAddress=&routeDataArr%5B0%5D%5BlocLatVal%5D=&routeDataArr%5B0%5D%5BlocLonVal%5D=&routeDataArr%5B0%5D%5BbrtLocationVal%5D=&routeDataArr%5B1%5D%5BlocLatVal%5D=&routeDataArr%5B1%5D%5BlocLonVal%5D=&routeDataArr%5B1%5D%5BbrtLocationVal%5D=&pickupDate=31%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 494.969] [M: 21760.88] [ET: 0.897/473.132] [MU: 21.05/21760.77] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 495.001] [M: 21762.55] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 496.191] [M: 21776.02] [ET: 1.067/474.34] [MU: 2.99/21773.52] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+10013),(IF((cpm_value_type=2),(10013+(10013*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30937 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30937) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-31 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=16 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 498.062] [M: 21818.24] [ET: 4.081/476.22] [MU: 78.88/21818.09] 
	RouteRates::calculate for CAB 16 2024-10-31 18:00:00 - Trip Type: 1 680458471
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 498.214] [M: 21795.93] [ET: 29.704/476.379] [MU: 259.07/21795.77] 
	Quote::calculateRules for CAB 16, From City Id: 30804, To city Id: 30711
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 498.526] [M: 21768.53] [ET: 0.238/476.688] [MU: 0.89/21768.28] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"16"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 498.603] [M: 21769.78] [ET: 38.838/476.761] [MU: 315.9/21769.69] 
	Quote For CabType: 16
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 499.693] [M: 21779.76] [ET: 0.387/477.852] [MU: 2.97/21779.32] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 500.087] [M: 21785.57] [ET: 0.328/478.249] [MU: 3.34/21785.13] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30711"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 500.648] [M: 21788.48] [ET: 0.482/478.791] [MU: 0.9/21788.26] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 501.456] [M: 21820.87] [ET: 0.668/479.61] [MU: 24.22/21819.37] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (100) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30711) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp44)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp47,:gp48)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp45,:gp46)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp49,:gp50))
			OR (scr_area_type = 5 AND scr_area_id IN (3699))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (45)
		ORDER BY rank DESC
		 
	 [params: {":gp44":"31",":gp45":"30804",":gp46":"30711",":gp47":"105",":gp48":"100",":gp49":"1",":gp50":"1","tripType":"1"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 502.198] [M: 21801.04] [ET: 0.252/480.355] [MU: 0.83/21800.85] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 502.562] [M: 21803.91] [ET: 0.282/480.71] [MU: 0.96/21803.6] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"4"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 504.292] [M: 21821.99] [ET: 0.574/482.45] [MU: 3.78/21821.12] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"45","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 506.114] [M: 21838.61] [ET: 0.665/484.26] [MU: 3.78/21837.73] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"16","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 507.918] [M: 21855.23] [ET: 0.439/486.076] [MU: 3.78/21854.35] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 509.062] [M: 21866.3] [ET: 5.478/487.226] [MU: 52.55/21866.18] 
	Quote::calculateOneWay  for CAB 45 Date: 2024-10-31 18:00:00
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 509.628] [M: 21869.8] [ET: 0.478/487.789] [MU: 0.9/21869.59] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 510.828] [M: 21882.55] [ET: 0.531/488.987] [MU: 3.33/21882.11] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 511.562] [M: 21911.47] [ET: 0.631/489.72] [MU: 22.4/21910.72] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp53)) OR (apr_area_type = 5 AND apr_area_id IN (:gp51)) OR (apr_area_type = 2 AND apr_area_id IN (:gp54)) OR (apr_area_type = 4 AND apr_area_id IN (:gp55)) OR (apr_area_type = 1 AND apr_area_id IN (:gp52))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp51":"3699",":gp52":"31",":gp53":"30804",":gp54":"105",":gp55":"1","cab":"45"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 513.029] [M: 21898.73] [ET: 0.452/491.189] [MU: 3.33/21898.29] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 519.933] [M: 21909.27] [ET: 6.787/498.069] [MU: 3.53/21908.4] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp58)) OR (scr_area_type = 5 AND scr_area_id IN (:gp56)) OR (scr_area_type = 2 AND scr_area_id IN (:gp59)) OR (scr_area_type = 4 AND scr_area_id IN (:gp60)) OR (scr_area_type = 1 AND scr_area_id IN (:gp57)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp56":"3699",":gp57":"31",":gp58":"3699",":gp59":"105",":gp60":"1","scv_id":"45"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 520.907] [M: 21914.58] [ET: 0.508/499.058] [MU: 7.1/21914.47] 
	BookingRoute::calculateDistance
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 522.965] [M: 21927.09] [ET: 1.173/501.113] [MU: 7.89/21926.98] 
	BookingRoute::calculateDistance
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 524.135] [M: 21932.57] [ET: 1.046/502.283] [MU: 8.26/21932.46] 
	BookingRoute::calculateDistance
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 525.177] [M: 21940.1] [ET: 0.369/503.317] [MU: 0.99/21939.73] 
	SQL: SELECT cts_airport_pickup_entry_fee
               FROM   cities
               INNER JOIN cities_stats
               ON cities.cty_id = cities_stats.cts_cty_id
               WHERE  cty_id = :cityId
               AND cty_is_airport = 1 AND cty_active = 1 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 527.188] [M: 21954.02] [ET: 1.233/505.336] [MU: 8.13/21953.91] 
	BookingRoute::calculateDistance
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 528.353] [M: 21961.76] [ET: 1.03/506.502] [MU: 8.08/21961.65] 
	BookingRoute::calculateDistance
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 528.905] [M: 21961.06] [ET: 0.403/507.012] [MU: 0.9/21960.84] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 530.19] [M: 21973.44] [ET: 0.529/508.348] [MU: 2.97/21973] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 531.104] [M: 22002.36] [ET: 0.774/509.215] [MU: 22.4/22001.61] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp63)) OR (apr_area_type = 5 AND apr_area_id IN (:gp61)) OR (apr_area_type = 2 AND apr_area_id IN (:gp64)) OR (apr_area_type = 4 AND apr_area_id IN (:gp65)) OR (apr_area_type = 1 AND apr_area_id IN (:gp62))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp61":"3699",":gp62":"31",":gp63":"30804",":gp64":"105",":gp65":"1","cab":"45"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 533.798] [M: 21989.62] [ET: 0.628/511.941] [MU: 3.33/21989.18] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 536.537] [M: 22000.16] [ET: 2.588/514.671] [MU: 3.53/21999.29] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp68)) OR (scr_area_type = 5 AND scr_area_id IN (:gp66)) OR (scr_area_type = 2 AND scr_area_id IN (:gp69)) OR (scr_area_type = 4 AND scr_area_id IN (:gp70)) OR (scr_area_type = 1 AND scr_area_id IN (:gp67)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp66":"3699",":gp67":"31",":gp68":"3699",":gp69":"105",":gp70":"1","scv_id":"45"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 537.25] [M: 22003.38] [ET: 0.304/515.405] [MU: 2.98/22003.27] 
	BookingRoute::calculateDistance
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 539.001] [M: 22020.52] [ET: 0.366/517.149] [MU: 7.1/22020.41] 
	BookingRoute::calculateDistance
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 539.426] [M: 22020.85] [ET: 0.315/517.575] [MU: 2.97/22020.74] 
	BookingRoute::calculateDistance
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 543.715] [M: 22056.74] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"3","tripDistance":"664","tripDuration":"690","multiCityData":"[{\"pickup_city\":\"30804\",\"drop_city\":\"30711\",\"pickup_address\":\"\",\"drop_address\":null,\"date\":\"2024-10-31 18:00:00\",\"distance\":\"664\",\"duration\":\"680\"}]","bookingType":"1","pickupAddress":"","dropupAddress":"","routeDataArr":[{"locLatVal":"","locLonVal":"","brtLocationVal":""},{"locLatVal":"","locLonVal":"","brtLocationVal":""}],"pickupDate":"31\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=3&tripDistance=664&tripDuration=690&multiCityData=%5B%7B%22pickup_city%22%3A%2230804%22%2C%22drop_city%22%3A%2230711%22%2C%22pickup_address%22%3A%22%22%2C%22drop_address%22%3Anull%2C%22date%22%3A%222024-10-31+18%3A00%3A00%22%2C%22distance%22%3A%22664%22%2C%22duration%22%3A%22680%22%7D%5D&bookingType=1&pickupAddress=&dropupAddress=&routeDataArr%5B0%5D%5BlocLatVal%5D=&routeDataArr%5B0%5D%5BlocLonVal%5D=&routeDataArr%5B0%5D%5BbrtLocationVal%5D=&routeDataArr%5B1%5D%5BlocLatVal%5D=&routeDataArr%5B1%5D%5BlocLonVal%5D=&routeDataArr%5B1%5D%5BbrtLocationVal%5D=&pickupDate=31%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 544.12] [M: 22075.84] [ET: 0.838/522.285] [MU: 21.05/22075.73] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 544.151] [M: 22077.52] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 545.198] [M: 22090.98] [ET: 0.911/523.327] [MU: 2.99/22088.48] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+10013),(IF((cpm_value_type=2),(10013+(10013*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30937 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30937) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-31 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=45 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 547.279] [M: 22133.2] [ET: 4.025/525.412] [MU: 78.88/22133.05] 
	RouteRates::calculate for CAB 45 2024-10-31 18:00:00 - Trip Type: 1 433587718
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 547.534] [M: 22142.89] [ET: 38.413/525.695] [MU: 275.1/22142.73] 
	Quote::calculateRules for CAB 45, From City Id: 30804, To city Id: 30711
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 548.073] [M: 22115.27] [ET: 0.451/526.23] [MU: 0.9/22115.02] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"45"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 548.162] [M: 22116.52] [ET: 49.506/526.324] [MU: 345.44/22116.43] 
	Quote For CabType: 45
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 549.435] [M: 22126.5] [ET: 0.369/527.594] [MU: 2.97/22126.06] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 549.823] [M: 22132.31] [ET: 0.315/527.984] [MU: 3.34/22131.88] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30711"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 550.42] [M: 22135.22] [ET: 0.529/528.578] [MU: 0.9/22135] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 551.013] [M: 22167.61] [ET: 0.476/529.149] [MU: 24.22/22166.11] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (100) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30711) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp71)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp74,:gp75)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp72,:gp73)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp76,:gp77))
			OR (scr_area_type = 5 AND scr_area_id IN (3699))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (54)
		ORDER BY rank DESC
		 
	 [params: {":gp71":"31",":gp72":"30804",":gp73":"30711",":gp74":"105",":gp75":"100",":gp76":"1",":gp77":"1","tripType":"1"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 551.827] [M: 22147.8] [ET: 0.212/529.977] [MU: 0.83/22147.61] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 552.21] [M: 22150.67] [ET: 0.285/530.358] [MU: 0.96/22150.36] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"4"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 553.635] [M: 22163.64] [ET: 0.415/531.781] [MU: 2.04/22163.14] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"54"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 554.785] [M: 22173.27] [ET: 0.871/532.927] [MU: 3.78/22172.4] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"54","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 556.93] [M: 22189.91] [ET: 0.603/535.074] [MU: 3.78/22189.03] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"45","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 558.854] [M: 22206.52] [ET: 0.586/536.998] [MU: 3.78/22205.65] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"16","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 560.721] [M: 22223.14] [ET: 0.496/538.877] [MU: 3.78/22222.27] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 561.981] [M: 22235.06] [ET: 8.242/540.118] [MU: 70.03/22234.94] 
	Quote::calculateOneWay  for CAB 54 Date: 2024-10-31 18:00:00
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 562.493] [M: 22238.56] [ET: 0.393/540.651] [MU: 0.9/22238.34] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 563.591] [M: 22251.3] [ET: 0.501/541.748] [MU: 3.34/22250.87] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 564.602] [M: 22280.23] [ET: 0.877/542.752] [MU: 22.41/22279.48] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp80)) OR (apr_area_type = 5 AND apr_area_id IN (:gp78)) OR (apr_area_type = 2 AND apr_area_id IN (:gp81)) OR (apr_area_type = 4 AND apr_area_id IN (:gp82)) OR (apr_area_type = 1 AND apr_area_id IN (:gp79))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp78":"3699",":gp79":"31",":gp80":"30804",":gp81":"105",":gp82":"1","cab":"54"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 566.097] [M: 22267.5] [ET: 0.466/544.256] [MU: 3.34/22267.06] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 568.394] [M: 22278.05] [ET: 2.175/546.524] [MU: 3.53/22277.17] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp85)) OR (scr_area_type = 5 AND scr_area_id IN (:gp83)) OR (scr_area_type = 2 AND scr_area_id IN (:gp86)) OR (scr_area_type = 4 AND scr_area_id IN (:gp87)) OR (scr_area_type = 1 AND scr_area_id IN (:gp84)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp83":"3699",":gp84":"31",":gp85":"3699",":gp86":"105",":gp87":"1","scv_id":"54"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 569.191] [M: 22283.34] [ET: 0.392/547.332] [MU: 7.1/22283.23] 
	BookingRoute::calculateDistance
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 571.191] [M: 22295.85] [ET: 1.114/549.35] [MU: 7.88/22295.74] 
	BookingRoute::calculateDistance
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 572.11] [M: 22301.33] [ET: 0.819/550.256] [MU: 8.26/22301.22] 
	BookingRoute::calculateDistance
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 573.14] [M: 22308.86] [ET: 0.306/551.299] [MU: 1/22308.48] 
	SQL: SELECT cts_airport_pickup_entry_fee
               FROM   cities
               INNER JOIN cities_stats
               ON cities.cty_id = cities_stats.cts_cty_id
               WHERE  cty_id = :cityId
               AND cty_is_airport = 1 AND cty_active = 1 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 574.651] [M: 22322.77] [ET: 0.933/552.795] [MU: 8.14/22322.66] 
	BookingRoute::calculateDistance
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 575.727] [M: 22330.52] [ET: 0.939/553.887] [MU: 8.08/22330.41] 
	BookingRoute::calculateDistance
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 576.125] [M: 22329.82] [ET: 0.306/554.27] [MU: 0.89/22329.6] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 577.493] [M: 22342.2] [ET: 0.65/555.636] [MU: 2.97/22341.76] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 578.348] [M: 22371.12] [ET: 0.69/556.483] [MU: 22.41/22370.37] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp90)) OR (apr_area_type = 5 AND apr_area_id IN (:gp88)) OR (apr_area_type = 2 AND apr_area_id IN (:gp91)) OR (apr_area_type = 4 AND apr_area_id IN (:gp92)) OR (apr_area_type = 1 AND apr_area_id IN (:gp89))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp88":"3699",":gp89":"31",":gp90":"30804",":gp91":"105",":gp92":"1","cab":"54"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 579.965] [M: 22358.39] [ET: 0.503/558.122] [MU: 3.34/22357.95] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 582.649] [M: 22368.94] [ET: 2.562/560.787] [MU: 3.54/22368.06] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp95)) OR (scr_area_type = 5 AND scr_area_id IN (:gp93)) OR (scr_area_type = 2 AND scr_area_id IN (:gp96)) OR (scr_area_type = 4 AND scr_area_id IN (:gp97)) OR (scr_area_type = 1 AND scr_area_id IN (:gp94)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp93":"3699",":gp94":"31",":gp95":"3699",":gp96":"105",":gp97":"1","scv_id":"54"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 583.432] [M: 22372.14] [ET: 0.321/561.596] [MU: 2.97/22372.03] 
	BookingRoute::calculateDistance
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 584.985] [M: 22389.28] [ET: 0.371/563.133] [MU: 7.1/22389.17] 
	BookingRoute::calculateDistance
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 585.411] [M: 22389.59] [ET: 0.316/563.56] [MU: 2.97/22389.5] 
	BookingRoute::calculateDistance
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 589.612] [M: 22425.5] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"3","tripDistance":"664","tripDuration":"690","multiCityData":"[{\"pickup_city\":\"30804\",\"drop_city\":\"30711\",\"pickup_address\":\"\",\"drop_address\":null,\"date\":\"2024-10-31 18:00:00\",\"distance\":\"664\",\"duration\":\"680\"}]","bookingType":"1","pickupAddress":"","dropupAddress":"","routeDataArr":[{"locLatVal":"","locLonVal":"","brtLocationVal":""},{"locLatVal":"","locLonVal":"","brtLocationVal":""}],"pickupDate":"31\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=3&tripDistance=664&tripDuration=690&multiCityData=%5B%7B%22pickup_city%22%3A%2230804%22%2C%22drop_city%22%3A%2230711%22%2C%22pickup_address%22%3A%22%22%2C%22drop_address%22%3Anull%2C%22date%22%3A%222024-10-31+18%3A00%3A00%22%2C%22distance%22%3A%22664%22%2C%22duration%22%3A%22680%22%7D%5D&bookingType=1&pickupAddress=&dropupAddress=&routeDataArr%5B0%5D%5BlocLatVal%5D=&routeDataArr%5B0%5D%5BlocLonVal%5D=&routeDataArr%5B0%5D%5BbrtLocationVal%5D=&routeDataArr%5B1%5D%5BlocLatVal%5D=&routeDataArr%5B1%5D%5BlocLonVal%5D=&routeDataArr%5B1%5D%5BbrtLocationVal%5D=&pickupDate=31%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 590.016] [M: 22444.59] [ET: 0.86/568.181] [MU: 21.05/22444.48] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 590.047] [M: 22446.27] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 591.081] [M: 22459.73] [ET: 0.911/569.229] [MU: 3/22457.23] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+10013),(IF((cpm_value_type=2),(10013+(10013*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30937 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30937) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-31 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=54 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 592.475] [M: 22501.96] [ET: 3.371/570.635] [MU: 78.88/22501.8] 
	RouteRates::calculate for CAB 54 2024-10-31 18:00:00 - Trip Type: 1 743877737
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 592.618] [M: 22479.65] [ET: 30.556/570.784] [MU: 243.09/22479.49] 
	Quote::calculateRules for CAB 54, From City Id: 30804, To city Id: 30711
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 592.897] [M: 22451.15] [ET: 0.207/571.061] [MU: 0.9/22450.9] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"54"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 592.967] [M: 22452.4] [ET: 44.735/571.131] [MU: 334.57/22452.3] 
	Quote For CabType: 54
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 594.083] [M: 22462.38] [ET: 0.368/572.242] [MU: 2.97/22461.94] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 594.469] [M: 22468.19] [ET: 0.318/572.63] [MU: 3.33/22467.75] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30711"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 595.071] [M: 22471.09] [ET: 0.531/573.231] [MU: 0.9/22470.88] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 595.694] [M: 22503.48] [ET: 0.515/573.85] [MU: 24.22/22501.98] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (100) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30711) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp98)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp101,:gp102)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp99,:gp100)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp103,:gp104))
			OR (scr_area_type = 5 AND scr_area_id IN (3699))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (55)
		ORDER BY rank DESC
		 
	 [params: {":gp98":"31",":gp99":"30804",":gp100":"30711",":gp101":"105",":gp102":"100",":gp103":"1",":gp104":"1","tripType":"1"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 596.361] [M: 22483.66] [ET: 0.239/574.523] [MU: 0.84/22483.48] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 596.697] [M: 22486.54] [ET: 0.267/574.86] [MU: 0.96/22486.23] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"4"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 598.824] [M: 22499.51] [ET: 0.765/576.97] [MU: 2.05/22499.01] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"55"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 599.863] [M: 22509.14] [ET: 0.709/578.014] [MU: 3.78/22508.27] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"55","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 601.589] [M: 22525.77] [ET: 0.437/579.746] [MU: 3.78/22524.89] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"45","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 602.96] [M: 22542.38] [ET: 0.4/581.119] [MU: 3.78/22541.51] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"16","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:53 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 604.275] [M: 22559] [ET: 0.385/582.434] [MU: 3.78/22558.13] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 605.372] [M: 22570.93] [ET: 6.467/583.537] [MU: 70.03/22570.8] 
	Quote::calculateOneWay  for CAB 55 Date: 2024-10-31 18:00:00
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 605.793] [M: 22574.46] [ET: 0.323/583.954] [MU: 0.89/22574.21] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 606.852] [M: 22587.17] [ET: 0.518/585.011] [MU: 3.34/22586.73] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 607.449] [M: 22616.34] [ET: 0.494/585.607] [MU: 22.53/22615.59] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp107)) OR (apr_area_type = 5 AND apr_area_id IN (:gp105)) OR (apr_area_type = 2 AND apr_area_id IN (:gp108)) OR (apr_area_type = 4 AND apr_area_id IN (:gp109)) OR (apr_area_type = 1 AND apr_area_id IN (:gp106))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp105":"3699",":gp106":"31",":gp107":"30804",":gp108":"105",":gp109":"1","cab":"55"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 608.832] [M: 22603.36] [ET: 0.443/586.983] [MU: 3.33/22602.92] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 611.251] [M: 22613.91] [ET: 2.298/589.382] [MU: 3.53/22613.03] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp112)) OR (scr_area_type = 5 AND scr_area_id IN (:gp110)) OR (scr_area_type = 2 AND scr_area_id IN (:gp113)) OR (scr_area_type = 4 AND scr_area_id IN (:gp114)) OR (scr_area_type = 1 AND scr_area_id IN (:gp111)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp110":"3699",":gp111":"31",":gp112":"3699",":gp113":"105",":gp114":"1","scv_id":"55"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 611.997] [M: 22619.2] [ET: 0.357/590.144] [MU: 7.11/22619.09] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 614.393] [M: 22631.72] [ET: 1.456/592.533] [MU: 7.88/22631.61] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 615.889] [M: 22637.2] [ET: 1.366/594.049] [MU: 8.27/22637.09] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 616.698] [M: 22644.73] [ET: 0.333/594.859] [MU: 0.99/22644.35] 
	SQL: SELECT cts_airport_pickup_entry_fee
               FROM   cities
               INNER JOIN cities_stats
               ON cities.cty_id = cities_stats.cts_cty_id
               WHERE  cty_id = :cityId
               AND cty_is_airport = 1 AND cty_active = 1 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 618.245] [M: 22658.64] [ET: 0.99/596.404] [MU: 8.13/22658.53] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 619.182] [M: 22666.38] [ET: 0.839/597.344] [MU: 8.08/22666.27] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 619.651] [M: 22665.69] [ET: 0.388/597.811] [MU: 0.9/22665.47] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 620.774] [M: 22678.06] [ET: 0.574/598.933] [MU: 2.97/22677.63] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 621.473] [M: 22707.23] [ET: 0.593/599.629] [MU: 22.53/22706.48] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp117)) OR (apr_area_type = 5 AND apr_area_id IN (:gp115)) OR (apr_area_type = 2 AND apr_area_id IN (:gp118)) OR (apr_area_type = 4 AND apr_area_id IN (:gp119)) OR (apr_area_type = 1 AND apr_area_id IN (:gp116))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp115":"3699",":gp116":"31",":gp117":"30804",":gp118":"105",":gp119":"1","cab":"55"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 622.886] [M: 22694.25] [ET: 0.487/601.043] [MU: 3.34/22693.81] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 625.323] [M: 22704.8] [ET: 2.307/603.453] [MU: 3.53/22703.92] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp122)) OR (scr_area_type = 5 AND scr_area_id IN (:gp120)) OR (scr_area_type = 2 AND scr_area_id IN (:gp123)) OR (scr_area_type = 4 AND scr_area_id IN (:gp124)) OR (scr_area_type = 1 AND scr_area_id IN (:gp121)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp120":"3699",":gp121":"31",":gp122":"3699",":gp123":"105",":gp124":"1","scv_id":"55"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 626.179] [M: 22708.01] [ET: 0.354/604.327] [MU: 2.98/22707.9] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 627.893] [M: 22725.15] [ET: 0.246/606.057] [MU: 7.1/22725.04] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 628.167] [M: 22725.48] [ET: 0.204/606.33] [MU: 2.98/22725.37] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 633.454] [M: 22761.37] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"3","tripDistance":"664","tripDuration":"690","multiCityData":"[{\"pickup_city\":\"30804\",\"drop_city\":\"30711\",\"pickup_address\":\"\",\"drop_address\":null,\"date\":\"2024-10-31 18:00:00\",\"distance\":\"664\",\"duration\":\"680\"}]","bookingType":"1","pickupAddress":"","dropupAddress":"","routeDataArr":[{"locLatVal":"","locLonVal":"","brtLocationVal":""},{"locLatVal":"","locLonVal":"","brtLocationVal":""}],"pickupDate":"31\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=3&tripDistance=664&tripDuration=690&multiCityData=%5B%7B%22pickup_city%22%3A%2230804%22%2C%22drop_city%22%3A%2230711%22%2C%22pickup_address%22%3A%22%22%2C%22drop_address%22%3Anull%2C%22date%22%3A%222024-10-31+18%3A00%3A00%22%2C%22distance%22%3A%22664%22%2C%22duration%22%3A%22680%22%7D%5D&bookingType=1&pickupAddress=&dropupAddress=&routeDataArr%5B0%5D%5BlocLatVal%5D=&routeDataArr%5B0%5D%5BlocLonVal%5D=&routeDataArr%5B0%5D%5BbrtLocationVal%5D=&routeDataArr%5B1%5D%5BlocLatVal%5D=&routeDataArr%5B1%5D%5BlocLonVal%5D=&routeDataArr%5B1%5D%5BbrtLocationVal%5D=&pickupDate=31%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 634.087] [M: 22780.46] [ET: 1.173/612.235] [MU: 21.04/22780.35] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 634.137] [M: 22782.14] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 635.176] [M: 22795.6] [ET: 0.873/613.321] [MU: 2.99/22793.1] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+10013),(IF((cpm_value_type=2),(10013+(10013*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30937 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30937) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-31 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=55 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 636.668] [M: 22837.83] [ET: 3.845/614.829] [MU: 78.87/22837.67] 
	RouteRates::calculate for CAB 55 2024-10-31 18:00:00 - Trip Type: 1 939825353
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 636.807] [M: 22815.52] [ET: 31.379/614.973] [MU: 243.09/22815.36] 
	Quote::calculateRules for CAB 55, From City Id: 30804, To city Id: 30711
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 637.089] [M: 22787.02] [ET: 0.203/615.249] [MU: 0.9/22786.77] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"55"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 637.161] [M: 22788.27] [ET: 44.144/615.326] [MU: 334.57/22788.18] 
	Quote For CabType: 55
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 638.305] [M: 22798.25] [ET: 0.368/616.463] [MU: 2.97/22797.81] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 638.694] [M: 22804.06] [ET: 0.323/616.857] [MU: 3.34/22803.63] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 639.282] [M: 22806.97] [ET: 0.52/617.442] [MU: 0.9/22806.75] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 639.879] [M: 22839.36] [ET: 0.49/618.035] [MU: 24.22/22837.86] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (100) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30711) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp125)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp128,:gp129)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp126,:gp127)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp130,:gp131))
			OR (scr_area_type = 5 AND scr_area_id IN (3699))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (57)
		ORDER BY rank DESC
		 
	 [params: {":gp125":"31",":gp126":"30804",":gp127":"30711",":gp128":"105",":gp129":"100",":gp130":"1",":gp131":"1","tripType":"1"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 640.539] [M: 22819.54] [ET: 0.209/618.703] [MU: 0.83/22819.35] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 640.863] [M: 22822.41] [ET: 0.254/619.025] [MU: 0.96/22822.1] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"4"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 641.896] [M: 22835.38] [ET: 0.295/620.056] [MU: 2.05/22834.88] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"57"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 642.662] [M: 22845.02] [ET: 0.569/620.814] [MU: 3.78/22844.14] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"57","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 644.162] [M: 22861.64] [ET: 0.436/622.321] [MU: 3.78/22860.77] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"45","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 645.674] [M: 22878.26] [ET: 0.51/623.831] [MU: 3.79/22877.38] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"16","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 647.9] [M: 22894.88] [ET: 0.72/626.03] [MU: 3.78/22894] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 650.36] [M: 22906.8] [ET: 8.374/628.494] [MU: 70.03/22906.68] 
	Quote::calculateOneWay  for CAB 57 Date: 2024-10-31 18:00:00
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 651.23] [M: 22910.3] [ET: 0.694/629.353] [MU: 0.9/22910.09] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 653.214] [M: 22923.05] [ET: 0.716/631.334] [MU: 3.33/22922.61] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 654.212] [M: 22952.22] [ET: 0.802/632.337] [MU: 22.53/22951.47] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp134)) OR (apr_area_type = 5 AND apr_area_id IN (:gp132)) OR (apr_area_type = 2 AND apr_area_id IN (:gp135)) OR (apr_area_type = 4 AND apr_area_id IN (:gp136)) OR (apr_area_type = 1 AND apr_area_id IN (:gp133))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp132":"3699",":gp133":"31",":gp134":"30804",":gp135":"105",":gp136":"1","cab":"57"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 656.419] [M: 22939.23] [ET: 0.615/634.529] [MU: 3.34/22938.8] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 659.389] [M: 22949.78] [ET: 2.788/637.518] [MU: 3.53/22948.91] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp139)) OR (scr_area_type = 5 AND scr_area_id IN (:gp137)) OR (scr_area_type = 2 AND scr_area_id IN (:gp140)) OR (scr_area_type = 4 AND scr_area_id IN (:gp141)) OR (scr_area_type = 1 AND scr_area_id IN (:gp138)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp137":"3699",":gp138":"31",":gp139":"3699",":gp140":"105",":gp141":"1","scv_id":"57"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 660.273] [M: 22955.08] [ET: 0.432/638.416] [MU: 7.1/22954.97] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 663.013] [M: 22967.59] [ET: 1.595/641.139] [MU: 7.89/22967.48] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 664.821] [M: 22973.07] [ET: 1.652/642.957] [MU: 8.26/22972.96] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 666.223] [M: 22980.6] [ET: 0.501/644.373] [MU: 0.99/22980.23] 
	SQL: SELECT cts_airport_pickup_entry_fee
               FROM   cities
               INNER JOIN cities_stats
               ON cities.cty_id = cities_stats.cts_cty_id
               WHERE  cty_id = :cityId
               AND cty_is_airport = 1 AND cty_active = 1 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 667.82] [M: 22994.52] [ET: 0.999/645.975] [MU: 8.13/22994.41] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 669.208] [M: 23002.26] [ET: 1.25/647.336] [MU: 8.08/23002.15] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 670.046] [M: 23001.56] [ET: 0.687/648.17] [MU: 0.9/23001.34] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 671.946] [M: 23013.94] [ET: 0.73/650.079] [MU: 2.97/23013.5] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 672.901] [M: 23043.11] [ET: 0.767/651.031] [MU: 22.53/23042.36] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp144)) OR (apr_area_type = 5 AND apr_area_id IN (:gp142)) OR (apr_area_type = 2 AND apr_area_id IN (:gp145)) OR (apr_area_type = 4 AND apr_area_id IN (:gp146)) OR (apr_area_type = 1 AND apr_area_id IN (:gp143))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp142":"3699",":gp143":"31",":gp144":"30804",":gp145":"105",":gp146":"1","cab":"57"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 675.097] [M: 23094.13] [ET: 0.636/653.236] [MU: 67.34/23093.69] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 678.223] [M: 23104.67] [ET: 2.946/656.355] [MU: 3.53/23103.8] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp149)) OR (scr_area_type = 5 AND scr_area_id IN (:gp147)) OR (scr_area_type = 2 AND scr_area_id IN (:gp150)) OR (scr_area_type = 4 AND scr_area_id IN (:gp151)) OR (scr_area_type = 1 AND scr_area_id IN (:gp148)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp147":"3699",":gp148":"31",":gp149":"3699",":gp150":"105",":gp151":"1","scv_id":"57"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 679.185] [M: 23113.38] [ET: 0.394/657.327] [MU: 2.98/23113.27] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 681.559] [M: 23130.52] [ET: 0.419/659.701] [MU: 7.1/23130.41] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 682.037] [M: 23130.85] [ET: 0.358/660.178] [MU: 2.97/23130.74] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 686.996] [M: 23166.55] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"3","tripDistance":"664","tripDuration":"690","multiCityData":"[{\"pickup_city\":\"30804\",\"drop_city\":\"30711\",\"pickup_address\":\"\",\"drop_address\":null,\"date\":\"2024-10-31 18:00:00\",\"distance\":\"664\",\"duration\":\"680\"}]","bookingType":"1","pickupAddress":"","dropupAddress":"","routeDataArr":[{"locLatVal":"","locLonVal":"","brtLocationVal":""},{"locLatVal":"","locLonVal":"","brtLocationVal":""}],"pickupDate":"31\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=3&tripDistance=664&tripDuration=690&multiCityData=%5B%7B%22pickup_city%22%3A%2230804%22%2C%22drop_city%22%3A%2230711%22%2C%22pickup_address%22%3A%22%22%2C%22drop_address%22%3Anull%2C%22date%22%3A%222024-10-31+18%3A00%3A00%22%2C%22distance%22%3A%22664%22%2C%22duration%22%3A%22680%22%7D%5D&bookingType=1&pickupAddress=&dropupAddress=&routeDataArr%5B0%5D%5BlocLatVal%5D=&routeDataArr%5B0%5D%5BlocLonVal%5D=&routeDataArr%5B0%5D%5BbrtLocationVal%5D=&routeDataArr%5B1%5D%5BlocLatVal%5D=&routeDataArr%5B1%5D%5BlocLonVal%5D=&routeDataArr%5B1%5D%5BbrtLocationVal%5D=&pickupDate=31%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 687.632] [M: 23185.65] [ET: 1.197/665.777] [MU: 21.05/23185.54] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 687.682] [M: 23187.33] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 688.974] [M: 23200.79] [ET: 1.106/667.094] [MU: 2.99/23198.29] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+10013),(IF((cpm_value_type=2),(10013+(10013*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30937 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30937) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-31 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=57 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 691.11] [M: 23243.02] [ET: 4.77/669.248] [MU: 78.87/23242.86] 
	RouteRates::calculate for CAB 57 2024-10-31 18:00:00 - Trip Type: 1 884975712
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 691.367] [M: 23220.7] [ET: 40.9/669.51] [MU: 312.41/23220.55] 
	Quote::calculateRules for CAB 57, From City Id: 30804, To city Id: 30711
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 691.755] [M: 23192.21] [ET: 0.262/669.899] [MU: 0.89/23191.96] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"57"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 691.869] [M: 23193.46] [ET: 54.644/670.017] [MU: 403.88/23193.37] 
	Quote For CabType: 57
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 693.31] [M: 23203.44] [ET: 0.53/671.452] [MU: 2.97/23203] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 693.883] [M: 23209.25] [ET: 0.464/672.024] [MU: 3.34/23208.81] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 694.603] [M: 23212.16] [ET: 0.604/672.745] [MU: 0.9/23211.94] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 695.379] [M: 23244.55] [ET: 0.606/673.504] [MU: 24.22/23243.05] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (100) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30711) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp152)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp155,:gp156)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp153,:gp154)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp157,:gp158))
			OR (scr_area_type = 5 AND scr_area_id IN (3699))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (69)
		ORDER BY rank DESC
		 
	 [params: {":gp152":"31",":gp153":"30804",":gp154":"30711",":gp155":"105",":gp156":"100",":gp157":"1",":gp158":"1","tripType":"1"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 696.322] [M: 23224.73] [ET: 0.276/674.46] [MU: 0.83/23224.54] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 697.101] [M: 23227.6] [ET: 0.648/675.226] [MU: 0.96/23227.29] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"4"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 699.635] [M: 23240.57] [ET: 0.872/677.763] [MU: 2.04/23240.07] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"69"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 700.666] [M: 23250.2] [ET: 0.64/678.824] [MU: 3.78/23249.33] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"69","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 702.572] [M: 23266.83] [ET: 0.628/680.707] [MU: 3.79/23265.95] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"45","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 704.308] [M: 23283.45] [ET: 0.44/682.465] [MU: 3.78/23282.57] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"16","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 706.023] [M: 23300.06] [ET: 0.578/684.159] [MU: 3.78/23299.19] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 707.456] [M: 23311.99] [ET: 7.686/685.62] [MU: 70.03/23311.87] 
	Quote::calculateOneWay  for CAB 69 Date: 2024-10-31 18:00:00
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 707.941] [M: 23315.49] [ET: 0.39/686.099] [MU: 0.9/23315.27] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 709.238] [M: 23328.23] [ET: 0.644/687.376] [MU: 3.34/23327.8] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 710.021] [M: 23357.41] [ET: 0.598/688.149] [MU: 22.53/23356.66] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp161)) OR (apr_area_type = 5 AND apr_area_id IN (:gp159)) OR (apr_area_type = 2 AND apr_area_id IN (:gp162)) OR (apr_area_type = 4 AND apr_area_id IN (:gp163)) OR (apr_area_type = 1 AND apr_area_id IN (:gp160))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp159":"3699",":gp160":"31",":gp161":"30804",":gp162":"105",":gp163":"1","cab":"69"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 711.908] [M: 23344.42] [ET: 0.591/690.045] [MU: 3.34/23343.98] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 714.867] [M: 23354.97] [ET: 2.755/692.969] [MU: 3.53/23354.09] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp166)) OR (scr_area_type = 5 AND scr_area_id IN (:gp164)) OR (scr_area_type = 2 AND scr_area_id IN (:gp167)) OR (scr_area_type = 4 AND scr_area_id IN (:gp168)) OR (scr_area_type = 1 AND scr_area_id IN (:gp165)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp164":"3699",":gp165":"31",":gp166":"3699",":gp167":"105",":gp168":"1","scv_id":"69"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 715.872] [M: 23360.27] [ET: 0.482/694.012] [MU: 7.1/23360.16] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 718.125] [M: 23372.78] [ET: 1.304/696.27] [MU: 7.88/23372.67] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 719.458] [M: 23378.26] [ET: 1.198/697.614] [MU: 8.26/23378.15] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 720.283] [M: 23385.79] [ET: 0.327/698.441] [MU: 1/23385.41] 
	SQL: SELECT cts_airport_pickup_entry_fee
               FROM   cities
               INNER JOIN cities_stats
               ON cities.cty_id = cities_stats.cts_cty_id
               WHERE  cty_id = :cityId
               AND cty_is_airport = 1 AND cty_active = 1 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 722.153] [M: 23399.7] [ET: 1.238/700.311] [MU: 8.14/23399.59] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 723.193] [M: 23407.45] [ET: 0.923/701.334] [MU: 8.08/23407.34] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 723.82] [M: 23406.78] [ET: 0.506/701.976] [MU: 0.89/23406.53] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 725.057] [M: 23419.13] [ET: 0.556/703.192] [MU: 2.97/23418.69] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 725.864] [M: 23448.3] [ET: 0.633/704.002] [MU: 22.53/23447.55] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp171)) OR (apr_area_type = 5 AND apr_area_id IN (:gp169)) OR (apr_area_type = 2 AND apr_area_id IN (:gp172)) OR (apr_area_type = 4 AND apr_area_id IN (:gp173)) OR (apr_area_type = 1 AND apr_area_id IN (:gp170))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp169":"3699",":gp170":"31",":gp171":"30804",":gp172":"105",":gp173":"1","cab":"69"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 727.934] [M: 23435.31] [ET: 0.455/706.093] [MU: 3.34/23434.88] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 730.597] [M: 23445.86] [ET: 2.404/708.583] [MU: 3.53/23444.98] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp176)) OR (scr_area_type = 5 AND scr_area_id IN (:gp174)) OR (scr_area_type = 2 AND scr_area_id IN (:gp177)) OR (scr_area_type = 4 AND scr_area_id IN (:gp178)) OR (scr_area_type = 1 AND scr_area_id IN (:gp175)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp174":"3699",":gp175":"31",":gp176":"3699",":gp177":"105",":gp178":"1","scv_id":"69"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 731.575] [M: 23449.07] [ET: 0.417/709.712] [MU: 2.97/23448.96] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 733.637] [M: 23466.2] [ET: 0.406/711.78] [MU: 7.1/23466.1] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 734.114] [M: 23466.54] [ET: 0.358/712.264] [MU: 2.97/23466.43] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 738.606] [M: 23502.43] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"3","tripDistance":"664","tripDuration":"690","multiCityData":"[{\"pickup_city\":\"30804\",\"drop_city\":\"30711\",\"pickup_address\":\"\",\"drop_address\":null,\"date\":\"2024-10-31 18:00:00\",\"distance\":\"664\",\"duration\":\"680\"}]","bookingType":"1","pickupAddress":"","dropupAddress":"","routeDataArr":[{"locLatVal":"","locLonVal":"","brtLocationVal":""},{"locLatVal":"","locLonVal":"","brtLocationVal":""}],"pickupDate":"31\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=3&tripDistance=664&tripDuration=690&multiCityData=%5B%7B%22pickup_city%22%3A%2230804%22%2C%22drop_city%22%3A%2230711%22%2C%22pickup_address%22%3A%22%22%2C%22drop_address%22%3Anull%2C%22date%22%3A%222024-10-31+18%3A00%3A00%22%2C%22distance%22%3A%22664%22%2C%22duration%22%3A%22680%22%7D%5D&bookingType=1&pickupAddress=&dropupAddress=&routeDataArr%5B0%5D%5BlocLatVal%5D=&routeDataArr%5B0%5D%5BlocLonVal%5D=&routeDataArr%5B0%5D%5BbrtLocationVal%5D=&routeDataArr%5B1%5D%5BlocLatVal%5D=&routeDataArr%5B1%5D%5BlocLonVal%5D=&routeDataArr%5B1%5D%5BbrtLocationVal%5D=&pickupDate=31%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 739.339] [M: 23521.52] [ET: 1.302/717.482] [MU: 21.05/23521.41] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 739.396] [M: 23523.2] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 740.733] [M: 23536.66] [ET: 1.138/718.86] [MU: 3/23534.16] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+10013),(IF((cpm_value_type=2),(10013+(10013*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30937 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30937) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-31 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=69 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 742.979] [M: 23578.89] [ET: 5.023/721.117] [MU: 78.88/23578.73] 
	RouteRates::calculate for CAB 69 2024-10-31 18:00:00 - Trip Type: 1 808238654
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 743.22] [M: 23556.58] [ET: 35.693/721.368] [MU: 243.09/23556.42] 
	Quote::calculateRules for CAB 69, From City Id: 30804, To city Id: 30711
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 743.632] [M: 23528.09] [ET: 0.292/721.769] [MU: 0.9/23527.84] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"69"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 743.757] [M: 23529.34] [ET: 51.804/721.901] [MU: 334.57/23529.24] 
	Quote For CabType: 69
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 745.155] [M: 23539.31] [ET: 0.515/723.294] [MU: 2.97/23538.88] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 745.744] [M: 23545.13] [ET: 0.477/723.886] [MU: 3.34/23544.69] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 746.335] [M: 23548.03] [ET: 0.488/724.492] [MU: 0.9/23547.81] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 747.255] [M: 23580.42] [ET: 0.79/725.383] [MU: 24.21/23578.92] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (100) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30711) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp179)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp182,:gp183)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp180,:gp181)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp184,:gp185))
			OR (scr_area_type = 5 AND scr_area_id IN (3699))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (70)
		ORDER BY rank DESC
		 
	 [params: {":gp179":"31",":gp180":"30804",":gp181":"30711",":gp182":"105",":gp183":"100",":gp184":"1",":gp185":"1","tripType":"1"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 748.243] [M: 23560.6] [ET: 0.248/726.401] [MU: 0.84/23560.41] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 748.662] [M: 23563.48] [ET: 0.343/726.823] [MU: 0.96/23563.16] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"4"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 749.848] [M: 23576.45] [ET: 0.391/728.004] [MU: 2.05/23575.95] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"70"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 750.875] [M: 23586.08] [ET: 0.764/729.007] [MU: 3.79/23585.2] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"70","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 752.782] [M: 23602.7] [ET: 0.518/730.936] [MU: 3.78/23601.83] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"45","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 754.45] [M: 23619.32] [ET: 0.495/732.605] [MU: 3.78/23618.45] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"16","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 756.094] [M: 23635.94] [ET: 0.493/734.248] [MU: 3.79/23635.06] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 757.874] [M: 23647.87] [ET: 7.935/736.017] [MU: 70.03/23647.74] 
	Quote::calculateOneWay  for CAB 70 Date: 2024-10-31 18:00:00
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 758.788] [M: 23651.37] [ET: 0.69/736.913] [MU: 0.9/23651.15] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 759.965] [M: 23664.11] [ET: 0.493/738.122] [MU: 3.33/23663.67] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 760.577] [M: 23693.28] [ET: 0.491/738.713] [MU: 22.53/23692.53] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp188)) OR (apr_area_type = 5 AND apr_area_id IN (:gp186)) OR (apr_area_type = 2 AND apr_area_id IN (:gp189)) OR (apr_area_type = 4 AND apr_area_id IN (:gp190)) OR (apr_area_type = 1 AND apr_area_id IN (:gp187))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp186":"3699",":gp187":"31",":gp188":"30804",":gp189":"105",":gp190":"1","cab":"70"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 762.131] [M: 23680.3] [ET: 0.462/740.288] [MU: 3.33/23679.86] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 764.839] [M: 23690.84] [ET: 2.583/742.969] [MU: 3.53/23689.97] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp193)) OR (scr_area_type = 5 AND scr_area_id IN (:gp191)) OR (scr_area_type = 2 AND scr_area_id IN (:gp194)) OR (scr_area_type = 4 AND scr_area_id IN (:gp195)) OR (scr_area_type = 1 AND scr_area_id IN (:gp192)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp191":"3699",":gp192":"31",":gp193":"3699",":gp194":"105",":gp195":"1","scv_id":"70"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 765.705] [M: 23696.14] [ET: 0.435/743.847] [MU: 7.1/23696.03] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 768.736] [M: 23708.66] [ET: 1.454/746.893] [MU: 7.88/23708.55] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 769.831] [M: 23714.13] [ET: 1.003/747.989] [MU: 8.27/23714.02] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 770.656] [M: 23721.66] [ET: 0.338/748.814] [MU: 0.99/23721.29] 
	SQL: SELECT cts_airport_pickup_entry_fee
               FROM   cities
               INNER JOIN cities_stats
               ON cities.cty_id = cities_stats.cts_cty_id
               WHERE  cty_id = :cityId
               AND cty_is_airport = 1 AND cty_active = 1 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 772.131] [M: 23735.58] [ET: 0.914/750.292] [MU: 8.13/23735.47] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 773.122] [M: 23743.32] [ET: 0.894/751.283] [MU: 8.07/23743.21] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 773.585] [M: 23742.63] [ET: 0.382/751.745] [MU: 0.9/23742.41] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 774.99] [M: 23755] [ET: 0.726/753.123] [MU: 2.97/23754.56] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 775.902] [M: 23784.17] [ET: 0.742/754.058] [MU: 22.53/23783.42] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp198)) OR (apr_area_type = 5 AND apr_area_id IN (:gp196)) OR (apr_area_type = 2 AND apr_area_id IN (:gp199)) OR (apr_area_type = 4 AND apr_area_id IN (:gp200)) OR (apr_area_type = 1 AND apr_area_id IN (:gp197))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp196":"3699",":gp197":"31",":gp198":"30804",":gp199":"105",":gp200":"1","cab":"70"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 777.486] [M: 23771.19] [ET: 0.539/755.625] [MU: 3.33/23770.75] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 780.501] [M: 23781.73] [ET: 2.843/758.629] [MU: 3.53/23780.86] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp203)) OR (scr_area_type = 5 AND scr_area_id IN (:gp201)) OR (scr_area_type = 2 AND scr_area_id IN (:gp204)) OR (scr_area_type = 4 AND scr_area_id IN (:gp205)) OR (scr_area_type = 1 AND scr_area_id IN (:gp202)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp201":"3699",":gp202":"31",":gp203":"3699",":gp204":"105",":gp205":"1","scv_id":"70"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 781.43] [M: 23784.95] [ET: 0.387/759.539] [MU: 2.98/23784.84] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 783.888] [M: 23810.07] [ET: 0.422/762.03] [MU: 7.1/23809.98] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 784.362] [M: 23810.41] [ET: 0.356/762.505] [MU: 2.98/23810.3] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 789.74] [M: 23846.3] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"3","tripDistance":"664","tripDuration":"690","multiCityData":"[{\"pickup_city\":\"30804\",\"drop_city\":\"30711\",\"pickup_address\":\"\",\"drop_address\":null,\"date\":\"2024-10-31 18:00:00\",\"distance\":\"664\",\"duration\":\"680\"}]","bookingType":"1","pickupAddress":"","dropupAddress":"","routeDataArr":[{"locLatVal":"","locLonVal":"","brtLocationVal":""},{"locLatVal":"","locLonVal":"","brtLocationVal":""}],"pickupDate":"31\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=3&tripDistance=664&tripDuration=690&multiCityData=%5B%7B%22pickup_city%22%3A%2230804%22%2C%22drop_city%22%3A%2230711%22%2C%22pickup_address%22%3A%22%22%2C%22drop_address%22%3Anull%2C%22date%22%3A%222024-10-31+18%3A00%3A00%22%2C%22distance%22%3A%22664%22%2C%22duration%22%3A%22680%22%7D%5D&bookingType=1&pickupAddress=&dropupAddress=&routeDataArr%5B0%5D%5BlocLatVal%5D=&routeDataArr%5B0%5D%5BlocLonVal%5D=&routeDataArr%5B0%5D%5BbrtLocationVal%5D=&routeDataArr%5B1%5D%5BlocLatVal%5D=&routeDataArr%5B1%5D%5BlocLonVal%5D=&routeDataArr%5B1%5D%5BbrtLocationVal%5D=&pickupDate=31%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 790.5] [M: 23865.4] [ET: 1.386/768.635] [MU: 21.05/23865.29] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 790.561] [M: 23867.08] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 791.751] [M: 23880.54] [ET: 0.994/769.891] [MU: 2.99/23878.04] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+10013),(IF((cpm_value_type=2),(10013+(10013*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30937 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30937) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-31 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=70 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 793.346] [M: 23922.77] [ET: 4.349/771.505] [MU: 78.87/23922.61] 
	RouteRates::calculate for CAB 70 2024-10-31 18:00:00 - Trip Type: 1 269401065
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 793.495] [M: 23900.45] [ET: 35.48/771.659] [MU: 251.09/23900.3] 
	Quote::calculateRules for CAB 70, From City Id: 30804, To city Id: 30711
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 793.821] [M: 23871.96] [ET: 0.244/771.981] [MU: 0.89/23871.71] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"70"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 793.891] [M: 23873.21] [ET: 50.063/772.058] [MU: 342.57/23873.12] 
	Quote For CabType: 70
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 794.994] [M: 23883.19] [ET: 0.4/773.153] [MU: 2.97/23882.75] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 795.428] [M: 23889] [ET: 0.36/773.584] [MU: 3.34/23888.56] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 795.958] [M: 23891.91] [ET: 0.46/774.117] [MU: 0.9/23891.69] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 796.523] [M: 23924.3] [ET: 0.456/774.678] [MU: 24.22/23922.8] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (100) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30711) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp206)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp209,:gp210)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp207,:gp208)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp211,:gp212))
			OR (scr_area_type = 5 AND scr_area_id IN (3699))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (73)
		ORDER BY rank DESC
		 
	 [params: {":gp206":"31",":gp207":"30804",":gp208":"30711",":gp209":"105",":gp210":"100",":gp211":"1",":gp212":"1","tripType":"1"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 797.876] [M: 23904.47] [ET: 0.468/775.999] [MU: 0.83/23904.28] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 798.456] [M: 23907.31] [ET: 0.447/776.598] [MU: 0.93/23907] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"6"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 800.541] [M: 23925.26] [ET: 0.69/778.682] [MU: 3.79/23924.38] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"73","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 802.689] [M: 23941.88] [ET: 0.559/780.819] [MU: 3.78/23941] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 804.234] [M: 23952.09] [ET: 4.634/782.372] [MU: 35.08/23951.97] 
	Quote::calculateOneWay  for CAB 73 Date: 2024-10-31 18:00:00
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 804.879] [M: 23955.59] [ET: 0.494/783.022] [MU: 0.9/23955.38] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 806.379] [M: 23968.34] [ET: 0.64/784.519] [MU: 3.33/23967.9] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 807.229] [M: 23997.51] [ET: 0.69/785.379] [MU: 22.53/23996.76] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp215)) OR (apr_area_type = 5 AND apr_area_id IN (:gp213)) OR (apr_area_type = 2 AND apr_area_id IN (:gp216)) OR (apr_area_type = 4 AND apr_area_id IN (:gp217)) OR (apr_area_type = 1 AND apr_area_id IN (:gp214))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp213":"3699",":gp214":"31",":gp215":"30804",":gp216":"105",":gp217":"1","cab":"73"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 808.926] [M: 23984.52] [ET: 0.489/787.082] [MU: 3.34/23984.08] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 811.387] [M: 23995.06] [ET: 2.333/789.516] [MU: 3.53/23994.19] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp220)) OR (scr_area_type = 5 AND scr_area_id IN (:gp218)) OR (scr_area_type = 2 AND scr_area_id IN (:gp221)) OR (scr_area_type = 4 AND scr_area_id IN (:gp222)) OR (scr_area_type = 1 AND scr_area_id IN (:gp219)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp218":"3699",":gp219":"31",":gp220":"3699",":gp221":"105",":gp222":"1","scv_id":"73"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 812.211] [M: 24000.37] [ET: 0.418/790.352] [MU: 7.1/24000.26] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 814.719] [M: 24012.88] [ET: 1.507/792.837] [MU: 7.89/24012.77] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 816.086] [M: 24018.36] [ET: 1.222/794.218] [MU: 8.26/24018.25] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 817.326] [M: 24025.89] [ET: 0.387/795.468] [MU: 0.99/24025.52] 
	SQL: SELECT cts_airport_pickup_entry_fee
               FROM   cities
               INNER JOIN cities_stats
               ON cities.cty_id = cities_stats.cts_cty_id
               WHERE  cty_id = :cityId
               AND cty_is_airport = 1 AND cty_active = 1 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 818.869] [M: 24039.79] [ET: 0.91/797.028] [MU: 8.13/24039.7] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 819.839] [M: 24047.55] [ET: 0.868/797.996] [MU: 8.08/24047.44] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 820.294] [M: 24046.85] [ET: 0.364/798.45] [MU: 0.9/24046.63] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 821.508] [M: 24059.23] [ET: 0.586/799.643] [MU: 2.97/24058.79] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 822.404] [M: 24088.4] [ET: 0.718/800.541] [MU: 22.53/24087.65] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp225)) OR (apr_area_type = 5 AND apr_area_id IN (:gp223)) OR (apr_area_type = 2 AND apr_area_id IN (:gp226)) OR (apr_area_type = 4 AND apr_area_id IN (:gp227)) OR (apr_area_type = 1 AND apr_area_id IN (:gp224))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp223":"3699",":gp224":"31",":gp225":"30804",":gp226":"105",":gp227":"1","cab":"73"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 824.261] [M: 24075.41] [ET: 0.51/802.415] [MU: 3.33/24074.97] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 826.514] [M: 24085.95] [ET: 2.126/804.642] [MU: 3.53/24085.08] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp230)) OR (scr_area_type = 5 AND scr_area_id IN (:gp228)) OR (scr_area_type = 2 AND scr_area_id IN (:gp231)) OR (scr_area_type = 4 AND scr_area_id IN (:gp232)) OR (scr_area_type = 1 AND scr_area_id IN (:gp229)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp228":"3699",":gp229":"31",":gp230":"3699",":gp231":"105",":gp232":"1","scv_id":"73"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 827.41] [M: 24089.17] [ET: 0.384/805.555] [MU: 2.98/24089.06] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 829.505] [M: 24106.3] [ET: 0.379/807.65] [MU: 7.11/24106.2] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 830.098] [M: 24106.64] [ET: 0.433/808.197] [MU: 2.97/24106.53] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 836.456] [M: 24142.53] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"3","tripDistance":"664","tripDuration":"690","multiCityData":"[{\"pickup_city\":\"30804\",\"drop_city\":\"30711\",\"pickup_address\":\"\",\"drop_address\":null,\"date\":\"2024-10-31 18:00:00\",\"distance\":\"664\",\"duration\":\"680\"}]","bookingType":"1","pickupAddress":"","dropupAddress":"","routeDataArr":[{"locLatVal":"","locLonVal":"","brtLocationVal":""},{"locLatVal":"","locLonVal":"","brtLocationVal":""}],"pickupDate":"31\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=3&tripDistance=664&tripDuration=690&multiCityData=%5B%7B%22pickup_city%22%3A%2230804%22%2C%22drop_city%22%3A%2230711%22%2C%22pickup_address%22%3A%22%22%2C%22drop_address%22%3Anull%2C%22date%22%3A%222024-10-31+18%3A00%3A00%22%2C%22distance%22%3A%22664%22%2C%22duration%22%3A%22680%22%7D%5D&bookingType=1&pickupAddress=&dropupAddress=&routeDataArr%5B0%5D%5BlocLatVal%5D=&routeDataArr%5B0%5D%5BlocLonVal%5D=&routeDataArr%5B0%5D%5BbrtLocationVal%5D=&routeDataArr%5B1%5D%5BlocLatVal%5D=&routeDataArr%5B1%5D%5BlocLonVal%5D=&routeDataArr%5B1%5D%5BbrtLocationVal%5D=&pickupDate=31%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 837.12] [M: 24161.63] [ET: 1.209/815.262] [MU: 21.05/24161.52] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 837.173] [M: 24163.3] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 838.69] [M: 24176.77] [ET: 1.328/816.812] [MU: 2.99/24174.27] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+10013),(IF((cpm_value_type=2),(10013+(10013*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30937 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30937) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-31 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=73 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 840.494] [M: 24218.99] [ET: 4.675/818.652] [MU: 78.88/24218.84] 
	RouteRates::calculate for CAB 73 2024-10-31 18:00:00 - Trip Type: 1 349657126
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 840.645] [M: 24196.68] [ET: 36.325/818.809] [MU: 243.1/24196.52] 
	Quote::calculateRules for CAB 73, From City Id: 30804, To city Id: 30711
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 841.009] [M: 24169.2] [ET: 0.261/819.157] [MU: 0.9/24168.95] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"73"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 841.086] [M: 24170.76] [ET: 47.145/819.251] [MU: 296.25/24170.66] 
	Quote For CabType: 73
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 842.341] [M: 24180.73] [ET: 0.494/820.48] [MU: 2.97/24180.3] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 842.879] [M: 24186.55] [ET: 0.425/821.024] [MU: 3.33/24186.11] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 843.56] [M: 24189.45] [ET: 0.566/821.701] [MU: 0.9/24189.23] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 844.344] [M: 24221.84] [ET: 0.598/822.473] [MU: 24.22/24220.34] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (100) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30711) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp233)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp236,:gp237)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp234,:gp235)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp238,:gp239))
			OR (scr_area_type = 5 AND scr_area_id IN (3699))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (78)
		ORDER BY rank DESC
		 
	 [params: {":gp233":"31",":gp234":"30804",":gp235":"30711",":gp236":"105",":gp237":"100",":gp238":"1",":gp239":"1","tripType":"1"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 845.277] [M: 24202.03] [ET: 0.264/823.435] [MU: 0.84/24201.84] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 845.68] [M: 24204.91] [ET: 0.323/823.838] [MU: 0.96/24204.59] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"1"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 848.604] [M: 24217.67] [ET: 0.881/826.611] [MU: 2.04/24217.17] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"78"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 849.559] [M: 24227.3] [ET: 0.662/827.693] [MU: 3.78/24226.43] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"78","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 851.674] [M: 24243.94] [ET: 0.555/829.815] [MU: 3.79/24243.06] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 853.129] [M: 24254.14] [ET: 4.402/831.277] [MU: 35.08/24254.02] 
	Quote::calculateOneWay  for CAB 78 Date: 2024-10-31 18:00:00
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 853.801] [M: 24257.67] [ET: 0.529/831.939] [MU: 0.89/24257.42] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 855.405] [M: 24270.38] [ET: 0.542/833.561] [MU: 3.34/24269.95] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 856.229] [M: 24299.55] [ET: 0.71/834.38] [MU: 22.53/24298.8] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp242)) OR (apr_area_type = 5 AND apr_area_id IN (:gp240)) OR (apr_area_type = 2 AND apr_area_id IN (:gp243)) OR (apr_area_type = 4 AND apr_area_id IN (:gp244)) OR (apr_area_type = 1 AND apr_area_id IN (:gp241))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp240":"3699",":gp241":"31",":gp242":"30804",":gp243":"105",":gp244":"1","cab":"78"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 858.145] [M: 24286.58] [ET: 0.585/836.283] [MU: 3.33/24286.14] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 860.887] [M: 24297.13] [ET: 2.557/839.017] [MU: 3.53/24296.25] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp247)) OR (scr_area_type = 5 AND scr_area_id IN (:gp245)) OR (scr_area_type = 2 AND scr_area_id IN (:gp248)) OR (scr_area_type = 4 AND scr_area_id IN (:gp249)) OR (scr_area_type = 1 AND scr_area_id IN (:gp246)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp245":"3699",":gp246":"31",":gp247":"3699",":gp248":"105",":gp249":"1","scv_id":"78"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 861.742] [M: 24302.4] [ET: 0.42/839.884] [MU: 7.1/24302.3] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 864.379] [M: 24314.93] [ET: 1.539/842.518] [MU: 7.88/24314.82] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 865.748] [M: 24320.41] [ET: 1.231/843.888] [MU: 8.27/24320.3] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 866.945] [M: 24327.94] [ET: 0.382/845.089] [MU: 1/24327.56] 
	SQL: SELECT cts_airport_pickup_entry_fee
               FROM   cities
               INNER JOIN cities_stats
               ON cities.cty_id = cities_stats.cts_cty_id
               WHERE  cty_id = :cityId
               AND cty_is_airport = 1 AND cty_active = 1 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 868.881] [M: 24341.85] [ET: 1.267/847.023] [MU: 8.13/24341.74] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 870.301] [M: 24349.59] [ET: 1.263/848.431] [MU: 8.08/24349.48] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 871.146] [M: 24348.9] [ET: 0.7/849.276] [MU: 0.9/24348.68] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 872.805] [M: 24361.27] [ET: 0.706/850.942] [MU: 2.97/24360.84] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 873.617] [M: 24390.45] [ET: 0.645/851.749] [MU: 22.53/24389.7] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp252)) OR (apr_area_type = 5 AND apr_area_id IN (:gp250)) OR (apr_area_type = 2 AND apr_area_id IN (:gp253)) OR (apr_area_type = 4 AND apr_area_id IN (:gp254)) OR (apr_area_type = 1 AND apr_area_id IN (:gp251))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp250":"3699",":gp251":"31",":gp252":"30804",":gp253":"105",":gp254":"1","cab":"78"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 875.526] [M: 24377.47] [ET: 0.568/853.668] [MU: 3.33/24377.03] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 878.138] [M: 24388.02] [ET: 2.428/856.258] [MU: 3.53/24387.14] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp257)) OR (scr_area_type = 5 AND scr_area_id IN (:gp255)) OR (scr_area_type = 2 AND scr_area_id IN (:gp258)) OR (scr_area_type = 4 AND scr_area_id IN (:gp259)) OR (scr_area_type = 1 AND scr_area_id IN (:gp256)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp255":"3699",":gp256":"31",":gp257":"3699",":gp258":"105",":gp259":"1","scv_id":"78"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 879.247] [M: 24391.2] [ET: 0.49/857.38] [MU: 2.97/24391.11] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 882.378] [M: 24408.34] [ET: 0.47/860.52] [MU: 7.1/24408.25] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 882.871] [M: 24408.69] [ET: 0.374/861.015] [MU: 2.98/24408.58] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 888.173] [M: 24444.58] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"3","tripDistance":"664","tripDuration":"690","multiCityData":"[{\"pickup_city\":\"30804\",\"drop_city\":\"30711\",\"pickup_address\":\"\",\"drop_address\":null,\"date\":\"2024-10-31 18:00:00\",\"distance\":\"664\",\"duration\":\"680\"}]","bookingType":"1","pickupAddress":"","dropupAddress":"","routeDataArr":[{"locLatVal":"","locLonVal":"","brtLocationVal":""},{"locLatVal":"","locLonVal":"","brtLocationVal":""}],"pickupDate":"31\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=3&tripDistance=664&tripDuration=690&multiCityData=%5B%7B%22pickup_city%22%3A%2230804%22%2C%22drop_city%22%3A%2230711%22%2C%22pickup_address%22%3A%22%22%2C%22drop_address%22%3Anull%2C%22date%22%3A%222024-10-31+18%3A00%3A00%22%2C%22distance%22%3A%22664%22%2C%22duration%22%3A%22680%22%7D%5D&bookingType=1&pickupAddress=&dropupAddress=&routeDataArr%5B0%5D%5BlocLatVal%5D=&routeDataArr%5B0%5D%5BlocLonVal%5D=&routeDataArr%5B0%5D%5BbrtLocationVal%5D=&routeDataArr%5B1%5D%5BlocLatVal%5D=&routeDataArr%5B1%5D%5BlocLonVal%5D=&routeDataArr%5B1%5D%5BbrtLocationVal%5D=&pickupDate=31%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 888.927] [M: 24463.67] [ET: 1.369/867.066] [MU: 21.05/24463.56] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 888.984] [M: 24465.35] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 890.308] [M: 24478.81] [ET: 1.126/868.437] [MU: 3/24476.31] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+10013),(IF((cpm_value_type=2),(10013+(10013*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30937 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30937) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-31 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=78 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 892.592] [M: 24521.04] [ET: 5.105/870.714] [MU: 78.88/24520.88] 
	RouteRates::calculate for CAB 78 2024-10-31 18:00:00 - Trip Type: 1 993510951
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 892.934] [M: 24498.73] [ET: 39.699/871.063] [MU: 243.09/24498.57] 
	Quote::calculateRules for CAB 78, From City Id: 30804, To city Id: 30711
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 893.501] [M: 24470.43] [ET: 0.4/871.625] [MU: 0.9/24470.18] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"78"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 893.67] [M: 24471.99] [ET: 52.491/871.786] [MU: 299.93/24471.9] 
	Quote For CabType: 78
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 895.289] [M: 24481.97] [ET: 0.585/873.424] [MU: 2.96/24481.53] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 895.927] [M: 24487.78] [ET: 0.517/874.066] [MU: 3.34/24487.34] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 896.53] [M: 24490.69] [ET: 0.495/874.682] [MU: 0.9/24490.47] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 897.462] [M: 24523.08] [ET: 0.79/875.608] [MU: 24.22/24521.58] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (100) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30711) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp260)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp263,:gp264)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp261,:gp262)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp265,:gp266))
			OR (scr_area_type = 5 AND scr_area_id IN (3699))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (81)
		ORDER BY rank DESC
		 
	 [params: {":gp260":"31",":gp261":"30804",":gp262":"30711",":gp263":"105",":gp264":"100",":gp265":"1",":gp266":"1","tripType":"1"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 898.6] [M: 24503.26] [ET: 0.323/876.743] [MU: 0.83/24503.07] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 899.058] [M: 24506.13] [ET: 0.344/877.217] [MU: 0.96/24505.82] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"1"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 900.345] [M: 24518.9] [ET: 0.456/878.502] [MU: 2.05/24518.4] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"81"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 901.111] [M: 24528.53] [ET: 0.567/879.268] [MU: 3.78/24527.66] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"81","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 902.929] [M: 24545.16] [ET: 0.605/881.084] [MU: 3.78/24544.28] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 904] [M: 24555.37] [ET: 3.587/882.164] [MU: 35.07/24555.24] 
	Quote::calculateOneWay  for CAB 81 Date: 2024-10-31 18:00:00
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 904.464] [M: 24558.87] [ET: 0.364/882.616] [MU: 0.9/24558.65] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 905.883] [M: 24571.61] [ET: 0.718/884.013] [MU: 3.33/24571.17] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 906.589] [M: 24600.78] [ET: 0.542/884.742] [MU: 22.53/24600.03] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp269)) OR (apr_area_type = 5 AND apr_area_id IN (:gp267)) OR (apr_area_type = 2 AND apr_area_id IN (:gp270)) OR (apr_area_type = 4 AND apr_area_id IN (:gp271)) OR (apr_area_type = 1 AND apr_area_id IN (:gp268))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp267":"3699",":gp268":"31",":gp269":"30804",":gp270":"105",":gp271":"1","cab":"81"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 908.452] [M: 24587.8] [ET: 0.64/886.569] [MU: 3.33/24587.36] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 911.392] [M: 24598.34] [ET: 2.758/889.539] [MU: 3.53/24597.47] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp274)) OR (scr_area_type = 5 AND scr_area_id IN (:gp272)) OR (scr_area_type = 2 AND scr_area_id IN (:gp275)) OR (scr_area_type = 4 AND scr_area_id IN (:gp276)) OR (scr_area_type = 1 AND scr_area_id IN (:gp273)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp272":"3699",":gp273":"31",":gp274":"3699",":gp275":"105",":gp276":"1","scv_id":"81"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 912.222] [M: 24603.64] [ET: 0.432/890.365] [MU: 7.1/24603.53] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 915.212] [M: 24616.16] [ET: 1.798/893.355] [MU: 7.88/24616.05] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 916.77] [M: 24621.63] [ET: 1.403/894.903] [MU: 8.27/24621.52] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 918.288] [M: 24629.16] [ET: 0.717/896.413] [MU: 0.99/24628.79] 
	SQL: SELECT cts_airport_pickup_entry_fee
               FROM   cities
               INNER JOIN cities_stats
               ON cities.cty_id = cities_stats.cts_cty_id
               WHERE  cty_id = :cityId
               AND cty_is_airport = 1 AND cty_active = 1 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 920.831] [M: 24643.08] [ET: 1.569/898.967] [MU: 8.13/24642.97] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 922.464] [M: 24650.82] [ET: 1.437/900.59] [MU: 8.07/24650.71] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 923.247] [M: 24650.13] [ET: 0.637/901.377] [MU: 0.9/24649.91] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 925.126] [M: 24662.5] [ET: 0.796/903.258] [MU: 2.97/24662.06] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 926.138] [M: 24691.67] [ET: 0.821/904.272] [MU: 22.53/24690.92] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp279)) OR (apr_area_type = 5 AND apr_area_id IN (:gp277)) OR (apr_area_type = 2 AND apr_area_id IN (:gp280)) OR (apr_area_type = 4 AND apr_area_id IN (:gp281)) OR (apr_area_type = 1 AND apr_area_id IN (:gp278))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp277":"3699",":gp278":"31",":gp279":"30804",":gp280":"105",":gp281":"1","cab":"81"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 929.023] [M: 24678.69] [ET: 0.739/907.159] [MU: 3.33/24678.25] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 934.17] [M: 24689.23] [ET: 4.736/912.069] [MU: 3.53/24688.36] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp284)) OR (scr_area_type = 5 AND scr_area_id IN (:gp282)) OR (scr_area_type = 2 AND scr_area_id IN (:gp285)) OR (scr_area_type = 4 AND scr_area_id IN (:gp286)) OR (scr_area_type = 1 AND scr_area_id IN (:gp283)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp282":"3699",":gp283":"31",":gp284":"3699",":gp285":"105",":gp286":"1","scv_id":"81"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 935.364] [M: 24692.45] [ET: 0.401/913.507] [MU: 2.98/24692.34] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 937.64] [M: 24709.59] [ET: 0.447/915.785] [MU: 7.1/24709.48] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 938.144] [M: 24709.91] [ET: 0.382/916.288] [MU: 2.98/24709.8] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 944.379] [M: 24745.8] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"3","tripDistance":"664","tripDuration":"690","multiCityData":"[{\"pickup_city\":\"30804\",\"drop_city\":\"30711\",\"pickup_address\":\"\",\"drop_address\":null,\"date\":\"2024-10-31 18:00:00\",\"distance\":\"664\",\"duration\":\"680\"}]","bookingType":"1","pickupAddress":"","dropupAddress":"","routeDataArr":[{"locLatVal":"","locLonVal":"","brtLocationVal":""},{"locLatVal":"","locLonVal":"","brtLocationVal":""}],"pickupDate":"31\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=3&tripDistance=664&tripDuration=690&multiCityData=%5B%7B%22pickup_city%22%3A%2230804%22%2C%22drop_city%22%3A%2230711%22%2C%22pickup_address%22%3A%22%22%2C%22drop_address%22%3Anull%2C%22date%22%3A%222024-10-31+18%3A00%3A00%22%2C%22distance%22%3A%22664%22%2C%22duration%22%3A%22680%22%7D%5D&bookingType=1&pickupAddress=&dropupAddress=&routeDataArr%5B0%5D%5BlocLatVal%5D=&routeDataArr%5B0%5D%5BlocLonVal%5D=&routeDataArr%5B0%5D%5BbrtLocationVal%5D=&routeDataArr%5B1%5D%5BlocLatVal%5D=&routeDataArr%5B1%5D%5BlocLonVal%5D=&routeDataArr%5B1%5D%5BbrtLocationVal%5D=&pickupDate=31%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 945.166] [M: 24764.9] [ET: 1.458/923.307] [MU: 21.05/24764.79] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 945.225] [M: 24766.58] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 946.974] [M: 24780.04] [ET: 1.529/925.093] [MU: 2.99/24777.54] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+10013),(IF((cpm_value_type=2),(10013+(10013*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30937 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30937) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-31 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=81 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 949.806] [M: 24822.27] [ET: 6.187/927.94] [MU: 78.87/24822.11] 
	RouteRates::calculate for CAB 81 2024-10-31 18:00:00 - Trip Type: 1 965199042
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 950.065] [M: 24799.95] [ET: 45.989/928.209] [MU: 243.09/24799.8] 
	Quote::calculateRules for CAB 81, From City Id: 30804, To city Id: 30711
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 950.898] [M: 24771.66] [ET: 0.695/929.034] [MU: 0.9/24771.41] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"81"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 951.018] [M: 24773.23] [ET: 57.252/929.168] [MU: 299.93/24773.13] 
	Quote For CabType: 81
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 952.704] [M: 24783.2] [ET: 0.637/930.824] [MU: 2.97/24782.77] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 953.487] [M: 24789.02] [ET: 0.63/931.62] [MU: 3.34/24788.58] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 954.308] [M: 24791.92] [ET: 0.679/932.442] [MU: 0.9/24791.7] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 955.759] [M: 24824.31] [ET: 1.264/933.885] [MU: 24.22/24822.81] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (100) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30711) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp287)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp290,:gp291)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp288,:gp289)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp292,:gp293))
			OR (scr_area_type = 5 AND scr_area_id IN (3699))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (82)
		ORDER BY rank DESC
		 
	 [params: {":gp287":"31",":gp288":"30804",":gp289":"30711",":gp290":"105",":gp291":"100",":gp292":"1",":gp293":"1","tripType":"1"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 957.07] [M: 24804.49] [ET: 0.445/935.202] [MU: 0.84/24804.3] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 957.73] [M: 24807.37] [ET: 0.517/935.866] [MU: 0.96/24807.05] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"1"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 959.927] [M: 24820.13] [ET: 0.675/938.051] [MU: 2.05/24819.63] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"82"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 961.167] [M: 24829.77] [ET: 0.879/939.296] [MU: 3.78/24828.89] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"82","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 964.063] [M: 24846.39] [ET: 0.827/942.195] [MU: 3.78/24845.52] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 965.972] [M: 24856.6] [ET: 5.918/944.111] [MU: 35.08/24856.48] 
	Quote::calculateOneWay  for CAB 82 Date: 2024-10-31 18:00:00
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 967.041] [M: 24860.1] [ET: 0.897/945.171] [MU: 0.9/24859.88] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 968.865] [M: 24872.84] [ET: 0.761/947.001] [MU: 3.34/24872.41] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 969.848] [M: 24902.02] [ET: 0.795/947.972] [MU: 22.53/24901.27] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp296)) OR (apr_area_type = 5 AND apr_area_id IN (:gp294)) OR (apr_area_type = 2 AND apr_area_id IN (:gp297)) OR (apr_area_type = 4 AND apr_area_id IN (:gp298)) OR (apr_area_type = 1 AND apr_area_id IN (:gp295))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp294":"3699",":gp295":"31",":gp296":"30804",":gp297":"105",":gp298":"1","cab":"82"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 971.907] [M: 24889.03] [ET: 0.545/950.061] [MU: 3.34/24888.59] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 974.473] [M: 24899.58] [ET: 2.401/952.563] [MU: 3.54/24898.7] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp301)) OR (scr_area_type = 5 AND scr_area_id IN (:gp299)) OR (scr_area_type = 2 AND scr_area_id IN (:gp302)) OR (scr_area_type = 4 AND scr_area_id IN (:gp303)) OR (scr_area_type = 1 AND scr_area_id IN (:gp300)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp299":"3699",":gp300":"31",":gp301":"3699",":gp302":"105",":gp303":"1","scv_id":"82"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 975.242] [M: 24904.88] [ET: 0.357/953.403] [MU: 7.1/24904.77] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 977.221] [M: 24917.39] [ET: 1.191/955.352] [MU: 7.88/24917.28] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 978.637] [M: 24922.87] [ET: 1.258/956.79] [MU: 8.27/24922.76] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 979.98] [M: 25058.4] [ET: 0.484/958.116] [MU: 1/25058.02] 
	SQL: SELECT cts_airport_pickup_entry_fee
               FROM   cities
               INNER JOIN cities_stats
               ON cities.cty_id = cities_stats.cts_cty_id
               WHERE  cty_id = :cityId
               AND cty_is_airport = 1 AND cty_active = 1 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 982.212] [M: 25072.31] [ET: 1.362/960.362] [MU: 8.14/25072.2] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 983.642] [M: 25080.05] [ET: 1.309/961.798] [MU: 8.08/25079.95] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 984.203] [M: 25079.36] [ET: 0.458/962.355] [MU: 0.9/25079.14] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 985.459] [M: 25091.73] [ET: 0.518/963.597] [MU: 2.97/25091.3] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 986.299] [M: 25120.91] [ET: 0.661/964.431] [MU: 22.53/25120.16] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp306)) OR (apr_area_type = 5 AND apr_area_id IN (:gp304)) OR (apr_area_type = 2 AND apr_area_id IN (:gp307)) OR (apr_area_type = 4 AND apr_area_id IN (:gp308)) OR (apr_area_type = 1 AND apr_area_id IN (:gp305))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp304":"3699",":gp305":"31",":gp306":"30804",":gp307":"105",":gp308":"1","cab":"82"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 988.19] [M: 25107.92] [ET: 0.528/966.328] [MU: 3.34/25107.48] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 990.81] [M: 25118.47] [ET: 2.441/968.937] [MU: 3.53/25117.59] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp311)) OR (scr_area_type = 5 AND scr_area_id IN (:gp309)) OR (scr_area_type = 2 AND scr_area_id IN (:gp312)) OR (scr_area_type = 4 AND scr_area_id IN (:gp313)) OR (scr_area_type = 1 AND scr_area_id IN (:gp310)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp309":"3699",":gp310":"31",":gp311":"3699",":gp312":"105",":gp313":"1","scv_id":"82"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 991.695] [M: 25121.68] [ET: 0.363/969.858] [MU: 2.97/25121.57] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 993.151] [M: 25138.82] [ET: 0.261/971.313] [MU: 7.1/25138.71] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 993.472] [M: 25139.15] [ET: 0.243/971.634] [MU: 2.97/25139.04] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 998.785] [M: 25175.04] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"3","tripDistance":"664","tripDuration":"690","multiCityData":"[{\"pickup_city\":\"30804\",\"drop_city\":\"30711\",\"pickup_address\":\"\",\"drop_address\":null,\"date\":\"2024-10-31 18:00:00\",\"distance\":\"664\",\"duration\":\"680\"}]","bookingType":"1","pickupAddress":"","dropupAddress":"","routeDataArr":[{"locLatVal":"","locLonVal":"","brtLocationVal":""},{"locLatVal":"","locLonVal":"","brtLocationVal":""}],"pickupDate":"31\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=3&tripDistance=664&tripDuration=690&multiCityData=%5B%7B%22pickup_city%22%3A%2230804%22%2C%22drop_city%22%3A%2230711%22%2C%22pickup_address%22%3A%22%22%2C%22drop_address%22%3Anull%2C%22date%22%3A%222024-10-31+18%3A00%3A00%22%2C%22distance%22%3A%22664%22%2C%22duration%22%3A%22680%22%7D%5D&bookingType=1&pickupAddress=&dropupAddress=&routeDataArr%5B0%5D%5BlocLatVal%5D=&routeDataArr%5B0%5D%5BlocLonVal%5D=&routeDataArr%5B0%5D%5BbrtLocationVal%5D=&routeDataArr%5B1%5D%5BlocLatVal%5D=&routeDataArr%5B1%5D%5BlocLonVal%5D=&routeDataArr%5B1%5D%5BbrtLocationVal%5D=&pickupDate=31%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 999.48] [M: 25194.13] [ET: 1.349/977.643] [MU: 21.05/25194.02] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 999.519] [M: 25195.81] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1000.53] [M: 25209.27] [ET: 0.868/978.672] [MU: 3/25206.77] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+10013),(IF((cpm_value_type=2),(10013+(10013*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30937 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30937) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-31 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=82 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1002.488] [M: 25251.5] [ET: 4.419/980.646] [MU: 78.88/25251.34] 
	RouteRates::calculate for CAB 82 2024-10-31 18:00:00 - Trip Type: 1 468204681
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1002.658] [M: 25229.19] [ET: 36.595/980.822] [MU: 371.09/25229.03] 
	Quote::calculateRules for CAB 82, From City Id: 30804, To city Id: 30711
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1003.052] [M: 25200.9] [ET: 0.296/981.205] [MU: 0.9/25200.65] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"82"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1003.147] [M: 25202.46] [ET: 52.049/981.3] [MU: 427.93/25202.37] 
	Quote For CabType: 82
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1004.317] [M: 25212.44] [ET: 0.464/982.455] [MU: 2.97/25212] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1004.915] [M: 25218.25] [ET: 0.499/983.071] [MU: 3.34/25217.81] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1005.585] [M: 25221.16] [ET: 0.577/983.739] [MU: 0.9/25220.94] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1006.579] [M: 25253.55] [ET: 0.803/984.701] [MU: 24.22/25252.05] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (100) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30711) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp314)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp317,:gp318)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp315,:gp316)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp319,:gp320))
			OR (scr_area_type = 5 AND scr_area_id IN (3699))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (83)
		ORDER BY rank DESC
		 
	 [params: {":gp314":"31",":gp315":"30804",":gp316":"30711",":gp317":"105",":gp318":"100",":gp319":"1",":gp320":"1","tripType":"1"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1007.724] [M: 25233.73] [ET: 0.318/985.868] [MU: 0.83/25233.54] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1008.275] [M: 25236.6] [ET: 0.451/986.425] [MU: 0.96/25236.29] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"1"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1009.881] [M: 25249.37] [ET: 0.556/988.034] [MU: 2.05/25248.87] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"83"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1010.73] [M: 25259] [ET: 0.604/988.868] [MU: 3.78/25258.13] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"83","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1012.607] [M: 25275.63] [ET: 0.522/990.744] [MU: 3.78/25274.75] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1015.458] [M: 25285.84] [ET: 5.492/993.616] [MU: 35.07/25285.71] 
	Quote::calculateOneWay  for CAB 83 Date: 2024-10-31 18:00:00
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1016.175] [M: 25289.34] [ET: 0.597/994.322] [MU: 0.9/25289.12] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1017.538] [M: 25302.08] [ET: 0.501/995.693] [MU: 3.33/25301.64] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1018.249] [M: 25331.25] [ET: 0.578/996.381] [MU: 22.53/25330.5] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp323)) OR (apr_area_type = 5 AND apr_area_id IN (:gp321)) OR (apr_area_type = 2 AND apr_area_id IN (:gp324)) OR (apr_area_type = 4 AND apr_area_id IN (:gp325)) OR (apr_area_type = 1 AND apr_area_id IN (:gp322))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp321":"3699",":gp322":"31",":gp323":"30804",":gp324":"105",":gp325":"1","cab":"83"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1020.26] [M: 25318.27] [ET: 0.504/998.387] [MU: 3.34/25317.83] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1026.858] [M: 25328.81] [ET: 6.404/1004.985] [MU: 3.53/25327.94] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp328)) OR (scr_area_type = 5 AND scr_area_id IN (:gp326)) OR (scr_area_type = 2 AND scr_area_id IN (:gp329)) OR (scr_area_type = 4 AND scr_area_id IN (:gp330)) OR (scr_area_type = 1 AND scr_area_id IN (:gp327)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp326":"3699",":gp327":"31",":gp328":"3699",":gp329":"105",":gp330":"1","scv_id":"83"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1027.707] [M: 25334.09] [ET: 0.4/1005.849] [MU: 7.1/25334] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1034.819] [M: 25346.63] [ET: 6.177/1012.857] [MU: 7.88/25346.52] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1036.433] [M: 25352.1] [ET: 1.316/1014.586] [MU: 8.26/25351.99] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1037.699] [M: 25359.63] [ET: 0.624/1015.844] [MU: 0.99/25359.26] 
	SQL: SELECT cts_airport_pickup_entry_fee
               FROM   cities
               INNER JOIN cities_stats
               ON cities.cty_id = cities_stats.cts_cty_id
               WHERE  cty_id = :cityId
               AND cty_is_airport = 1 AND cty_active = 1 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1040.474] [M: 25373.55] [ET: 1.67/1018.606] [MU: 8.13/25373.44] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1041.952] [M: 25381.29] [ET: 1.311/1020.1] [MU: 8.08/25381.18] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1042.613] [M: 25380.63] [ET: 0.535/1020.746] [MU: 0.9/25380.38] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1044.2] [M: 25392.97] [ET: 0.621/1022.335] [MU: 2.96/25392.53] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1045.093] [M: 25422.14] [ET: 0.717/1023.222] [MU: 22.53/25421.39] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp333)) OR (apr_area_type = 5 AND apr_area_id IN (:gp331)) OR (apr_area_type = 2 AND apr_area_id IN (:gp334)) OR (apr_area_type = 4 AND apr_area_id IN (:gp335)) OR (apr_area_type = 1 AND apr_area_id IN (:gp332))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp331":"3699",":gp332":"31",":gp333":"30804",":gp334":"105",":gp335":"1","cab":"83"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1047.841] [M: 25409.16] [ET: 0.633/1025.973] [MU: 3.33/25408.72] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1050.629] [M: 25419.7] [ET: 2.612/1028.754] [MU: 3.53/25418.83] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp338)) OR (scr_area_type = 5 AND scr_area_id IN (:gp336)) OR (scr_area_type = 2 AND scr_area_id IN (:gp339)) OR (scr_area_type = 4 AND scr_area_id IN (:gp340)) OR (scr_area_type = 1 AND scr_area_id IN (:gp337)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp336":"3699",":gp337":"31",":gp338":"3699",":gp339":"105",":gp340":"1","scv_id":"83"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1051.518] [M: 25422.91] [ET: 0.373/1029.679] [MU: 2.98/25422.8] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1054.015] [M: 25440.05] [ET: 0.475/1032.15] [MU: 7.1/25439.95] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1054.56] [M: 25440.38] [ET: 0.415/1032.703] [MU: 2.98/25440.27] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1059.744] [M: 25476.27] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"3","tripDistance":"664","tripDuration":"690","multiCityData":"[{\"pickup_city\":\"30804\",\"drop_city\":\"30711\",\"pickup_address\":\"\",\"drop_address\":null,\"date\":\"2024-10-31 18:00:00\",\"distance\":\"664\",\"duration\":\"680\"}]","bookingType":"1","pickupAddress":"","dropupAddress":"","routeDataArr":[{"locLatVal":"","locLonVal":"","brtLocationVal":""},{"locLatVal":"","locLonVal":"","brtLocationVal":""}],"pickupDate":"31\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=3&tripDistance=664&tripDuration=690&multiCityData=%5B%7B%22pickup_city%22%3A%2230804%22%2C%22drop_city%22%3A%2230711%22%2C%22pickup_address%22%3A%22%22%2C%22drop_address%22%3Anull%2C%22date%22%3A%222024-10-31+18%3A00%3A00%22%2C%22distance%22%3A%22664%22%2C%22duration%22%3A%22680%22%7D%5D&bookingType=1&pickupAddress=&dropupAddress=&routeDataArr%5B0%5D%5BlocLatVal%5D=&routeDataArr%5B0%5D%5BlocLonVal%5D=&routeDataArr%5B0%5D%5BbrtLocationVal%5D=&routeDataArr%5B1%5D%5BlocLatVal%5D=&routeDataArr%5B1%5D%5BlocLonVal%5D=&routeDataArr%5B1%5D%5BbrtLocationVal%5D=&pickupDate=31%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1060.489] [M: 25495.37] [ET: 1.367/1038.633] [MU: 21.05/25495.26] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1060.546] [M: 25497.05] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1061.996] [M: 25510.51] [ET: 1.226/1040.109] [MU: 2.99/25508.01] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+10013),(IF((cpm_value_type=2),(10013+(10013*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30937 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30937) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-31 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=83 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1065.25] [M: 25552.73] [ET: 6.207/1043.389] [MU: 78.87/25552.58] 
	RouteRates::calculate for CAB 83 2024-10-31 18:00:00 - Trip Type: 1 827817748
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1065.483] [M: 25530.42] [ET: 49.955/1043.644] [MU: 243.1/25530.27] 
	Quote::calculateRules for CAB 83, From City Id: 30804, To city Id: 30711
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1065.938] [M: 25502.13] [ET: 0.355/1044.094] [MU: 0.9/25501.88] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"83"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1066.025] [M: 25503.7] [ET: 62.818/1044.185] [MU: 299.93/25503.6] 
	Quote For CabType: 83
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1067.343] [M: 25513.67] [ET: 0.532/1045.477] [MU: 2.97/25513.23] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1067.978] [M: 25519.48] [ET: 0.517/1046.115] [MU: 3.34/25519.05] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1068.717] [M: 25522.42] [ET: 0.628/1046.866] [MU: 0.89/25522.17] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1069.59] [M: 25554.78] [ET: 0.726/1047.73] [MU: 24.21/25553.28] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (100) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30711) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp341)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp344,:gp345)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp342,:gp343)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp346,:gp347))
			OR (scr_area_type = 5 AND scr_area_id IN (3699))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (84)
		ORDER BY rank DESC
		 
	 [params: {":gp341":"31",":gp342":"30804",":gp343":"30711",":gp344":"105",":gp345":"100",":gp346":"1",":gp347":"1","tripType":"1"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1070.73] [M: 25534.96] [ET: 0.42/1048.864] [MU: 0.84/25534.77] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1071.316] [M: 25537.84] [ET: 0.483/1049.47] [MU: 0.96/25537.52] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"1"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1072.779] [M: 25550.6] [ET: 0.52/1050.917] [MU: 2.04/25550.1] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"84"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1073.949] [M: 25560.23] [ET: 0.838/1052.067] [MU: 3.78/25559.36] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"84","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1076.11] [M: 25576.86] [ET: 0.531/1054.25] [MU: 3.78/25575.98] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1077.677] [M: 25587.1] [ET: 4.794/1055.812] [MU: 35.08/25586.95] 
	Quote::calculateOneWay  for CAB 84 Date: 2024-10-31 18:00:00
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1078.54] [M: 25590.6] [ET: 0.673/1056.638] [MU: 0.89/25590.35] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1080.739] [M: 25603.31] [ET: 1.01/1058.851] [MU: 3.34/25602.88] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1081.721] [M: 25632.48] [ET: 0.764/1059.841] [MU: 22.53/25631.73] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp350)) OR (apr_area_type = 5 AND apr_area_id IN (:gp348)) OR (apr_area_type = 2 AND apr_area_id IN (:gp351)) OR (apr_area_type = 4 AND apr_area_id IN (:gp352)) OR (apr_area_type = 1 AND apr_area_id IN (:gp349))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp348":"3699",":gp349":"31",":gp350":"30804",":gp351":"105",":gp352":"1","cab":"84"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1084.037] [M: 25619.5] [ET: 0.632/1062.173] [MU: 3.34/25619.06] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1087.132] [M: 25630.05] [ET: 2.913/1065.263] [MU: 3.53/25629.17] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp355)) OR (scr_area_type = 5 AND scr_area_id IN (:gp353)) OR (scr_area_type = 2 AND scr_area_id IN (:gp356)) OR (scr_area_type = 4 AND scr_area_id IN (:gp357)) OR (scr_area_type = 1 AND scr_area_id IN (:gp354)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp353":"3699",":gp354":"31",":gp355":"3699",":gp356":"105",":gp357":"1","scv_id":"84"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1087.914] [M: 25635.34] [ET: 0.371/1066.075] [MU: 7.1/25635.23] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1089.914] [M: 25647.86] [ET: 1.194/1068.06] [MU: 7.88/25647.75] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1091.218] [M: 25653.34] [ET: 1.182/1069.356] [MU: 8.27/25653.23] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1092.45] [M: 25660.87] [ET: 0.438/1070.591] [MU: 0.99/25660.49] 
	SQL: SELECT cts_airport_pickup_entry_fee
               FROM   cities
               INNER JOIN cities_stats
               ON cities.cty_id = cities_stats.cts_cty_id
               WHERE  cty_id = :cityId
               AND cty_is_airport = 1 AND cty_active = 1 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1094.244] [M: 25674.78] [ET: 1.215/1072.382] [MU: 8.13/25674.67] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1095.708] [M: 25682.52] [ET: 1.282/1073.846] [MU: 8.08/25682.41] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1096.392] [M: 25681.86] [ET: 0.547/1074.528] [MU: 0.9/25681.61] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1098.236] [M: 25694.2] [ET: 0.584/1076.38] [MU: 2.97/25693.77] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1098.971] [M: 25723.38] [ET: 0.601/1077.119] [MU: 22.53/25722.63] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp360)) OR (apr_area_type = 5 AND apr_area_id IN (:gp358)) OR (apr_area_type = 2 AND apr_area_id IN (:gp361)) OR (apr_area_type = 4 AND apr_area_id IN (:gp362)) OR (apr_area_type = 1 AND apr_area_id IN (:gp359))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp358":"3699",":gp359":"31",":gp360":"30804",":gp361":"105",":gp362":"1","cab":"84"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1100.866] [M: 25710.39] [ET: 0.5/1079.018] [MU: 3.34/25709.95] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1103.553] [M: 25720.94] [ET: 2.554/1081.68] [MU: 3.54/25720.06] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp365)) OR (scr_area_type = 5 AND scr_area_id IN (:gp363)) OR (scr_area_type = 2 AND scr_area_id IN (:gp366)) OR (scr_area_type = 4 AND scr_area_id IN (:gp367)) OR (scr_area_type = 1 AND scr_area_id IN (:gp364)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp363":"3699",":gp364":"31",":gp365":"3699",":gp366":"105",":gp367":"1","scv_id":"84"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1104.395] [M: 25724.15] [ET: 0.274/1082.551] [MU: 2.97/25724.04] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1106.14] [M: 25741.29] [ET: 0.408/1084.275] [MU: 7.1/25741.18] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1106.632] [M: 25741.62] [ET: 0.371/1084.775] [MU: 2.98/25741.51] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1111.357] [M: 25777.51] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"3","tripDistance":"664","tripDuration":"690","multiCityData":"[{\"pickup_city\":\"30804\",\"drop_city\":\"30711\",\"pickup_address\":\"\",\"drop_address\":null,\"date\":\"2024-10-31 18:00:00\",\"distance\":\"664\",\"duration\":\"680\"}]","bookingType":"1","pickupAddress":"","dropupAddress":"","routeDataArr":[{"locLatVal":"","locLonVal":"","brtLocationVal":""},{"locLatVal":"","locLonVal":"","brtLocationVal":""}],"pickupDate":"31\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=3&tripDistance=664&tripDuration=690&multiCityData=%5B%7B%22pickup_city%22%3A%2230804%22%2C%22drop_city%22%3A%2230711%22%2C%22pickup_address%22%3A%22%22%2C%22drop_address%22%3Anull%2C%22date%22%3A%222024-10-31+18%3A00%3A00%22%2C%22distance%22%3A%22664%22%2C%22duration%22%3A%22680%22%7D%5D&bookingType=1&pickupAddress=&dropupAddress=&routeDataArr%5B0%5D%5BlocLatVal%5D=&routeDataArr%5B0%5D%5BlocLonVal%5D=&routeDataArr%5B0%5D%5BbrtLocationVal%5D=&routeDataArr%5B1%5D%5BlocLatVal%5D=&routeDataArr%5B1%5D%5BlocLonVal%5D=&routeDataArr%5B1%5D%5BbrtLocationVal%5D=&pickupDate=31%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1111.924] [M: 25796.6] [ET: 1.229/1090.069] [MU: 21.04/25796.49] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1111.98] [M: 25798.28] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1113.542] [M: 25811.74] [ET: 1.348/1091.663] [MU: 2.99/25809.24] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+10013),(IF((cpm_value_type=2),(10013+(10013*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30937 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30937) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-31 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=84 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1115.757] [M: 25853.97] [ET: 5.193/1093.912] [MU: 78.88/25853.81] 
	RouteRates::calculate for CAB 84 2024-10-31 18:00:00 - Trip Type: 1 176243938
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1115.943] [M: 25831.66] [ET: 38.168/1094.091] [MU: 243.09/25831.5] 
	Quote::calculateRules for CAB 84, From City Id: 30804, To city Id: 30711
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1116.36] [M: 25803.37] [ET: 0.32/1094.516] [MU: 0.9/25803.12] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"84"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1116.446] [M: 25804.93] [ET: 50.369/1094.61] [MU: 299.93/25804.84] 
	Quote For CabType: 84
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1117.627] [M: 25814.91] [ET: 0.485/1095.784] [MU: 2.97/25814.47] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1118.223] [M: 25820.72] [ET: 0.514/1096.378] [MU: 3.33/25820.28] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1118.979] [M: 25823.66] [ET: 0.667/1097.124] [MU: 0.9/25823.41] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1119.832] [M: 25856.02] [ET: 0.695/1097.971] [MU: 24.22/25854.52] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (100) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30711) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp368)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp371,:gp372)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp369,:gp370)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp373,:gp374))
			OR (scr_area_type = 5 AND scr_area_id IN (3699))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (93)
		ORDER BY rank DESC
		 
	 [params: {":gp368":"31",":gp369":"30804",":gp370":"30711",":gp371":"105",":gp372":"100",":gp373":"1",":gp374":"1","tripType":"1"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1120.754] [M: 25836.2] [ET: 0.297/1098.908] [MU: 0.84/25836.02] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1121.252] [M: 25839.08] [ET: 0.396/1099.4] [MU: 0.96/25838.77] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"2"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1122.783] [M: 25851.83] [ET: 0.498/1100.933] [MU: 2.05/25851.33] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"93"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1123.65] [M: 25861.46] [ET: 0.609/1101.806] [MU: 3.78/25860.59] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"93","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1125.728] [M: 25878.09] [ET: 0.516/1103.864] [MU: 3.78/25877.22] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"16","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1128.098] [M: 25894.71] [ET: 0.604/1106.234] [MU: 3.78/25893.84] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1129.545] [M: 25905.8] [ET: 6.678/1107.703] [MU: 52.55/25905.65] 
	Quote::calculateOneWay  for CAB 93 Date: 2024-10-31 18:00:00
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1130.342] [M: 25909.3] [ET: 0.672/1108.471] [MU: 0.9/25909.05] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1132.892] [M: 25922.02] [ET: 1.051/1111.043] [MU: 3.34/25921.58] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1133.811] [M: 25951.19] [ET: 0.767/1111.937] [MU: 22.53/25950.44] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp377)) OR (apr_area_type = 5 AND apr_area_id IN (:gp375)) OR (apr_area_type = 2 AND apr_area_id IN (:gp378)) OR (apr_area_type = 4 AND apr_area_id IN (:gp379)) OR (apr_area_type = 1 AND apr_area_id IN (:gp376))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp375":"3699",":gp376":"31",":gp377":"30804",":gp378":"105",":gp379":"1","cab":"93"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1136.23] [M: 25938.21] [ET: 0.587/1114.365] [MU: 3.34/25937.77] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1138.778] [M: 25948.76] [ET: 2.356/1116.904] [MU: 3.54/25947.88] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp382)) OR (scr_area_type = 5 AND scr_area_id IN (:gp380)) OR (scr_area_type = 2 AND scr_area_id IN (:gp383)) OR (scr_area_type = 4 AND scr_area_id IN (:gp384)) OR (scr_area_type = 1 AND scr_area_id IN (:gp381)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp380":"3699",":gp381":"31",":gp382":"3699",":gp383":"105",":gp384":"1","scv_id":"93"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1139.672] [M: 25954.05] [ET: 0.426/1117.791] [MU: 7.1/25953.94] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1141.691] [M: 25966.56] [ET: 1.176/1119.842] [MU: 7.89/25966.45] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1143.091] [M: 25972.04] [ET: 1.288/1121.246] [MU: 8.26/25971.93] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1144.336] [M: 25979.57] [ET: 0.447/1122.491] [MU: 0.99/25979.2] 
	SQL: SELECT cts_airport_pickup_entry_fee
               FROM   cities
               INNER JOIN cities_stats
               ON cities.cty_id = cities_stats.cts_cty_id
               WHERE  cty_id = :cityId
               AND cty_is_airport = 1 AND cty_active = 1 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1146.265] [M: 25993.48] [ET: 1.303/1124.422] [MU: 8.14/25993.38] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1147.98] [M: 26001.23] [ET: 1.595/1126.134] [MU: 8.08/26001.12] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1148.646] [M: 26000.56] [ET: 0.549/1126.801] [MU: 0.9/26000.31] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1150.098] [M: 26012.91] [ET: 0.604/1128.23] [MU: 2.97/26012.47] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1151.152] [M: 26042.08] [ET: 0.882/1129.279] [MU: 22.53/26041.33] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp387)) OR (apr_area_type = 5 AND apr_area_id IN (:gp385)) OR (apr_area_type = 2 AND apr_area_id IN (:gp388)) OR (apr_area_type = 4 AND apr_area_id IN (:gp389)) OR (apr_area_type = 1 AND apr_area_id IN (:gp386))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp385":"3699",":gp386":"31",":gp387":"30804",":gp388":"105",":gp389":"1","cab":"93"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1153.162] [M: 26029.1] [ET: 0.497/1131.311] [MU: 3.34/26028.66] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1160.478] [M: 26039.65] [ET: 7.176/1138.602] [MU: 3.54/26038.77] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp392)) OR (scr_area_type = 5 AND scr_area_id IN (:gp390)) OR (scr_area_type = 2 AND scr_area_id IN (:gp393)) OR (scr_area_type = 4 AND scr_area_id IN (:gp394)) OR (scr_area_type = 1 AND scr_area_id IN (:gp391)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp390":"3699",":gp391":"31",":gp392":"3699",":gp393":"105",":gp394":"1","scv_id":"93"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1161.497] [M: 26042.85] [ET: 0.417/1139.625] [MU: 2.97/26042.74] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1163.883] [M: 26059.99] [ET: 0.496/1142.026] [MU: 7.11/26059.88] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1164.375] [M: 26060.32] [ET: 0.374/1142.517] [MU: 2.97/26060.21] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1170.4] [M: 26096.21] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"3","tripDistance":"664","tripDuration":"690","multiCityData":"[{\"pickup_city\":\"30804\",\"drop_city\":\"30711\",\"pickup_address\":\"\",\"drop_address\":null,\"date\":\"2024-10-31 18:00:00\",\"distance\":\"664\",\"duration\":\"680\"}]","bookingType":"1","pickupAddress":"","dropupAddress":"","routeDataArr":[{"locLatVal":"","locLonVal":"","brtLocationVal":""},{"locLatVal":"","locLonVal":"","brtLocationVal":""}],"pickupDate":"31\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=3&tripDistance=664&tripDuration=690&multiCityData=%5B%7B%22pickup_city%22%3A%2230804%22%2C%22drop_city%22%3A%2230711%22%2C%22pickup_address%22%3A%22%22%2C%22drop_address%22%3Anull%2C%22date%22%3A%222024-10-31+18%3A00%3A00%22%2C%22distance%22%3A%22664%22%2C%22duration%22%3A%22680%22%7D%5D&bookingType=1&pickupAddress=&dropupAddress=&routeDataArr%5B0%5D%5BlocLatVal%5D=&routeDataArr%5B0%5D%5BlocLonVal%5D=&routeDataArr%5B0%5D%5BbrtLocationVal%5D=&routeDataArr%5B1%5D%5BlocLatVal%5D=&routeDataArr%5B1%5D%5BlocLonVal%5D=&routeDataArr%5B1%5D%5BbrtLocationVal%5D=&pickupDate=31%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1171.223] [M: 26115.3] [ET: 1.386/1149.366] [MU: 21.05/26115.2] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1171.282] [M: 26116.98] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1172.778] [M: 26130.45] [ET: 1.275/1150.902] [MU: 2.99/26127.95] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+10013),(IF((cpm_value_type=2),(10013+(10013*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30937 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30937) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-31 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=93 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1175.157] [M: 26172.67] [ET: 5.412/1153.284] [MU: 78.88/26172.52] 
	RouteRates::calculate for CAB 93 2024-10-31 18:00:00 - Trip Type: 1 970919047
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1175.444] [M: 26150.36] [ET: 45.821/1153.587] [MU: 243.1/26150.2] 
	Quote::calculateRules for CAB 93, From City Id: 30804, To city Id: 30711
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1176.01] [M: 26122.08] [ET: 0.426/1154.144] [MU: 0.9/26121.83] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"93"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1176.15] [M: 26123.64] [ET: 59.633/1154.296] [MU: 317.41/26123.55] 
	Quote For CabType: 93
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1177.451] [M: 26133.62] [ET: 0.498/1155.589] [MU: 2.97/26133.18] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1178.123] [M: 26139.43] [ET: 0.553/1156.259] [MU: 3.33/26138.99] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1178.825] [M: 26142.37] [ET: 0.589/1156.965] [MU: 0.9/26142.12] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1179.683] [M: 26174.73] [ET: 0.688/1157.79] [MU: 24.22/26173.23] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (100) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30711) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp395)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp398,:gp399)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp396,:gp397)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp400,:gp401))
			OR (scr_area_type = 5 AND scr_area_id IN (3699))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (96)
		ORDER BY rank DESC
		 
	 [params: {":gp395":"31",":gp396":"30804",":gp397":"30711",":gp398":"105",":gp399":"100",":gp400":"1",":gp401":"1","tripType":"1"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1181.215] [M: 26154.91] [ET: 0.58/1159.346] [MU: 0.83/26154.72] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1181.923] [M: 26157.78] [ET: 0.562/1160.048] [MU: 0.96/26157.47] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"2"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1183.858] [M: 26170.53] [ET: 0.621/1161.989] [MU: 2.04/26170.03] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"96"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1184.965] [M: 26180.16] [ET: 0.759/1163.095] [MU: 3.78/26179.29] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"96","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1186.658] [M: 26196.79] [ET: 0.453/1164.815] [MU: 3.78/26195.91] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"16","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1188.14] [M: 26213.41] [ET: 0.441/1166.296] [MU: 3.78/26212.53] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1189.272] [M: 26224.51] [ET: 5.312/1167.436] [MU: 52.55/26224.35] 
	Quote::calculateOneWay  for CAB 96 Date: 2024-10-31 18:00:00
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1189.851] [M: 26228.01] [ET: 0.484/1168.009] [MU: 0.9/26227.76] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1191.109] [M: 26240.72] [ET: 0.506/1169.261] [MU: 3.33/26240.28] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1191.818] [M: 26269.89] [ET: 0.599/1169.972] [MU: 22.53/26269.14] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp404)) OR (apr_area_type = 5 AND apr_area_id IN (:gp402)) OR (apr_area_type = 2 AND apr_area_id IN (:gp405)) OR (apr_area_type = 4 AND apr_area_id IN (:gp406)) OR (apr_area_type = 1 AND apr_area_id IN (:gp403))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp402":"3699",":gp403":"31",":gp404":"30804",":gp405":"105",":gp406":"1","cab":"96"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1193.74] [M: 26256.91] [ET: 0.582/1171.87] [MU: 3.33/26256.47] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1196.192] [M: 26267.45] [ET: 2.283/1174.336] [MU: 3.53/26266.58] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp409)) OR (scr_area_type = 5 AND scr_area_id IN (:gp407)) OR (scr_area_type = 2 AND scr_area_id IN (:gp410)) OR (scr_area_type = 4 AND scr_area_id IN (:gp411)) OR (scr_area_type = 1 AND scr_area_id IN (:gp408)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp407":"3699",":gp408":"31",":gp409":"3699",":gp410":"105",":gp411":"1","scv_id":"96"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1197.348] [M: 26272.75] [ET: 0.587/1175.49] [MU: 7.1/26272.64] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1200.086] [M: 26285.27] [ET: 1.304/1178.244] [MU: 7.88/26285.16] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1201.087] [M: 26290.74] [ET: 0.91/1179.247] [MU: 8.27/26290.63] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1201.902] [M: 26298.27] [ET: 0.338/1180.059] [MU: 0.99/26297.9] 
	SQL: SELECT cts_airport_pickup_entry_fee
               FROM   cities
               INNER JOIN cities_stats
               ON cities.cty_id = cities_stats.cts_cty_id
               WHERE  cty_id = :cityId
               AND cty_is_airport = 1 AND cty_active = 1 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1203.43] [M: 26312.19] [ET: 0.982/1181.59] [MU: 8.13/26312.08] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1204.409] [M: 26319.93] [ET: 0.883/1182.548] [MU: 8.08/26319.82] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1204.932] [M: 26319.23] [ET: 0.437/1183.09] [MU: 0.9/26319.02] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1206.182] [M: 26331.61] [ET: 0.634/1184.324] [MU: 2.96/26331.17] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1207.101] [M: 26360.78] [ET: 0.787/1185.25] [MU: 22.53/26360.03] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp414)) OR (apr_area_type = 5 AND apr_area_id IN (:gp412)) OR (apr_area_type = 2 AND apr_area_id IN (:gp415)) OR (apr_area_type = 4 AND apr_area_id IN (:gp416)) OR (apr_area_type = 1 AND apr_area_id IN (:gp413))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp412":"3699",":gp413":"31",":gp414":"30804",":gp415":"105",":gp416":"1","cab":"96"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1209.1] [M: 26347.8] [ET: 0.599/1187.237] [MU: 3.33/26347.36] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1211.743] [M: 26358.34] [ET: 2.459/1189.868] [MU: 3.53/26357.47] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp419)) OR (scr_area_type = 5 AND scr_area_id IN (:gp417)) OR (scr_area_type = 2 AND scr_area_id IN (:gp420)) OR (scr_area_type = 4 AND scr_area_id IN (:gp421)) OR (scr_area_type = 1 AND scr_area_id IN (:gp418)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp417":"3699",":gp418":"31",":gp419":"3699",":gp420":"105",":gp421":"1","scv_id":"96"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1212.698] [M: 26361.55] [ET: 0.412/1190.839] [MU: 2.98/26361.45] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1214.965] [M: 26378.7] [ET: 0.29/1193.127] [MU: 7.1/26378.59] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1215.272] [M: 26379.02] [ET: 0.234/1193.436] [MU: 2.98/26378.91] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1219.572] [M: 26414.91] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"3","tripDistance":"664","tripDuration":"690","multiCityData":"[{\"pickup_city\":\"30804\",\"drop_city\":\"30711\",\"pickup_address\":\"\",\"drop_address\":null,\"date\":\"2024-10-31 18:00:00\",\"distance\":\"664\",\"duration\":\"680\"}]","bookingType":"1","pickupAddress":"","dropupAddress":"","routeDataArr":[{"locLatVal":"","locLonVal":"","brtLocationVal":""},{"locLatVal":"","locLonVal":"","brtLocationVal":""}],"pickupDate":"31\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=3&tripDistance=664&tripDuration=690&multiCityData=%5B%7B%22pickup_city%22%3A%2230804%22%2C%22drop_city%22%3A%2230711%22%2C%22pickup_address%22%3A%22%22%2C%22drop_address%22%3Anull%2C%22date%22%3A%222024-10-31+18%3A00%3A00%22%2C%22distance%22%3A%22664%22%2C%22duration%22%3A%22680%22%7D%5D&bookingType=1&pickupAddress=&dropupAddress=&routeDataArr%5B0%5D%5BlocLatVal%5D=&routeDataArr%5B0%5D%5BlocLonVal%5D=&routeDataArr%5B0%5D%5BbrtLocationVal%5D=&routeDataArr%5B1%5D%5BlocLatVal%5D=&routeDataArr%5B1%5D%5BlocLonVal%5D=&routeDataArr%5B1%5D%5BbrtLocationVal%5D=&pickupDate=31%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1220.01] [M: 26434.01] [ET: 0.873/1198.174] [MU: 21.05/26433.9] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1220.042] [M: 26435.69] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1221.043] [M: 26449.15] [ET: 0.873/1199.185] [MU: 2.99/26446.65] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+10013),(IF((cpm_value_type=2),(10013+(10013*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30937 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30937) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-31 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=96 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1222.863] [M: 26491.38] [ET: 3.782/1201.022] [MU: 78.87/26491.22] 
	RouteRates::calculate for CAB 96 2024-10-31 18:00:00 - Trip Type: 1 134064462
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1223.008] [M: 26469.06] [ET: 33.678/1201.174] [MU: 243.09/26468.91] 
	Quote::calculateRules for CAB 96, From City Id: 30804, To city Id: 30711
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1223.355] [M: 26440.79] [ET: 0.264/1201.516] [MU: 0.9/26440.54] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"96"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1223.431] [M: 26442.35] [ET: 47.208/1201.596] [MU: 317.41/26442.26] 
	Quote For CabType: 96
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1224.51] [M: 26452.33] [ET: 0.366/1202.668] [MU: 2.97/26451.89] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1224.911] [M: 26458.14] [ET: 0.333/1203.069] [MU: 3.34/26457.7] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1225.49] [M: 26461.08] [ET: 0.499/1203.633] [MU: 0.9/26460.83] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1226.159] [M: 26493.44] [ET: 0.526/1204.313] [MU: 24.22/26491.94] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (100) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30711) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp422)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp425,:gp426)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp423,:gp424)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp427,:gp428))
			OR (scr_area_type = 5 AND scr_area_id IN (3699))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (97)
		ORDER BY rank DESC
		 
	 [params: {":gp422":"31",":gp423":"30804",":gp424":"30711",":gp425":"105",":gp426":"100",":gp427":"1",":gp428":"1","tripType":"1"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1226.852] [M: 26473.62] [ET: 0.22/1205.013] [MU: 0.83/26473.43] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1227.228] [M: 26476.49] [ET: 0.3/1205.387] [MU: 0.96/26476.18] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"2"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1228.667] [M: 26489.24] [ET: 0.462/1206.806] [MU: 2.04/26488.74] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"97"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1229.545] [M: 26498.88] [ET: 0.593/1207.7] [MU: 3.78/26498] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"97","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1232.544] [M: 26515.5] [ET: 0.747/1210.698] [MU: 3.78/26514.63] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"16","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1234.255] [M: 26532.12] [ET: 0.541/1212.409] [MU: 3.78/26531.24] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1235.754] [M: 26543.22] [ET: 6.986/1213.903] [MU: 52.56/26543.06] 
	Quote::calculateOneWay  for CAB 97 Date: 2024-10-31 18:00:00
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1236.488] [M: 26546.72] [ET: 0.587/1214.626] [MU: 0.9/26546.47] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1238.199] [M: 26559.43] [ET: 0.766/1216.352] [MU: 3.33/26558.99] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1238.952] [M: 26588.6] [ET: 0.639/1217.107] [MU: 22.53/26587.85] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp431)) OR (apr_area_type = 5 AND apr_area_id IN (:gp429)) OR (apr_area_type = 2 AND apr_area_id IN (:gp432)) OR (apr_area_type = 4 AND apr_area_id IN (:gp433)) OR (apr_area_type = 1 AND apr_area_id IN (:gp430))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp429":"3699",":gp430":"31",":gp431":"30804",":gp432":"105",":gp433":"1","cab":"97"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1240.647] [M: 26575.62] [ET: 0.627/1218.791] [MU: 3.33/26575.18] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1243.069] [M: 26586.16] [ET: 2.258/1221.213] [MU: 3.53/26585.29] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp436)) OR (scr_area_type = 5 AND scr_area_id IN (:gp434)) OR (scr_area_type = 2 AND scr_area_id IN (:gp437)) OR (scr_area_type = 4 AND scr_area_id IN (:gp438)) OR (scr_area_type = 1 AND scr_area_id IN (:gp435)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp434":"3699",":gp435":"31",":gp436":"3699",":gp437":"105",":gp438":"1","scv_id":"97"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1243.752] [M: 26591.46] [ET: 0.401/1221.898] [MU: 7.1/26591.35] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1245.84] [M: 26603.98] [ET: 1.162/1223.997] [MU: 7.88/26603.87] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1247.517] [M: 26609.45] [ET: 1.585/1225.673] [MU: 8.27/26609.34] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1248.851] [M: 26616.98] [ET: 0.438/1226.993] [MU: 0.99/26616.61] 
	SQL: SELECT cts_airport_pickup_entry_fee
               FROM   cities
               INNER JOIN cities_stats
               ON cities.cty_id = cities_stats.cts_cty_id
               WHERE  cty_id = :cityId
               AND cty_is_airport = 1 AND cty_active = 1 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1250.818] [M: 26630.9] [ET: 1.193/1228.961] [MU: 8.13/26630.79] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1252.022] [M: 26638.64] [ET: 1.055/1230.168] [MU: 8.07/26638.53] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1252.499] [M: 26637.98] [ET: 0.371/1230.655] [MU: 0.9/26637.73] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1253.67] [M: 26650.32] [ET: 0.525/1231.818] [MU: 2.97/26649.88] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1254.368] [M: 26679.49] [ET: 0.581/1232.513] [MU: 22.53/26678.74] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp441)) OR (apr_area_type = 5 AND apr_area_id IN (:gp439)) OR (apr_area_type = 2 AND apr_area_id IN (:gp442)) OR (apr_area_type = 4 AND apr_area_id IN (:gp443)) OR (apr_area_type = 1 AND apr_area_id IN (:gp440))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp439":"3699",":gp440":"31",":gp441":"30804",":gp442":"105",":gp443":"1","cab":"97"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1256.116] [M: 26666.51] [ET: 0.557/1234.272] [MU: 3.33/26666.07] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1258.682] [M: 26677.05] [ET: 2.431/1236.811] [MU: 3.53/26676.18] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp446)) OR (scr_area_type = 5 AND scr_area_id IN (:gp444)) OR (scr_area_type = 2 AND scr_area_id IN (:gp447)) OR (scr_area_type = 4 AND scr_area_id IN (:gp448)) OR (scr_area_type = 1 AND scr_area_id IN (:gp445)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp444":"3699",":gp445":"31",":gp446":"3699",":gp447":"105",":gp448":"1","scv_id":"97"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1259.581] [M: 26680.27] [ET: 0.368/1237.729] [MU: 2.98/26680.16] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1261.676] [M: 26697.41] [ET: 0.417/1239.804] [MU: 7.1/26697.3] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1262.136] [M: 26697.73] [ET: 0.353/1240.286] [MU: 2.98/26697.63] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1267.929] [M: 26733.63] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"3","tripDistance":"664","tripDuration":"690","multiCityData":"[{\"pickup_city\":\"30804\",\"drop_city\":\"30711\",\"pickup_address\":\"\",\"drop_address\":null,\"date\":\"2024-10-31 18:00:00\",\"distance\":\"664\",\"duration\":\"680\"}]","bookingType":"1","pickupAddress":"","dropupAddress":"","routeDataArr":[{"locLatVal":"","locLonVal":"","brtLocationVal":""},{"locLatVal":"","locLonVal":"","brtLocationVal":""}],"pickupDate":"31\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=3&tripDistance=664&tripDuration=690&multiCityData=%5B%7B%22pickup_city%22%3A%2230804%22%2C%22drop_city%22%3A%2230711%22%2C%22pickup_address%22%3A%22%22%2C%22drop_address%22%3Anull%2C%22date%22%3A%222024-10-31+18%3A00%3A00%22%2C%22distance%22%3A%22664%22%2C%22duration%22%3A%22680%22%7D%5D&bookingType=1&pickupAddress=&dropupAddress=&routeDataArr%5B0%5D%5BlocLatVal%5D=&routeDataArr%5B0%5D%5BlocLonVal%5D=&routeDataArr%5B0%5D%5BbrtLocationVal%5D=&routeDataArr%5B1%5D%5BlocLatVal%5D=&routeDataArr%5B1%5D%5BlocLonVal%5D=&routeDataArr%5B1%5D%5BbrtLocationVal%5D=&pickupDate=31%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1268.665] [M: 26752.72] [ET: 1.306/1246.788] [MU: 21.04/26752.61] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1268.727] [M: 26754.4] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1270.193] [M: 26767.86] [ET: 1.253/1248.314] [MU: 2.99/26765.36] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+10013),(IF((cpm_value_type=2),(10013+(10013*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30937 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30937) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-31 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=97 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1272.402] [M: 26810.09] [ET: 5.156/1250.544] [MU: 78.87/26809.93] 
	RouteRates::calculate for CAB 97 2024-10-31 18:00:00 - Trip Type: 1 520688953
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1272.656] [M: 26787.77] [ET: 36.809/1250.804] [MU: 243.09/26787.62] 
	Quote::calculateRules for CAB 97, From City Id: 30804, To city Id: 30711
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1273.083] [M: 26759.5] [ET: 0.299/1251.223] [MU: 0.9/26759.25] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"97"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1273.205] [M: 26761.69] [ET: 49.709/1251.351] [MU: 318.03/26761.59] 
	Quote For CabType: 97
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1274.709] [M: 26771.66] [ET: 0.556/1252.84] [MU: 2.97/26771.23] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1275.547] [M: 26777.48] [ET: 0.707/1253.683] [MU: 3.33/26777.04] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1276.358] [M: 26780.41] [ET: 0.687/1254.465] [MU: 0.9/26780.16] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1277.308] [M: 26812.77] [ET: 0.758/1255.429] [MU: 24.22/26811.27] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (100) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30711) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp449)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp452,:gp453)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp450,:gp451)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp454,:gp455))
			OR (scr_area_type = 5 AND scr_area_id IN (3699))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (98)
		ORDER BY rank DESC
		 
	 [params: {":gp449":"31",":gp450":"30804",":gp451":"30711",":gp452":"105",":gp453":"100",":gp454":"1",":gp455":"1","tripType":"1"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1278.673] [M: 26792.95] [ET: 0.529/1256.803] [MU: 0.84/26792.77] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1279.834] [M: 26795.83] [ET: 0.941/1257.894] [MU: 0.96/26795.52] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"2"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1282.181] [M: 26808.58] [ET: 0.73/1260.307] [MU: 2.05/26808.08] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"98"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1283.462] [M: 26818.21] [ET: 0.899/1261.596] [MU: 3.78/26817.34] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"98","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1286.295] [M: 26834.84] [ET: 0.884/1264.424] [MU: 3.78/26833.96] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"16","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1288.774] [M: 26851.45] [ET: 0.681/1266.884] [MU: 3.78/26850.58] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1290.557] [M: 26862.52] [ET: 8.25/1268.698] [MU: 52.55/26862.4] 
	Quote::calculateOneWay  for CAB 98 Date: 2024-10-31 18:00:00
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1291.283] [M: 26866.02] [ET: 0.557/1269.418] [MU: 0.9/26865.8] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1292.884] [M: 26878.77] [ET: 0.681/1271.018] [MU: 3.34/26878.33] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1293.769] [M: 26907.94] [ET: 0.702/1271.899] [MU: 22.53/26907.19] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp458)) OR (apr_area_type = 5 AND apr_area_id IN (:gp456)) OR (apr_area_type = 2 AND apr_area_id IN (:gp459)) OR (apr_area_type = 4 AND apr_area_id IN (:gp460)) OR (apr_area_type = 1 AND apr_area_id IN (:gp457))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp456":"3699",":gp457":"31",":gp458":"30804",":gp459":"105",":gp460":"1","cab":"98"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1295.926] [M: 26894.95] [ET: 0.487/1274.081] [MU: 3.34/26894.52] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1299.323] [M: 26905.5] [ET: 3.258/1277.448] [MU: 3.53/26904.63] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp463)) OR (scr_area_type = 5 AND scr_area_id IN (:gp461)) OR (scr_area_type = 2 AND scr_area_id IN (:gp464)) OR (scr_area_type = 4 AND scr_area_id IN (:gp465)) OR (scr_area_type = 1 AND scr_area_id IN (:gp462)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp461":"3699",":gp462":"31",":gp463":"3699",":gp464":"105",":gp465":"1","scv_id":"98"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1300.23] [M: 26910.8] [ET: 0.417/1278.37] [MU: 7.1/26910.69] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1302.778] [M: 26923.31] [ET: 1.526/1280.908] [MU: 7.89/26923.2] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1304.349] [M: 26928.79] [ET: 1.399/1282.484] [MU: 8.26/26928.68] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1305.589] [M: 26936.32] [ET: 0.432/1283.724] [MU: 0.99/26935.95] 
	SQL: SELECT cts_airport_pickup_entry_fee
               FROM   cities
               INNER JOIN cities_stats
               ON cities.cty_id = cities_stats.cts_cty_id
               WHERE  cty_id = :cityId
               AND cty_is_airport = 1 AND cty_active = 1 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1307.577] [M: 26950.23] [ET: 1.266/1285.733] [MU: 8.14/26950.13] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1308.711] [M: 26957.98] [ET: 1.011/1286.853] [MU: 8.08/26957.87] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1309.281] [M: 26957.31] [ET: 0.478/1287.435] [MU: 0.9/26957.06] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1310.889] [M: 26969.66] [ET: 0.799/1289.031] [MU: 2.97/26969.22] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1311.7] [M: 26998.83] [ET: 0.677/1289.832] [MU: 22.53/26998.08] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp468)) OR (apr_area_type = 5 AND apr_area_id IN (:gp466)) OR (apr_area_type = 2 AND apr_area_id IN (:gp469)) OR (apr_area_type = 4 AND apr_area_id IN (:gp470)) OR (apr_area_type = 1 AND apr_area_id IN (:gp467))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp466":"3699",":gp467":"31",":gp468":"30804",":gp469":"105",":gp470":"1","cab":"98"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1314.311] [M: 26985.84] [ET: 0.984/1292.405] [MU: 3.34/26985.41] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1317.202] [M: 26996.39] [ET: 2.671/1295.331] [MU: 3.53/26995.52] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp473)) OR (scr_area_type = 5 AND scr_area_id IN (:gp471)) OR (scr_area_type = 2 AND scr_area_id IN (:gp474)) OR (scr_area_type = 4 AND scr_area_id IN (:gp475)) OR (scr_area_type = 1 AND scr_area_id IN (:gp472)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp471":"3699",":gp472":"31",":gp473":"3699",":gp474":"105",":gp475":"1","scv_id":"98"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1318.132] [M: 26999.6] [ET: 0.402/1296.273] [MU: 2.97/26999.49] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1320.36] [M: 27016.74] [ET: 0.431/1298.5] [MU: 7.11/27016.63] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1320.867] [M: 27017.07] [ET: 0.385/1299.009] [MU: 2.97/27016.96] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1326.673] [M: 27052.96] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"3","tripDistance":"664","tripDuration":"690","multiCityData":"[{\"pickup_city\":\"30804\",\"drop_city\":\"30711\",\"pickup_address\":\"\",\"drop_address\":null,\"date\":\"2024-10-31 18:00:00\",\"distance\":\"664\",\"duration\":\"680\"}]","bookingType":"1","pickupAddress":"","dropupAddress":"","routeDataArr":[{"locLatVal":"","locLonVal":"","brtLocationVal":""},{"locLatVal":"","locLonVal":"","brtLocationVal":""}],"pickupDate":"31\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=3&tripDistance=664&tripDuration=690&multiCityData=%5B%7B%22pickup_city%22%3A%2230804%22%2C%22drop_city%22%3A%2230711%22%2C%22pickup_address%22%3A%22%22%2C%22drop_address%22%3Anull%2C%22date%22%3A%222024-10-31+18%3A00%3A00%22%2C%22distance%22%3A%22664%22%2C%22duration%22%3A%22680%22%7D%5D&bookingType=1&pickupAddress=&dropupAddress=&routeDataArr%5B0%5D%5BlocLatVal%5D=&routeDataArr%5B0%5D%5BlocLonVal%5D=&routeDataArr%5B0%5D%5BbrtLocationVal%5D=&routeDataArr%5B1%5D%5BlocLatVal%5D=&routeDataArr%5B1%5D%5BlocLonVal%5D=&routeDataArr%5B1%5D%5BbrtLocationVal%5D=&pickupDate=31%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1327.213] [M: 27072.05] [ET: 1.265/1305.377] [MU: 21.05/27071.95] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1327.246] [M: 27073.73] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1328.87] [M: 27087.2] [ET: 1.47/1306.983] [MU: 2.99/27084.7] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+10013),(IF((cpm_value_type=2),(10013+(10013*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30937 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30937) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-31 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=98 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1331.821] [M: 27129.42] [ET: 5.938/1309.952] [MU: 78.88/27129.27] 
	RouteRates::calculate for CAB 98 2024-10-31 18:00:00 - Trip Type: 1 725679401
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1332.095] [M: 27107.11] [ET: 41.426/1310.237] [MU: 243.1/27106.95] 
	Quote::calculateRules for CAB 98, From City Id: 30804, To city Id: 30711
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1332.563] [M: 27078.84] [ET: 0.339/1310.702] [MU: 0.9/27078.59] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"98"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1332.69] [M: 27081.02] [ET: 59.399/1310.835] [MU: 318.03/27080.93] 
	Quote For CabType: 98
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1334.189] [M: 27091] [ET: 0.558/1312.32] [MU: 2.97/27090.56] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1335.055] [M: 27096.81] [ET: 0.722/1313.187] [MU: 3.34/27096.38] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1335.841] [M: 27099.72] [ET: 0.657/1313.974] [MU: 0.9/27099.5] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1336.742] [M: 27132.11] [ET: 0.719/1314.868] [MU: 24.22/27130.61] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (100) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30711) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp476)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp479,:gp480)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp477,:gp478)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp481,:gp482))
			OR (scr_area_type = 5 AND scr_area_id IN (3699))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (99)
		ORDER BY rank DESC
		 
	 [params: {":gp476":"31",":gp477":"30804",":gp478":"30711",":gp479":"105",":gp480":"100",":gp481":"1",":gp482":"1","tripType":"1"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1337.962] [M: 27112.29] [ET: 0.398/1316.097] [MU: 0.83/27112.1] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1338.593] [M: 27115.16] [ET: 0.492/1316.728] [MU: 0.96/27114.85] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"2"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1340.367] [M: 27127.91] [ET: 0.505/1318.499] [MU: 2.05/27127.41] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"99"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1341.433] [M: 27137.55] [ET: 0.745/1319.564] [MU: 3.78/27136.67] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"99","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1343.806] [M: 27154.17] [ET: 0.622/1321.938] [MU: 3.78/27153.3] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"16","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1346.06] [M: 27170.79] [ET: 0.625/1324.196] [MU: 3.78/27169.91] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1348.842] [M: 27181.89] [ET: 8.363/1326.981] [MU: 52.56/27181.73] 
	Quote::calculateOneWay  for CAB 99 Date: 2024-10-31 18:00:00
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1349.588] [M: 27185.39] [ET: 0.582/1327.726] [MU: 0.9/27185.14] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1351.114] [M: 27198.1] [ET: 0.641/1329.252] [MU: 3.34/27197.66] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1351.941] [M: 27227.27] [ET: 0.652/1330.066] [MU: 22.54/27226.52] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp485)) OR (apr_area_type = 5 AND apr_area_id IN (:gp483)) OR (apr_area_type = 2 AND apr_area_id IN (:gp486)) OR (apr_area_type = 4 AND apr_area_id IN (:gp487)) OR (apr_area_type = 1 AND apr_area_id IN (:gp484))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp483":"3699",":gp484":"31",":gp485":"30804",":gp486":"105",":gp487":"1","cab":"99"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1353.959] [M: 27214.29] [ET: 0.645/1332.093] [MU: 3.33/27213.85] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1356.751] [M: 27224.84] [ET: 2.599/1334.877] [MU: 3.53/27223.96] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp490)) OR (scr_area_type = 5 AND scr_area_id IN (:gp488)) OR (scr_area_type = 2 AND scr_area_id IN (:gp491)) OR (scr_area_type = 4 AND scr_area_id IN (:gp492)) OR (scr_area_type = 1 AND scr_area_id IN (:gp489)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp488":"3699",":gp489":"31",":gp490":"3699",":gp491":"105",":gp492":"1","scv_id":"99"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1357.611] [M: 27230.13] [ET: 0.431/1335.75] [MU: 7.11/27230.02] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1359.955] [M: 27242.65] [ET: 1.343/1338.09] [MU: 7.88/27242.54] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1361.443] [M: 27248.13] [ET: 1.333/1339.578] [MU: 8.27/27248.02] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1362.904] [M: 27255.66] [ET: 0.535/1340.993] [MU: 0.99/27255.28] 
	SQL: SELECT cts_airport_pickup_entry_fee
               FROM   cities
               INNER JOIN cities_stats
               ON cities.cty_id = cities_stats.cts_cty_id
               WHERE  cty_id = :cityId
               AND cty_is_airport = 1 AND cty_active = 1 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1365.56] [M: 27269.57] [ET: 1.712/1343.695] [MU: 8.13/27269.46] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1367.148] [M: 27277.3] [ET: 1.435/1345.3] [MU: 8.08/27277.2] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1367.891] [M: 27276.62] [ET: 0.624/1346.022] [MU: 0.9/27276.4] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1369.393] [M: 27288.99] [ET: 0.67/1347.531] [MU: 2.97/27288.55] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1370.247] [M: 27318.16] [ET: 0.653/1348.377] [MU: 22.53/27317.41] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp495)) OR (apr_area_type = 5 AND apr_area_id IN (:gp493)) OR (apr_area_type = 2 AND apr_area_id IN (:gp496)) OR (apr_area_type = 4 AND apr_area_id IN (:gp497)) OR (apr_area_type = 1 AND apr_area_id IN (:gp494))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp493":"3699",":gp494":"31",":gp495":"30804",":gp496":"105",":gp497":"1","cab":"99"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1372.004] [M: 27305.18] [ET: 0.481/1350.159] [MU: 3.33/27304.74] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1374.667] [M: 27315.73] [ET: 2.529/1352.794] [MU: 3.53/27314.85] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp500)) OR (scr_area_type = 5 AND scr_area_id IN (:gp498)) OR (scr_area_type = 2 AND scr_area_id IN (:gp501)) OR (scr_area_type = 4 AND scr_area_id IN (:gp502)) OR (scr_area_type = 1 AND scr_area_id IN (:gp499)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp498":"3699",":gp499":"31",":gp500":"3699",":gp501":"105",":gp502":"1","scv_id":"99"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1375.613] [M: 27322.94] [ET: 0.369/1353.771] [MU: 2.98/27322.83] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1377.361] [M: 27340.08] [ET: 0.423/1355.502] [MU: 7.1/27339.97] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1377.867] [M: 27340.41] [ET: 0.381/1356.008] [MU: 2.98/27340.3] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1383.754] [M: 27376.3] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"3","tripDistance":"664","tripDuration":"690","multiCityData":"[{\"pickup_city\":\"30804\",\"drop_city\":\"30711\",\"pickup_address\":\"\",\"drop_address\":null,\"date\":\"2024-10-31 18:00:00\",\"distance\":\"664\",\"duration\":\"680\"}]","bookingType":"1","pickupAddress":"","dropupAddress":"","routeDataArr":[{"locLatVal":"","locLonVal":"","brtLocationVal":""},{"locLatVal":"","locLonVal":"","brtLocationVal":""}],"pickupDate":"31\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=3&tripDistance=664&tripDuration=690&multiCityData=%5B%7B%22pickup_city%22%3A%2230804%22%2C%22drop_city%22%3A%2230711%22%2C%22pickup_address%22%3A%22%22%2C%22drop_address%22%3Anull%2C%22date%22%3A%222024-10-31+18%3A00%3A00%22%2C%22distance%22%3A%22664%22%2C%22duration%22%3A%22680%22%7D%5D&bookingType=1&pickupAddress=&dropupAddress=&routeDataArr%5B0%5D%5BlocLatVal%5D=&routeDataArr%5B0%5D%5BlocLonVal%5D=&routeDataArr%5B0%5D%5BbrtLocationVal%5D=&routeDataArr%5B1%5D%5BlocLatVal%5D=&routeDataArr%5B1%5D%5BlocLonVal%5D=&routeDataArr%5B1%5D%5BbrtLocationVal%5D=&pickupDate=31%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1384.488] [M: 27395.39] [ET: 1.332/1362.631] [MU: 21.04/27395.28] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1384.546] [M: 27397.07] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1385.924] [M: 27410.53] [ET: 1.176/1364.05] [MU: 2.99/27408.03] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+10013),(IF((cpm_value_type=2),(10013+(10013*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30937 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30937) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-31 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=99 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1387.739] [M: 27452.76] [ET: 4.685/1365.896] [MU: 78.87/27452.6] 
	RouteRates::calculate for CAB 99 2024-10-31 18:00:00 - Trip Type: 1 888772553
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1387.9] [M: 27430.45] [ET: 38.967/1366.064] [MU: 247.09/27430.29] 
	Quote::calculateRules for CAB 99, From City Id: 30804, To city Id: 30711
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1388.258] [M: 27402.17] [ET: 0.259/1366.395] [MU: 0.89/27401.92] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"99"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1388.414] [M: 27404.36] [ET: 55.635/1366.537] [MU: 322.03/27404.27] 
	Quote For CabType: 99
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1389.841] [M: 27414.34] [ET: 0.524/1367.978] [MU: 2.97/27413.9] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1390.518] [M: 27420.15] [ET: 0.562/1368.656] [MU: 3.33/27419.71] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1391.245] [M: 27423.05] [ET: 0.61/1369.378] [MU: 0.9/27422.84] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1392.036] [M: 27455.45] [ET: 0.612/1370.167] [MU: 24.22/27453.95] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (100) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30711) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp503)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp506,:gp507)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp504,:gp505)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp508,:gp509))
			OR (scr_area_type = 5 AND scr_area_id IN (3699))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (108)
		ORDER BY rank DESC
		 
	 [params: {":gp503":"31",":gp504":"30804",":gp505":"30711",":gp506":"105",":gp507":"100",":gp508":"1",":gp509":"1","tripType":"1"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1392.927] [M: 27435.64] [ET: 0.262/1371.071] [MU: 0.84/27435.45] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1393.378] [M: 27438.48] [ET: 0.335/1371.517] [MU: 0.93/27438.17] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"6"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1395.175] [M: 27451.32] [ET: 0.474/1373.307] [MU: 2.04/27450.82] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"108"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1396.411] [M: 27460.95] [ET: 0.814/1374.456] [MU: 3.78/27460.08] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"108","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1399.128] [M: 27477.59] [ET: 0.756/1377.261] [MU: 3.78/27476.72] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"73","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1401.212] [M: 27494.21] [ET: 0.505/1379.366] [MU: 3.78/27493.34] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1402.649] [M: 27505.3] [ET: 7.357/1380.787] [MU: 52.55/27505.14] 
	Quote::calculateOneWay  for CAB 108 Date: 2024-10-31 18:00:00
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1403.274] [M: 27508.8] [ET: 0.461/1381.432] [MU: 0.9/27508.55] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1404.748] [M: 27521.51] [ET: 0.676/1382.879] [MU: 3.33/27521.07] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1405.503] [M: 27550.68] [ET: 0.629/1383.659] [MU: 22.53/27549.93] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp512)) OR (apr_area_type = 5 AND apr_area_id IN (:gp510)) OR (apr_area_type = 2 AND apr_area_id IN (:gp513)) OR (apr_area_type = 4 AND apr_area_id IN (:gp514)) OR (apr_area_type = 1 AND apr_area_id IN (:gp511))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp510":"3699",":gp511":"31",":gp512":"30804",":gp513":"105",":gp514":"1","cab":"108"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1407.747] [M: 27537.71] [ET: 0.599/1385.877] [MU: 3.34/27537.27] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1410.704] [M: 27548.26] [ET: 2.761/1388.825] [MU: 3.54/27547.38] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp517)) OR (scr_area_type = 5 AND scr_area_id IN (:gp515)) OR (scr_area_type = 2 AND scr_area_id IN (:gp518)) OR (scr_area_type = 4 AND scr_area_id IN (:gp519)) OR (scr_area_type = 1 AND scr_area_id IN (:gp516)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp515":"3699",":gp516":"31",":gp517":"3699",":gp518":"105",":gp519":"1","scv_id":"108"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1411.359] [M: 27553.54] [ET: 0.301/1389.514] [MU: 7.1/27553.43] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1413.931] [M: 27566.05] [ET: 1.704/1392.065] [MU: 7.88/27565.95] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1415.717] [M: 27571.53] [ET: 1.61/1393.854] [MU: 8.26/27571.42] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1417.259] [M: 27579.06] [ET: 0.635/1395.404] [MU: 0.99/27578.69] 
	SQL: SELECT cts_airport_pickup_entry_fee
               FROM   cities
               INNER JOIN cities_stats
               ON cities.cty_id = cities_stats.cts_cty_id
               WHERE  cty_id = :cityId
               AND cty_is_airport = 1 AND cty_active = 1 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1419.074] [M: 27592.98] [ET: 1.162/1397.215] [MU: 8.13/27592.87] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1420.342] [M: 27600.72] [ET: 1.139/1398.495] [MU: 8.08/27600.61] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1420.966] [M: 27600.02] [ET: 0.502/1399.103] [MU: 0.9/27599.8] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1422.533] [M: 27612.4] [ET: 0.675/1400.67] [MU: 2.97/27611.96] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1423.601] [M: 27641.57] [ET: 0.793/1401.736] [MU: 22.53/27640.82] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp522)) OR (apr_area_type = 5 AND apr_area_id IN (:gp520)) OR (apr_area_type = 2 AND apr_area_id IN (:gp523)) OR (apr_area_type = 4 AND apr_area_id IN (:gp524)) OR (apr_area_type = 1 AND apr_area_id IN (:gp521))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp520":"3699",":gp521":"31",":gp522":"30804",":gp523":"105",":gp524":"1","cab":"108"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1425.563] [M: 27628.6] [ET: 0.515/1403.7] [MU: 3.34/27628.16] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1428.062] [M: 27639.15] [ET: 2.322/1406.191] [MU: 3.54/27638.27] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp527)) OR (scr_area_type = 5 AND scr_area_id IN (:gp525)) OR (scr_area_type = 2 AND scr_area_id IN (:gp528)) OR (scr_area_type = 4 AND scr_area_id IN (:gp529)) OR (scr_area_type = 1 AND scr_area_id IN (:gp526)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp525":"3699",":gp526":"31",":gp527":"3699",":gp528":"105",":gp529":"1","scv_id":"108"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1428.99] [M: 27642.34] [ET: 0.397/1407.132] [MU: 2.98/27642.23] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1431.631] [M: 27659.48] [ET: 0.702/1409.75] [MU: 7.1/27659.38] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1432.271] [M: 27659.81] [ET: 0.496/1410.412] [MU: 2.98/27659.7] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1436.512] [M: 27695.7] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"3","tripDistance":"664","tripDuration":"690","multiCityData":"[{\"pickup_city\":\"30804\",\"drop_city\":\"30711\",\"pickup_address\":\"\",\"drop_address\":null,\"date\":\"2024-10-31 18:00:00\",\"distance\":\"664\",\"duration\":\"680\"}]","bookingType":"1","pickupAddress":"","dropupAddress":"","routeDataArr":[{"locLatVal":"","locLonVal":"","brtLocationVal":""},{"locLatVal":"","locLonVal":"","brtLocationVal":""}],"pickupDate":"31\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=3&tripDistance=664&tripDuration=690&multiCityData=%5B%7B%22pickup_city%22%3A%2230804%22%2C%22drop_city%22%3A%2230711%22%2C%22pickup_address%22%3A%22%22%2C%22drop_address%22%3Anull%2C%22date%22%3A%222024-10-31+18%3A00%3A00%22%2C%22distance%22%3A%22664%22%2C%22duration%22%3A%22680%22%7D%5D&bookingType=1&pickupAddress=&dropupAddress=&routeDataArr%5B0%5D%5BlocLatVal%5D=&routeDataArr%5B0%5D%5BlocLonVal%5D=&routeDataArr%5B0%5D%5BbrtLocationVal%5D=&routeDataArr%5B1%5D%5BlocLatVal%5D=&routeDataArr%5B1%5D%5BlocLonVal%5D=&routeDataArr%5B1%5D%5BbrtLocationVal%5D=&pickupDate=31%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1436.926] [M: 27714.8] [ET: 0.828/1415.09] [MU: 21.05/27714.69] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1436.957] [M: 27716.48] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1438.016] [M: 27729.94] [ET: 0.858/1416.08] [MU: 2.99/27727.44] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+10013),(IF((cpm_value_type=2),(10013+(10013*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30937 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30937) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-31 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=108 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1439.919] [M: 27772.16] [ET: 3.855/1418.057] [MU: 78.87/27772.01] 
	RouteRates::calculate for CAB 108 2024-10-31 18:00:00 - Trip Type: 1 740345632
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1440.172] [M: 27749.85] [ET: 37.393/1418.312] [MU: 243.1/27749.7] 
	Quote::calculateRules for CAB 108, From City Id: 30804, To city Id: 30711
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1440.563] [M: 27721.48] [ET: 0.281/1418.724] [MU: 0.9/27721.23] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"108"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1440.636] [M: 27723.66] [ET: 52.148/1418.802] [MU: 318/27723.57] 
	Quote For CabType: 108
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1441.675] [M: 27733.64] [ET: 0.373/1419.834] [MU: 2.97/27733.2] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1442.083] [M: 27739.45] [ET: 0.342/1420.244] [MU: 3.34/27739.02] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1442.585] [M: 27742.39] [ET: 0.433/1420.742] [MU: 0.9/27742.14] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1443.137] [M: 27774.75] [ET: 0.445/1421.291] [MU: 24.22/27773.25] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (100) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30711) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp530)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp533,:gp534)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp531,:gp532)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp535,:gp536))
			OR (scr_area_type = 5 AND scr_area_id IN (3699))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (111)
		ORDER BY rank DESC
		 
	 [params: {":gp530":"31",":gp531":"30804",":gp532":"30711",":gp533":"105",":gp534":"100",":gp535":"1",":gp536":"1","tripType":"1"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1443.866] [M: 27754.94] [ET: 0.223/1422.007] [MU: 0.83/27754.75] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1444.302] [M: 27757.78] [ET: 0.331/1422.462] [MU: 0.93/27757.47] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"6"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1445.486] [M: 27770.62] [ET: 0.354/1423.618] [MU: 2.05/27770.12] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"111"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1447.163] [M: 27780.25] [ET: 1.348/1425.293] [MU: 3.78/27779.38] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"111","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1449.529] [M: 27796.88] [ET: 0.468/1427.685] [MU: 3.78/27796.01] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"73","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1451.107] [M: 27813.5] [ET: 0.472/1429.263] [MU: 3.78/27812.63] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1452.267] [M: 27824.59] [ET: 6.687/1430.432] [MU: 52.55/27824.44] 
	Quote::calculateOneWay  for CAB 111 Date: 2024-10-31 18:00:00
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1452.834] [M: 27828.09] [ET: 0.474/1430.992] [MU: 0.9/27827.84] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1453.988] [M: 27840.8] [ET: 0.485/1432.096] [MU: 3.34/27840.37] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1454.752] [M: 27869.98] [ET: 0.636/1432.903] [MU: 22.53/27869.23] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp539)) OR (apr_area_type = 5 AND apr_area_id IN (:gp537)) OR (apr_area_type = 2 AND apr_area_id IN (:gp540)) OR (apr_area_type = 4 AND apr_area_id IN (:gp541)) OR (apr_area_type = 1 AND apr_area_id IN (:gp538))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp537":"3699",":gp538":"31",":gp539":"30804",":gp540":"105",":gp541":"1","cab":"111"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1456.245] [M: 27857] [ET: 0.427/1434.404] [MU: 3.34/27856.56] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1458.937] [M: 27867.55] [ET: 2.569/1437.068] [MU: 3.53/27866.67] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp544)) OR (scr_area_type = 5 AND scr_area_id IN (:gp542)) OR (scr_area_type = 2 AND scr_area_id IN (:gp545)) OR (scr_area_type = 4 AND scr_area_id IN (:gp546)) OR (scr_area_type = 1 AND scr_area_id IN (:gp543)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp542":"3699",":gp543":"31",":gp544":"3699",":gp545":"105",":gp546":"1","scv_id":"111"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1459.761] [M: 27872.84] [ET: 0.416/1437.902] [MU: 7.1/27872.73] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1461.984] [M: 27885.35] [ET: 1.251/1440.074] [MU: 7.88/27885.24] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1463.843] [M: 27890.83] [ET: 1.708/1441.974] [MU: 8.26/27890.72] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1464.989] [M: 27898.36] [ET: 0.406/1443.143] [MU: 1/27897.98] 
	SQL: SELECT cts_airport_pickup_entry_fee
               FROM   cities
               INNER JOIN cities_stats
               ON cities.cty_id = cities_stats.cts_cty_id
               WHERE  cty_id = :cityId
               AND cty_is_airport = 1 AND cty_active = 1 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1466.443] [M: 27912.27] [ET: 0.9/1444.601] [MU: 8.14/27912.16] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1467.326] [M: 27920.02] [ET: 0.786/1445.487] [MU: 8.08/27919.91] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1467.782] [M: 27919.35] [ET: 0.373/1445.941] [MU: 0.89/27919.1] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1468.864] [M: 27931.7] [ET: 0.508/1447.022] [MU: 2.97/27931.26] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1469.463] [M: 27960.87] [ET: 0.492/1447.617] [MU: 22.53/27960.12] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp549)) OR (apr_area_type = 5 AND apr_area_id IN (:gp547)) OR (apr_area_type = 2 AND apr_area_id IN (:gp550)) OR (apr_area_type = 4 AND apr_area_id IN (:gp551)) OR (apr_area_type = 1 AND apr_area_id IN (:gp548))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp547":"3699",":gp548":"31",":gp549":"30804",":gp550":"105",":gp551":"1","cab":"111"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1471.291] [M: 27947.89] [ET: 0.542/1449.448] [MU: 3.34/27947.45] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1473.572] [M: 27958.44] [ET: 2.154/1451.702] [MU: 3.54/27957.56] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp554)) OR (scr_area_type = 5 AND scr_area_id IN (:gp552)) OR (scr_area_type = 2 AND scr_area_id IN (:gp555)) OR (scr_area_type = 4 AND scr_area_id IN (:gp556)) OR (scr_area_type = 1 AND scr_area_id IN (:gp553)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp552":"3699",":gp553":"31",":gp554":"3699",":gp555":"105",":gp556":"1","scv_id":"111"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1474.477] [M: 27961.64] [ET: 0.394/1452.62] [MU: 2.97/27961.53] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1476.539] [M: 27978.78] [ET: 0.378/1454.685] [MU: 7.1/27978.67] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1476.977] [M: 27979.09] [ET: 0.328/1455.124] [MU: 2.97/27979] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1482.545] [M: 28015] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"3","tripDistance":"664","tripDuration":"690","multiCityData":"[{\"pickup_city\":\"30804\",\"drop_city\":\"30711\",\"pickup_address\":\"\",\"drop_address\":null,\"date\":\"2024-10-31 18:00:00\",\"distance\":\"664\",\"duration\":\"680\"}]","bookingType":"1","pickupAddress":"","dropupAddress":"","routeDataArr":[{"locLatVal":"","locLonVal":"","brtLocationVal":""},{"locLatVal":"","locLonVal":"","brtLocationVal":""}],"pickupDate":"31\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=3&tripDistance=664&tripDuration=690&multiCityData=%5B%7B%22pickup_city%22%3A%2230804%22%2C%22drop_city%22%3A%2230711%22%2C%22pickup_address%22%3A%22%22%2C%22drop_address%22%3Anull%2C%22date%22%3A%222024-10-31+18%3A00%3A00%22%2C%22distance%22%3A%22664%22%2C%22duration%22%3A%22680%22%7D%5D&bookingType=1&pickupAddress=&dropupAddress=&routeDataArr%5B0%5D%5BlocLatVal%5D=&routeDataArr%5B0%5D%5BlocLonVal%5D=&routeDataArr%5B0%5D%5BbrtLocationVal%5D=&routeDataArr%5B1%5D%5BlocLatVal%5D=&routeDataArr%5B1%5D%5BlocLonVal%5D=&routeDataArr%5B1%5D%5BbrtLocationVal%5D=&pickupDate=31%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1482.967] [M: 28034.09] [ET: 0.861/1461.132] [MU: 21.05/28033.98] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1482.998] [M: 28035.77] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1484.185] [M: 28049.23] [ET: 1.062/1462.331] [MU: 3/28046.73] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+10013),(IF((cpm_value_type=2),(10013+(10013*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30937 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30937) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-31 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=111 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1485.761] [M: 28091.46] [ET: 3.705/1463.92] [MU: 78.88/28091.3] 
	RouteRates::calculate for CAB 111 2024-10-31 18:00:00 - Trip Type: 1 333197254
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1485.915] [M: 28069.15] [ET: 33.589/1464.08] [MU: 243.09/28068.99] 
	Quote::calculateRules for CAB 111, From City Id: 30804, To city Id: 30711
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1486.545] [M: 28040.78] [ET: 0.456/1464.675] [MU: 0.89/28040.53] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"111"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1486.679] [M: 28042.97] [ET: 45.979/1464.826] [MU: 318/28042.88] 
	Quote For CabType: 111
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1488.072] [M: 28052.95] [ET: 0.575/1466.21] [MU: 2.97/28052.51] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1488.681] [M: 28058.76] [ET: 0.495/1466.822] [MU: 3.33/28058.32] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1489.268] [M: 28061.7] [ET: 0.482/1467.425] [MU: 0.9/28061.45] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1490] [M: 28094.05] [ET: 0.624/1468.154] [MU: 24.22/28092.55] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (100) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30711) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp557)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp560,:gp561)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp558,:gp559)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp562,:gp563))
			OR (scr_area_type = 5 AND scr_area_id IN (3699))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (112)
		ORDER BY rank DESC
		 
	 [params: {":gp557":"31",":gp558":"30804",":gp559":"30711",":gp560":"105",":gp561":"100",":gp562":"1",":gp563":"1","tripType":"1"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1490.683] [M: 28074.24] [ET: 0.217/1468.844] [MU: 0.84/28074.05] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1491.066] [M: 28077.09] [ET: 0.306/1469.226] [MU: 0.93/28076.77] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"6"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1492.33] [M: 28089.92] [ET: 0.428/1470.464] [MU: 2.04/28089.42] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"112"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1493.209] [M: 28099.55] [ET: 0.667/1471.365] [MU: 3.78/28098.68] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"112","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1495.229] [M: 28116.19] [ET: 0.571/1473.38] [MU: 3.79/28115.31] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"73","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1497.778] [M: 28132.8] [ET: 0.806/1475.911] [MU: 3.78/28131.93] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1499.32] [M: 28143.9] [ET: 6.92/1477.483] [MU: 52.55/28143.74] 
	Quote::calculateOneWay  for CAB 112 Date: 2024-10-31 18:00:00
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1499.844] [M: 28147.4] [ET: 0.413/1477.973] [MU: 0.9/28147.15] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1501.301] [M: 28160.11] [ET: 0.611/1479.432] [MU: 3.33/28159.67] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1502.02] [M: 28189.28] [ET: 0.544/1480.114] [MU: 22.53/28188.53] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp566)) OR (apr_area_type = 5 AND apr_area_id IN (:gp564)) OR (apr_area_type = 2 AND apr_area_id IN (:gp567)) OR (apr_area_type = 4 AND apr_area_id IN (:gp568)) OR (apr_area_type = 1 AND apr_area_id IN (:gp565))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp564":"3699",":gp565":"31",":gp566":"30804",":gp567":"105",":gp568":"1","cab":"112"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1503.737] [M: 28176.3] [ET: 0.457/1481.895] [MU: 3.34/28175.87] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1505.966] [M: 28186.85] [ET: 2.12/1484.114] [MU: 3.53/28185.98] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp571)) OR (scr_area_type = 5 AND scr_area_id IN (:gp569)) OR (scr_area_type = 2 AND scr_area_id IN (:gp572)) OR (scr_area_type = 4 AND scr_area_id IN (:gp573)) OR (scr_area_type = 1 AND scr_area_id IN (:gp570)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp569":"3699",":gp570":"31",":gp571":"3699",":gp572":"105",":gp573":"1","scv_id":"112"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1506.531] [M: 28192.14] [ET: 0.296/1484.693] [MU: 7.1/28192.03] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1508.284] [M: 28204.66] [ET: 1.022/1486.416] [MU: 7.88/28204.55] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1509.521] [M: 28210.13] [ET: 1.099/1487.681] [MU: 8.27/28210.02] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1510.504] [M: 28217.66] [ET: 0.439/1488.64] [MU: 0.99/28217.29] 
	SQL: SELECT cts_airport_pickup_entry_fee
               FROM   cities
               INNER JOIN cities_stats
               ON cities.cty_id = cities_stats.cts_cty_id
               WHERE  cty_id = :cityId
               AND cty_is_airport = 1 AND cty_active = 1 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1512.21] [M: 28231.58] [ET: 1.064/1490.368] [MU: 8.13/28231.47] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1513.567] [M: 28239.32] [ET: 1.238/1491.703] [MU: 8.07/28239.21] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1514.192] [M: 28238.66] [ET: 0.483/1492.347] [MU: 0.9/28238.41] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1515.355] [M: 28251] [ET: 0.499/1493.512] [MU: 2.97/28250.56] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1516.057] [M: 28280.17] [ET: 0.596/1494.212] [MU: 22.53/28279.42] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp576)) OR (apr_area_type = 5 AND apr_area_id IN (:gp574)) OR (apr_area_type = 2 AND apr_area_id IN (:gp577)) OR (apr_area_type = 4 AND apr_area_id IN (:gp578)) OR (apr_area_type = 1 AND apr_area_id IN (:gp575))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp574":"3699",":gp575":"31",":gp576":"30804",":gp577":"105",":gp578":"1","cab":"112"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1517.447] [M: 28267.2] [ET: 0.432/1495.605] [MU: 3.34/28266.76] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1520.071] [M: 28277.74] [ET: 2.498/1498.196] [MU: 3.53/28276.87] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp581)) OR (scr_area_type = 5 AND scr_area_id IN (:gp579)) OR (scr_area_type = 2 AND scr_area_id IN (:gp582)) OR (scr_area_type = 4 AND scr_area_id IN (:gp583)) OR (scr_area_type = 1 AND scr_area_id IN (:gp580)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp579":"3699",":gp580":"31",":gp581":"3699",":gp582":"105",":gp583":"1","scv_id":"112"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1520.962] [M: 28280.95] [ET: 0.379/1499.103] [MU: 2.98/28280.84] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1522.999] [M: 28298.09] [ET: 0.41/1501.142] [MU: 7.1/28297.98] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1523.478] [M: 28298.41] [ET: 0.358/1501.618] [MU: 2.98/28298.3] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1528.687] [M: 28334.3] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"3","tripDistance":"664","tripDuration":"690","multiCityData":"[{\"pickup_city\":\"30804\",\"drop_city\":\"30711\",\"pickup_address\":\"\",\"drop_address\":null,\"date\":\"2024-10-31 18:00:00\",\"distance\":\"664\",\"duration\":\"680\"}]","bookingType":"1","pickupAddress":"","dropupAddress":"","routeDataArr":[{"locLatVal":"","locLonVal":"","brtLocationVal":""},{"locLatVal":"","locLonVal":"","brtLocationVal":""}],"pickupDate":"31\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=3&tripDistance=664&tripDuration=690&multiCityData=%5B%7B%22pickup_city%22%3A%2230804%22%2C%22drop_city%22%3A%2230711%22%2C%22pickup_address%22%3A%22%22%2C%22drop_address%22%3Anull%2C%22date%22%3A%222024-10-31+18%3A00%3A00%22%2C%22distance%22%3A%22664%22%2C%22duration%22%3A%22680%22%7D%5D&bookingType=1&pickupAddress=&dropupAddress=&routeDataArr%5B0%5D%5BlocLatVal%5D=&routeDataArr%5B0%5D%5BlocLonVal%5D=&routeDataArr%5B0%5D%5BbrtLocationVal%5D=&routeDataArr%5B1%5D%5BlocLatVal%5D=&routeDataArr%5B1%5D%5BlocLonVal%5D=&routeDataArr%5B1%5D%5BbrtLocationVal%5D=&pickupDate=31%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1529.141] [M: 28353.4] [ET: 0.885/1507.306] [MU: 21.05/28353.29] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1529.174] [M: 28355.08] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1530.591] [M: 28368.54] [ET: 1.269/1508.712] [MU: 2.99/28366.04] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+10013),(IF((cpm_value_type=2),(10013+(10013*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30937 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30937) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-31 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=112 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1533.178] [M: 28410.77] [ET: 4.976/1511.336] [MU: 78.87/28410.61] 
	RouteRates::calculate for CAB 112 2024-10-31 18:00:00 - Trip Type: 1 511309494
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1533.332] [M: 28388.45] [ET: 33.952/1511.497] [MU: 243.09/28388.3] 
	Quote::calculateRules for CAB 112, From City Id: 30804, To city Id: 30711
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1533.633] [M: 28360.09] [ET: 0.224/1511.793] [MU: 0.9/28359.84] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"112"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1533.73] [M: 28362.27] [ET: 46.982/1511.896] [MU: 318/28362.18] 
	Quote For CabType: 112
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1535.24] [M: 28372.25] [ET: 0.635/1513.379] [MU: 2.97/28371.81] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1535.858] [M: 28378.06] [ET: 0.507/1513.997] [MU: 3.34/28377.63] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1536.538] [M: 28380.97] [ET: 0.57/1514.681] [MU: 0.9/28380.75] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1537.257] [M: 28413.36] [ET: 0.561/1515.391] [MU: 24.22/28411.86] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (100) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30711) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp584)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp587,:gp588)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp585,:gp586)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp589,:gp590))
			OR (scr_area_type = 5 AND scr_area_id IN (3699))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (113)
		ORDER BY rank DESC
		 
	 [params: {":gp584":"31",":gp585":"30804",":gp586":"30711",":gp587":"105",":gp588":"100",":gp589":"1",":gp590":"1","tripType":"1"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1538.106] [M: 28393.55] [ET: 0.228/1516.265] [MU: 0.83/28393.36] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1538.461] [M: 28396.39] [ET: 0.278/1516.62] [MU: 0.93/28396.08] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"6"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1539.639] [M: 28409.23] [ET: 0.401/1517.794] [MU: 2.05/28408.73] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"113"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1540.482] [M: 28418.86] [ET: 0.635/1518.636] [MU: 3.78/28417.98] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"113","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1542.26] [M: 28435.49] [ET: 0.544/1520.399] [MU: 3.78/28434.62] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"73","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1544.107] [M: 28452.11] [ET: 0.457/1522.264] [MU: 3.78/28451.23] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1545.221] [M: 28463.2] [ET: 5.512/1523.385] [MU: 52.56/28463.05] 
	Quote::calculateOneWay  for CAB 113 Date: 2024-10-31 18:00:00
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1545.776] [M: 28466.7] [ET: 0.464/1523.936] [MU: 0.9/28466.45] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1547.272] [M: 28479.41] [ET: 0.565/1525.427] [MU: 3.34/28478.98] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1548.214] [M: 28508.59] [ET: 0.762/1526.366] [MU: 22.53/28507.84] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp593)) OR (apr_area_type = 5 AND apr_area_id IN (:gp591)) OR (apr_area_type = 2 AND apr_area_id IN (:gp594)) OR (apr_area_type = 4 AND apr_area_id IN (:gp595)) OR (apr_area_type = 1 AND apr_area_id IN (:gp592))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp591":"3699",":gp592":"31",":gp593":"30804",":gp594":"105",":gp595":"1","cab":"113"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1549.907] [M: 28495.61] [ET: 0.625/1528.039] [MU: 3.33/28495.17] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1552.84] [M: 28506.16] [ET: 2.738/1530.971] [MU: 3.53/28505.28] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp598)) OR (scr_area_type = 5 AND scr_area_id IN (:gp596)) OR (scr_area_type = 2 AND scr_area_id IN (:gp599)) OR (scr_area_type = 4 AND scr_area_id IN (:gp600)) OR (scr_area_type = 1 AND scr_area_id IN (:gp597)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp596":"3699",":gp597":"31",":gp598":"3699",":gp599":"105",":gp600":"1","scv_id":"113"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1553.588] [M: 28511.45] [ET: 0.366/1531.736] [MU: 7.1/28511.34] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1555.226] [M: 28523.96] [ET: 0.925/1533.387] [MU: 7.88/28523.85] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1556.128] [M: 28529.44] [ET: 0.806/1534.288] [MU: 8.26/28529.33] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1556.92] [M: 28536.97] [ET: 0.307/1535.078] [MU: 1/28536.59] 
	SQL: SELECT cts_airport_pickup_entry_fee
               FROM   cities
               INNER JOIN cities_stats
               ON cities.cty_id = cities_stats.cts_cty_id
               WHERE  cty_id = :cityId
               AND cty_is_airport = 1 AND cty_active = 1 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1558.71] [M: 28550.88] [ET: 1.202/1536.85] [MU: 8.14/28550.77] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1560.261] [M: 28558.63] [ET: 1.37/1538.398] [MU: 8.08/28558.52] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1560.871] [M: 28557.96] [ET: 0.478/1539.013] [MU: 0.89/28557.71] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1562.288] [M: 28570.3] [ET: 0.612/1540.424] [MU: 2.97/28569.87] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1563.404] [M: 28599.48] [ET: 0.961/1541.542] [MU: 22.53/28598.73] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp603)) OR (apr_area_type = 5 AND apr_area_id IN (:gp601)) OR (apr_area_type = 2 AND apr_area_id IN (:gp604)) OR (apr_area_type = 4 AND apr_area_id IN (:gp605)) OR (apr_area_type = 1 AND apr_area_id IN (:gp602))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp601":"3699",":gp602":"31",":gp603":"30804",":gp604":"105",":gp605":"1","cab":"113"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1565.022] [M: 28586.5] [ET: 0.464/1543.179] [MU: 3.34/28586.06] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1567.682] [M: 28597.05] [ET: 2.537/1545.814] [MU: 3.53/28596.17] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp608)) OR (scr_area_type = 5 AND scr_area_id IN (:gp606)) OR (scr_area_type = 2 AND scr_area_id IN (:gp609)) OR (scr_area_type = 4 AND scr_area_id IN (:gp610)) OR (scr_area_type = 1 AND scr_area_id IN (:gp607)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp606":"3699",":gp607":"31",":gp608":"3699",":gp609":"105",":gp610":"1","scv_id":"113"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1568.548] [M: 28600.25] [ET: 0.361/1546.695] [MU: 2.97/28600.14] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1570.656] [M: 28617.39] [ET: 0.384/1548.801] [MU: 7.1/28617.28] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1571.094] [M: 28617.72] [ET: 0.328/1549.24] [MU: 2.97/28617.61] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1575.502] [M: 28653.61] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"3","tripDistance":"664","tripDuration":"690","multiCityData":"[{\"pickup_city\":\"30804\",\"drop_city\":\"30711\",\"pickup_address\":\"\",\"drop_address\":null,\"date\":\"2024-10-31 18:00:00\",\"distance\":\"664\",\"duration\":\"680\"}]","bookingType":"1","pickupAddress":"","dropupAddress":"","routeDataArr":[{"locLatVal":"","locLonVal":"","brtLocationVal":""},{"locLatVal":"","locLonVal":"","brtLocationVal":""}],"pickupDate":"31\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=3&tripDistance=664&tripDuration=690&multiCityData=%5B%7B%22pickup_city%22%3A%2230804%22%2C%22drop_city%22%3A%2230711%22%2C%22pickup_address%22%3A%22%22%2C%22drop_address%22%3Anull%2C%22date%22%3A%222024-10-31+18%3A00%3A00%22%2C%22distance%22%3A%22664%22%2C%22duration%22%3A%22680%22%7D%5D&bookingType=1&pickupAddress=&dropupAddress=&routeDataArr%5B0%5D%5BlocLatVal%5D=&routeDataArr%5B0%5D%5BlocLonVal%5D=&routeDataArr%5B0%5D%5BbrtLocationVal%5D=&routeDataArr%5B1%5D%5BlocLatVal%5D=&routeDataArr%5B1%5D%5BlocLonVal%5D=&routeDataArr%5B1%5D%5BbrtLocationVal%5D=&pickupDate=31%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1575.941] [M: 28672.7] [ET: 0.934/1554.105] [MU: 21.05/28672.59] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1575.973] [M: 28674.38] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1577.121] [M: 28687.84] [ET: 1.012/1555.264] [MU: 3/28685.34] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+10013),(IF((cpm_value_type=2),(10013+(10013*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30937 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30937) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-31 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=113 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1578.726] [M: 28730.07] [ET: 3.773/1556.879] [MU: 78.88/28729.91] 
	RouteRates::calculate for CAB 113 2024-10-31 18:00:00 - Trip Type: 1 887412977
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1578.877] [M: 28707.76] [ET: 33.598/1557.042] [MU: 243.09/28707.6] 
	Quote::calculateRules for CAB 113, From City Id: 30804, To city Id: 30711
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1579.17] [M: 28679.39] [ET: 0.215/1557.33] [MU: 0.9/28679.14] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"113"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1579.245] [M: 28681.58] [ET: 45.465/1557.41] [MU: 318/28681.48] 
	Quote For CabType: 113
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1580.943] [M: 28691.55] [ET: 0.51/1559.078] [MU: 2.97/28691.12] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1581.546] [M: 28697.37] [ET: 0.488/1559.688] [MU: 3.33/28696.93] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1582.194] [M: 28700.3] [ET: 0.532/1560.331] [MU: 0.9/28700.05] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1582.875] [M: 28732.66] [ET: 0.516/1561.008] [MU: 24.22/28731.16] 
	SQL: SELECT scv_id, CASE
				WHEN scr_area_type=1 AND scr_area_id IN (31) THEN 10
				WHEN scr_area_type=1 AND scr_area_id IN (0) THEN 9
				WHEN scr_area_type=2 AND scr_area_id IN (105) THEN 5
				WHEN scr_area_type=2 AND scr_area_id IN (100) THEN 4
				WHEN scr_area_type=3 AND scr_area_id IN (30804) THEN 20
				WHEN scr_area_type=3 AND scr_area_id IN (30711) THEN 19
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 3
				WHEN scr_area_type=4 AND scr_area_id IN (1) THEN 2
				WHEN scr_area_type=5 THEN 25
				ELSE 1
				END AS rank, 
			scc_id, scr_is_allowed 
		FROM service_class_rule 
		INNER JOIN svc_class_vhc_cat ON scv_id = scr_scv_id AND scv_active = 1
		INNER JOIN service_class ON scv_scc_id = scc_id
		WHERE   ((scr_area_type = 1 AND scr_area_id IN (:gp611)) 
			OR (scr_area_type = 2 AND scr_area_id IN (:gp614,:gp615)) 
			OR (scr_area_type = 3 AND scr_area_id IN (:gp612,:gp613)) 
			OR (scr_area_type = 4 AND scr_area_id IN (:gp616,:gp617))
			OR (scr_area_type = 5 AND scr_area_id IN (3699))
			OR scr_area_type IS NULL)
			AND (scr_trip_type = :tripType OR scr_trip_type IS NULL) 
			AND scr_active = 1 AND scv_id IN (114)
		ORDER BY rank DESC
		 
	 [params: {":gp611":"31",":gp612":"30804",":gp613":"30711",":gp614":"105",":gp615":"100",":gp616":"1",":gp617":"1","tripType":"1"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1583.69] [M: 28712.85] [ET: 0.237/1561.851] [MU: 0.84/28712.66] 
	SQL: SELECT cts_category FROM cities_stats WHERE cts_cty_id = :cityId 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1584.075] [M: 28715.7] [ET: 0.303/1562.229] [MU: 0.93/28715.38] 
	SQL: SELECT GROUP_CONCAT(adn_id) as ids FROM addon_service_class_rule INNER JOIN addons ON ascr_adn_id = adn_id AND adn_active=1 AND ascr_active = 1 WHERE ascr_cty_category=:cat AND ascr_scc_id=:class 
	 [params: {"cat":2,"class":"6"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1585.331] [M: 28728.53] [ET: 0.434/1563.489] [MU: 2.04/28728.03] 
	SQL: SELECT svc1.* FROM `svc_class_vhc_cat` svc
                INNER JOIN service_class sc1 ON svc.scv_scc_id=sc1.scc_id AND svc.scv_active = 1 AND sc1.scc_active = 1 
                INNER JOIN svc_class_vhc_cat svc1 ON svc1.scv_vct_id=svc.scv_vct_id AND sc1.scc_id=svc1.scv_scc_id AND svc1.scv_active = 1 AND svc1.scv_model=0
                WHERE 1 AND svc.scv_id = :scvId 
	 [params: {"scvId":"114"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1586.243] [M: 28994.16] [ET: 0.681/1564.398] [MU: 259.78/28993.29] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"114","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1587.931] [M: 29010.8] [ET: 0.538/1566.087] [MU: 3.78/29009.92] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"73","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1589.496] [M: 29027.41] [ET: 0.451/1567.652] [MU: 3.78/29026.54] 
	SQL: SELECT route.rut_id, route.rut_from_city_id start,route.rut_to_city_id end, NULL AS fromAlias, NULL AS toAlias, rut_name,route.rut_estm_distance as quotedDistance, route.rut_estm_distance as rateDistance,
                                0 AS extraDistance, 
								0 AS extraStartDistance,
								1 as rank,
                                0 as startTime, 0 as endTime, route.rut_estm_time,rate.*
                        FROM   route
						INNER JOIN rate ON rut_id = rate.rte_route_id AND rate.rte_status=1 AND rate.rte_vendor_amount>0 AND rate.rte_vehicletype_id=:cabType
                        WHERE  rut_active = 1 AND route.rut_from_city_id =:fromCity AND route.rut_to_city_id =:toCity 
	 [params: {"cabType":"3","fromCity":"30804","toCity":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1590.816] [M: 29038.51] [ET: 5.398/1568.958] [MU: 308.55/29038.35] 
	Quote::calculateOneWay  for CAB 114 Date: 2024-10-31 18:00:00
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1591.438] [M: 29042.01] [ET: 0.484/1569.597] [MU: 0.9/29041.76] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1592.538] [M: 29054.72] [ET: 0.481/1570.696] [MU: 3.33/29054.28] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1593.157] [M: 29083.89] [ET: 0.495/1571.289] [MU: 22.53/29083.14] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp620)) OR (apr_area_type = 5 AND apr_area_id IN (:gp618)) OR (apr_area_type = 2 AND apr_area_id IN (:gp621)) OR (apr_area_type = 4 AND apr_area_id IN (:gp622)) OR (apr_area_type = 1 AND apr_area_id IN (:gp619))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp618":"3699",":gp619":"31",":gp620":"30804",":gp621":"105",":gp622":"1","cab":"114"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1594.992] [M: 29070.91] [ET: 0.453/1573.148] [MU: 3.34/29070.48] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1597.922] [M: 29081.46] [ET: 2.803/1576.05] [MU: 3.53/29080.59] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp625)) OR (scr_area_type = 5 AND scr_area_id IN (:gp623)) OR (scr_area_type = 2 AND scr_area_id IN (:gp626)) OR (scr_area_type = 4 AND scr_area_id IN (:gp627)) OR (scr_area_type = 1 AND scr_area_id IN (:gp624)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp623":"3699",":gp624":"31",":gp625":"3699",":gp626":"105",":gp627":"1","scv_id":"114"}]
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1598.773] [M: 29086.75] [ET: 0.42/1576.912] [MU: 7.1/29086.64] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1601.042] [M: 29099.27] [ET: 1.293/1579.18] [MU: 7.88/29099.16] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1602.391] [M: 29104.74] [ET: 1.208/1580.512] [MU: 8.27/29104.63] 
	BookingRoute::calculateDistance
2024/10/17 13:53:54 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1603.537] [M: 29112.27] [ET: 0.405/1581.675] [MU: 0.99/29111.9] 
	SQL: SELECT cts_airport_pickup_entry_fee
               FROM   cities
               INNER JOIN cities_stats
               ON cities.cty_id = cities_stats.cts_cty_id
               WHERE  cty_id = :cityId
               AND cty_is_airport = 1 AND cty_active = 1 
	 [params: {"cityId":"30804"}]
2024/10/17 13:53:55 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1605.537] [M: 29126.19] [ET: 1.282/1583.674] [MU: 8.13/29126.08] 
	BookingRoute::calculateDistance
2024/10/17 13:53:55 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1606.933] [M: 29133.93] [ET: 1.217/1585.077] [MU: 8.08/29133.82] 
	BookingRoute::calculateDistance
2024/10/17 13:53:55 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1607.459] [M: 29133.27] [ET: 0.414/1585.613] [MU: 0.9/29133.02] 
	SQL: SELECT rut_id FROM `route` WHERE rut_from_city_id =:fromCty AND rut_to_city_id=:toCty AND rut_active = 1 
	 [params: {"fromCty":"30804","toCty":"30711"}]
2024/10/17 13:53:55 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1608.768] [M: 29145.61] [ET: 0.659/1586.925] [MU: 2.96/29145.17] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:55 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1609.452] [M: 29174.78] [ET: 0.569/1587.607] [MU: 22.53/29174.03] 
	SQL: SELECT area_price_rule.*,
					CASE area_price_rule.apr_area_type
					WHEN 1 THEN 10
					WHEN 2 THEN 5
					WHEN 3 THEN 20   
					ELSE 1
					END AS rank
				FROM area_price_rule 
				WHERE apr_active=1 AND ((apr_area_type = 3 AND apr_area_id IN (:gp630)) OR (apr_area_type = 5 AND apr_area_id IN (:gp628)) OR (apr_area_type = 2 AND apr_area_id IN (:gp631)) OR (apr_area_type = 4 AND apr_area_id IN (:gp632)) OR (apr_area_type = 1 AND apr_area_id IN (:gp629))) AND apr_cab_type=:cab ORDER BY rank DESC 
	 [params: {":gp628":"3699",":gp629":"31",":gp630":"30804",":gp631":"105",":gp632":"1","cab":"114"}]
2024/10/17 13:53:55 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1611.336] [M: 29161.8] [ET: 0.571/1589.477] [MU: 3.34/29161.37] 
	SQL: SELECT stt_id, GROUP_CONCAT(DISTINCT zct_zon_id) zones, stt_zone AS region
				FROM   cities
				INNER JOIN states ON cty_state_id = stt_id AND stt_active = '1'
				LEFT JOIN zone_cities ON cty_id = zct_cty_id AND zct_active = 1
				LEFT JOIN zones ON zon_id=zct_zon_id AND zon_active=1
				WHERE  cty_id =:city AND cty_active = 1 
	 [params: {"city":"30804"}]
2024/10/17 13:53:55 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1614.775] [M: 29172.35] [ET: 3.255/1592.89] [MU: 3.53/29171.48] 
	SQL: SELECT service_class_rule.*,
					CASE 
						WHEN scr_area_type=1 THEN 10
						WHEN scr_area_type=2 THEN 5
						WHEN scr_area_type=3 THEN 20
						WHEN scr_area_type=4 THEN 3
						WHEN scr_area_type=5 THEN 25
						ELSE 1
					END AS rank FROM service_class_rule
				INNER JOIN svc_class_vhc_cat scv ON scv.scv_id = scr_scv_id
				WHERE ((scr_area_type = 3 AND scr_area_id IN (:gp635)) OR (scr_area_type = 5 AND scr_area_id IN (:gp633)) OR (scr_area_type = 2 AND scr_area_id IN (:gp636)) OR (scr_area_type = 4 AND scr_area_id IN (:gp637)) OR (scr_area_type = 1 AND scr_area_id IN (:gp634)) OR scr_area_type IS NULL) 
					AND scv.scv_id=:scv_id AND scr_active=1
				ORDER BY rank DESC
						 
	 [params: {":gp633":"3699",":gp634":"31",":gp635":"3699",":gp636":"105",":gp637":"1","scv_id":"114"}]
2024/10/17 13:53:55 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1615.462] [M: 29175.55] [ET: 0.263/1593.625] [MU: 2.98/29175.45] 
	BookingRoute::calculateDistance
2024/10/17 13:53:55 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1616.883] [M: 29192.7] [ET: 0.248/1595.048] [MU: 7.1/29192.59] 
	BookingRoute::calculateDistance
2024/10/17 13:53:55 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1617.148] [M: 29193.02] [ET: 0.199/1595.314] [MU: 2.98/29192.91] 
	BookingRoute::calculateDistance
2024/10/17 13:53:55 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1621.33] [M: 29228.91] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.RouteRates.calculateDriverAllowance START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"3","tripDistance":"664","tripDuration":"690","multiCityData":"[{\"pickup_city\":\"30804\",\"drop_city\":\"30711\",\"pickup_address\":\"\",\"drop_address\":null,\"date\":\"2024-10-31 18:00:00\",\"distance\":\"664\",\"duration\":\"680\"}]","bookingType":"1","pickupAddress":"","dropupAddress":"","routeDataArr":[{"locLatVal":"","locLonVal":"","brtLocationVal":""},{"locLatVal":"","locLonVal":"","brtLocationVal":""}],"pickupDate":"31\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=3&tripDistance=664&tripDuration=690&multiCityData=%5B%7B%22pickup_city%22%3A%2230804%22%2C%22drop_city%22%3A%2230711%22%2C%22pickup_address%22%3A%22%22%2C%22drop_address%22%3Anull%2C%22date%22%3A%222024-10-31+18%3A00%3A00%22%2C%22distance%22%3A%22664%22%2C%22duration%22%3A%22680%22%7D%5D&bookingType=1&pickupAddress=&dropupAddress=&routeDataArr%5B0%5D%5BlocLatVal%5D=&routeDataArr%5B0%5D%5BlocLonVal%5D=&routeDataArr%5B0%5D%5BbrtLocationVal%5D=&routeDataArr%5B1%5D%5BlocLatVal%5D=&routeDataArr%5B1%5D%5BlocLonVal%5D=&routeDataArr%5B1%5D%5BbrtLocationVal%5D=&pickupDate=31%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 13:53:55 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1621.798] [M: 29248.01] [ET: 0.921/1599.961] [MU: 21.05/29247.9] 
	models.RouteRates.calculateDriverAllowance
2024/10/17 13:53:55 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1621.833] [M: 29249.69] 
============================================================Profile models.RouteRates.calculateDriverAllowance DONE==================================================
2024/10/17 13:53:55 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1623.186] [M: 29263.15] [ET: 1.207/1601.321] [MU: 2.99/29260.65] 
	SQL: SELECT * FROM (
                                SELECT *, FLOOR(IF((cpm_value_type=1),(cpm_value+10013),(IF((cpm_value_type=2),(10013+(10013*(cpm_value/100))),cpm_value))))amount,
                                    ((SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30804 GROUP BY z2.zct_cty_id)) as srcZones,
                                    (SELECT GROUP_CONCAT(z2.zct_zon_id) as srcZones FROM zone_cities z2
                                        WHERE z2.zct_active=1 AND zct_cty_id=30937 GROUP BY z2.zct_cty_id) as dstZones,
                                    (
                                    IF(cpm_agent_id IS NOT NULL, 1,0) +
                                    IF(cpm_source_city IS NOT NULL,54,0) +
                                    IF(cpm_destination_city IS NOT NULL,54,0) +
                                    IF(cpm_source_zone IS NOT NULL,18,0) +
                                    IF(cpm_destination_zone IS NOT NULL,18,0) +
                                    IF(cpm_source_state IS NOT NULL,6,0) +
                                    IF(cpm_destination_state IS NOT NULL,6,0) +
                                    IF(cpm_trip_type IS NOT NULL,1,0) +
                                    IF(cpm_vehicle_type IS NOT NULL,1,0)
                               ) as rank
                                FROM `channel_partner_markup`
                                WHERE cpm_active=1) a
                            WHERE
                            (
                                (cpm_source_city IS NULL OR cpm_source_city=30804) AND
                                (cpm_destination_city IS NULL OR cpm_destination_city=30937) AND
                                (cpm_source_zone IS NULL OR cpm_source_zone IN (srcZones)) AND
                                (cpm_destination_zone IS NULL OR cpm_destination_zone IN (dstZones))
                            )
                            AND cpm_agent_id = 1249
                            AND ('2024-10-31 18:00:00' BETWEEN cpm_from_date AND cpm_to_date)  AND (cpm_vehicle_type=114 OR cpm_vehicle_type IS NULL)  AND (cpm_trip_type=1 OR cpm_trip_type IS NULL)
                        ORDER BY rank DESC, amount DESC  LIMIT 1 
	 [params: []]
2024/10/17 13:53:55 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1625.194] [M: 29305.38] [ET: 4.347/1603.323] [MU: 78.87/29305.22] 
	RouteRates::calculate for CAB 114 2024-10-31 18:00:00 - Trip Type: 1 468698224
2024/10/17 13:53:55 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1625.481] [M: 29283.06] [ET: 34.563/1603.623] [MU: 243.09/29282.91] 
	Quote::calculateRules for CAB 114, From City Id: 30804, To city Id: 30711
2024/10/17 13:53:55 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1626.1] [M: 29254.7] [ET: 0.474/1604.237] [MU: 0.9/29254.45] 
	SQL: SELECT svc.scv_scc_id FROM svc_class_vhc_cat svc
					-- INNER JOIN service_class scc ON svc.scv_scc_id=scc_id
					WHERE scv_id=:cabId 
	 [params: {"cabId":"114"}]
2024/10/17 13:53:55 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1626.233] [M: 29256.88] [ET: 46.919/1604.381] [MU: 574/29256.79] 
	Quote For CabType: 114
2024/10/17 13:53:55 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1628.614] [M: 29299.69] 
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++profile models.QuotesDataCreated.setData START++++++++++++++++++++++++++++++++++++++++++++++++++
	URL: [POST]/aaohome/booking/getamountbyvehicle
	User IP: 192.168.1.240
	Referrer: http://localhost:84/aaohome/booking/create
	POST: {"fromCity":"30804","toCity":"30711","cabType":"3","tripDistance":"664","tripDuration":"690","multiCityData":"[{\"pickup_city\":\"30804\",\"drop_city\":\"30711\",\"pickup_address\":\"\",\"drop_address\":null,\"date\":\"2024-10-31 18:00:00\",\"distance\":\"664\",\"duration\":\"680\"}]","bookingType":"1","pickupAddress":"","dropupAddress":"","routeDataArr":[{"locLatVal":"","locLonVal":"","brtLocationVal":""},{"locLatVal":"","locLonVal":"","brtLocationVal":""}],"pickupDate":"31\/10\/2024","pickupTime":"06:00 PM","isGozonow":"0","minTripDistance":"0","tripUser":"1","YII_CSRF_TOKEN":"WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA==","isAirportPickup":"1"}
	RawBody: fromCity=30804&toCity=30711&cabType=3&tripDistance=664&tripDuration=690&multiCityData=%5B%7B%22pickup_city%22%3A%2230804%22%2C%22drop_city%22%3A%2230711%22%2C%22pickup_address%22%3A%22%22%2C%22drop_address%22%3Anull%2C%22date%22%3A%222024-10-31+18%3A00%3A00%22%2C%22distance%22%3A%22664%22%2C%22duration%22%3A%22680%22%7D%5D&bookingType=1&pickupAddress=&dropupAddress=&routeDataArr%5B0%5D%5BlocLatVal%5D=&routeDataArr%5B0%5D%5BlocLonVal%5D=&routeDataArr%5B0%5D%5BbrtLocationVal%5D=&routeDataArr%5B1%5D%5BlocLatVal%5D=&routeDataArr%5B1%5D%5BlocLonVal%5D=&routeDataArr%5B1%5D%5BbrtLocationVal%5D=&pickupDate=31%2F10%2F2024&pickupTime=06%3A00+PM&isGozonow=0&minTripDistance=0&tripUser=1&YII_CSRF_TOKEN=WXNPTUJMSWVRVldJOEx-d05yUlNaS2Uwb1Z1bjlxVVbcPYQNd6slCd-zuD_h2YBprDCwXjTsRSiXzK9TaRAgVA%3D%3D&isAirportPickup=1
	[UserID: 30] [UserType: 4]
2024/10/17 13:53:55 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1661.467] [M: 29384.55] [ET: 15.687/1639.598] [MU: 15.62/29384.44] 
	QuotesDataPickup::setData for CAB Array
2024/10/17 13:53:55 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1661.607] [M: 29380.13] [ET: 33.563/1639.748] [MU: 82.39/29380.02] 
	models.QuotesDataCreated.setData
2024/10/17 13:53:55 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1661.666] [M: 29381.8] 
============================================================Profile models.QuotesDataCreated.setData DONE==================================================
2024/10/17 13:53:55 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1661.857] [M: 29378.2] [ET: 1336.744/1639.998] [MU: 10556.43/29378.11] 
	models.Quote.getQuote
2024/10/17 13:53:55 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1662.041] [M: 29381.7] 
============================================================Profile models.Quote.getQuote DONE==================================================
2024/10/17 13:53:55 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1720.437] [M: 30064.88] [ET: 2.118/1698.564] [MU: 1.97/30064.5] 
	SQL: SELECT dzs_zone_type FROM dynamic_zone_surge WHERE dzs_fromzoneid IN (:gp638) AND dzs_tozoneid IN (:gp639,:gp640) AND dzs_scv_id=:cab AND dzs_booking_type=:tripType  ORDER BY  dzs_zone_type ASC 
	 [params: {":gp639":"238",":gp640":"79",":gp638":"31","cab":3,"tripType":"1"}]
2024/10/17 13:53:55 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1726.987] [M: 30067.78] [ET: 5.937/1705.133] [MU: 1.24/30067.16] 
	SQL: SELECT prc_cancel_rule_id FROM `partner_cancel_rule` 
			WHERE (prc_zone_category = :zoneType OR prc_zone_category IS NULL)
		AND (prc_scc_id = :sccId OR prc_scc_id IS NULL)
		AND (prc_partner_id = :partnerId OR prc_partner_id IS NULL) 
		AND (prc_bkg_type = :tripType OR prc_bkg_type IS NULL) 
		 AND (prc_is_gozonow IS NULL) 
		AND prc_active=1  
		ORDER BY prc_partner_id DESC, prc_bkg_type DESC  
	 [params: {"zoneType":1,"sccId":"1","partnerId":null,"tripType":"1"}]
2024/10/17 13:53:55 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1737.112] [M: 30144.17] [ET: 5.784/1715.239] [MU: 1.42/30143.98] 
	SQL: SELECT acp_cr_to,acp_margin_data FROM `addon_cancellation_policy` WHERE `acp_id` = :id 
	 [params: {"id":"8"}]
2024/10/17 13:53:55 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1760.162] [M: 30183.48] [ET: 0.508/1738.289] [MU: 1.42/30183.3] 
	SQL: SELECT acp_cr_to,acp_margin_data FROM `addon_cancellation_policy` WHERE `acp_id` = :id 
	 [params: {"id":"9"}]
2024/10/17 13:53:55 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1770.386] [M: 30262.13] [ET: 6.055/1748.514] [MU: 1.34/30261.94] 
	SQL: SELECT acm_svc_id_to,acm_margin_data FROM `addon_cab_models` WHERE `acm_id` = :id 
	 [params: {"id":"1"}]
2024/10/17 13:53:55 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1771.452] [M: 30265.94] [ET: 0.292/1749.592] [MU: 1.34/30265.75] 
	SQL: SELECT acm_svc_id_to,acm_margin_data FROM `addon_cab_models` WHERE `acm_id` = :id 
	 [params: {"id":"2"}]
2024/10/17 13:53:55 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1772.256] [M: 30269.38] [ET: 0.246/1750.399] [MU: 1.34/30269.19] 
	SQL: SELECT acm_svc_id_to,acm_margin_data FROM `addon_cab_models` WHERE `acm_id` = :id 
	 [params: {"id":"3"}]
2024/10/17 13:53:55 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1773.023] [M: 30272.81] [ET: 0.233/1751.165] [MU: 1.35/30272.63] 
	SQL: SELECT acm_svc_id_to,acm_margin_data FROM `addon_cab_models` WHERE `acm_id` = :id 
	 [params: {"id":"4"}]
2024/10/17 13:53:55 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1792.074] [M: 30608.1] [ET: 12.488/1770.217] [MU: 48.57/30606.85] 
	SQL:  SELECT scv_id,scc_id, vct_id, scc_cancel_rule, scc_label,scc_rank, scv_label, scv_code, scc_model_year, 
								CONCAT(vct_label, ' (', scc_label , ')') label,
									vct_label,vct_rank, vct_desc, CONCAT(vct_label, ' ', vct_desc) vhcName, 
									vct_capacity, IF(vct_image IS NULL, 'images/cabs/no-image.png', vct_image) as vct_image, vct_big_bag_capacity, vct_small_bag_capacity, vcsc_small_bag, FLOOR(vcsc_small_bag/2) AS big_bag,
									scc_is_cng, scc_is_petrol_diesel, scc_id, scc_desc, IF( vct_id IN(5, 6), '1', '0' ) AS is_assured, scv_vct_id,scv_parent_id,scv_vct_id,scv_model,scv_scc_id
						FROM svc_class_vhc_cat
						INNER JOIN service_class ON scc_id = scv_scc_id
						INNER JOIN vehicle_category ON vct_id = scv_vct_id
						INNER JOIN vehicle_cat_svc_class on vcsc_ssc_id = scv_scc_id AND vcsc_vct_id = scv_vct_id
						WHERE scv_active = 1 
							AND scc_active = 1 
						AND vct_active = 1
		 AND scv_vct_id = 3 
	 [params: []]
2024/10/17 13:53:55 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1803.912] [M: 30550.96] [ET: 1717.805/1782.042] [MU: 20493.24/30550.84] 
	module.admin.controller.booking.getamountbyvehicle
2024/10/17 13:53:55 [profile] [profile.module.admin.controller.booking.getamountbyvehicle] [T: 1803.968] [M: 30551.61] 
*******************************************************module.admin.controller.booking.getamountbyvehicle ACTION DONE****************************************************************
